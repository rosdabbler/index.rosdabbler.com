<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Index</title>
    <meta name="description" content="a community-maintained index of robotics software
">

    
    <link rel="canonical" href="http://index.rosdabbler.com/r/lidar_situational_graphs/github-snt-arg-lidar_situational_graphs/">
    
    
    <link rel="icon" sizes="any" type="image/svg+xml" href="/assets/rosindex_logo.svg">

    

    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">
    

    

    <script type="text/javascript" src=/js/jquery.js></script>
    <script src=/bootstrap/js/bootstrap.min.js type="text/javascript"></script>
    <script src=/js/jquery-cookie.js type="text/javascript"></script>
    
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EVD5Z6G6NH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EVD5Z6G6NH');
</script>

    <script type="text/javascript" src=/js/toc.js></script>

    <script src=/js/distro_switch.js></script>
  </head>

  <body>

    <header class="site-header">

  <div class="wrapper">
    <div class="container-fluid" style="margin-bottom: 10px">
      <div class="row">
        <!-- title -->
        <div class="col-xs-3" style="white-space:nowrap">
          <a class="site-title" href="/">
            <img src="/assets/rosindex_logo.svg" width="26" height="26" alt="ROS index logo" style="padding-bottom: 3px"/>
            ROS Index</a>
        </div>
        <!-- main internal links -->
        <div class="col-xs-6 text-center" style="padding:0px">
          <div class="btn-group hidden-xs" role="group" aria-label="..." style="padding: 6px">
            <div class="btn-group" role="group">
              <a href="/?search_packages=true" class="btn btn-default" role="button">Package List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/?search_repos=true" class="btn btn-default" role="button">Repository List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/search_deps" class="btn btn-default" role="button">System Dependencies</a>
            </div>
          </div>
          <div class="hidden-lg hidden-md hidden-sm">
            <button id="hLabel" class="btn btn-link dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Lists <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="hLabel">
              <li><a href="/?search_packages=true">Package List</a></li>
              <li><a href="/?search_repos=true">Repository List</a></li>
              <li><a href="/search_deps">System Dependencies</a></li>
            </ul>
          </div>
        </div>
        <!-- additional links -->
        <div class="col-xs-3 text-right" style="white-space:nowrap; padding:0px">
          <ul class="list-inline" style="margin-bottom:0px;">
            <li class="dropdown hidden-xs hidden-sm">
              <button id="rLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                ROS Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu" aria-labelledby="rLabel">
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-xs hidden-sm">
              <button id="aLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                About <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="aLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-md hidden-lg">
              <button id="qLabel" class="btn btn-link" type="button"
                      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="qLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
                <hr style="margin:7px" />
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin-top:20px">
  <div class="container-fluid">
    <div class="row">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/repos">Repos</a></li>
        <li class="active">lidar_situational_graphs</li>
        <!--<li class="active">lidar_situational_graphs</li>-->
      </ol>
    </div>
    <div class="row">
      

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
    <label id="humble-option" class="distro-button btn btn-xs btn-primary" href="#humble" data="humble">
      <input type="radio" name="options" id="humble-radio" autocomplete="off"> humble
    </label>
  
    <label id="jazzy-option" class="distro-button btn btn-xs btn-default" href="#jazzy" data="jazzy">
      <input type="radio" name="options" id="jazzy-radio" autocomplete="off"> jazzy
    </label>
  
    <label id="kilted-option" class="distro-button btn btn-xs btn-default" href="#kilted" data="kilted">
      <input type="radio" name="options" id="kilted-radio" autocomplete="off"> kilted
    </label>
  
    <label id="rolling-option" class="distro-button btn btn-xs btn-default" href="#rolling" data="rolling">
      <input type="radio" name="options" id="rolling-radio" autocomplete="off"> rolling
    </label>
  
    <label id="github-option" class="distro-button btn btn-xs btn-default" href="#github" data="github">
      <input type="radio" name="options" id="github-radio" autocomplete="off"> github
    </label>
  
    <label id="noetic-option" class="distro-button btn btn-xs btn-default" href="#noetic" data="noetic">
      <input type="radio" name="options" id="noetic-radio" autocomplete="off"> noetic
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-primary" data-toggle="dropdown" id="older-distro-button">
        <input type="radio" name="options" autocomplete="off">
      <span id="older-label">Older</span>
      <span class="caret"></span>
    </label>
    <ul class="dropdown-menu" role="menu">
      
        <li data="galactic" id="galactic-option" class="disabled older-distro-option"  href="#galactic">
          <a href="#galactic" data="galactic" id="galactic-button">galactic</a>
        </li>
      
        <li data="iron" id="iron-option" class=" older-distro-option"  href="#iron">
          <a href="#iron" data="iron" id="iron-button">iron</a>
        </li>
      
        <li data="melodic" id="melodic-option" class="disabled older-distro-option"  href="#melodic">
          <a href="#melodic" data="melodic" id="melodic-button">melodic</a>
        </li>
      
    </ul>
  </div>
</div>

    </div>
    <div class="row">
      &nbsp;
    </div>
  </div>
</div>


  <div class="distro distro-humble">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/lidar_situational_graphs">lidar_situational_graphs</a> <small>repository</small></h3>
        
        
        <a class="label label-primary pkg-label" href="/p/lidar_situational_graphs">lidar_situational_graphs</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-snt-arg-lidar_situational_graphs
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-snt-arg-lidar_situational_graphs" role="menuitem" tabindex="-1" href="/r/lidar_situational_graphs/github-snt-arg-lidar_situational_graphs" data="github-snt-arg-lidar_situational_graphs">
                    <span class="glyphicon glyphicon-star"></span>
                    github-snt-arg-lidar_situational_graphs
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">Repository to generate in real-time Situational Graphs (S-Graphs) for robot pose and map optimization using 3D LiDAR Data</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/snt-arg/lidar_situational_graphs.git">https://github.com/snt-arg/lidar_situational_graphs.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">feature/ros2</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2024-07-02
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/lidar_situational_graphs/#humble-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/lidar_situational_graphs/#humble-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/lidar_situational_graphs/#humble-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/lidar_situational_graphs">lidar_situational_graphs</a></td>
                    <td>0.0.1</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<div align="center">
 <h1>LiDAR S-Graphs</h1>

<a href="https://github.com/snt-arg/lidar_situational_graphs/actions/workflows/foxy_build.yaml"><img src="https://github.com/snt-arg/lidar_situational_graphs/actions/workflows/foxy_build.yaml/badge.svg"></a>
<a href="https://github.com/snt-arg/lidar_situational_graphs/actions/workflows/humble_build.yaml"><img src="https://github.com/snt-arg/lidar_situational_graphs/actions/workflows/humble_build.yaml/badge.svg"></a>
<a href="https://github.com/snt-arg/lidar_situational_graphs/actions/workflows/iron_build.yaml"><img src="https://github.com/snt-arg/lidar_situational_graphs/actions/workflows/iron_build.yaml/badge.svg"></a>

</div>

<p><strong>LiDAR Situational Graphs (S-Graphs)</strong> is a ROS2 package for generating in real-time four-layered hierarchical factor graphs representing a scene graph using 3D LiDAR which includes <strong><em>Keyframes</em></strong> registring the robot poses, <strong><em>Walls</em></strong> which map wall planes, <strong><em>Rooms Layer</em></strong> constraining the wall planes using 4 wall-room or 2 wall-room factors, <strong><em>Floors</em></strong> constraining the rooms within a given floor level. It also supports several graph constraints, such as GPS, IMU acceleration (gravity vector), IMU orientation (magnetic sensor). We have tested this package mostly with Velodyne (VLP16) sensors in structured indoor environments. This work is a fork of <a href="https://github.com/koide3/hdl_graph_slam">hdl_graph_slam</a> which as previously in ROS1.</p>

<p align="center">
  <a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/">
    <img src="https://raw.githubusercontent.com/snt-arg/lidar_situational_graphs/feature/ros2/./imgs/s_graphs_rotating.gif" alt="Logo" width="80%">
  </a>
</p>

<h2 id="-table-of-contents">📜 Table of contents</h2>

<ul>
  <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#published-papers">📖 Published Papers</a></li>
  <li>
<a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#installation">⚙️ Installation</a>
    <ul>
      <li>
<a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#installation-from-source">📦 Installation From Source</a>
        <ul>
          <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#installation-for-ros1">ROS1 Optional</a></li>
        </ul>
      </li>
      <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#docker">🐳 Docker</a></li>
    </ul>
  </li>
  <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#examples">🚀 Examples on Datasets</a></li>
  <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#custom-data">🛠️ Run S_Graphs On Your Data</a></li>
  <li>
<a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#ros-related">🤖 ROS Related</a>
    <ul>
      <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#subscribed-topics">📥 Subscribed Topics</a></li>
      <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#published-topics">📤 Published Topics</a></li>
      <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#ros-services">🔄 ROS Services</a></li>
      <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#ros-parameters">⚙️ ROS Parameters</a></li>
      <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#published-tfs">🌐 Published TFs</a></li>
    </ul>
  </li>
  <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#unit-tests">🧪 Unit Tests</a></li>
</ul>

<h2 id="-published-papers-">📖 Published Papers <a id="published-papers"></a>
</h2>

<details>
    <summary><a href="https://arxiv.org/abs/2212.11770">S-Graphs+: Real-time Localization and Mapping leveraging Hierarchical Representations </a>
    </summary>

    @ARTICLE{10168233,
     author={Bavle, Hriday and Sanchez-Lopez, Jose Luis and Shaheer, Muhammad and Civera, Javier and Voos, Holger},
     journal={IEEE Robotics and Automation Letters},
     title={S-Graphs+: Real-Time Localization and Mapping Leveraging Hierarchical Representations},
     year={2023},
     volume={8},
     number={8},
     pages={4927-4934},
     doi={10.1109/LRA.2023.3290512}}

</details>
<details>
    <summary><a href="https://arxiv.org/abs/2202.12197">Situational Graphs for Robot Navigation in Structured Indoor Environments</a></summary>

      @ARTICLE{9826367,
        author={Bavle, Hriday and Sanchez-Lopez, Jose Luis and Shaheer, Muhammad and Civera, Javier and Voos, Holger},
        journal={IEEE Robotics and Automation Letters},
        title={Situational Graphs for Robot Navigation in Structured Indoor Environments},
        year={2022},
        volume={7},
        number={4},
        pages={9107-9114},
        doi={10.1109/LRA.2022.3189785}}

</details>

<h2 id="️-installation-">⚙️ Installation <a id="installation"></a>
</h2>

<!-- TODO: When s-graphs is available in rosdistro add here the command to install -->

<blockquote>
  <p>[!NOTE]
S-Graphs+ was only tested on Ubuntu 20.04, ROS2 Foxy, Humble Distros.
We strongly recommend using <a href="https://docs.ros.org/en/humble/Installation/DDS-Implementations/Working-with-Eclipse-CycloneDDS.html">cyclone_dds</a> instead of the default fastdds.</p>
</blockquote>

<h3 id="-installation-from-source-">📦 Installation From Source <a id="installation-from-source"></a>
</h3>

<blockquote>
  <p>[!IMPORTANT]
Before proceeding, make sure you have <code class="language-plaintext highlighter-rouge">rosdep</code> installed. You can install it using <code class="language-plaintext highlighter-rouge">sudo apt-get install python3-rosdep</code>
In addition, ssh keys are needed to be configured on you GitHub account. If you haven’t
yet configured ssh keys, follow this <a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent">tutorial</a></p>
</blockquote>

<ol>
  <li>Update Rosdep:</li>
</ol>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rosdep init <span class="o">&amp;&amp;</span> rosdep update <span class="nt">--include-eol-distros</span>

</code></pre></div></div>

<ol>
  <li>Create a ROS2 workspace for S-Graphs</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> <span class="nv">$HOME</span>/workspaces <span class="o">&amp;&amp;</span> <span class="nb">cd</span> <span class="nv">$HOME</span>/workspaces

</code></pre></div></div>

<ol>
  <li>Clone the S-Graphs repository into the created workspace</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone git@github.com:snt-arg/lidar_situational_graphs.git <span class="nt">-b</span> feature/ros2 s_graphs 

</code></pre></div></div>

<blockquote>
  <p>[!IMPORTANT]
If you have Nvidia GPU please install CUDA from this <a href="https://developer.nvidia.com/cuda-11-8-0-download-archive">link</a>. This code has only been tested with CUDA 11.8.
If you dont have CUDA S-Graphs will use CPU only.</p>
</blockquote>

<ol>
  <li>Install required dependencies. Change $ROS_DISTRO to your ros2 version.</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>s_graphs <span class="o">&amp;&amp;</span> <span class="nb">source</span> /opt/ros/<span class="nv">$ROS_DISTRO</span>/setup.sh <span class="o">&amp;&amp;</span> ./setup.sh

</code></pre></div></div>

<blockquote>
  <p>[!NOTE]
If you want to compile with debug traces (from backward_cpp) run:</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>colcon build <span class="nt">--symlink-install</span> <span class="nt">--cmake-args</span> <span class="nt">-DCMAKE_BUILD_TYPE</span><span class="o">=</span>RelWithDebInfo

</code></pre></div></div>

<h4 id="optional-ros1-install-old-version-of-room-segmentation-">Optional ROS1 Install (Old Version of Room Segmentation) <a id="installation-for-ros1"></a>
</h4>

<details>

&gt; [!NOTE]
&gt; This is an optional older version of room segmentation algorithm which requires ROS1 noetic. There is no hard dependecy on this package so you can easily ignore this step.

##### Download ROS Bridge <a id="download-ros-bridge"></a>


```bash
source /opt/ros/foxy/setup.bash &amp;&amp; sudo apt install ros-foxy-ros1-bridge

```

##### Installation on ROS1

&gt; [!IMPORTANT]
&gt; Before following the instructions from below, ensure that you are in a fresh
&gt; terminal, **without ROS2 sourced**.

1. Create a ROS1 workspace for S-Graphs


```bash
mkdir -p $HOME/workspaces/s_graphs_ros1_ws/src &amp;&amp; cd $HOME/workspaces/s_graphs_ros1_ws/src &amp;&amp; source /opt/ros/noetic/setup.bash

```

2. Clone the S-Graphs repository into the created workspace


```bash
git clone git@github.com:snt-arg/lidar_situational_graphs.git -b feature/ros2 s_graphs

```

3. Install required dependencies using `vcstool`


```bash
cd s_graphs &amp;&amp; vcs import --recursive ../ &lt; .rosinstall_ros1

```

4. Install required ROS packages


```bash
cd ../../ &amp;&amp; rosdep install --from-paths src --ignore-src -y -r

```

5. Install `pcl_ros`


```sh
sudo apt install ros-noetic-pcl-ros

```

6. Build workspace

&gt; [!IMPORTANT]
&gt; Make sure s_graphs_ros1_ws is built in Release otherwise the room extraction won't work properly.


```bash
catkin config --cmake-args -DCMAKE_BUILD_TYPE=Release &amp;&amp; catkin build

```

</details>

<h3 id="-docker-">🐳 Docker <a id="docker"></a>
</h3>

<h4 id="build-docker-image">Build Docker Image</h4>

<ol>
  <li>Create a ROS2 workspace for S-Graphs</li>
</ol>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> <span class="nv">$HOME</span>/workspaces <span class="o">&amp;&amp;</span> <span class="nb">cd</span> <span class="nv">$HOME</span>/workspaces

</code></pre></div></div>

<ol>
  <li>Change directory to where Dockerfile is located in <code class="language-plaintext highlighter-rouge">s_graphs</code>
</li>
</ol>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone git@github.com:snt-arg/lidar_situational_graphs.git <span class="nt">-b</span> feature/ros2 s_graphs <span class="o">&amp;&amp;</span> <span class="nb">cd</span> <span class="nv">$HOME</span>/workspaces/s_graphs/docker/foxy_noetic

</code></pre></div></div>

<ol>
  <li>Build image</li>
</ol>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker build <span class="nt">-t</span> sntarg/s_graphs <span class="nb">.</span>

</code></pre></div></div>

<blockquote>
  <p>[!NOTE]
There are two docker files, one for foxy and another for humble. The above commands build the foxy image, you use the same commands to build the humble image if needed.</p>
</blockquote>

<h2 id="-example-on-datasets-">🚀 Example on Datasets <a id="examples"></a>
</h2>

<blockquote>
  <p>[!WARNING]
For execution of the experiments we use <a href="https://github.com/pvolok/mprocs">mprocs</a>, which makes the process of launching different processes easier.</p>
</blockquote>

<h3 id="real-dataset">Real Dataset</h3>

<blockquote>
  <p>[!IMPORTANT]
Download real dataset using this <a href="https://uniluxembourg-my.sharepoint.com/:u:/g/personal/hriday_bavle_uni_lu/ET2kNySZrzVBlveGgvSByeUBAvQk5wl05GMF0NwqbkL6ZA?e=hoaaOo">link</a> and store it in the folder <code class="language-plaintext highlighter-rouge">~/Downloads/real</code>, the below mprocs script will not work otherwise.</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> <span class="nv">$HOME</span>/workspaces/s_graphs <span class="o">&amp;&amp;</span> mprocs <span class="nt">--config</span> .real_mprocs.yaml

</code></pre></div></div>

<h3 id="virtual-dataset">Virtual Dataset</h3>

<blockquote>
  <p>[!IMPORTANT]
Download virtual dataset using this <a href="https://uniluxembourg-my.sharepoint.com/:u:/g/personal/hriday_bavle_uni_lu/ETEfrz2n8qhKrXSJ712gNYgBtl5ra_9lUxZmsmyUa804ew?e=3XJOhG">link</a> and store it in the folder <code class="language-plaintext highlighter-rouge">~/Downloads/virtual</code>, the below mprocs script will not work otherwise.</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> <span class="nv">$HOME</span>/workspaces/s_graphs <span class="o">&amp;&amp;</span> mprocs <span class="nt">--config</span> .virtual_mprocs.yaml

</code></pre></div></div>

<h3 id="running-s_graphs-with-docker">Running S_Graphs with Docker</h3>

<blockquote>
  <p>[!NOTE]
This tutorial assumes that you have followed the instructions to setup docker
in section <a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#docker">🐳 Docker</a></p>
</blockquote>

<ol>
  <li>Create a container for the s_graphs image.</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="nt">-dit</span> <span class="nt">--volume</span><span class="o">=</span>/tmp/.X11-unix:/tmp/.X11-unix:rw <span class="nt">--network</span><span class="o">=</span>host <span class="nt">-e</span> <span class="nv">DISPLAY</span><span class="o">=</span><span class="nv">$DISPLAY</span> <span class="nt">--name</span> s_graphs_container sntarg/s_graphs

</code></pre></div></div>

<ol>
  <li>
    <p>Download the dataset you desire from above to your <strong>local machine</strong>.</p>
  </li>
  <li>
    <p>Move the rosbag inside docker container</p>
  </li>
</ol>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker <span class="nb">cp</span> ~/Downloads/real s_graphs_container:/root/Downloads/real <span class="c"># For real dataset</span>
<span class="c"># OR</span>
docker <span class="nb">cp</span> ~/Downloads/virtual s_graphs_container:/root/Downloads/virtual <span class="c"># For virtual dataset</span>

</code></pre></div></div>

<ol>
  <li>Execute the container</li>
</ol>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker <span class="nb">exec</span> <span class="nt">-ti</span> s_graphs_container bash

</code></pre></div></div>

<blockquote>
  <p>[!IMPORTANT]
If rviz2 doesnt open inside the docker, do <code class="language-plaintext highlighter-rouge">xhost +</code> in a terminal of your pc and then relaunch the mprocs command inside docker.</p>
</blockquote>

<ol>
  <li>Run mprocs</li>
</ol>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mprocs_real <span class="c"># To run on a real robot or a real dataset</span>
<span class="c"># OR</span>
mprocs_virtual <span class="c"># To run on a simulation or virtual dataset</span>

</code></pre></div></div>

<!--
4. Visualization using Rviz (open another terminal to run this command)

> [!NOTE]
> The command below assumes you has ros2 foxy on your local machine


```sh
source /opt/ros/foxy/setup.bash && rviz2 -d $HOME/workspaces/s_graphs_ros2_ws/src/s_graphs/rviz/s_graphs_ros2.rviz

```
-->

<blockquote>
  <p>[!NOTE]
Press reset on rviz2 once in a while when running S-Graphs to avoid freezing effect caused by rviz2 on foxy.</p>
</blockquote>

<h2 id="️-run-s_graphs-on-your-data-">🛠️ Run S_Graphs On Your Data <a id="custom-data"></a>
</h2>

<ol>
  <li>Define the transformation between your sensors (LIDAR, IMU, GPS) and base_link of your system using static_transform_publisher (see <a href="https://github.com/snt-arg/s_graphs/blob/c0489660552cb3a2fc8ac0bef17998ee5fb6e15a/launch/s_graphs_launch.py#L118">line</a>, s_graphs_launch.py). All the sensor data will be transformed into the common <code class="language-plaintext highlighter-rouge">base_link</code> frame, and then fed to the SLAM algorithm. Note: <code class="language-plaintext highlighter-rouge">base_link</code> frame in virtual dataset is set to <code class="language-plaintext highlighter-rouge">base_footprint</code> and in real dataset is set to <code class="language-plaintext highlighter-rouge">body</code>. You can set the <code class="language-plaintext highlighter-rouge">frames</code>, <code class="language-plaintext highlighter-rouge">topics</code> for your dataset easily during the launch execution as follows:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    ros2 launch lidar_situational_graphs s_graphs_launch.py compute_odom:<span class="o">=</span><span class="nb">true </span>lidar_topic:<span class="o">=</span>/rs_lidar/points

</code></pre></div></div>

<ol>
  <li>If you have an odometry source convert it to base ENU frame, then set the arg <code class="language-plaintext highlighter-rouge">compute_odom</code> to <code class="language-plaintext highlighter-rouge">false</code> in <code class="language-plaintext highlighter-rouge">s_graphs_ros2_launch.py</code> and then remap odom topic in <strong>s_graphs_node</strong> like</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  ros2 launch lidar_situational_graphs s_graphs_launch.py compute_odom:<span class="o">=</span><span class="nb">false </span>lidar_topic:<span class="o">=</span>/rs_lidar/points odom_topic:<span class="o">=</span>/odom

</code></pre></div></div>

<blockquote>
  <p>[!NOTE]
If you want to visualize the tfs correctly from your odom source, you MUST provide a tf from the <code class="language-plaintext highlighter-rouge">odom</code> to <code class="language-plaintext highlighter-rouge">base_link</code> frame.</p>
</blockquote>

<h2 id="-ros-related-">🤖 ROS Related <a id="ros-related"></a>
</h2>

<h3 id="-subscribed-topics-">📥 Subscribed Topics <a id="subscribed-topics"></a>
</h3>

<h4 id="s_graphs-node">
<code class="language-plaintext highlighter-rouge">s_graphs</code> node</h4>

<table>
  <thead>
    <tr>
      <th>Topic name</th>
      <th>Message Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/odom</code></td>
      <td><a href="http://docs.ros.org/en/noetic/api/nav_msgs/html/msg/Odometry.html">nav_msgs/Odometry</a></td>
      <td>The odometry from the robot.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/filtered_points</code></td>
      <td><a href="http://docs.ros.org/en/melodic/api/sensor_msgs/html/msg/PointCloud2.html">sensor_msgs/PointCloud2</a></td>
      <td>The filtered data from the LiDAR sensor.</td>
    </tr>
  </tbody>
</table>

<h4 id="room_segmentation-node">
<code class="language-plaintext highlighter-rouge">room_segmentation</code> node</h4>

<table>
  <thead>
    <tr>
      <th>Topic name</th>
      <th>Message Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/voxblox_skeletonizer/sparse_graph</code></td>
      <td><a href="http://docs.ros.org/en/noetic/api/visualization_msgs/html/msg/MarkerArray.html">visualization_msgs/MarkerArray</a></td>
      <td>Represents the free space where the robot can go to. Also known as free-space clusters.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/map_planes</code></td>
      <td><a href="https://github.com/snt-arg/s_graphs/blob/feature/ros2/msg/PlaneData.msg">s_graphs/PlanesData</a></td>
      <td>Planes seen by the current robot keyframe.</td>
    </tr>
  </tbody>
</table>

<h4 id="floor_plan-node">
<code class="language-plaintext highlighter-rouge">floor_plan</code> node</h4>

<table>
  <thead>
    <tr>
      <th>Topic name</th>
      <th>Message Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/all_map_planes</code></td>
      <td><a href="http://docs.ros.org/en/noetic/api/visualization_msgs/html/msg/MarkerArray.html">visualization_msgs/MarkerArray</a></td>
      <td>All the planes that have been seen by the robot.</td>
    </tr>
  </tbody>
</table>

<h3 id="-published-topics-">📤 Published Topics <a id="published-topics"></a>
</h3>

<h4 id="s_graphs-node-1">
<code class="language-plaintext highlighter-rouge">s_graphs</code> node</h4>

<table>
  <thead>
    <tr>
      <th>Topic name</th>
      <th>Message Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/markers</code></td>
      <td><a href="http://docs.ros.org/en/noetic/api/visualization_msgs/html/msg/MarkerArray.html">visualization_msgs/MarkerArray</a></td>
      <td>These markers represent the different s_graphs layers.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/odom2map</code></td>
      <td><a href="http://docs.ros.org/en/api/geometry_msgs/html/msg/TransformStamped.html">geometry_msgs/TransformStamped</a></td>
      <td>The estimated drift of the robot within its map frame (world).</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/odom_pose_corrected</code></td>
      <td><a href="http://docs.ros.org/en/noetic/api/geometry_msgs/html/msg/PoseStamped.html">geometry_msgs/PoseStamped</a></td>
      <td>The optimized/drift-free pose of the robot once odom2map is applied.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/odom_path_corrected</code></td>
      <td><a href="http://docs.ros.org/en/noetic/api/nav_msgs/html/msg/Path.html">nav_msgs/Path</a></td>
      <td>The optimized/drift-free pose path of the robot once the odom2map is applied.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/map_points</code></td>
      <td><a href="http://docs.ros.org/en/melodic/api/sensor_msgs/html/msg/PointCloud2.html">sensor_msgs/PointCloud2</a></td>
      <td>The projected 3D points using the optimized robot pose.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/map_planes</code></td>
      <td><a href="https://github.com/snt-arg/s_graphs/blob/feature/ros2/msg/PlanesData.msg">s_graphs/PlanesData</a></td>
      <td>Planes seen by the current robot keyframe.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/all_map_planes</code></td>
      <td><a href="https://github.com/snt-arg/s_graphs/blob/feature/ros2/msg/PlanesData.msg">s_graphs/PlanesData</a></td>
      <td>All the planes that have been seen by the robot.</td>
    </tr>
  </tbody>
</table>

<h4 id="room_segmentation-node-1">
<code class="language-plaintext highlighter-rouge">room_segmentation</code> node</h4>

<table>
  <thead>
    <tr>
      <th>Topic name</th>
      <th>Message Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/room_segmentation/room_data</code></td>
      <td><a href="https://github.com/snt-arg/s_graphs/blob/feature/ros2/msg/RoomsData.msg">s_graphs/RoomsData</a></td>
      <td>Contains all the necessary information about the rooms on a given floor.</td>
    </tr>
  </tbody>
</table>

<h4 id="floor_plan-node-1">
<code class="language-plaintext highlighter-rouge">floor_plan</code> node</h4>

<table>
  <thead>
    <tr>
      <th>Topic name</th>
      <th>Message Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/floor_plan/floor_data</code></td>
      <td><a href="https://github.com/snt-arg/s_graphs/blob/feature/ros2/msg/RoomsData.msg">s_graphs/RoomData</a></td>
      <td>Contains all the necessary information about each floor.</td>
    </tr>
  </tbody>
</table>

<h3 id="-ros-services-">🔄 ROS Services <a id="ros-services"></a>
</h3>

<table>
  <thead>
    <tr>
      <th>Topic name</th>
      <th>Message Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/dump</code></td>
      <td><a href="https://github.com/snt-arg/s_graphs/blob/feature/ros2/srv/DumpGraph.srv">s_graphs/DumpGraph</a></td>
      <td>Save all the internal data (point clouds, floor coeffs, odoms, and pose graph) to a directory.</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>Topic name</th>
      <th>Message Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/save_map</code></td>
      <td><a href="https://github.com/snt-arg/s_graphs/blob/feature/ros2/srv/SaveMap.srv">s_graphs/SaveMap</a></td>
      <td>Save the generated 3D map as a PCD file.</td>
    </tr>
  </tbody>
</table>

<h3 id="️-ros-parameters-">⚙️ ROS Parameters <a id="ros-parameters"></a>
</h3>

<p>All the configurable parameters are listed in config folder as ros params.</p>

<h3 id="-published-tfs-">🌐 Published TFs <a id="published-tfs"></a>
</h3>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">map2odom</code>: The transform published between the map frame and the odom frame after the corrections have been applied.</p>
  </li>
  <li>
    <p>The entire <code class="language-plaintext highlighter-rouge">tf_tree</code> for the virtual experiment can be seen in the figure below.</p>
  </li>
</ul>

<p align="center">
  <a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/">
    <img src="https://raw.githubusercontent.com/snt-arg/lidar_situational_graphs/feature/ros2/./imgs/Tf-tree.png" alt="tf_tree" width="80%">
  </a>
</p>

<h2 id="-unit-tests-">🧪 Unit Tests <a id="unit-tests"></a>
</h2>

<p>Some unit tests are available. In case you want to add additional tests, run the following command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>colcon <span class="nb">test</span> <span class="nt">--packages-select</span> s_graphs <span class="nt">--event-handler</span><span class="o">=</span>console_direct+

</code></pre></div></div>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <em>No CONTRIBUTING.md found.</em>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-jazzy">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/lidar_situational_graphs">lidar_situational_graphs</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-snt-arg-lidar_situational_graphs
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-snt-arg-lidar_situational_graphs" role="menuitem" tabindex="-1" href="/r/lidar_situational_graphs/github-snt-arg-lidar_situational_graphs" data="github-snt-arg-lidar_situational_graphs">
                    <span class="glyphicon glyphicon-star"></span>
                    github-snt-arg-lidar_situational_graphs
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>jazzy</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-kilted">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/lidar_situational_graphs">lidar_situational_graphs</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-snt-arg-lidar_situational_graphs
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-snt-arg-lidar_situational_graphs" role="menuitem" tabindex="-1" href="/r/lidar_situational_graphs/github-snt-arg-lidar_situational_graphs" data="github-snt-arg-lidar_situational_graphs">
                    <span class="glyphicon glyphicon-star"></span>
                    github-snt-arg-lidar_situational_graphs
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>kilted</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-rolling">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/lidar_situational_graphs">lidar_situational_graphs</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-snt-arg-lidar_situational_graphs
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-snt-arg-lidar_situational_graphs" role="menuitem" tabindex="-1" href="/r/lidar_situational_graphs/github-snt-arg-lidar_situational_graphs" data="github-snt-arg-lidar_situational_graphs">
                    <span class="glyphicon glyphicon-star"></span>
                    github-snt-arg-lidar_situational_graphs
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>rolling</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-github">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/lidar_situational_graphs">lidar_situational_graphs</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-snt-arg-lidar_situational_graphs
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-snt-arg-lidar_situational_graphs" role="menuitem" tabindex="-1" href="/r/lidar_situational_graphs/github-snt-arg-lidar_situational_graphs" data="github-snt-arg-lidar_situational_graphs">
                    <span class="glyphicon glyphicon-star"></span>
                    github-snt-arg-lidar_situational_graphs
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>github</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-noetic">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/lidar_situational_graphs">lidar_situational_graphs</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-snt-arg-lidar_situational_graphs
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-snt-arg-lidar_situational_graphs" role="menuitem" tabindex="-1" href="/r/lidar_situational_graphs/github-snt-arg-lidar_situational_graphs" data="github-snt-arg-lidar_situational_graphs">
                    <span class="glyphicon glyphicon-star"></span>
                    github-snt-arg-lidar_situational_graphs
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>noetic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-galactic">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/lidar_situational_graphs">lidar_situational_graphs</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-snt-arg-lidar_situational_graphs
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-snt-arg-lidar_situational_graphs" role="menuitem" tabindex="-1" href="/r/lidar_situational_graphs/github-snt-arg-lidar_situational_graphs" data="github-snt-arg-lidar_situational_graphs">
                    <span class="glyphicon glyphicon-star"></span>
                    github-snt-arg-lidar_situational_graphs
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>galactic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-iron">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/lidar_situational_graphs">lidar_situational_graphs</a> <small>repository</small></h3>
        
        
        <a class="label label-primary pkg-label" href="/p/lidar_situational_graphs">lidar_situational_graphs</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-snt-arg-lidar_situational_graphs
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-snt-arg-lidar_situational_graphs" role="menuitem" tabindex="-1" href="/r/lidar_situational_graphs/github-snt-arg-lidar_situational_graphs" data="github-snt-arg-lidar_situational_graphs">
                    <span class="glyphicon glyphicon-star"></span>
                    github-snt-arg-lidar_situational_graphs
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">Repository to generate in real-time Situational Graphs (S-Graphs) for robot pose and map optimization using 3D LiDAR Data</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/snt-arg/lidar_situational_graphs.git">https://github.com/snt-arg/lidar_situational_graphs.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">feature/ros2</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2024-07-02
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/lidar_situational_graphs/#iron-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/lidar_situational_graphs/#iron-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/lidar_situational_graphs/#iron-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/lidar_situational_graphs">lidar_situational_graphs</a></td>
                    <td>0.0.1</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<div align="center">
 <h1>LiDAR S-Graphs</h1>

<a href="https://github.com/snt-arg/lidar_situational_graphs/actions/workflows/foxy_build.yaml"><img src="https://github.com/snt-arg/lidar_situational_graphs/actions/workflows/foxy_build.yaml/badge.svg"></a>
<a href="https://github.com/snt-arg/lidar_situational_graphs/actions/workflows/humble_build.yaml"><img src="https://github.com/snt-arg/lidar_situational_graphs/actions/workflows/humble_build.yaml/badge.svg"></a>
<a href="https://github.com/snt-arg/lidar_situational_graphs/actions/workflows/iron_build.yaml"><img src="https://github.com/snt-arg/lidar_situational_graphs/actions/workflows/iron_build.yaml/badge.svg"></a>

</div>

<p><strong>LiDAR Situational Graphs (S-Graphs)</strong> is a ROS2 package for generating in real-time four-layered hierarchical factor graphs representing a scene graph using 3D LiDAR which includes <strong><em>Keyframes</em></strong> registring the robot poses, <strong><em>Walls</em></strong> which map wall planes, <strong><em>Rooms Layer</em></strong> constraining the wall planes using 4 wall-room or 2 wall-room factors, <strong><em>Floors</em></strong> constraining the rooms within a given floor level. It also supports several graph constraints, such as GPS, IMU acceleration (gravity vector), IMU orientation (magnetic sensor). We have tested this package mostly with Velodyne (VLP16) sensors in structured indoor environments. This work is a fork of <a href="https://github.com/koide3/hdl_graph_slam">hdl_graph_slam</a> which as previously in ROS1.</p>

<p align="center">
  <a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/">
    <img src="https://raw.githubusercontent.com/snt-arg/lidar_situational_graphs/feature/ros2/./imgs/s_graphs_rotating.gif" alt="Logo" width="80%">
  </a>
</p>

<h2 id="-table-of-contents">📜 Table of contents</h2>

<ul>
  <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#published-papers">📖 Published Papers</a></li>
  <li>
<a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#installation">⚙️ Installation</a>
    <ul>
      <li>
<a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#installation-from-source">📦 Installation From Source</a>
        <ul>
          <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#installation-for-ros1">ROS1 Optional</a></li>
        </ul>
      </li>
      <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#docker">🐳 Docker</a></li>
    </ul>
  </li>
  <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#examples">🚀 Examples on Datasets</a></li>
  <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#custom-data">🛠️ Run S_Graphs On Your Data</a></li>
  <li>
<a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#ros-related">🤖 ROS Related</a>
    <ul>
      <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#subscribed-topics">📥 Subscribed Topics</a></li>
      <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#published-topics">📤 Published Topics</a></li>
      <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#ros-services">🔄 ROS Services</a></li>
      <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#ros-parameters">⚙️ ROS Parameters</a></li>
      <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#published-tfs">🌐 Published TFs</a></li>
    </ul>
  </li>
  <li><a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#unit-tests">🧪 Unit Tests</a></li>
</ul>

<h2 id="-published-papers-">📖 Published Papers <a id="published-papers"></a>
</h2>

<details>
    <summary><a href="https://arxiv.org/abs/2212.11770">S-Graphs+: Real-time Localization and Mapping leveraging Hierarchical Representations </a>
    </summary>

    @ARTICLE{10168233,
     author={Bavle, Hriday and Sanchez-Lopez, Jose Luis and Shaheer, Muhammad and Civera, Javier and Voos, Holger},
     journal={IEEE Robotics and Automation Letters},
     title={S-Graphs+: Real-Time Localization and Mapping Leveraging Hierarchical Representations},
     year={2023},
     volume={8},
     number={8},
     pages={4927-4934},
     doi={10.1109/LRA.2023.3290512}}

</details>
<details>
    <summary><a href="https://arxiv.org/abs/2202.12197">Situational Graphs for Robot Navigation in Structured Indoor Environments</a></summary>

      @ARTICLE{9826367,
        author={Bavle, Hriday and Sanchez-Lopez, Jose Luis and Shaheer, Muhammad and Civera, Javier and Voos, Holger},
        journal={IEEE Robotics and Automation Letters},
        title={Situational Graphs for Robot Navigation in Structured Indoor Environments},
        year={2022},
        volume={7},
        number={4},
        pages={9107-9114},
        doi={10.1109/LRA.2022.3189785}}

</details>

<h2 id="️-installation-">⚙️ Installation <a id="installation"></a>
</h2>

<!-- TODO: When s-graphs is available in rosdistro add here the command to install -->

<blockquote>
  <p>[!NOTE]
S-Graphs+ was only tested on Ubuntu 20.04, ROS2 Foxy, Humble Distros.
We strongly recommend using <a href="https://docs.ros.org/en/humble/Installation/DDS-Implementations/Working-with-Eclipse-CycloneDDS.html">cyclone_dds</a> instead of the default fastdds.</p>
</blockquote>

<h3 id="-installation-from-source-">📦 Installation From Source <a id="installation-from-source"></a>
</h3>

<blockquote>
  <p>[!IMPORTANT]
Before proceeding, make sure you have <code class="language-plaintext highlighter-rouge">rosdep</code> installed. You can install it using <code class="language-plaintext highlighter-rouge">sudo apt-get install python3-rosdep</code>
In addition, ssh keys are needed to be configured on you GitHub account. If you haven’t
yet configured ssh keys, follow this <a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent">tutorial</a></p>
</blockquote>

<ol>
  <li>Update Rosdep:</li>
</ol>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rosdep init <span class="o">&amp;&amp;</span> rosdep update <span class="nt">--include-eol-distros</span>

</code></pre></div></div>

<ol>
  <li>Create a ROS2 workspace for S-Graphs</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> <span class="nv">$HOME</span>/workspaces <span class="o">&amp;&amp;</span> <span class="nb">cd</span> <span class="nv">$HOME</span>/workspaces

</code></pre></div></div>

<ol>
  <li>Clone the S-Graphs repository into the created workspace</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone git@github.com:snt-arg/lidar_situational_graphs.git <span class="nt">-b</span> feature/ros2 s_graphs 

</code></pre></div></div>

<blockquote>
  <p>[!IMPORTANT]
If you have Nvidia GPU please install CUDA from this <a href="https://developer.nvidia.com/cuda-11-8-0-download-archive">link</a>. This code has only been tested with CUDA 11.8.
If you dont have CUDA S-Graphs will use CPU only.</p>
</blockquote>

<ol>
  <li>Install required dependencies. Change $ROS_DISTRO to your ros2 version.</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>s_graphs <span class="o">&amp;&amp;</span> <span class="nb">source</span> /opt/ros/<span class="nv">$ROS_DISTRO</span>/setup.sh <span class="o">&amp;&amp;</span> ./setup.sh

</code></pre></div></div>

<blockquote>
  <p>[!NOTE]
If you want to compile with debug traces (from backward_cpp) run:</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>colcon build <span class="nt">--symlink-install</span> <span class="nt">--cmake-args</span> <span class="nt">-DCMAKE_BUILD_TYPE</span><span class="o">=</span>RelWithDebInfo

</code></pre></div></div>

<h4 id="optional-ros1-install-old-version-of-room-segmentation-">Optional ROS1 Install (Old Version of Room Segmentation) <a id="installation-for-ros1"></a>
</h4>

<details>

&gt; [!NOTE]
&gt; This is an optional older version of room segmentation algorithm which requires ROS1 noetic. There is no hard dependecy on this package so you can easily ignore this step.

##### Download ROS Bridge <a id="download-ros-bridge"></a>


```bash
source /opt/ros/foxy/setup.bash &amp;&amp; sudo apt install ros-foxy-ros1-bridge

```

##### Installation on ROS1

&gt; [!IMPORTANT]
&gt; Before following the instructions from below, ensure that you are in a fresh
&gt; terminal, **without ROS2 sourced**.

1. Create a ROS1 workspace for S-Graphs


```bash
mkdir -p $HOME/workspaces/s_graphs_ros1_ws/src &amp;&amp; cd $HOME/workspaces/s_graphs_ros1_ws/src &amp;&amp; source /opt/ros/noetic/setup.bash

```

2. Clone the S-Graphs repository into the created workspace


```bash
git clone git@github.com:snt-arg/lidar_situational_graphs.git -b feature/ros2 s_graphs

```

3. Install required dependencies using `vcstool`


```bash
cd s_graphs &amp;&amp; vcs import --recursive ../ &lt; .rosinstall_ros1

```

4. Install required ROS packages


```bash
cd ../../ &amp;&amp; rosdep install --from-paths src --ignore-src -y -r

```

5. Install `pcl_ros`


```sh
sudo apt install ros-noetic-pcl-ros

```

6. Build workspace

&gt; [!IMPORTANT]
&gt; Make sure s_graphs_ros1_ws is built in Release otherwise the room extraction won't work properly.


```bash
catkin config --cmake-args -DCMAKE_BUILD_TYPE=Release &amp;&amp; catkin build

```

</details>

<h3 id="-docker-">🐳 Docker <a id="docker"></a>
</h3>

<h4 id="build-docker-image">Build Docker Image</h4>

<ol>
  <li>Create a ROS2 workspace for S-Graphs</li>
</ol>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> <span class="nv">$HOME</span>/workspaces <span class="o">&amp;&amp;</span> <span class="nb">cd</span> <span class="nv">$HOME</span>/workspaces

</code></pre></div></div>

<ol>
  <li>Change directory to where Dockerfile is located in <code class="language-plaintext highlighter-rouge">s_graphs</code>
</li>
</ol>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone git@github.com:snt-arg/lidar_situational_graphs.git <span class="nt">-b</span> feature/ros2 s_graphs <span class="o">&amp;&amp;</span> <span class="nb">cd</span> <span class="nv">$HOME</span>/workspaces/s_graphs/docker/foxy_noetic

</code></pre></div></div>

<ol>
  <li>Build image</li>
</ol>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker build <span class="nt">-t</span> sntarg/s_graphs <span class="nb">.</span>

</code></pre></div></div>

<blockquote>
  <p>[!NOTE]
There are two docker files, one for foxy and another for humble. The above commands build the foxy image, you use the same commands to build the humble image if needed.</p>
</blockquote>

<h2 id="-example-on-datasets-">🚀 Example on Datasets <a id="examples"></a>
</h2>

<blockquote>
  <p>[!WARNING]
For execution of the experiments we use <a href="https://github.com/pvolok/mprocs">mprocs</a>, which makes the process of launching different processes easier.</p>
</blockquote>

<h3 id="real-dataset">Real Dataset</h3>

<blockquote>
  <p>[!IMPORTANT]
Download real dataset using this <a href="https://uniluxembourg-my.sharepoint.com/:u:/g/personal/hriday_bavle_uni_lu/ET2kNySZrzVBlveGgvSByeUBAvQk5wl05GMF0NwqbkL6ZA?e=hoaaOo">link</a> and store it in the folder <code class="language-plaintext highlighter-rouge">~/Downloads/real</code>, the below mprocs script will not work otherwise.</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> <span class="nv">$HOME</span>/workspaces/s_graphs <span class="o">&amp;&amp;</span> mprocs <span class="nt">--config</span> .real_mprocs.yaml

</code></pre></div></div>

<h3 id="virtual-dataset">Virtual Dataset</h3>

<blockquote>
  <p>[!IMPORTANT]
Download virtual dataset using this <a href="https://uniluxembourg-my.sharepoint.com/:u:/g/personal/hriday_bavle_uni_lu/ETEfrz2n8qhKrXSJ712gNYgBtl5ra_9lUxZmsmyUa804ew?e=3XJOhG">link</a> and store it in the folder <code class="language-plaintext highlighter-rouge">~/Downloads/virtual</code>, the below mprocs script will not work otherwise.</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> <span class="nv">$HOME</span>/workspaces/s_graphs <span class="o">&amp;&amp;</span> mprocs <span class="nt">--config</span> .virtual_mprocs.yaml

</code></pre></div></div>

<h3 id="running-s_graphs-with-docker">Running S_Graphs with Docker</h3>

<blockquote>
  <p>[!NOTE]
This tutorial assumes that you have followed the instructions to setup docker
in section <a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/#docker">🐳 Docker</a></p>
</blockquote>

<ol>
  <li>Create a container for the s_graphs image.</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="nt">-dit</span> <span class="nt">--volume</span><span class="o">=</span>/tmp/.X11-unix:/tmp/.X11-unix:rw <span class="nt">--network</span><span class="o">=</span>host <span class="nt">-e</span> <span class="nv">DISPLAY</span><span class="o">=</span><span class="nv">$DISPLAY</span> <span class="nt">--name</span> s_graphs_container sntarg/s_graphs

</code></pre></div></div>

<ol>
  <li>
    <p>Download the dataset you desire from above to your <strong>local machine</strong>.</p>
  </li>
  <li>
    <p>Move the rosbag inside docker container</p>
  </li>
</ol>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker <span class="nb">cp</span> ~/Downloads/real s_graphs_container:/root/Downloads/real <span class="c"># For real dataset</span>
<span class="c"># OR</span>
docker <span class="nb">cp</span> ~/Downloads/virtual s_graphs_container:/root/Downloads/virtual <span class="c"># For virtual dataset</span>

</code></pre></div></div>

<ol>
  <li>Execute the container</li>
</ol>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker <span class="nb">exec</span> <span class="nt">-ti</span> s_graphs_container bash

</code></pre></div></div>

<blockquote>
  <p>[!IMPORTANT]
If rviz2 doesnt open inside the docker, do <code class="language-plaintext highlighter-rouge">xhost +</code> in a terminal of your pc and then relaunch the mprocs command inside docker.</p>
</blockquote>

<ol>
  <li>Run mprocs</li>
</ol>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mprocs_real <span class="c"># To run on a real robot or a real dataset</span>
<span class="c"># OR</span>
mprocs_virtual <span class="c"># To run on a simulation or virtual dataset</span>

</code></pre></div></div>

<!--
4. Visualization using Rviz (open another terminal to run this command)

> [!NOTE]
> The command below assumes you has ros2 foxy on your local machine


```sh
source /opt/ros/foxy/setup.bash && rviz2 -d $HOME/workspaces/s_graphs_ros2_ws/src/s_graphs/rviz/s_graphs_ros2.rviz

```
-->

<blockquote>
  <p>[!NOTE]
Press reset on rviz2 once in a while when running S-Graphs to avoid freezing effect caused by rviz2 on foxy.</p>
</blockquote>

<h2 id="️-run-s_graphs-on-your-data-">🛠️ Run S_Graphs On Your Data <a id="custom-data"></a>
</h2>

<ol>
  <li>Define the transformation between your sensors (LIDAR, IMU, GPS) and base_link of your system using static_transform_publisher (see <a href="https://github.com/snt-arg/s_graphs/blob/c0489660552cb3a2fc8ac0bef17998ee5fb6e15a/launch/s_graphs_launch.py#L118">line</a>, s_graphs_launch.py). All the sensor data will be transformed into the common <code class="language-plaintext highlighter-rouge">base_link</code> frame, and then fed to the SLAM algorithm. Note: <code class="language-plaintext highlighter-rouge">base_link</code> frame in virtual dataset is set to <code class="language-plaintext highlighter-rouge">base_footprint</code> and in real dataset is set to <code class="language-plaintext highlighter-rouge">body</code>. You can set the <code class="language-plaintext highlighter-rouge">frames</code>, <code class="language-plaintext highlighter-rouge">topics</code> for your dataset easily during the launch execution as follows:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    ros2 launch lidar_situational_graphs s_graphs_launch.py compute_odom:<span class="o">=</span><span class="nb">true </span>lidar_topic:<span class="o">=</span>/rs_lidar/points

</code></pre></div></div>

<ol>
  <li>If you have an odometry source convert it to base ENU frame, then set the arg <code class="language-plaintext highlighter-rouge">compute_odom</code> to <code class="language-plaintext highlighter-rouge">false</code> in <code class="language-plaintext highlighter-rouge">s_graphs_ros2_launch.py</code> and then remap odom topic in <strong>s_graphs_node</strong> like</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  ros2 launch lidar_situational_graphs s_graphs_launch.py compute_odom:<span class="o">=</span><span class="nb">false </span>lidar_topic:<span class="o">=</span>/rs_lidar/points odom_topic:<span class="o">=</span>/odom

</code></pre></div></div>

<blockquote>
  <p>[!NOTE]
If you want to visualize the tfs correctly from your odom source, you MUST provide a tf from the <code class="language-plaintext highlighter-rouge">odom</code> to <code class="language-plaintext highlighter-rouge">base_link</code> frame.</p>
</blockquote>

<h2 id="-ros-related-">🤖 ROS Related <a id="ros-related"></a>
</h2>

<h3 id="-subscribed-topics-">📥 Subscribed Topics <a id="subscribed-topics"></a>
</h3>

<h4 id="s_graphs-node">
<code class="language-plaintext highlighter-rouge">s_graphs</code> node</h4>

<table>
  <thead>
    <tr>
      <th>Topic name</th>
      <th>Message Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/odom</code></td>
      <td><a href="http://docs.ros.org/en/noetic/api/nav_msgs/html/msg/Odometry.html">nav_msgs/Odometry</a></td>
      <td>The odometry from the robot.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/filtered_points</code></td>
      <td><a href="http://docs.ros.org/en/melodic/api/sensor_msgs/html/msg/PointCloud2.html">sensor_msgs/PointCloud2</a></td>
      <td>The filtered data from the LiDAR sensor.</td>
    </tr>
  </tbody>
</table>

<h4 id="room_segmentation-node">
<code class="language-plaintext highlighter-rouge">room_segmentation</code> node</h4>

<table>
  <thead>
    <tr>
      <th>Topic name</th>
      <th>Message Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/voxblox_skeletonizer/sparse_graph</code></td>
      <td><a href="http://docs.ros.org/en/noetic/api/visualization_msgs/html/msg/MarkerArray.html">visualization_msgs/MarkerArray</a></td>
      <td>Represents the free space where the robot can go to. Also known as free-space clusters.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/map_planes</code></td>
      <td><a href="https://github.com/snt-arg/s_graphs/blob/feature/ros2/msg/PlaneData.msg">s_graphs/PlanesData</a></td>
      <td>Planes seen by the current robot keyframe.</td>
    </tr>
  </tbody>
</table>

<h4 id="floor_plan-node">
<code class="language-plaintext highlighter-rouge">floor_plan</code> node</h4>

<table>
  <thead>
    <tr>
      <th>Topic name</th>
      <th>Message Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/all_map_planes</code></td>
      <td><a href="http://docs.ros.org/en/noetic/api/visualization_msgs/html/msg/MarkerArray.html">visualization_msgs/MarkerArray</a></td>
      <td>All the planes that have been seen by the robot.</td>
    </tr>
  </tbody>
</table>

<h3 id="-published-topics-">📤 Published Topics <a id="published-topics"></a>
</h3>

<h4 id="s_graphs-node-1">
<code class="language-plaintext highlighter-rouge">s_graphs</code> node</h4>

<table>
  <thead>
    <tr>
      <th>Topic name</th>
      <th>Message Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/markers</code></td>
      <td><a href="http://docs.ros.org/en/noetic/api/visualization_msgs/html/msg/MarkerArray.html">visualization_msgs/MarkerArray</a></td>
      <td>These markers represent the different s_graphs layers.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/odom2map</code></td>
      <td><a href="http://docs.ros.org/en/api/geometry_msgs/html/msg/TransformStamped.html">geometry_msgs/TransformStamped</a></td>
      <td>The estimated drift of the robot within its map frame (world).</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/odom_pose_corrected</code></td>
      <td><a href="http://docs.ros.org/en/noetic/api/geometry_msgs/html/msg/PoseStamped.html">geometry_msgs/PoseStamped</a></td>
      <td>The optimized/drift-free pose of the robot once odom2map is applied.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/odom_path_corrected</code></td>
      <td><a href="http://docs.ros.org/en/noetic/api/nav_msgs/html/msg/Path.html">nav_msgs/Path</a></td>
      <td>The optimized/drift-free pose path of the robot once the odom2map is applied.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/map_points</code></td>
      <td><a href="http://docs.ros.org/en/melodic/api/sensor_msgs/html/msg/PointCloud2.html">sensor_msgs/PointCloud2</a></td>
      <td>The projected 3D points using the optimized robot pose.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/map_planes</code></td>
      <td><a href="https://github.com/snt-arg/s_graphs/blob/feature/ros2/msg/PlanesData.msg">s_graphs/PlanesData</a></td>
      <td>Planes seen by the current robot keyframe.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/all_map_planes</code></td>
      <td><a href="https://github.com/snt-arg/s_graphs/blob/feature/ros2/msg/PlanesData.msg">s_graphs/PlanesData</a></td>
      <td>All the planes that have been seen by the robot.</td>
    </tr>
  </tbody>
</table>

<h4 id="room_segmentation-node-1">
<code class="language-plaintext highlighter-rouge">room_segmentation</code> node</h4>

<table>
  <thead>
    <tr>
      <th>Topic name</th>
      <th>Message Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/room_segmentation/room_data</code></td>
      <td><a href="https://github.com/snt-arg/s_graphs/blob/feature/ros2/msg/RoomsData.msg">s_graphs/RoomsData</a></td>
      <td>Contains all the necessary information about the rooms on a given floor.</td>
    </tr>
  </tbody>
</table>

<h4 id="floor_plan-node-1">
<code class="language-plaintext highlighter-rouge">floor_plan</code> node</h4>

<table>
  <thead>
    <tr>
      <th>Topic name</th>
      <th>Message Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/floor_plan/floor_data</code></td>
      <td><a href="https://github.com/snt-arg/s_graphs/blob/feature/ros2/msg/RoomsData.msg">s_graphs/RoomData</a></td>
      <td>Contains all the necessary information about each floor.</td>
    </tr>
  </tbody>
</table>

<h3 id="-ros-services-">🔄 ROS Services <a id="ros-services"></a>
</h3>

<table>
  <thead>
    <tr>
      <th>Topic name</th>
      <th>Message Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/dump</code></td>
      <td><a href="https://github.com/snt-arg/s_graphs/blob/feature/ros2/srv/DumpGraph.srv">s_graphs/DumpGraph</a></td>
      <td>Save all the internal data (point clouds, floor coeffs, odoms, and pose graph) to a directory.</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>Topic name</th>
      <th>Message Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">/s_graphs/save_map</code></td>
      <td><a href="https://github.com/snt-arg/s_graphs/blob/feature/ros2/srv/SaveMap.srv">s_graphs/SaveMap</a></td>
      <td>Save the generated 3D map as a PCD file.</td>
    </tr>
  </tbody>
</table>

<h3 id="️-ros-parameters-">⚙️ ROS Parameters <a id="ros-parameters"></a>
</h3>

<p>All the configurable parameters are listed in config folder as ros params.</p>

<h3 id="-published-tfs-">🌐 Published TFs <a id="published-tfs"></a>
</h3>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">map2odom</code>: The transform published between the map frame and the odom frame after the corrections have been applied.</p>
  </li>
  <li>
    <p>The entire <code class="language-plaintext highlighter-rouge">tf_tree</code> for the virtual experiment can be seen in the figure below.</p>
  </li>
</ul>

<p align="center">
  <a href="https://github.com/snt-arg/lidar_situational_graphs/tree/feature/ros2/">
    <img src="https://raw.githubusercontent.com/snt-arg/lidar_situational_graphs/feature/ros2/./imgs/Tf-tree.png" alt="tf_tree" width="80%">
  </a>
</p>

<h2 id="-unit-tests-">🧪 Unit Tests <a id="unit-tests"></a>
</h2>

<p>Some unit tests are available. In case you want to add additional tests, run the following command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>colcon <span class="nb">test</span> <span class="nt">--packages-select</span> s_graphs <span class="nt">--event-handler</span><span class="o">=</span>console_direct+

</code></pre></div></div>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <em>No CONTRIBUTING.md found.</em>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-melodic">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/lidar_situational_graphs">lidar_situational_graphs</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-snt-arg-lidar_situational_graphs
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-snt-arg-lidar_situational_graphs" role="menuitem" tabindex="-1" href="/r/lidar_situational_graphs/github-snt-arg-lidar_situational_graphs" data="github-snt-arg-lidar_situational_graphs">
                    <span class="glyphicon glyphicon-star"></span>
                    github-snt-arg-lidar_situational_graphs
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>melodic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>


<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
  $(function() {
    setupContributeListTabLinks();
  });
  $(document).ready(function() {
    setupDistroSwitch("humble");
    setupContributeLists("https://github.com/snt-arg/lidar_situational_graphs.git");
  });
</script>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="container-fluid">
      <div style="float:left;">
        
          <a href="https://github.com/rkent/rosindex" title="Find rosindex in Github">
          <span class="icon  icon--github">
            <svg viewBox="0 0 16 16">
              <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
            </svg>
          </span>

          <span class="username">rkent/rosindex</span>
        </a>
        <em class="hidden-xs">| generated on 2025-05-05</em>
      
      </div>
      <div style="float:right;">
        <p class="text"><span class="hidden-xs">a community-maintained index of robotics software
 | </span><a href="/privacy.txt">privacy</a></p>
      </div>
    </div>
  </div>

</footer>


  </body>

</html>
