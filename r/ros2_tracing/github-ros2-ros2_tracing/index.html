<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Index</title>
    <meta name="description" content="a community-maintained index of robotics software
">

    
    <link rel="canonical" href="http://index.rosdabbler.com/r/ros2_tracing/github-ros2-ros2_tracing/">
    
    
    <link rel="icon" sizes="any" type="image/svg+xml" href="/assets/rosindex_logo.svg">

    

    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">
    

    

    <script type="text/javascript" src=/js/jquery.js></script>
    <script src=/bootstrap/js/bootstrap.min.js type="text/javascript"></script>
    <script src=/js/jquery-cookie.js type="text/javascript"></script>
    
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EVD5Z6G6NH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EVD5Z6G6NH');
</script>

    <script type="text/javascript" src=/js/toc.js></script>

    <script src=/js/distro_switch.js></script>
  </head>

  <body>

    <header class="site-header">

  <div class="wrapper">
    <div class="container-fluid" style="margin-bottom: 10px">
      <div class="row">
        <!-- title -->
        <div class="col-xs-3" style="white-space:nowrap">
          <a class="site-title" href="/">
            <img src="/assets/rosindex_logo.svg" width="26" height="26" alt="ROS index logo" style="padding-bottom: 3px"/>
            ROS Index</a>
        </div>
        <!-- main internal links -->
        <div class="col-xs-6 text-center" style="padding:0px">
          <div class="btn-group hidden-xs" role="group" aria-label="..." style="padding: 6px">
            <div class="btn-group" role="group">
              <a href="/?search_packages=true" class="btn btn-default" role="button">Package List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/?search_repos=true" class="btn btn-default" role="button">Repository List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/search_deps" class="btn btn-default" role="button">System Dependencies</a>
            </div>
          </div>
          <div class="hidden-lg hidden-md hidden-sm">
            <button id="hLabel" class="btn btn-link dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Lists <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="hLabel">
              <li><a href="/?search_packages=true">Package List</a></li>
              <li><a href="/?search_repos=true">Repository List</a></li>
              <li><a href="/search_deps">System Dependencies</a></li>
            </ul>
          </div>
        </div>
        <!-- additional links -->
        <div class="col-xs-3 text-right" style="white-space:nowrap; padding:0px">
          <ul class="list-inline" style="margin-bottom:0px;">
            <li class="dropdown hidden-xs hidden-sm">
              <button id="rLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                ROS Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu" aria-labelledby="rLabel">
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-xs hidden-sm">
              <button id="aLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                About <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="aLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-md hidden-lg">
              <button id="qLabel" class="btn btn-link" type="button"
                      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="qLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
                <hr style="margin:7px" />
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin-top:20px">
  <div class="container-fluid">
    <div class="row">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/repos">Repos</a></li>
        <li class="active">ros2_tracing</li>
        <!--<li class="active">ros2_tracing</li>-->
      </ol>
    </div>
    <div class="row">
      

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
    <label id="humble-option" class="distro-button btn btn-xs btn-primary" href="#humble" data="humble">
      <input type="radio" name="options" id="humble-radio" autocomplete="off"> humble
    </label>
  
    <label id="jazzy-option" class="distro-button btn btn-xs btn-primary" href="#jazzy" data="jazzy">
      <input type="radio" name="options" id="jazzy-radio" autocomplete="off"> jazzy
    </label>
  
    <label id="kilted-option" class="distro-button btn btn-xs btn-primary" href="#kilted" data="kilted">
      <input type="radio" name="options" id="kilted-radio" autocomplete="off"> kilted
    </label>
  
    <label id="rolling-option" class="distro-button btn btn-xs btn-primary" href="#rolling" data="rolling">
      <input type="radio" name="options" id="rolling-radio" autocomplete="off"> rolling
    </label>
  
    <label id="github-option" class="distro-button btn btn-xs btn-default" href="#github" data="github">
      <input type="radio" name="options" id="github-radio" autocomplete="off"> github
    </label>
  
    <label id="noetic-option" class="distro-button btn btn-xs btn-default" href="#noetic" data="noetic">
      <input type="radio" name="options" id="noetic-radio" autocomplete="off"> noetic
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-primary" data-toggle="dropdown" id="older-distro-button">
        <input type="radio" name="options" autocomplete="off">
      <span id="older-label">Older</span>
      <span class="caret"></span>
    </label>
    <ul class="dropdown-menu" role="menu">
      
        <li data="galactic" id="galactic-option" class=" older-distro-option"  href="#galactic">
          <a href="#galactic" data="galactic" id="galactic-button">galactic</a>
        </li>
      
        <li data="iron" id="iron-option" class=" older-distro-option"  href="#iron">
          <a href="#iron" data="iron" id="iron-button">iron</a>
        </li>
      
        <li data="melodic" id="melodic-option" class="disabled older-distro-option"  href="#melodic">
          <a href="#melodic" data="melodic" id="melodic-button">melodic</a>
        </li>
      
    </ul>
  </div>
</div>

    </div>
    <div class="row">
      &nbsp;
    </div>
  </div>
</div>


  <div class="distro distro-humble">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/ros2_tracing">ros2_tracing</a> <small>repository</small></h3>
        <span class="label label-default">tools</span> <span class="label label-default">instrumentation</span> <span class="label label-default">ros</span> <span class="label label-default">tracing</span> <span class="label label-default">performance-analysis</span> <span class="label label-default">ros2</span> <span class="label label-default">ros2-tracing</span> 
        
        <a class="label label-primary pkg-label" href="/p/ros2trace">ros2trace</a>
        
        <a class="label label-primary pkg-label" href="/p/test_tracetools">test_tracetools</a>
        
        <a class="label label-primary pkg-label" href="/p/test_tracetools_launch">test_tracetools_launch</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools">tracetools</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_launch">tracetools_launch</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_read">tracetools_read</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_test">tracetools_test</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_trace">tracetools_trace</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-ros2-ros2_tracing
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-ros2-ros2_tracing" role="menuitem" tabindex="-1" href="/r/ros2_tracing/github-ros2-ros2_tracing" data="github-ros2-ros2_tracing">
                    <span class="glyphicon glyphicon-star"></span>
                    github-ros2-ros2_tracing
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">Tracing tools for ROS 2.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/ros2/ros2_tracing.git">https://github.com/ros2/ros2_tracing.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">humble</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2022-11-07
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <span class="label label-default">tools</span> <span class="label label-default">instrumentation</span> <span class="label label-default">ros</span> <span class="label label-default">tracing</span> <span class="label label-default">performance-analysis</span> <span class="label label-default">ros2</span> <span class="label label-default">ros2-tracing</span> 
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/ros2_tracing/#humble-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ros2_tracing/#humble-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ros2_tracing/#humble-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/ros2trace">ros2trace</a></td>
                    <td>4.1.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/test_tracetools">test_tracetools</a></td>
                    <td>4.1.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/test_tracetools_launch">test_tracetools_launch</a></td>
                    <td>4.1.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools">tracetools</a></td>
                    <td>4.1.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_launch">tracetools_launch</a></td>
                    <td>4.1.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_read">tracetools_read</a></td>
                    <td>4.1.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_test">tracetools_test</a></td>
                    <td>4.1.1</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_trace">tracetools_trace</a></td>
                    <td>4.1.1</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="ros2_tracing">ros2_tracing</h1>

<p><a href="https://gitlab.com/ros-tracing/ros2_tracing/commits/master"><img src="https://gitlab.com/ros-tracing/ros2_tracing/badges/master/pipeline.svg" alt="pipeline status"></a>
<a href="https://codecov.io/gl/ros-tracing/ros2_tracing"><img src="https://codecov.io/gl/ros-tracing/ros2_tracing/branch/master/graph/badge.svg" alt="codecov"></a></p>

<p>Tracing tools for ROS 2.</p>

<h2 id="overview">Overview</h2>

<p><code class="language-plaintext highlighter-rouge">ros2_tracing</code> provides <a href="https://github.com/ros2/ros2_tracing/tree/humble/#tracetools">tracing instrumentation</a> for the core ROS 2 packages.
It also provides <a href="https://github.com/ros2/ros2_tracing/tree/humble/#tracing">tools to configure tracing</a> through <a href="https://github.com/ros2/ros2_tracing/tree/humble/#launch-file-trace-action">a launch action</a> and a <a href="https://github.com/ros2/ros2_tracing/tree/humble/#trace-command"><code class="language-plaintext highlighter-rouge">ros2</code> CLI command</a>.</p>

<p><code class="language-plaintext highlighter-rouge">ros2_tracing</code> currently only supports the <a href="https://lttng.org/">LTTng</a> tracer.
Consequently, it currently only supports Linux.</p>

<h2 id="publications--presentations">Publications &amp; presentations</h2>

<p><a href="https://arxiv.org/abs/2201.00393">Read the <code class="language-plaintext highlighter-rouge">ros2_tracing</code> paper!</a>
If you use or refer to <code class="language-plaintext highlighter-rouge">ros2_tracing</code>, please cite:</p>
<ul>
  <li>C. Bédard, I. Lütkebohle, and M. Dagenais, “ros2_tracing: Multipurpose Low-Overhead Framework for Real-Time Tracing of ROS 2,” <em>IEEE Robotics and Automation Letters</em>, vol. 7, no. 3, pp. 6511–6518, 2022.</li>
</ul>

<details>
<summary>BibTeX</summary>


```bibtex
@article{bedard2022ros2tracing,
  title={ros2\_tracing: Multipurpose Low-Overhead Framework for Real-Time Tracing of ROS 2},
  author={B{\'e}dard, Christophe and L{\"u}tkebohle, Ingo and Dagenais, Michel},
  journal={IEEE Robotics and Automation Letters},
  year={2022},
  volume={7},
  number={3},
  pages={6511--6518},
  doi={10.1109/LRA.2022.3174346}
}

```
</details>

<p>Also, check out the ROS World 2021 presentation titled “Tracing ROS 2 with ros2_tracing” (<a href="https://vimeo.com/652633418">video</a>, <a href="https://gitlab.com/ros-tracing/ros2_tracing/-/raw/master/doc/2021-10-20_ROS_World_2021_-_Tracing_ROS_2_with_ros2_tracing.pdf">slides</a>).
Reference:</p>
<ul>
  <li>C. Bédard, “Tracing ROS 2 with ros2_tracing,” in <em>ROS World 2021</em>. Open Robotics, October 2021. [Online]. Available: https://vimeo.com/652633418, <a href="https://gitlab.com/ros-tracing/ros2_tracing/-/raw/master/doc/2021-10-20_ROS_World_2021_-_Tracing_ROS_2_with_ros2_tracing.pdf">(pdf)</a>
</li>
</ul>

<h2 id="tutorials--demos">Tutorials &amp; demos</h2>

<ul>
  <li>Real-Time Working Group documentation tutorial: <a href="https://ros-realtime.github.io/Guides/ros2_tracing_trace_and_analyze.html">How to use <code class="language-plaintext highlighter-rouge">ros2_tracing</code> to trace and analyze an application</a>
</li>
  <li>ROS World 2021 demo: <a href="https://github.com/christophebedard/ros-world-2021-demo">github.com/christophebedard/ros-world-2021-demo</a>
</li>
</ul>

<h2 id="building">Building</h2>

<p>As of Foxy, these instructions also apply to an installation from the Debian packages; it will not work out-of-the-box.</p>

<p>If LTTng is not found during build, or if the <a href="https://github.com/ros2/ros2_tracing/tree/humble/#disabling-tracing"><code class="language-plaintext highlighter-rouge">TRACETOOLS_DISABLED</code> option is enabled</a>, then this package will not do anything.</p>

<p>To enable tracing:</p>

<ol>
  <li>Install <a href="https://lttng.org/docs/v2.13/">LTTng</a> (<code class="language-plaintext highlighter-rouge">&gt;=2.11.1</code>) with the Python bindings to control tracing and read traces:</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    $ sudo apt-get update
    $ sudo apt-get install lttng-tools liblttng-ust-dev
    $ sudo apt-get install python3-babeltrace python3-lttng
    
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>* The above commands will only install the LTTng userspace tracer, LTTng-UST. You only need the userspace tracer to trace ROS 2.
* To install the [LTTng kernel tracer](https://lttng.org/docs/v2.13/#doc-tracing-the-linux-kernel):
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        $ sudo apt-get install lttng-modules-dkms
        
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>* For more information about LTTng, [see its documentation](https://lttng.org/docs/v2.13/). 2. Build:
*  If you've already built ROS 2 from source before installing LTTng, you will need to re-build at least up to `tracetools`:
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        $ colcon build --packages-up-to tracetools --cmake-force-configure
        
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>* If you rely on the ROS 2 binaries (Debian packages, release binaries, or prerelease binaries), you will need to clone this repo into your workspace and build at least up to `tracetools`:
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        $ cd src/
        $ git clone https://gitlab.com/ros-tracing/ros2_tracing.git
        $ cd ../
        $ colcon build --packages-up-to tracetools
        
</code></pre></div></div>
<ol>
  <li>Source and check that tracing is enabled:</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    $ source ./install/setup.bash
    $ ros2 run tracetools status
    Tracing enabled
    
</code></pre></div></div>

<h3 id="disabling-tracing">Disabling tracing</h3>

<p>Alternatively, to build and disable tracing, use <code class="language-plaintext highlighter-rouge">TRACETOOLS_DISABLED</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ colcon build --cmake-args " -DTRACETOOLS_DISABLED=ON"

</code></pre></div></div>

<p>This will remove all instrumentation from the core ROS 2 packages, and thus they will not depend on or link against the shared library provided by the <a href="https://github.com/ros2/ros2_tracing/tree/humble/#tracetools"><code class="language-plaintext highlighter-rouge">tracetools</code> package</a>.</p>

<h2 id="tracing">Tracing</h2>

<p>The steps above will not lead to trace data being generated, and thus they will have no impact on execution.
LTTng has to be configured for tracing.
The packages in this repo provide two options: a <a href="https://github.com/ros2/ros2_tracing/tree/humble/#trace-command">command</a> and a <a href="https://github.com/ros2/ros2_tracing/tree/humble/#launch-file-trace-action">launch file action</a>.</p>

<p>The tracing directory can be configured using command/launch action parameters, or through environment variables with the following logic:</p>

<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">$ROS_TRACE_DIR</code> if <code class="language-plaintext highlighter-rouge">ROS_TRACE_DIR</code> is set and not empty.</li>
  <li>Otherwise, use <code class="language-plaintext highlighter-rouge">$ROS_HOME/tracing</code>, using <code class="language-plaintext highlighter-rouge">~/.ros</code> for <code class="language-plaintext highlighter-rouge">ROS_HOME</code> if not set or if empty.</li>
</ul>

<p>Additionally, <strong>if you’re using kernel tracing with a non-root user, make sure that the <a href="https://lttng.org/docs/v2.13/#doc-tracing-group"><code class="language-plaintext highlighter-rouge">tracing</code> group exists and that your user is added to it</a></strong>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Create group if it doesn't exist
$ sudo groupadd -r tracing
# Add user to the group
$ sudo usermod -aG tracing $USER

</code></pre></div></div>

<h3 id="trace-command">Trace command</h3>

<p>The first option is to use the <code class="language-plaintext highlighter-rouge">ros2 trace</code> command.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 trace

</code></pre></div></div>

<p>By default, it will enable all ROS tracepoints and a few kernel tracepoints.
The trace will be written to <code class="language-plaintext highlighter-rouge">~/.ros/tracing/session-YYYYMMDDHHMMSS</code>.
Run the command with <code class="language-plaintext highlighter-rouge">-h</code> for more information.</p>

<p>You must <a href="https://github.com/ros2/ros2_tracing/tree/humble/#building">install the kernel tracer</a> if you want to enable kernel events (using the <code class="language-plaintext highlighter-rouge">-k</code>/<code class="language-plaintext highlighter-rouge">--kernel-events</code> option).
If have installed the kernel tracer, use kernel tracing, and still encounter an error here, make sure to <a href="https://github.com/ros2/ros2_tracing/tree/humble/#tracing">add your user to the <code class="language-plaintext highlighter-rouge">tracing</code> group</a>.</p>

<h3 id="launch-file-trace-action">Launch file trace action</h3>

<p>Another option is to use the <code class="language-plaintext highlighter-rouge">Trace</code> action in a Python, XML, or YAML launch file along with your <code class="language-plaintext highlighter-rouge">Node</code> action(s).
This way, tracing automatically starts when launching the launch file and ends when it exits or when terminated.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 launch tracetools_launch example.launch.py

</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">Trace</code> action will also set the <code class="language-plaintext highlighter-rouge">LD_PRELOAD</code> environment to preload <a href="https://lttng.org/docs/v2.13/#doc-prebuilt-ust-helpers">LTTng’s userspace tracing helper(s)</a> if the corresponding event(s) are enabled.
For more information, see <a href="https://github.com/ros2/ros2_tracing/tree/humble/./tracetools_launch/launch/example.launch.py">this example launch file</a> and the <a href="https://github.com/ros2/ros2_tracing/tree/humble/./tracetools_launch/tracetools_launch/action.py"><code class="language-plaintext highlighter-rouge">Trace</code> action</a>.</p>

<p>You must <a href="https://github.com/ros2/ros2_tracing/tree/humble/#building">install the kernel tracer</a> if you want to enable kernel events (<code class="language-plaintext highlighter-rouge">events_kernel</code> in Python, <code class="language-plaintext highlighter-rouge">events-kernel</code> in XML or YAML).
If have installed the kernel tracer, use kernel tracing, and still encounter an error here, make sure to <a href="https://github.com/ros2/ros2_tracing/tree/humble/#tracing">add your user to the <code class="language-plaintext highlighter-rouge">tracing</code> group</a>.</p>

<h2 id="design">Design</h2>

<p>See the <a href="https://github.com/ros2/ros2_tracing/tree/humble/./doc/design_ros_2.md">design document</a>.</p>

<h2 id="real-time">Real-time</h2>

<p>LTTng-UST, the current default userspace tracer used for <a href="https://github.com/ros2/ros2_tracing/tree/humble/#overview">tracing ROS 2</a>, was designed for real-time production applications.
It is a low-overhead tracer with many important real-time compatible features:</p>

<ul>
  <li>userspace tracer completely implemented in userspace, independent from the kernel</li>
  <li>reentrant, thread-safe, signal-safe, non-blocking</li>
  <li>no system calls in the fast path</li>
  <li>no copies of the trace data</li>
</ul>

<p>However, some settings need to be tuned for it to be fully real-time safe and for performance to be optimal for your use-case:</p>

<ul>
  <li>timers<sup id="fnref:rt-1" role="doc-noteref"><a href="https://github.com/ros2/ros2_tracing/tree/humble/#fn:rt-1" class="footnote" rel="footnote">1</a></sup>: use <a href="https://lttng.org/docs/v2.13/#doc-channel-read-timer">read timer</a> to avoid a write(2) call</li>
  <li>sub-buffer<sup id="fnref:rt-1:1" role="doc-noteref"><a href="https://github.com/ros2/ros2_tracing/tree/humble/#fn:rt-1" class="footnote" rel="footnote">1</a></sup> count and size:
    <ul>
      <li>see <a href="https://lttng.org/docs/v2.13/#doc-channel-subbuf-size-vs-subbuf-count">documentation</a> for sub-buffer count and size tuning tips based on your use-case</li>
      <li>minimize sub-buffer count to minimize sub-buffer switching overhead</li>
    </ul>
  </li>
  <li>one-time memory allocation/lock/syscall per thread:
    <ul>
      <li>usually done the first time a tracepoint is executed within a thread for URCU thread registration, but registration can be manually performed to force it to be done during your application’s initialization</li>
      <li>see <a href="https://lists.lttng.org/pipermail/lttng-dev/2019-November/029409.html">this LTTng mailing list message</a>
</li>
    </ul>
  </li>
</ul>

<p>For further reading:</p>

<ul>
  <li><a href="https://lttng.org/docs/v2.13/">LTTng documentation</a></li>
  <li>
<a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.641.1965&amp;rep=rep1&amp;type=pdf#page=87">Combined Tracing of the Kernel and Applications with LTTng</a>: LTTng-UST architecture and design goals (section 3)</li>
  <li>
<a href="https://dl.acm.org/doi/abs/10.1145/3158644">Survey and Analysis of Kernel and Userspace Tracers on Linux: Design, Implementation, and Overhead</a>: LTTng-UST overhead and design compared to other kernel and userspace tracers (table 6: average latency overhead per tracepoint of 158 ns)</li>
</ul>

<p>The LTTng kernel tracer has a similar implementation, but is separate from the userspace tracer.</p>

<h2 id="packages">Packages</h2>

<h3 id="ros2trace">ros2trace</h3>

<p>Package containing a <code class="language-plaintext highlighter-rouge">ros2cli</code> extension to enable tracing.</p>

<h3 id="tracetools">tracetools</h3>

<p>Library to support instrumenting ROS packages, including core packages.</p>

<p>This package claims to be in the <strong>Quality Level 1</strong> category, see the <a href="https://github.com/ros2/ros2_tracing/tree/humble/./tracetools/QUALITY_DECLARATION.md">Quality Declaration</a> for more details.</p>

<p>See the <a href="https://ros-tracing.gitlab.io/ros2_tracing-api/">API documentation</a>.</p>

<h3 id="tracetools_launch">tracetools_launch</h3>

<p>Package containing tools to enable tracing through launch files.</p>

<h3 id="tracetools_read">tracetools_read</h3>

<p>Package containing tools to read traces.</p>

<h3 id="tracetools_test">tracetools_test</h3>

<p>Package containing tools for tracing-related tests.</p>

<h3 id="tracetools_trace">tracetools_trace</h3>

<p>Package containing tools to enable tracing.</p>

<h3 id="test_tracetools">test_tracetools</h3>

<p>Package containing unit and system tests for <code class="language-plaintext highlighter-rouge">tracetools</code>.</p>

<h2 id="analysis">Analysis</h2>

<p>See <a href="https://gitlab.com/ros-tracing/tracetools_analysis"><code class="language-plaintext highlighter-rouge">tracetools_analysis</code></a>.</p>
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:rt-1" role="doc-endnote">
      <p>this setting cannot currently be set through the <a href="https://github.com/ros2/ros2_tracing/tree/humble/#launch-file-trace-action"><code class="language-plaintext highlighter-rouge">Trace</code> launch file action</a> or the <a href="https://github.com/ros2/ros2_tracing/tree/humble/#trace-command"><code class="language-plaintext highlighter-rouge">ros2 trace</code> command</a>, see <a href="https://gitlab.com/ros-tracing/ros2_tracing/-/issues/129">!129</a> <a href="https://github.com/ros2/ros2_tracing/tree/humble/#fnref:rt-1" class="reversefootnote" role="doc-backlink">↩</a> <a href="https://github.com/ros2/ros2_tracing/tree/humble/#fnref:rt-1:1" class="reversefootnote" role="doc-backlink">↩<sup>2</sup></a></p>
    </li>
  </ol>
</div>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<p>Any contribution that you make to this repository will
be under the Apache 2 License, as dictated by that
<a href="http://www.apache.org/licenses/LICENSE-2.0.html">license</a>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5. Submission of Contributions. Unless You explicitly state otherwise,
   any Contribution intentionally submitted for inclusion in the Work
   by You to the Licensor shall be under the terms and conditions of
   this License, without any additional terms or conditions.
   Notwithstanding the above, nothing herein shall supersede or modify
   the terms of any separate license agreement you may have executed
   with Licensor regarding such Contributions.
</code></pre></div></div>

<p>Contributors must sign-off each commit by adding a <code class="language-plaintext highlighter-rouge">Signed-off-by: ...</code>
line to commit messages to certify that they have the right to submit
the code they are contributing to the project according to the
<a href="https://developercertificate.org/">Developer Certificate of Origin (DCO)</a>.</p>
</div>
              <hr id="humble-contribute-lists">
              <ul class="nav nav-tabs nav-justified" id="humble-contribute-lists-tabs">
                <li class="better-tabs active">
                  <a href="#humble-contribute-lists-help-wanted" data-toggle="tab"><span class="contribute-lists-help-wanted-count label label-primary">0</span> Help Wanted</a>
                </li>
                <li class="better-tabs">
                  <a href="#humble-contribute-lists-good-first-issue" data-toggle="tab"><span class="contribute-lists-good-first-issue-count label label-primary">0</span> Good First Issue</a>
                </li>
                <li class="better-tabs">
                  <a href="#humble-contribute-lists-pull-requests" data-toggle="tab"><span class="contribute-lists-pull-requests-count label label-primary">0</span> Pull Requests to Review</a>
                </li>
              </ul>
              <div class="tab-content contribute-lists">
                <div class="tab-pane active" id="humble-contribute-lists-help-wanted">
                  <div class="contribute-lists-help-wanted"></div>
                </div>
                <div class="tab-pane" id="humble-contribute-lists-good-first-issue">
                  <div class="contribute-lists-good-first-issue"></div>
                </div>
                <div class="tab-pane" id="humble-contribute-lists-pull-requests">
                  <div class="contribute-lists-pull-requests"></div>
                </div>
              </div>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-jazzy">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/ros2_tracing">ros2_tracing</a> <small>repository</small></h3>
        <span class="label label-default">tools</span> <span class="label label-default">instrumentation</span> <span class="label label-default">ros</span> <span class="label label-default">tracing</span> <span class="label label-default">performance-analysis</span> <span class="label label-default">ros2</span> <span class="label label-default">ros2-tracing</span> 
        
        <a class="label label-primary pkg-label" href="/p/lttngpy">lttngpy</a>
        
        <a class="label label-primary pkg-label" href="/p/ros2trace">ros2trace</a>
        
        <a class="label label-primary pkg-label" href="/p/test_ros2trace">test_ros2trace</a>
        
        <a class="label label-primary pkg-label" href="/p/test_tracetools">test_tracetools</a>
        
        <a class="label label-primary pkg-label" href="/p/test_tracetools_launch">test_tracetools_launch</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools">tracetools</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_launch">tracetools_launch</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_read">tracetools_read</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_test">tracetools_test</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_trace">tracetools_trace</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-ros2-ros2_tracing
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-ros2-ros2_tracing" role="menuitem" tabindex="-1" href="/r/ros2_tracing/github-ros2-ros2_tracing" data="github-ros2-ros2_tracing">
                    <span class="glyphicon glyphicon-star"></span>
                    github-ros2-ros2_tracing
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">Tracing tools for ROS 2.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/ros2/ros2_tracing.git">https://github.com/ros2/ros2_tracing.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">jazzy</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-04-30
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <span class="label label-default">tools</span> <span class="label label-default">instrumentation</span> <span class="label label-default">ros</span> <span class="label label-default">tracing</span> <span class="label label-default">performance-analysis</span> <span class="label label-default">ros2</span> <span class="label label-default">ros2-tracing</span> 
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/ros2_tracing/#jazzy-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ros2_tracing/#jazzy-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ros2_tracing/#jazzy-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/lttngpy">lttngpy</a></td>
                    <td>8.2.3</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ros2trace">ros2trace</a></td>
                    <td>8.2.3</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/test_ros2trace">test_ros2trace</a></td>
                    <td>8.2.3</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/test_tracetools">test_tracetools</a></td>
                    <td>8.2.3</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/test_tracetools_launch">test_tracetools_launch</a></td>
                    <td>8.2.3</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools">tracetools</a></td>
                    <td>8.2.3</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_launch">tracetools_launch</a></td>
                    <td>8.2.3</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_read">tracetools_read</a></td>
                    <td>8.2.3</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_test">tracetools_test</a></td>
                    <td>8.2.3</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_trace">tracetools_trace</a></td>
                    <td>8.2.3</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="ros2_tracing">ros2_tracing</h1>

<p><a href="https://github.com/ros2/ros2_tracing/actions/workflows/test.yml"><img src="https://github.com/ros2/ros2_tracing/actions/workflows/test.yml/badge.svg?branch=rolling" alt="GitHub CI"></a>
<a href="https://codecov.io/gh/ros2/ros2_tracing"><img src="https://codecov.io/gh/ros2/ros2_tracing/branch/rolling/graph/badge.svg" alt="codecov"></a></p>

<p>Tracing tools for ROS 2.</p>

<h2 id="overview">Overview</h2>

<p><code class="language-plaintext highlighter-rouge">ros2_tracing</code> provides <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/#tracetools">tracing instrumentation</a> for the core ROS 2 packages.
It also provides <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/#tracing">tools to configure tracing</a> through <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/#launch-file-trace-action">a launch action</a> and a <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/#trace-command"><code class="language-plaintext highlighter-rouge">ros2</code> CLI command</a>.</p>

<p><code class="language-plaintext highlighter-rouge">ros2_tracing</code> currently only supports the <a href="https://lttng.org/">LTTng</a> tracer.
Consequently, it currently only supports Linux.</p>

<p><strong>Note</strong>: make sure to use the right branch, depending on the ROS 2 distro: <a href="https://docs.ros.org/en/rolling/The-ROS2-Project/Contributing/Developer-Guide.html#branches">use <code class="language-plaintext highlighter-rouge">rolling</code> for Rolling, <code class="language-plaintext highlighter-rouge">galactic</code> for Galactic, etc.</a></p>

<h2 id="publications--presentations">Publications &amp; presentations</h2>

<p><a href="https://arxiv.org/abs/2201.00393">Read the <code class="language-plaintext highlighter-rouge">ros2_tracing</code> paper!</a>
If you use or refer to <code class="language-plaintext highlighter-rouge">ros2_tracing</code>, please cite:</p>
<ul>
  <li>C. Bédard, I. Lütkebohle, and M. Dagenais, <a href="https://arxiv.org/abs/2201.00393">“ros2_tracing: Multipurpose Low-Overhead Framework for Real-Time Tracing of ROS 2,”</a> <em>IEEE Robotics and Automation Letters</em>, vol. 7, no. 3, pp. 6511–6518, 2022.
    <details>
  <summary>BibTeX</summary>

    
</details>
  </li>
</ul>
<div class="language-bibtex highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nc">@article</span><span class="p">{</span><span class="nl">bedard2022ros2tracing</span><span class="p">,</span>
      <span class="na">title</span><span class="p">=</span><span class="s">{ros2\_tracing: Multipurpose Low-Overhead Framework for Real-Time Tracing of ROS 2}</span><span class="p">,</span>
      <span class="na">author</span><span class="p">=</span><span class="s">{B{\'e}dard, Christophe and L{\"u}tkebohle, Ingo and Dagenais, Michel}</span><span class="p">,</span>
      <span class="na">journal</span><span class="p">=</span><span class="s">{IEEE Robotics and Automation Letters}</span><span class="p">,</span>
      <span class="na">year</span><span class="p">=</span><span class="s">{2022}</span><span class="p">,</span>
      <span class="na">volume</span><span class="p">=</span><span class="s">{7}</span><span class="p">,</span>
      <span class="na">number</span><span class="p">=</span><span class="s">{3}</span><span class="p">,</span>
      <span class="na">pages</span><span class="p">=</span><span class="s">{6511--6518}</span><span class="p">,</span>
      <span class="na">doi</span><span class="p">=</span><span class="s">{10.1109/LRA.2022.3174346}</span>
    <span class="p">}</span>
    
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;/details&gt;
</code></pre></div></div>

<p>This other paper leverages <code class="language-plaintext highlighter-rouge">ros2_tracing</code> to analyze and visualize the flow of messages across distributed ROS 2 systems:</p>
<ul>
  <li>C. Bédard, P.-Y. Lajoie, G. Beltrame, and M. Dagenais, <a href="https://arxiv.org/abs/2204.10208">“Message Flow Analysis with Complex Causal Links for Distributed ROS 2 Systems,”</a> <em>Robotics and Autonomous Systems</em>, vol. 161, p. 104361, 2023.
    <details>
  <summary>BibTeX</summary>

    
</details>
  </li>
</ul>
<div class="language-bibtex highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nc">@article</span><span class="p">{</span><span class="nl">bedard2023messageflow</span><span class="p">,</span>
      <span class="na">title</span><span class="p">=</span><span class="s">{Message flow analysis with complex causal links for distributed {ROS} 2 systems}</span><span class="p">,</span>
      <span class="na">author</span><span class="p">=</span><span class="s">{B{\'e}dard, Christophe and Lajoie, Pierre-Yves and Beltrame, Giovanni and Dagenais, Michel}</span><span class="p">,</span>
      <span class="na">journal</span><span class="p">=</span><span class="s">{Robotics and Autonomous Systems}</span><span class="p">,</span>
      <span class="na">year</span><span class="p">=</span><span class="s">{2023}</span><span class="p">,</span>
      <span class="na">volume</span><span class="p">=</span><span class="s">{161}</span><span class="p">,</span>
      <span class="na">pages</span><span class="p">=</span><span class="s">{104361}</span><span class="p">,</span>
      <span class="na">doi</span><span class="p">=</span><span class="s">{10.1016/j.robot.2022.104361}</span>
    <span class="p">}</span>
    
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;/details&gt;
</code></pre></div></div>

<p>Finally, check out the following presentations:</p>

<ul>
  <li>ROSCon 2023: “Improving Your Application’s Algorithms and Optimizing Performance Using Trace Data” (<a href="https://vimeo.com/879001159">video</a>, <a href="https://roscon.ros.org/2023/talks/Improving_Your_Applications_Algorithms_and_Optimizing_Performance_Using_Trace_Data.pdf">slides</a>)</li>
  <li>ROS World 2021: “Tracing ROS 2 with ros2_tracing” (<a href="https://vimeo.com/652633418">video</a>, <a href="https://github.com/ros2/ros2_tracing/blob/rolling/doc/2021-10-20_ROS_World_2021_-_Tracing_ROS_2_with_ros2_tracing.pdf">slides</a>)</li>
</ul>

<h2 id="tutorials--demos">Tutorials &amp; demos</h2>

<ul>
  <li>ROS 2 documentation:
    <ul>
      <li><a href="https://docs.ros.org/en/rolling/How-To-Guides/Building-ROS-2-with-Tracing.html">Building ROS 2 with tracing</a></li>
      <li><a href="https://docs.ros.org/en/rolling/Tutorials/Advanced/ROS2-Tracing-Trace-and-Analyze.html">How to use <code class="language-plaintext highlighter-rouge">ros2_tracing</code> to trace and analyze an application</a></li>
    </ul>
  </li>
  <li>ROS World 2021 demo: <a href="https://github.com/christophebedard/ros-world-2021-demo">github.com/christophebedard/ros-world-2021-demo</a>
</li>
</ul>

<h2 id="building">Building</h2>

<p>As of Iron, the LTTng tracer is a ROS 2 dependency.
Therefore, ROS 2 can be traced out-of-the-box on Linux; this package does not need to be re-built.</p>

<p>To make sure that the instrumentation and tracepoints are available:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ source /opt/ros/rolling/setup.bash  # With a binary install
$ source ./install/setup.bash  # When building from source
$ ros2 run tracetools status
Tracing enabled

</code></pre></div></div>

<p>A ROS 2 installation only includes the LTTng userspace tracer (LTTng-UST), which is all that is needed to trace ROS 2.
To trace the Linux kernel, the <a href="https://lttng.org/docs/v2.13/#doc-tracing-the-linux-kernel">LTTng kernel tracer</a> must be installed separately:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo apt-get update
$ sudo apt-get install lttng-modules-dkms

</code></pre></div></div>

<p>For more information about LTTng, <a href="https://lttng.org/docs/v2.13/">refer to its documentation</a>.</p>

<h3 id="removing-the-instrumentation">Removing the instrumentation</h3>

<p>To build and remove all instrumentation, use <code class="language-plaintext highlighter-rouge">TRACETOOLS_DISABLED</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ colcon build --cmake-args -DTRACETOOLS_DISABLED=ON

</code></pre></div></div>

<p>This will remove all instrumentation from the core ROS 2 packages, and thus they will not depend on or link against the shared library provided by the <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/#tracetools"><code class="language-plaintext highlighter-rouge">tracetools</code> package</a>.
This also means that LTTng is not required at build-time or at runtime.</p>

<h3 id="excluding-tracepoints">Excluding tracepoints</h3>

<p>Alternatively, to only exclude the actual tracepoints, use <code class="language-plaintext highlighter-rouge">TRACETOOLS_TRACEPOINTS_EXCLUDED</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ colcon build --packages-select tracetools --cmake-clean-cache --cmake-args -DTRACETOOLS_TRACEPOINTS_EXCLUDED=ON

</code></pre></div></div>

<p>This will keep the instrumentation but remove all tracepoints.
This also means that LTTng is not required at build-time or at runtime.
This option can be useful, since tracepoints can be added back in or removed by simply replacing/re-building the shared library provided by the <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/#tracetools"><code class="language-plaintext highlighter-rouge">tracetools</code> package</a>.</p>

<h2 id="tracing">Tracing</h2>

<p>By default, trace data will not be generated, and thus these packages will have virtually no impact on execution.
LTTng has to be configured for tracing.
The packages in this repo provide two options: a <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/#trace-command">command</a> and a <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/#launch-file-trace-action">launch file action</a>.</p>

<p><strong>Note</strong>: tracing must be started before the application is launched.
Metadata is recorded during the initialization phase of the application.
This metadata is needed to understand the rest of the trace data, so if tracing is started after the application started executing, then the trace data might be unusable.
For more information, refer to the <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/./doc/design_ros_2.md#general-guidelines">design document</a>.
The <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/#launch-file-trace-action">launch file action</a> is designed to automatically start tracing before the application launches.</p>

<p>The tracing directory can be configured using command/launch action parameters, or through environment variables with the following logic:</p>

<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">$ROS_TRACE_DIR</code> if <code class="language-plaintext highlighter-rouge">ROS_TRACE_DIR</code> is set and not empty.</li>
  <li>Otherwise, use <code class="language-plaintext highlighter-rouge">$ROS_HOME/tracing</code>, using <code class="language-plaintext highlighter-rouge">~/.ros</code> for <code class="language-plaintext highlighter-rouge">ROS_HOME</code> if not set or if empty.</li>
</ul>

<p>Additionally, <strong>if you’re using kernel tracing with a non-root user, make sure that the <a href="https://lttng.org/docs/v2.13/#doc-tracing-group"><code class="language-plaintext highlighter-rouge">tracing</code> group exists and that your user is added to it</a></strong>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Create group if it doesn't exist
$ sudo groupadd -r tracing
# Add user to the group
$ sudo usermod -aG tracing $USER

</code></pre></div></div>

<h3 id="trace-command">Trace command</h3>

<p>The first option is to use the <code class="language-plaintext highlighter-rouge">ros2 trace</code> command.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 trace

</code></pre></div></div>

<p>By default, it will enable all ROS 2 tracepoints.
The trace will be written to <code class="language-plaintext highlighter-rouge">~/.ros/tracing/session-YYYYMMDDHHMMSS</code>.
Run the command with <code class="language-plaintext highlighter-rouge">-h</code> for more information.</p>

<p>The <code class="language-plaintext highlighter-rouge">ros2 trace</code> command requires user interaction to start and then stop tracing.
To trace without user interaction (e.g., in scripts), or for finer-grained tracing control, the following sub-commands can be used:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 trace start session_name   # Configure tracing session and start tracing
$ ros2 trace pause session_name   # Pause tracing after starting
$ ros2 trace resume session_name  # Resume tracing after pausing
$ ros2 trace stop session_name    # Stop tracing after starting or resuming

</code></pre></div></div>

<p>Run each command with <code class="language-plaintext highlighter-rouge">-h</code> for more information.</p>

<p>You must <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/#building">install the kernel tracer</a> if you want to enable kernel events (using the <code class="language-plaintext highlighter-rouge">-k</code>/<code class="language-plaintext highlighter-rouge">--kernel-events</code> option).
If you have installed the kernel tracer, use kernel tracing, and still encounter an error here, make sure to <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/#tracing">add your user to the <code class="language-plaintext highlighter-rouge">tracing</code> group</a>.</p>

<h3 id="launch-file-trace-action">Launch file trace action</h3>

<p>Another option is to use the <code class="language-plaintext highlighter-rouge">Trace</code> action in a Python, XML, or YAML launch file along with your <code class="language-plaintext highlighter-rouge">Node</code> action(s).
This way, tracing automatically starts when launching the launch file and ends when it exits or when terminated.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 launch tracetools_launch example.launch.py

</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">Trace</code> action will also set the <code class="language-plaintext highlighter-rouge">LD_PRELOAD</code> environment to preload <a href="https://lttng.org/docs/v2.13/#doc-prebuilt-ust-helpers">LTTng’s userspace tracing helper(s)</a> if the corresponding event(s) are enabled.
For more information, see <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/./tracetools_launch/launch/example.launch.py">this example launch file</a> and the <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/./tracetools_launch/tracetools_launch/action.py"><code class="language-plaintext highlighter-rouge">Trace</code> action</a>.</p>

<p>You must <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/#building">install the kernel tracer</a> if you want to enable kernel events (<code class="language-plaintext highlighter-rouge">events_kernel</code> in Python, <code class="language-plaintext highlighter-rouge">events-kernel</code> in XML or YAML).
If you have installed the kernel tracer, use kernel tracing, and still encounter an error here, make sure to <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/#tracing">add your user to the <code class="language-plaintext highlighter-rouge">tracing</code> group</a>.</p>

<h2 id="design">Design</h2>

<p>See the <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/./doc/design_ros_2.md">design document</a>.</p>

<h2 id="real-time">Real-time</h2>

<p>LTTng-UST, the current default userspace tracer used for <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/#overview">tracing ROS 2</a>, was designed for real-time production applications.
It is a low-overhead tracer with many important real-time compatible features:</p>

<ul>
  <li>userspace tracer completely implemented in userspace, independent from the kernel</li>
  <li>reentrant, thread-safe, signal-safe, non-blocking</li>
  <li>no system calls in the fast path</li>
  <li>no copies of the trace data</li>
</ul>

<p>However, some settings need to be tuned for it to be fully real-time safe and for performance to be optimal for your use-case:</p>

<ul>
  <li>timers<sup id="fnref:rt-1" role="doc-noteref"><a href="https://github.com/ros2/ros2_tracing/tree/jazzy/#fn:rt-1" class="footnote" rel="footnote">1</a></sup>: use <a href="https://lttng.org/docs/v2.13/#doc-channel-read-timer">read timer</a> to avoid a write(2) call</li>
  <li>sub-buffer<sup id="fnref:rt-1:1" role="doc-noteref"><a href="https://github.com/ros2/ros2_tracing/tree/jazzy/#fn:rt-1" class="footnote" rel="footnote">1</a></sup> count and size:
    <ul>
      <li>see <a href="https://lttng.org/docs/v2.13/#doc-channel-subbuf-size-vs-subbuf-count">documentation</a> for sub-buffer count and size tuning tips based on your use-case</li>
      <li>minimize sub-buffer count to minimize sub-buffer switching overhead</li>
    </ul>
  </li>
  <li>one-time memory allocation/lock/syscall per thread:
    <ul>
      <li>usually done the first time a tracepoint is executed within a thread for URCU thread registration, but registration can be manually performed to force it to be done during your application’s initialization</li>
      <li>see <a href="https://lists.lttng.org/pipermail/lttng-dev/2019-November/029409.html">this LTTng mailing list message</a>
</li>
    </ul>
  </li>
</ul>

<p>For further reading:</p>

<ul>
  <li><a href="https://lttng.org/docs/v2.13/">LTTng documentation</a></li>
  <li>
<a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.641.1965&amp;rep=rep1&amp;type=pdf#page=87">Combined Tracing of the Kernel and Applications with LTTng</a>: LTTng-UST architecture and design goals (section 3)</li>
  <li>
<a href="https://dl.acm.org/doi/abs/10.1145/3158644">Survey and Analysis of Kernel and Userspace Tracers on Linux: Design, Implementation, and Overhead</a>: LTTng-UST overhead and design compared to other kernel and userspace tracers (table 6: average latency overhead per tracepoint of 158 ns)</li>
</ul>

<p>The LTTng kernel tracer has a similar implementation, but is separate from the userspace tracer.</p>

<h2 id="packages">Packages</h2>

<h3 id="lttngpy">lttngpy</h3>

<p>Package containing <code class="language-plaintext highlighter-rouge">liblttng-ctl</code> Python bindings.</p>

<h3 id="ros2trace">ros2trace</h3>

<p>Package containing a <code class="language-plaintext highlighter-rouge">ros2cli</code> extension to enable tracing.</p>

<h3 id="tracetools">tracetools</h3>

<p>Library to support instrumenting ROS packages, including core packages.</p>

<p>This package claims to be in the <strong>Quality Level 1</strong> category, see the <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/./tracetools/QUALITY_DECLARATION.md">Quality Declaration</a> for more details.</p>

<p>See the <a href="https://docs.ros.org/en/rolling/p/tracetools/">API documentation</a>.</p>

<h3 id="tracetools_launch">tracetools_launch</h3>

<p>Package containing tools to enable tracing through launch files.</p>

<h3 id="tracetools_read">tracetools_read</h3>

<p>Package containing tools to read traces.</p>

<h3 id="tracetools_test">tracetools_test</h3>

<p>Package containing tools for tracing-related tests.</p>

<h3 id="tracetools_trace">tracetools_trace</h3>

<p>Package containing tools to enable tracing.</p>

<h3 id="test_ros2trace">test_ros2trace</h3>

<p>Package containing system tests for <code class="language-plaintext highlighter-rouge">ros2trace</code>.</p>

<h3 id="test_tracetools">test_tracetools</h3>

<p>Package containing unit and system tests for <code class="language-plaintext highlighter-rouge">tracetools</code>.</p>

<h3 id="test_tracetools_launch">test_tracetools_launch</h3>

<p>Package containing system tests for <code class="language-plaintext highlighter-rouge">tracetools_launch</code>.</p>

<h2 id="analysis">Analysis</h2>

<p>See <a href="https://github.com/ros-tracing/tracetools_analysis"><code class="language-plaintext highlighter-rouge">tracetools_analysis</code></a>.</p>
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:rt-1" role="doc-endnote">
      <p>this setting cannot currently be set through the <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/#launch-file-trace-action"><code class="language-plaintext highlighter-rouge">Trace</code> launch file action</a> or the <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/#trace-command"><code class="language-plaintext highlighter-rouge">ros2 trace</code> command</a>, see <a href="https://github.com/ros2/ros2_tracing/issues/20">#20</a> <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/#fnref:rt-1" class="reversefootnote" role="doc-backlink">↩</a> <a href="https://github.com/ros2/ros2_tracing/tree/jazzy/#fnref:rt-1:1" class="reversefootnote" role="doc-backlink">↩<sup>2</sup></a></p>
    </li>
  </ol>
</div>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<p>Any contribution that you make to this repository will
be under the Apache 2 License, as dictated by that
<a href="http://www.apache.org/licenses/LICENSE-2.0.html">license</a>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5. Submission of Contributions. Unless You explicitly state otherwise,
   any Contribution intentionally submitted for inclusion in the Work
   by You to the Licensor shall be under the terms and conditions of
   this License, without any additional terms or conditions.
   Notwithstanding the above, nothing herein shall supersede or modify
   the terms of any separate license agreement you may have executed
   with Licensor regarding such Contributions.
</code></pre></div></div>

<p>Contributors must sign-off each commit by adding a <code class="language-plaintext highlighter-rouge">Signed-off-by: ...</code>
line to commit messages to certify that they have the right to submit
the code they are contributing to the project according to the
<a href="https://developercertificate.org/">Developer Certificate of Origin (DCO)</a>.</p>
</div>
              <hr id="jazzy-contribute-lists">
              <ul class="nav nav-tabs nav-justified" id="jazzy-contribute-lists-tabs">
                <li class="better-tabs active">
                  <a href="#jazzy-contribute-lists-help-wanted" data-toggle="tab"><span class="contribute-lists-help-wanted-count label label-primary">0</span> Help Wanted</a>
                </li>
                <li class="better-tabs">
                  <a href="#jazzy-contribute-lists-good-first-issue" data-toggle="tab"><span class="contribute-lists-good-first-issue-count label label-primary">0</span> Good First Issue</a>
                </li>
                <li class="better-tabs">
                  <a href="#jazzy-contribute-lists-pull-requests" data-toggle="tab"><span class="contribute-lists-pull-requests-count label label-primary">0</span> Pull Requests to Review</a>
                </li>
              </ul>
              <div class="tab-content contribute-lists">
                <div class="tab-pane active" id="jazzy-contribute-lists-help-wanted">
                  <div class="contribute-lists-help-wanted"></div>
                </div>
                <div class="tab-pane" id="jazzy-contribute-lists-good-first-issue">
                  <div class="contribute-lists-good-first-issue"></div>
                </div>
                <div class="tab-pane" id="jazzy-contribute-lists-pull-requests">
                  <div class="contribute-lists-pull-requests"></div>
                </div>
              </div>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-kilted">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/ros2_tracing">ros2_tracing</a> <small>repository</small></h3>
        <span class="label label-default">tools</span> <span class="label label-default">instrumentation</span> <span class="label label-default">ros</span> <span class="label label-default">tracing</span> <span class="label label-default">performance-analysis</span> <span class="label label-default">ros2</span> <span class="label label-default">ros2-tracing</span> 
        
        <a class="label label-primary pkg-label" href="/p/lttngpy">lttngpy</a>
        
        <a class="label label-primary pkg-label" href="/p/ros2trace">ros2trace</a>
        
        <a class="label label-primary pkg-label" href="/p/test_ros2trace">test_ros2trace</a>
        
        <a class="label label-primary pkg-label" href="/p/test_tracetools">test_tracetools</a>
        
        <a class="label label-primary pkg-label" href="/p/test_tracetools_launch">test_tracetools_launch</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools">tracetools</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_launch">tracetools_launch</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_read">tracetools_read</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_test">tracetools_test</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_trace">tracetools_trace</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-ros2-ros2_tracing
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-ros2-ros2_tracing" role="menuitem" tabindex="-1" href="/r/ros2_tracing/github-ros2-ros2_tracing" data="github-ros2-ros2_tracing">
                    <span class="glyphicon glyphicon-star"></span>
                    github-ros2-ros2_tracing
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">Tracing tools for ROS 2.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/ros2/ros2_tracing.git">https://github.com/ros2/ros2_tracing.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">kilted</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-04-29
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <span class="label label-default">tools</span> <span class="label label-default">instrumentation</span> <span class="label label-default">ros</span> <span class="label label-default">tracing</span> <span class="label label-default">performance-analysis</span> <span class="label label-default">ros2</span> <span class="label label-default">ros2-tracing</span> 
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/ros2_tracing/#kilted-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ros2_tracing/#kilted-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ros2_tracing/#kilted-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/lttngpy">lttngpy</a></td>
                    <td>8.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ros2trace">ros2trace</a></td>
                    <td>8.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/test_ros2trace">test_ros2trace</a></td>
                    <td>8.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/test_tracetools">test_tracetools</a></td>
                    <td>8.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/test_tracetools_launch">test_tracetools_launch</a></td>
                    <td>8.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools">tracetools</a></td>
                    <td>8.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_launch">tracetools_launch</a></td>
                    <td>8.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_read">tracetools_read</a></td>
                    <td>8.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_test">tracetools_test</a></td>
                    <td>8.6.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_trace">tracetools_trace</a></td>
                    <td>8.6.0</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="ros2_tracing">ros2_tracing</h1>

<p><a href="https://github.com/ros2/ros2_tracing/actions/workflows/test.yml"><img src="https://github.com/ros2/ros2_tracing/actions/workflows/test.yml/badge.svg?branch=rolling" alt="GitHub CI"></a>
<a href="https://codecov.io/gh/ros2/ros2_tracing"><img src="https://codecov.io/gh/ros2/ros2_tracing/branch/rolling/graph/badge.svg" alt="codecov"></a></p>

<p>Tracing tools for ROS 2.</p>

<h2 id="overview">Overview</h2>

<p><code class="language-plaintext highlighter-rouge">ros2_tracing</code> provides <a href="https://github.com/ros2/ros2_tracing/tree/kilted/#tracetools">tracing instrumentation</a> for the core ROS 2 packages.
It also provides <a href="https://github.com/ros2/ros2_tracing/tree/kilted/#tracing">tools to configure tracing</a> through <a href="https://github.com/ros2/ros2_tracing/tree/kilted/#launch-file-trace-action">a launch action</a> and a <a href="https://github.com/ros2/ros2_tracing/tree/kilted/#trace-command"><code class="language-plaintext highlighter-rouge">ros2</code> CLI command</a>.
For more information about tracing, see the <a href="https://github.com/ros2/ros2_tracing/tree/kilted/#what-is-tracing"><em>What is tracing?</em></a> section.</p>

<p><code class="language-plaintext highlighter-rouge">ros2_tracing</code> currently only supports the <a href="https://lttng.org/">LTTng</a> tracer.
Consequently, it currently only supports Linux.</p>

<blockquote>
  <p>[!NOTE]
Make sure to use the right branch, depending on the ROS 2 distro: <a href="https://docs.ros.org/en/rolling/The-ROS2-Project/Contributing/Developer-Guide.html#branches">use <code class="language-plaintext highlighter-rouge">rolling</code> for Rolling, <code class="language-plaintext highlighter-rouge">galactic</code> for Galactic, etc.</a></p>
</blockquote>

<h2 id="publications--presentations">Publications &amp; presentations</h2>

<p><a href="https://arxiv.org/abs/2201.00393">Read the <code class="language-plaintext highlighter-rouge">ros2_tracing</code> paper!</a>
If you use or refer to <code class="language-plaintext highlighter-rouge">ros2_tracing</code>, please cite:</p>
<ul>
  <li>C. Bédard, I. Lütkebohle, and M. Dagenais, <a href="https://arxiv.org/abs/2201.00393">“ros2_tracing: Multipurpose Low-Overhead Framework for Real-Time Tracing of ROS 2,”</a> <em>IEEE Robotics and Automation Letters</em>, vol. 7, no. 3, pp. 6511–6518, 2022.
    <details>
  <summary>BibTeX</summary>

    
</details>
  </li>
</ul>
<div class="language-bibtex highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nc">@article</span><span class="p">{</span><span class="nl">bedard2022ros2tracing</span><span class="p">,</span>
      <span class="na">title</span><span class="p">=</span><span class="s">{ros2\_tracing: Multipurpose Low-Overhead Framework for Real-Time Tracing of ROS 2}</span><span class="p">,</span>
      <span class="na">author</span><span class="p">=</span><span class="s">{B{\'e}dard, Christophe and L{\"u}tkebohle, Ingo and Dagenais, Michel}</span><span class="p">,</span>
      <span class="na">journal</span><span class="p">=</span><span class="s">{IEEE Robotics and Automation Letters}</span><span class="p">,</span>
      <span class="na">year</span><span class="p">=</span><span class="s">{2022}</span><span class="p">,</span>
      <span class="na">volume</span><span class="p">=</span><span class="s">{7}</span><span class="p">,</span>
      <span class="na">number</span><span class="p">=</span><span class="s">{3}</span><span class="p">,</span>
      <span class="na">pages</span><span class="p">=</span><span class="s">{6511--6518}</span><span class="p">,</span>
      <span class="na">doi</span><span class="p">=</span><span class="s">{10.1109/LRA.2022.3174346}</span>
    <span class="p">}</span>
    
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;/details&gt;
</code></pre></div></div>

<p>This other paper leverages <code class="language-plaintext highlighter-rouge">ros2_tracing</code> to analyze and visualize the flow of messages across distributed ROS 2 systems:</p>
<ul>
  <li>C. Bédard, P.-Y. Lajoie, G. Beltrame, and M. Dagenais, <a href="https://arxiv.org/abs/2204.10208">“Message Flow Analysis with Complex Causal Links for Distributed ROS 2 Systems,”</a> <em>Robotics and Autonomous Systems</em>, vol. 161, p. 104361, 2023.
    <details>
  <summary>BibTeX</summary>

    
</details>
  </li>
</ul>
<div class="language-bibtex highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nc">@article</span><span class="p">{</span><span class="nl">bedard2023messageflow</span><span class="p">,</span>
      <span class="na">title</span><span class="p">=</span><span class="s">{Message flow analysis with complex causal links for distributed {ROS} 2 systems}</span><span class="p">,</span>
      <span class="na">author</span><span class="p">=</span><span class="s">{B{\'e}dard, Christophe and Lajoie, Pierre-Yves and Beltrame, Giovanni and Dagenais, Michel}</span><span class="p">,</span>
      <span class="na">journal</span><span class="p">=</span><span class="s">{Robotics and Autonomous Systems}</span><span class="p">,</span>
      <span class="na">year</span><span class="p">=</span><span class="s">{2023}</span><span class="p">,</span>
      <span class="na">volume</span><span class="p">=</span><span class="s">{161}</span><span class="p">,</span>
      <span class="na">pages</span><span class="p">=</span><span class="s">{104361}</span><span class="p">,</span>
      <span class="na">doi</span><span class="p">=</span><span class="s">{10.1016/j.robot.2022.104361}</span>
    <span class="p">}</span>
    
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;/details&gt;
</code></pre></div></div>

<p>Finally, check out the following presentations:</p>

<ul>
  <li>ROSCon 2023: “Improving Your Application’s Algorithms and Optimizing Performance Using Trace Data” (<a href="https://vimeo.com/879001159">video</a>, <a href="https://roscon.ros.org/2023/talks/Improving_Your_Applications_Algorithms_and_Optimizing_Performance_Using_Trace_Data.pdf">slides</a>)</li>
  <li>ROS World 2021: “Tracing ROS 2 with ros2_tracing” (<a href="https://vimeo.com/652633418">video</a>, <a href="https://github.com/ros2/ros2_tracing/blob/rolling/doc/2021-10-20_ROS_World_2021_-_Tracing_ROS_2_with_ros2_tracing.pdf">slides</a>)</li>
</ul>

<h2 id="tutorials--demos">Tutorials &amp; demos</h2>

<ul>
  <li>ROS 2 documentation:
    <ul>
      <li><a href="https://docs.ros.org/en/rolling/How-To-Guides/Building-ROS-2-with-Tracing.html">Building ROS 2 with tracing</a></li>
      <li><a href="https://docs.ros.org/en/rolling/Tutorials/Advanced/ROS2-Tracing-Trace-and-Analyze.html">How to use <code class="language-plaintext highlighter-rouge">ros2_tracing</code> to trace and analyze an application</a></li>
    </ul>
  </li>
  <li>ROS World 2021 demo: <a href="https://github.com/christophebedard/ros-world-2021-demo">github.com/christophebedard/ros-world-2021-demo</a>
</li>
</ul>

<h2 id="building">Building</h2>

<p>Starting from ROS 2 Iron Irwini, the LTTng tracer is a ROS 2 dependency.
Therefore, ROS 2 can be traced out-of-the-box on Linux; this package does not need to be re-built.
The following <code class="language-plaintext highlighter-rouge">rmw</code> implementations are supported:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">rmw_connextdds</code></li>
  <li><code class="language-plaintext highlighter-rouge">rmw_cyclonedds_cpp</code></li>
  <li><code class="language-plaintext highlighter-rouge">rmw_fastrtps_cpp</code></li>
  <li><code class="language-plaintext highlighter-rouge">rmw_fastrtps_dynamic_cpp</code></li>
  <li><code class="language-plaintext highlighter-rouge">rmw_zenoh_cpp</code></li>
</ul>

<p>To make sure that the instrumentation and tracepoints are available:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ source /opt/ros/rolling/setup.bash  # With a binary install
$ source ./install/setup.bash  # When building from source
$ ros2 run tracetools status
Tracing enabled

</code></pre></div></div>

<p>A ROS 2 installation only includes the LTTng userspace tracer (LTTng-UST), which is all that is needed to trace ROS 2.
To trace the Linux kernel, the <a href="https://lttng.org/docs/v2.13/#doc-tracing-the-linux-kernel">LTTng kernel tracer</a> must be installed separately:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo apt-get update
$ sudo apt-get install lttng-modules-dkms

</code></pre></div></div>

<p>For more information about LTTng, <a href="https://lttng.org/docs/v2.13/">refer to its documentation</a>.</p>

<h3 id="removing-the-instrumentation">Removing the instrumentation</h3>

<p>To build and remove all instrumentation, use <code class="language-plaintext highlighter-rouge">TRACETOOLS_DISABLED</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ colcon build --cmake-args -DTRACETOOLS_DISABLED=ON

</code></pre></div></div>

<p>This will remove all instrumentation from the core ROS 2 packages, and thus they will not depend on or link against the shared library provided by the <a href="https://github.com/ros2/ros2_tracing/tree/kilted/#tracetools"><code class="language-plaintext highlighter-rouge">tracetools</code> package</a>.
This also means that LTTng is not required at build-time or at runtime.</p>

<h3 id="excluding-tracepoints">Excluding tracepoints</h3>

<p>Alternatively, to only exclude the actual tracepoints, use <code class="language-plaintext highlighter-rouge">TRACETOOLS_TRACEPOINTS_EXCLUDED</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ colcon build --packages-select tracetools --cmake-clean-cache --cmake-args -DTRACETOOLS_TRACEPOINTS_EXCLUDED=ON

</code></pre></div></div>

<p>This will keep the instrumentation but remove all tracepoints.
This also means that LTTng is not required at build-time or at runtime.
This option can be useful, since tracepoints can be added back in or removed by simply replacing/re-building the shared library provided by the <a href="https://github.com/ros2/ros2_tracing/tree/kilted/#tracetools"><code class="language-plaintext highlighter-rouge">tracetools</code> package</a>.</p>

<h2 id="what-is-tracing">What is tracing?</h2>

<p>Software <em>tracing</em> is a method of collecting low-level runtime data to understand a system’s execution.
This is achieved by <em>instrumenting</em> the code using <em>tracepoints</em>, for example in ROS 2, the Linux kernel, or any other application.
When a tracepoint is executed, it generates information that is collected by a <em>tracer</em> into a <em>trace</em>.
Tracers are usually low-overhead to avoid affecting the execution.
Traces can then be analyzed to help understand the execution, fix bugs, improve performance, etc.
While <em>logs</em> are typically high-level enough for a user to read and understand, trace data is low-level &amp; high-rate and therefore usually needs to be processed to be useful.</p>

<p>For more information, see the following introductions on tracing:</p>

<ul>
  <li><a href="https://lttng.org/docs/v2.13/#doc-what-is-tracing">LTTng tracer documentation</a></li>
  <li><a href="https://github.com/tuxology/tracevizlab/tree/master/labs/001-what-is-tracing#what-is-tracing">Tracing tutorial</a></li>
  <li><a href="https://archive.eclipse.org/tracecompass/doc/stable/org.eclipse.tracecompass.doc.user/Overview.html#About_Tracing">Eclipse Trace Compass (trace analysis tool) documentation</a></li>
</ul>

<h2 id="tracing">Tracing</h2>

<p>By default, trace data will not be generated, and thus these packages will have virtually no impact on execution.
LTTng has to be configured for tracing.
The packages in this repo provide two options: a <a href="https://github.com/ros2/ros2_tracing/tree/kilted/#trace-command">command</a> and a <a href="https://github.com/ros2/ros2_tracing/tree/kilted/#launch-file-trace-action">launch file action</a>.</p>

<blockquote>
  <p>[!NOTE]
Tracing must be started before the application is launched.
Metadata is recorded during the initialization phase of the application.
This metadata is needed to understand the rest of the trace data, so if tracing is started after the application started executing, then the trace data might be unusable.
For more information, refer to the <a href="https://github.com/ros2/ros2_tracing/tree/kilted/./doc/design_ros_2.md#general-guidelines">design document</a>.
The <a href="https://github.com/ros2/ros2_tracing/tree/kilted/#launch-file-trace-action">launch file action</a> is designed to automatically start tracing before the application launches.</p>
</blockquote>

<p>The tracing directory can be configured using command/launch action parameters, or through environment variables with the following logic:</p>

<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">$ROS_TRACE_DIR</code> if <code class="language-plaintext highlighter-rouge">ROS_TRACE_DIR</code> is set and not empty.</li>
  <li>Otherwise, use <code class="language-plaintext highlighter-rouge">$ROS_HOME/tracing</code>, using <code class="language-plaintext highlighter-rouge">~/.ros</code> for <code class="language-plaintext highlighter-rouge">ROS_HOME</code> if not set or if empty.</li>
</ul>

<p>Additionally, <strong>if you’re using kernel tracing with a non-root user, make sure that the <a href="https://lttng.org/docs/v2.13/#doc-tracing-group"><code class="language-plaintext highlighter-rouge">tracing</code> group exists and that your user is added to it</a></strong>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Create group if it doesn't exist
$ sudo groupadd -r tracing
# Add user to the group
$ sudo usermod -aG tracing $USER

</code></pre></div></div>

<h3 id="trace-command">Trace command</h3>

<p>The first option is to use the <code class="language-plaintext highlighter-rouge">ros2 trace</code> command.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 trace

</code></pre></div></div>

<p>By default, it will enable all ROS 2 tracepoints.
The trace will be written to <code class="language-plaintext highlighter-rouge">~/.ros/tracing/session-YYYYMMDDHHMMSS</code>.
Run the command with <code class="language-plaintext highlighter-rouge">-h</code> for more information.</p>

<p>The <code class="language-plaintext highlighter-rouge">ros2 trace</code> command requires user interaction to start and then stop tracing.
To trace without user interaction (e.g., in scripts), or for finer-grained tracing control, the following sub-commands can be used:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 trace start session_name   # Configure tracing session and start tracing
$ ros2 trace pause session_name   # Pause tracing after starting
$ ros2 trace resume session_name  # Resume tracing after pausing
$ ros2 trace stop session_name    # Stop tracing after starting or resuming

</code></pre></div></div>

<p>Run each command with <code class="language-plaintext highlighter-rouge">-h</code> for more information.</p>

<p>You must <a href="https://github.com/ros2/ros2_tracing/tree/kilted/#building">install the kernel tracer</a> if you want to enable <a href="https://lttng.org/docs/v2.13/#doc-tracing-the-linux-kernel">kernel</a> events (using the <code class="language-plaintext highlighter-rouge">-k</code>/<code class="language-plaintext highlighter-rouge">--kernel-events</code> option) or syscalls (using the <code class="language-plaintext highlighter-rouge">--syscalls</code> option).
If you have installed the kernel tracer, use kernel tracing, and still encounter an error here, make sure to <a href="https://github.com/ros2/ros2_tracing/tree/kilted/#tracing">add your user to the <code class="language-plaintext highlighter-rouge">tracing</code> group</a>.</p>

<h3 id="launch-file-trace-action">Launch file trace action</h3>

<p>Another option is to use the <code class="language-plaintext highlighter-rouge">Trace</code> action in a Python, XML, or YAML launch file along with your <code class="language-plaintext highlighter-rouge">Node</code> action(s).
This way, tracing automatically starts when launching the launch file and ends when it exits or when terminated.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 launch tracetools_launch example.launch.py

</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">Trace</code> action will also set the <code class="language-plaintext highlighter-rouge">LD_PRELOAD</code> environment to preload <a href="https://lttng.org/docs/v2.13/#doc-prebuilt-ust-helpers">LTTng’s userspace tracing helper(s)</a> if the corresponding event(s) are enabled.
For more information, see <a href="https://github.com/ros2/ros2_tracing/tree/kilted/./tracetools_launch/launch/example.launch.py">this example launch file</a> and the <a href="https://github.com/ros2/ros2_tracing/tree/kilted/./tracetools_launch/tracetools_launch/action.py"><code class="language-plaintext highlighter-rouge">Trace</code> action</a>.</p>

<p>You must <a href="https://github.com/ros2/ros2_tracing/tree/kilted/#building">install the kernel tracer</a> if you want to enable <a href="https://lttng.org/docs/v2.13/#doc-tracing-the-linux-kernel">kernel</a> events (<code class="language-plaintext highlighter-rouge">events_kernel</code> in Python, <code class="language-plaintext highlighter-rouge">events-kernel</code> in XML or YAML) or syscalls (<code class="language-plaintext highlighter-rouge">syscalls</code> in Python, XML, or YAML).
If you have installed the kernel tracer, use kernel tracing, and still encounter an error here, make sure to <a href="https://github.com/ros2/ros2_tracing/tree/kilted/#tracing">add your user to the <code class="language-plaintext highlighter-rouge">tracing</code> group</a>.</p>

<h2 id="design">Design</h2>

<p>See the <a href="https://github.com/ros2/ros2_tracing/tree/kilted/./doc/design_ros_2.md">design document</a>.</p>

<h2 id="real-time">Real-time</h2>

<p>LTTng-UST, the current default userspace tracer used for <a href="https://github.com/ros2/ros2_tracing/tree/kilted/#overview">tracing ROS 2</a>, was designed for real-time production applications.
It is a low-overhead tracer with many important real-time compatible features:</p>

<ul>
  <li>userspace tracer completely implemented in userspace, independent from the kernel</li>
  <li>reentrant, thread-safe, signal-safe, non-blocking</li>
  <li>no system calls in the fast path</li>
  <li>no copies of the trace data</li>
</ul>

<p>However, some settings need to be tuned for it to be fully real-time safe and for performance to be optimal for your use-case:</p>

<ul>
  <li>timers<sup id="fnref:rt-1" role="doc-noteref"><a href="https://github.com/ros2/ros2_tracing/tree/kilted/#fn:rt-1" class="footnote" rel="footnote">1</a></sup>: use <a href="https://lttng.org/docs/v2.13/#doc-channel-read-timer">read timer</a> to avoid a write(2) call</li>
  <li>sub-buffer<sup id="fnref:rt-1:1" role="doc-noteref"><a href="https://github.com/ros2/ros2_tracing/tree/kilted/#fn:rt-1" class="footnote" rel="footnote">1</a></sup> count and size:
    <ul>
      <li>see <a href="https://lttng.org/docs/v2.13/#doc-channel-subbuf-size-vs-subbuf-count">documentation</a> for sub-buffer count and size tuning tips based on your use-case</li>
      <li>minimize sub-buffer count to minimize sub-buffer switching overhead</li>
    </ul>
  </li>
  <li>one-time memory allocation/lock/syscall per thread:
    <ul>
      <li>usually done the first time a tracepoint is executed within a thread for URCU thread registration, but registration can be manually performed to force it to be done during your application’s initialization</li>
      <li>see <a href="https://lists.lttng.org/pipermail/lttng-dev/2019-November/029409.html">this LTTng mailing list message</a>
</li>
    </ul>
  </li>
</ul>

<p>For further reading:</p>

<ul>
  <li><a href="https://lttng.org/docs/v2.13/">LTTng documentation</a></li>
  <li>
<a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.641.1965&amp;rep=rep1&amp;type=pdf#page=87">Combined Tracing of the Kernel and Applications with LTTng</a>: LTTng-UST architecture and design goals (section 3)</li>
  <li>
<a href="https://dl.acm.org/doi/abs/10.1145/3158644">Survey and Analysis of Kernel and Userspace Tracers on Linux: Design, Implementation, and Overhead</a>: LTTng-UST overhead and design compared to other kernel and userspace tracers (table 6: average latency overhead per tracepoint of 158 ns)</li>
</ul>

<p>The LTTng kernel tracer has a similar implementation, but is separate from the userspace tracer.</p>

<h2 id="packages">Packages</h2>

<h3 id="lttngpy">lttngpy</h3>

<p>Package containing <code class="language-plaintext highlighter-rouge">liblttng-ctl</code> Python bindings.</p>

<h3 id="ros2trace">ros2trace</h3>

<p>Package containing a <code class="language-plaintext highlighter-rouge">ros2cli</code> extension to enable tracing.</p>

<h3 id="tracetools">tracetools</h3>

<p>Library to support instrumenting ROS packages, including core packages.</p>

<p>This package claims to be in the <strong>Quality Level 1</strong> category, see the <a href="https://github.com/ros2/ros2_tracing/tree/kilted/./tracetools/QUALITY_DECLARATION.md">Quality Declaration</a> for more details.</p>

<p>See the <a href="https://docs.ros.org/en/rolling/p/tracetools/">API documentation</a>.</p>

<h3 id="tracetools_launch">tracetools_launch</h3>

<p>Package containing tools to enable tracing through launch files.</p>

<h3 id="tracetools_read">tracetools_read</h3>

<p>Package containing tools to read traces.</p>

<h3 id="tracetools_test">tracetools_test</h3>

<p>Package containing tools for tracing-related tests.</p>

<h3 id="tracetools_trace">tracetools_trace</h3>

<p>Package containing tools to enable tracing.</p>

<h3 id="test_ros2trace">test_ros2trace</h3>

<p>Package containing system tests for <code class="language-plaintext highlighter-rouge">ros2trace</code>.</p>

<h3 id="test_tracetools">test_tracetools</h3>

<p>Package containing unit and system tests for <code class="language-plaintext highlighter-rouge">tracetools</code>.</p>

<h3 id="test_tracetools_launch">test_tracetools_launch</h3>

<p>Package containing system tests for <code class="language-plaintext highlighter-rouge">tracetools_launch</code>.</p>

<h2 id="analysis">Analysis</h2>

<p>See <a href="https://github.com/ros-tracing/tracetools_analysis"><code class="language-plaintext highlighter-rouge">tracetools_analysis</code></a>.</p>
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:rt-1" role="doc-endnote">
      <p>this setting cannot currently be set through the <a href="https://github.com/ros2/ros2_tracing/tree/kilted/#launch-file-trace-action"><code class="language-plaintext highlighter-rouge">Trace</code> launch file action</a> or the <a href="https://github.com/ros2/ros2_tracing/tree/kilted/#trace-command"><code class="language-plaintext highlighter-rouge">ros2 trace</code> command</a>, see <a href="https://github.com/ros2/ros2_tracing/issues/20">#20</a> <a href="https://github.com/ros2/ros2_tracing/tree/kilted/#fnref:rt-1" class="reversefootnote" role="doc-backlink">↩</a> <a href="https://github.com/ros2/ros2_tracing/tree/kilted/#fnref:rt-1:1" class="reversefootnote" role="doc-backlink">↩<sup>2</sup></a></p>
    </li>
  </ol>
</div>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<p>Any contribution that you make to this repository will
be under the Apache 2 License, as dictated by that
<a href="http://www.apache.org/licenses/LICENSE-2.0.html">license</a>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5. Submission of Contributions. Unless You explicitly state otherwise,
   any Contribution intentionally submitted for inclusion in the Work
   by You to the Licensor shall be under the terms and conditions of
   this License, without any additional terms or conditions.
   Notwithstanding the above, nothing herein shall supersede or modify
   the terms of any separate license agreement you may have executed
   with Licensor regarding such Contributions.
</code></pre></div></div>

<p>Contributors must sign-off each commit by adding a <code class="language-plaintext highlighter-rouge">Signed-off-by: ...</code>
line to commit messages to certify that they have the right to submit
the code they are contributing to the project according to the
<a href="https://developercertificate.org/">Developer Certificate of Origin (DCO)</a>.</p>
</div>
              <hr id="kilted-contribute-lists">
              <ul class="nav nav-tabs nav-justified" id="kilted-contribute-lists-tabs">
                <li class="better-tabs active">
                  <a href="#kilted-contribute-lists-help-wanted" data-toggle="tab"><span class="contribute-lists-help-wanted-count label label-primary">0</span> Help Wanted</a>
                </li>
                <li class="better-tabs">
                  <a href="#kilted-contribute-lists-good-first-issue" data-toggle="tab"><span class="contribute-lists-good-first-issue-count label label-primary">0</span> Good First Issue</a>
                </li>
                <li class="better-tabs">
                  <a href="#kilted-contribute-lists-pull-requests" data-toggle="tab"><span class="contribute-lists-pull-requests-count label label-primary">0</span> Pull Requests to Review</a>
                </li>
              </ul>
              <div class="tab-content contribute-lists">
                <div class="tab-pane active" id="kilted-contribute-lists-help-wanted">
                  <div class="contribute-lists-help-wanted"></div>
                </div>
                <div class="tab-pane" id="kilted-contribute-lists-good-first-issue">
                  <div class="contribute-lists-good-first-issue"></div>
                </div>
                <div class="tab-pane" id="kilted-contribute-lists-pull-requests">
                  <div class="contribute-lists-pull-requests"></div>
                </div>
              </div>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-rolling">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/ros2_tracing">ros2_tracing</a> <small>repository</small></h3>
        <span class="label label-default">tools</span> <span class="label label-default">instrumentation</span> <span class="label label-default">ros</span> <span class="label label-default">tracing</span> <span class="label label-default">performance-analysis</span> <span class="label label-default">ros2</span> <span class="label label-default">ros2-tracing</span> 
        
        <a class="label label-primary pkg-label" href="/p/lttngpy">lttngpy</a>
        
        <a class="label label-primary pkg-label" href="/p/ros2trace">ros2trace</a>
        
        <a class="label label-primary pkg-label" href="/p/test_ros2trace">test_ros2trace</a>
        
        <a class="label label-primary pkg-label" href="/p/test_tracetools">test_tracetools</a>
        
        <a class="label label-primary pkg-label" href="/p/test_tracetools_launch">test_tracetools_launch</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools">tracetools</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_launch">tracetools_launch</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_read">tracetools_read</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_test">tracetools_test</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_trace">tracetools_trace</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-ros2-ros2_tracing
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-ros2-ros2_tracing" role="menuitem" tabindex="-1" href="/r/ros2_tracing/github-ros2-ros2_tracing" data="github-ros2-ros2_tracing">
                    <span class="glyphicon glyphicon-star"></span>
                    github-ros2-ros2_tracing
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">Tracing tools for ROS 2.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/ros2/ros2_tracing.git">https://github.com/ros2/ros2_tracing.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">rolling</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-05-04
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <span class="label label-default">tools</span> <span class="label label-default">instrumentation</span> <span class="label label-default">ros</span> <span class="label label-default">tracing</span> <span class="label label-default">performance-analysis</span> <span class="label label-default">ros2</span> <span class="label label-default">ros2-tracing</span> 
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/ros2_tracing/#rolling-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ros2_tracing/#rolling-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ros2_tracing/#rolling-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/lttngpy">lttngpy</a></td>
                    <td>8.7.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ros2trace">ros2trace</a></td>
                    <td>8.7.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/test_ros2trace">test_ros2trace</a></td>
                    <td>8.7.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/test_tracetools">test_tracetools</a></td>
                    <td>8.7.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/test_tracetools_launch">test_tracetools_launch</a></td>
                    <td>8.7.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools">tracetools</a></td>
                    <td>8.7.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_launch">tracetools_launch</a></td>
                    <td>8.7.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_read">tracetools_read</a></td>
                    <td>8.7.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_test">tracetools_test</a></td>
                    <td>8.7.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_trace">tracetools_trace</a></td>
                    <td>8.7.0</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="ros2_tracing">ros2_tracing</h1>

<p><a href="https://github.com/ros2/ros2_tracing/actions/workflows/test.yml"><img src="https://github.com/ros2/ros2_tracing/actions/workflows/test.yml/badge.svg?branch=rolling" alt="GitHub CI"></a>
<a href="https://codecov.io/gh/ros2/ros2_tracing"><img src="https://codecov.io/gh/ros2/ros2_tracing/branch/rolling/graph/badge.svg" alt="codecov"></a></p>

<p>Tracing tools for ROS 2.</p>

<h2 id="overview">Overview</h2>

<p><code class="language-plaintext highlighter-rouge">ros2_tracing</code> provides <a href="https://github.com/ros2/ros2_tracing/tree/rolling/#tracetools">tracing instrumentation</a> for the core ROS 2 packages.
It also provides <a href="https://github.com/ros2/ros2_tracing/tree/rolling/#tracing">tools to configure tracing</a> through <a href="https://github.com/ros2/ros2_tracing/tree/rolling/#launch-file-trace-action">a launch action</a> and a <a href="https://github.com/ros2/ros2_tracing/tree/rolling/#trace-command"><code class="language-plaintext highlighter-rouge">ros2</code> CLI command</a>.
For more information about tracing, see the <a href="https://github.com/ros2/ros2_tracing/tree/rolling/#what-is-tracing"><em>What is tracing?</em></a> section.</p>

<p><code class="language-plaintext highlighter-rouge">ros2_tracing</code> currently only supports the <a href="https://lttng.org/">LTTng</a> tracer.
Consequently, it currently only supports Linux.</p>

<blockquote>
  <p>[!NOTE]
Make sure to use the right branch, depending on the ROS 2 distro: <a href="https://docs.ros.org/en/rolling/The-ROS2-Project/Contributing/Developer-Guide.html#branches">use <code class="language-plaintext highlighter-rouge">rolling</code> for Rolling, <code class="language-plaintext highlighter-rouge">galactic</code> for Galactic, etc.</a></p>
</blockquote>

<h2 id="publications--presentations">Publications &amp; presentations</h2>

<p><a href="https://arxiv.org/abs/2201.00393">Read the <code class="language-plaintext highlighter-rouge">ros2_tracing</code> paper!</a>
If you use or refer to <code class="language-plaintext highlighter-rouge">ros2_tracing</code>, please cite:</p>
<ul>
  <li>C. Bédard, I. Lütkebohle, and M. Dagenais, <a href="https://arxiv.org/abs/2201.00393">“ros2_tracing: Multipurpose Low-Overhead Framework for Real-Time Tracing of ROS 2,”</a> <em>IEEE Robotics and Automation Letters</em>, vol. 7, no. 3, pp. 6511–6518, 2022.
    <details>
  <summary>BibTeX</summary>

    
</details>
  </li>
</ul>
<div class="language-bibtex highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nc">@article</span><span class="p">{</span><span class="nl">bedard2022ros2tracing</span><span class="p">,</span>
      <span class="na">title</span><span class="p">=</span><span class="s">{ros2\_tracing: Multipurpose Low-Overhead Framework for Real-Time Tracing of ROS 2}</span><span class="p">,</span>
      <span class="na">author</span><span class="p">=</span><span class="s">{B{\'e}dard, Christophe and L{\"u}tkebohle, Ingo and Dagenais, Michel}</span><span class="p">,</span>
      <span class="na">journal</span><span class="p">=</span><span class="s">{IEEE Robotics and Automation Letters}</span><span class="p">,</span>
      <span class="na">year</span><span class="p">=</span><span class="s">{2022}</span><span class="p">,</span>
      <span class="na">volume</span><span class="p">=</span><span class="s">{7}</span><span class="p">,</span>
      <span class="na">number</span><span class="p">=</span><span class="s">{3}</span><span class="p">,</span>
      <span class="na">pages</span><span class="p">=</span><span class="s">{6511--6518}</span><span class="p">,</span>
      <span class="na">doi</span><span class="p">=</span><span class="s">{10.1109/LRA.2022.3174346}</span>
    <span class="p">}</span>
    
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;/details&gt;
</code></pre></div></div>

<p>This other paper leverages <code class="language-plaintext highlighter-rouge">ros2_tracing</code> to analyze and visualize the flow of messages across distributed ROS 2 systems:</p>
<ul>
  <li>C. Bédard, P.-Y. Lajoie, G. Beltrame, and M. Dagenais, <a href="https://arxiv.org/abs/2204.10208">“Message Flow Analysis with Complex Causal Links for Distributed ROS 2 Systems,”</a> <em>Robotics and Autonomous Systems</em>, vol. 161, p. 104361, 2023.
    <details>
  <summary>BibTeX</summary>

    
</details>
  </li>
</ul>
<div class="language-bibtex highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nc">@article</span><span class="p">{</span><span class="nl">bedard2023messageflow</span><span class="p">,</span>
      <span class="na">title</span><span class="p">=</span><span class="s">{Message flow analysis with complex causal links for distributed {ROS} 2 systems}</span><span class="p">,</span>
      <span class="na">author</span><span class="p">=</span><span class="s">{B{\'e}dard, Christophe and Lajoie, Pierre-Yves and Beltrame, Giovanni and Dagenais, Michel}</span><span class="p">,</span>
      <span class="na">journal</span><span class="p">=</span><span class="s">{Robotics and Autonomous Systems}</span><span class="p">,</span>
      <span class="na">year</span><span class="p">=</span><span class="s">{2023}</span><span class="p">,</span>
      <span class="na">volume</span><span class="p">=</span><span class="s">{161}</span><span class="p">,</span>
      <span class="na">pages</span><span class="p">=</span><span class="s">{104361}</span><span class="p">,</span>
      <span class="na">doi</span><span class="p">=</span><span class="s">{10.1016/j.robot.2022.104361}</span>
    <span class="p">}</span>
    
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;/details&gt;
</code></pre></div></div>

<p>Finally, check out the following presentations:</p>

<ul>
  <li>ROSCon 2023: “Improving Your Application’s Algorithms and Optimizing Performance Using Trace Data” (<a href="https://vimeo.com/879001159">video</a>, <a href="https://roscon.ros.org/2023/talks/Improving_Your_Applications_Algorithms_and_Optimizing_Performance_Using_Trace_Data.pdf">slides</a>)</li>
  <li>ROS World 2021: “Tracing ROS 2 with ros2_tracing” (<a href="https://vimeo.com/652633418">video</a>, <a href="https://github.com/ros2/ros2_tracing/blob/rolling/doc/2021-10-20_ROS_World_2021_-_Tracing_ROS_2_with_ros2_tracing.pdf">slides</a>)</li>
</ul>

<h2 id="tutorials--demos">Tutorials &amp; demos</h2>

<ul>
  <li>ROS 2 documentation:
    <ul>
      <li><a href="https://docs.ros.org/en/rolling/How-To-Guides/Building-ROS-2-with-Tracing.html">Building ROS 2 with tracing</a></li>
      <li><a href="https://docs.ros.org/en/rolling/Tutorials/Advanced/ROS2-Tracing-Trace-and-Analyze.html">How to use <code class="language-plaintext highlighter-rouge">ros2_tracing</code> to trace and analyze an application</a></li>
    </ul>
  </li>
  <li>ROS World 2021 demo: <a href="https://github.com/christophebedard/ros-world-2021-demo">github.com/christophebedard/ros-world-2021-demo</a>
</li>
</ul>

<h2 id="building">Building</h2>

<p>Starting from ROS 2 Iron Irwini, the LTTng tracer is a ROS 2 dependency.
Therefore, ROS 2 can be traced out-of-the-box on Linux; this package does not need to be re-built.
The following <code class="language-plaintext highlighter-rouge">rmw</code> implementations are supported:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">rmw_connextdds</code></li>
  <li><code class="language-plaintext highlighter-rouge">rmw_cyclonedds_cpp</code></li>
  <li><code class="language-plaintext highlighter-rouge">rmw_fastrtps_cpp</code></li>
  <li><code class="language-plaintext highlighter-rouge">rmw_fastrtps_dynamic_cpp</code></li>
  <li><code class="language-plaintext highlighter-rouge">rmw_zenoh_cpp</code></li>
</ul>

<p>To make sure that the instrumentation and tracepoints are available:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ source /opt/ros/rolling/setup.bash  # With a binary install
$ source ./install/setup.bash  # When building from source
$ ros2 run tracetools status
Tracing enabled

</code></pre></div></div>

<p>A ROS 2 installation only includes the LTTng userspace tracer (LTTng-UST), which is all that is needed to trace ROS 2.
To trace the Linux kernel, the <a href="https://lttng.org/docs/v2.13/#doc-tracing-the-linux-kernel">LTTng kernel tracer</a> must be installed separately:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo apt-get update
$ sudo apt-get install lttng-modules-dkms

</code></pre></div></div>

<p>For more information about LTTng, <a href="https://lttng.org/docs/v2.13/">refer to its documentation</a>.</p>

<h3 id="removing-the-instrumentation">Removing the instrumentation</h3>

<p>To build and remove all instrumentation, use <code class="language-plaintext highlighter-rouge">TRACETOOLS_DISABLED</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ colcon build --cmake-args -DTRACETOOLS_DISABLED=ON

</code></pre></div></div>

<p>This will remove all instrumentation from the core ROS 2 packages, and thus they will not depend on or link against the shared library provided by the <a href="https://github.com/ros2/ros2_tracing/tree/rolling/#tracetools"><code class="language-plaintext highlighter-rouge">tracetools</code> package</a>.
This also means that LTTng is not required at build-time or at runtime.</p>

<h3 id="excluding-tracepoints">Excluding tracepoints</h3>

<p>Alternatively, to only exclude the actual tracepoints, use <code class="language-plaintext highlighter-rouge">TRACETOOLS_TRACEPOINTS_EXCLUDED</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ colcon build --packages-select tracetools --cmake-clean-cache --cmake-args -DTRACETOOLS_TRACEPOINTS_EXCLUDED=ON

</code></pre></div></div>

<p>This will keep the instrumentation but remove all tracepoints.
This also means that LTTng is not required at build-time or at runtime.
This option can be useful, since tracepoints can be added back in or removed by simply replacing/re-building the shared library provided by the <a href="https://github.com/ros2/ros2_tracing/tree/rolling/#tracetools"><code class="language-plaintext highlighter-rouge">tracetools</code> package</a>.</p>

<h2 id="what-is-tracing">What is tracing?</h2>

<p>Software <em>tracing</em> is a method of collecting low-level runtime data to understand a system’s execution.
This is achieved by <em>instrumenting</em> the code using <em>tracepoints</em>, for example in ROS 2, the Linux kernel, or any other application.
When a tracepoint is executed, it generates information that is collected by a <em>tracer</em> into a <em>trace</em>.
Tracers are usually low-overhead to avoid affecting the execution.
Traces can then be analyzed to help understand the execution, fix bugs, improve performance, etc.
While <em>logs</em> are typically high-level enough for a user to read and understand, trace data is low-level &amp; high-rate and therefore usually needs to be processed to be useful.</p>

<p>For more information, see the following introductions on tracing:</p>

<ul>
  <li><a href="https://lttng.org/docs/v2.13/#doc-what-is-tracing">LTTng tracer documentation</a></li>
  <li><a href="https://github.com/tuxology/tracevizlab/tree/master/labs/001-what-is-tracing#what-is-tracing">Tracing tutorial</a></li>
  <li><a href="https://archive.eclipse.org/tracecompass/doc/stable/org.eclipse.tracecompass.doc.user/Overview.html#About_Tracing">Eclipse Trace Compass (trace analysis tool) documentation</a></li>
</ul>

<h2 id="tracing">Tracing</h2>

<p>By default, trace data will not be generated, and thus these packages will have virtually no impact on execution.
LTTng has to be configured for tracing.
The packages in this repo provide two options: a <a href="https://github.com/ros2/ros2_tracing/tree/rolling/#trace-command">command</a> and a <a href="https://github.com/ros2/ros2_tracing/tree/rolling/#launch-file-trace-action">launch file action</a>.</p>

<blockquote>
  <p>[!NOTE]
Tracing must be started before the application is launched.
Metadata is recorded during the initialization phase of the application.
This metadata is needed to understand the rest of the trace data, so if tracing is started after the application started executing, then the trace data might be unusable.
For more information, refer to the <a href="https://github.com/ros2/ros2_tracing/tree/rolling/./doc/design_ros_2.md#general-guidelines">design document</a>.
The <a href="https://github.com/ros2/ros2_tracing/tree/rolling/#launch-file-trace-action">launch file action</a> is designed to automatically start tracing before the application launches.</p>
</blockquote>

<p>The tracing directory can be configured using command/launch action parameters, or through environment variables with the following logic:</p>

<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">$ROS_TRACE_DIR</code> if <code class="language-plaintext highlighter-rouge">ROS_TRACE_DIR</code> is set and not empty.</li>
  <li>Otherwise, use <code class="language-plaintext highlighter-rouge">$ROS_HOME/tracing</code>, using <code class="language-plaintext highlighter-rouge">~/.ros</code> for <code class="language-plaintext highlighter-rouge">ROS_HOME</code> if not set or if empty.</li>
</ul>

<p>Additionally, <strong>if you’re using kernel tracing with a non-root user, make sure that the <a href="https://lttng.org/docs/v2.13/#doc-tracing-group"><code class="language-plaintext highlighter-rouge">tracing</code> group exists and that your user is added to it</a></strong>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Create group if it doesn't exist
$ sudo groupadd -r tracing
# Add user to the group
$ sudo usermod -aG tracing $USER

</code></pre></div></div>

<h3 id="trace-command">Trace command</h3>

<p>The first option is to use the <code class="language-plaintext highlighter-rouge">ros2 trace</code> command.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 trace

</code></pre></div></div>

<p>By default, it will enable all ROS 2 tracepoints.
The trace will be written to <code class="language-plaintext highlighter-rouge">~/.ros/tracing/session-YYYYMMDDHHMMSS</code>.
Run the command with <code class="language-plaintext highlighter-rouge">-h</code> for more information.</p>

<p>The <code class="language-plaintext highlighter-rouge">ros2 trace</code> command requires user interaction to start and then stop tracing.
To trace without user interaction (e.g., in scripts), or for finer-grained tracing control, the following sub-commands can be used:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 trace start session_name   # Configure tracing session and start tracing
$ ros2 trace pause session_name   # Pause tracing after starting
$ ros2 trace resume session_name  # Resume tracing after pausing
$ ros2 trace stop session_name    # Stop tracing after starting or resuming

</code></pre></div></div>

<p>Run each command with <code class="language-plaintext highlighter-rouge">-h</code> for more information.</p>

<p>You must <a href="https://github.com/ros2/ros2_tracing/tree/rolling/#building">install the kernel tracer</a> if you want to enable <a href="https://lttng.org/docs/v2.13/#doc-tracing-the-linux-kernel">kernel</a> events (using the <code class="language-plaintext highlighter-rouge">-k</code>/<code class="language-plaintext highlighter-rouge">--kernel-events</code> option) or syscalls (using the <code class="language-plaintext highlighter-rouge">--syscalls</code> option).
If you have installed the kernel tracer, use kernel tracing, and still encounter an error here, make sure to <a href="https://github.com/ros2/ros2_tracing/tree/rolling/#tracing">add your user to the <code class="language-plaintext highlighter-rouge">tracing</code> group</a>.</p>

<h3 id="launch-file-trace-action">Launch file trace action</h3>

<p>Another option is to use the <code class="language-plaintext highlighter-rouge">Trace</code> action in a Python, XML, or YAML launch file along with your <code class="language-plaintext highlighter-rouge">Node</code> action(s).
This way, tracing automatically starts when launching the launch file and ends when it exits or when terminated.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 launch tracetools_launch example.launch.py

</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">Trace</code> action will also set the <code class="language-plaintext highlighter-rouge">LD_PRELOAD</code> environment to preload <a href="https://lttng.org/docs/v2.13/#doc-prebuilt-ust-helpers">LTTng’s userspace tracing helper(s)</a> if the corresponding event(s) are enabled.
For more information, see <a href="https://github.com/ros2/ros2_tracing/tree/rolling/./tracetools_launch/launch/example.launch.py">this example launch file</a> and the <a href="https://github.com/ros2/ros2_tracing/tree/rolling/./tracetools_launch/tracetools_launch/action.py"><code class="language-plaintext highlighter-rouge">Trace</code> action</a>.</p>

<p>You must <a href="https://github.com/ros2/ros2_tracing/tree/rolling/#building">install the kernel tracer</a> if you want to enable <a href="https://lttng.org/docs/v2.13/#doc-tracing-the-linux-kernel">kernel</a> events (<code class="language-plaintext highlighter-rouge">events_kernel</code> in Python, <code class="language-plaintext highlighter-rouge">events-kernel</code> in XML or YAML) or syscalls (<code class="language-plaintext highlighter-rouge">syscalls</code> in Python, XML, or YAML).
If you have installed the kernel tracer, use kernel tracing, and still encounter an error here, make sure to <a href="https://github.com/ros2/ros2_tracing/tree/rolling/#tracing">add your user to the <code class="language-plaintext highlighter-rouge">tracing</code> group</a>.</p>

<h2 id="design">Design</h2>

<p>See the <a href="https://github.com/ros2/ros2_tracing/tree/rolling/./doc/design_ros_2.md">design document</a>.</p>

<h2 id="real-time">Real-time</h2>

<p>LTTng-UST, the current default userspace tracer used for <a href="https://github.com/ros2/ros2_tracing/tree/rolling/#overview">tracing ROS 2</a>, was designed for real-time production applications.
It is a low-overhead tracer with many important real-time compatible features:</p>

<ul>
  <li>userspace tracer completely implemented in userspace, independent from the kernel</li>
  <li>reentrant, thread-safe, signal-safe, non-blocking</li>
  <li>no system calls in the fast path</li>
  <li>no copies of the trace data</li>
</ul>

<p>However, some settings need to be tuned for it to be fully real-time safe and for performance to be optimal for your use-case:</p>

<ul>
  <li>timers<sup id="fnref:rt-1" role="doc-noteref"><a href="https://github.com/ros2/ros2_tracing/tree/rolling/#fn:rt-1" class="footnote" rel="footnote">1</a></sup>: use <a href="https://lttng.org/docs/v2.13/#doc-channel-read-timer">read timer</a> to avoid a write(2) call</li>
  <li>sub-buffer<sup id="fnref:rt-1:1" role="doc-noteref"><a href="https://github.com/ros2/ros2_tracing/tree/rolling/#fn:rt-1" class="footnote" rel="footnote">1</a></sup> count and size:
    <ul>
      <li>see <a href="https://lttng.org/docs/v2.13/#doc-channel-subbuf-size-vs-subbuf-count">documentation</a> for sub-buffer count and size tuning tips based on your use-case</li>
      <li>minimize sub-buffer count to minimize sub-buffer switching overhead</li>
    </ul>
  </li>
  <li>one-time memory allocation/lock/syscall per thread:
    <ul>
      <li>usually done the first time a tracepoint is executed within a thread for URCU thread registration, but registration can be manually performed to force it to be done during your application’s initialization</li>
      <li>see <a href="https://lists.lttng.org/pipermail/lttng-dev/2019-November/029409.html">this LTTng mailing list message</a>
</li>
    </ul>
  </li>
</ul>

<p>For further reading:</p>

<ul>
  <li><a href="https://lttng.org/docs/v2.13/">LTTng documentation</a></li>
  <li>
<a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.641.1965&amp;rep=rep1&amp;type=pdf#page=87">Combined Tracing of the Kernel and Applications with LTTng</a>: LTTng-UST architecture and design goals (section 3)</li>
  <li>
<a href="https://dl.acm.org/doi/abs/10.1145/3158644">Survey and Analysis of Kernel and Userspace Tracers on Linux: Design, Implementation, and Overhead</a>: LTTng-UST overhead and design compared to other kernel and userspace tracers (table 6: average latency overhead per tracepoint of 158 ns)</li>
</ul>

<p>The LTTng kernel tracer has a similar implementation, but is separate from the userspace tracer.</p>

<h2 id="packages">Packages</h2>

<h3 id="lttngpy">lttngpy</h3>

<p>Package containing <code class="language-plaintext highlighter-rouge">liblttng-ctl</code> Python bindings.</p>

<h3 id="ros2trace">ros2trace</h3>

<p>Package containing a <code class="language-plaintext highlighter-rouge">ros2cli</code> extension to enable tracing.</p>

<h3 id="tracetools">tracetools</h3>

<p>Library to support instrumenting ROS packages, including core packages.</p>

<p>This package claims to be in the <strong>Quality Level 1</strong> category, see the <a href="https://github.com/ros2/ros2_tracing/tree/rolling/./tracetools/QUALITY_DECLARATION.md">Quality Declaration</a> for more details.</p>

<p>See the <a href="https://docs.ros.org/en/rolling/p/tracetools/">API documentation</a>.</p>

<h3 id="tracetools_launch">tracetools_launch</h3>

<p>Package containing tools to enable tracing through launch files.</p>

<h3 id="tracetools_read">tracetools_read</h3>

<p>Package containing tools to read traces.</p>

<h3 id="tracetools_test">tracetools_test</h3>

<p>Package containing tools for tracing-related tests.</p>

<h3 id="tracetools_trace">tracetools_trace</h3>

<p>Package containing tools to enable tracing.</p>

<h3 id="test_ros2trace">test_ros2trace</h3>

<p>Package containing system tests for <code class="language-plaintext highlighter-rouge">ros2trace</code>.</p>

<h3 id="test_tracetools">test_tracetools</h3>

<p>Package containing unit and system tests for <code class="language-plaintext highlighter-rouge">tracetools</code>.</p>

<h3 id="test_tracetools_launch">test_tracetools_launch</h3>

<p>Package containing system tests for <code class="language-plaintext highlighter-rouge">tracetools_launch</code>.</p>

<h2 id="analysis">Analysis</h2>

<p>See <a href="https://github.com/ros-tracing/tracetools_analysis"><code class="language-plaintext highlighter-rouge">tracetools_analysis</code></a>.</p>
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:rt-1" role="doc-endnote">
      <p>this setting cannot currently be set through the <a href="https://github.com/ros2/ros2_tracing/tree/rolling/#launch-file-trace-action"><code class="language-plaintext highlighter-rouge">Trace</code> launch file action</a> or the <a href="https://github.com/ros2/ros2_tracing/tree/rolling/#trace-command"><code class="language-plaintext highlighter-rouge">ros2 trace</code> command</a>, see <a href="https://github.com/ros2/ros2_tracing/issues/20">#20</a> <a href="https://github.com/ros2/ros2_tracing/tree/rolling/#fnref:rt-1" class="reversefootnote" role="doc-backlink">↩</a> <a href="https://github.com/ros2/ros2_tracing/tree/rolling/#fnref:rt-1:1" class="reversefootnote" role="doc-backlink">↩<sup>2</sup></a></p>
    </li>
  </ol>
</div>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<p>Any contribution that you make to this repository will
be under the Apache 2 License, as dictated by that
<a href="http://www.apache.org/licenses/LICENSE-2.0.html">license</a>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5. Submission of Contributions. Unless You explicitly state otherwise,
   any Contribution intentionally submitted for inclusion in the Work
   by You to the Licensor shall be under the terms and conditions of
   this License, without any additional terms or conditions.
   Notwithstanding the above, nothing herein shall supersede or modify
   the terms of any separate license agreement you may have executed
   with Licensor regarding such Contributions.
</code></pre></div></div>

<p>Contributors must sign-off each commit by adding a <code class="language-plaintext highlighter-rouge">Signed-off-by: ...</code>
line to commit messages to certify that they have the right to submit
the code they are contributing to the project according to the
<a href="https://developercertificate.org/">Developer Certificate of Origin (DCO)</a>.</p>
</div>
              <hr id="rolling-contribute-lists">
              <ul class="nav nav-tabs nav-justified" id="rolling-contribute-lists-tabs">
                <li class="better-tabs active">
                  <a href="#rolling-contribute-lists-help-wanted" data-toggle="tab"><span class="contribute-lists-help-wanted-count label label-primary">0</span> Help Wanted</a>
                </li>
                <li class="better-tabs">
                  <a href="#rolling-contribute-lists-good-first-issue" data-toggle="tab"><span class="contribute-lists-good-first-issue-count label label-primary">0</span> Good First Issue</a>
                </li>
                <li class="better-tabs">
                  <a href="#rolling-contribute-lists-pull-requests" data-toggle="tab"><span class="contribute-lists-pull-requests-count label label-primary">0</span> Pull Requests to Review</a>
                </li>
              </ul>
              <div class="tab-content contribute-lists">
                <div class="tab-pane active" id="rolling-contribute-lists-help-wanted">
                  <div class="contribute-lists-help-wanted"></div>
                </div>
                <div class="tab-pane" id="rolling-contribute-lists-good-first-issue">
                  <div class="contribute-lists-good-first-issue"></div>
                </div>
                <div class="tab-pane" id="rolling-contribute-lists-pull-requests">
                  <div class="contribute-lists-pull-requests"></div>
                </div>
              </div>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-github">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/ros2_tracing">ros2_tracing</a> <small>repository</small></h3>
        <span class="label label-default">tools</span> <span class="label label-default">instrumentation</span> <span class="label label-default">ros</span> <span class="label label-default">tracing</span> <span class="label label-default">performance-analysis</span> <span class="label label-default">ros2</span> <span class="label label-default">ros2-tracing</span> 
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-ros2-ros2_tracing
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-ros2-ros2_tracing" role="menuitem" tabindex="-1" href="/r/ros2_tracing/github-ros2-ros2_tracing" data="github-ros2-ros2_tracing">
                    <span class="glyphicon glyphicon-star"></span>
                    github-ros2-ros2_tracing
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>github</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-noetic">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/ros2_tracing">ros2_tracing</a> <small>repository</small></h3>
        <span class="label label-default">tools</span> <span class="label label-default">instrumentation</span> <span class="label label-default">ros</span> <span class="label label-default">tracing</span> <span class="label label-default">performance-analysis</span> <span class="label label-default">ros2</span> <span class="label label-default">ros2-tracing</span> 
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-ros2-ros2_tracing
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-ros2-ros2_tracing" role="menuitem" tabindex="-1" href="/r/ros2_tracing/github-ros2-ros2_tracing" data="github-ros2-ros2_tracing">
                    <span class="glyphicon glyphicon-star"></span>
                    github-ros2-ros2_tracing
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>noetic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-galactic">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/ros2_tracing">ros2_tracing</a> <small>repository</small></h3>
        <span class="label label-default">tools</span> <span class="label label-default">instrumentation</span> <span class="label label-default">ros</span> <span class="label label-default">tracing</span> <span class="label label-default">performance-analysis</span> <span class="label label-default">ros2</span> <span class="label label-default">ros2-tracing</span> 
        
        <a class="label label-primary pkg-label" href="/p/ros2trace">ros2trace</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools">tracetools</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_launch">tracetools_launch</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_read">tracetools_read</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_test">tracetools_test</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_trace">tracetools_trace</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-ros2-ros2_tracing
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-ros2-ros2_tracing" role="menuitem" tabindex="-1" href="/r/ros2_tracing/github-ros2-ros2_tracing" data="github-ros2-ros2_tracing">
                    <span class="glyphicon glyphicon-star"></span>
                    github-ros2-ros2_tracing
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">Tracing tools for ROS 2.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/ros2/ros2_tracing.git">https://github.com/ros2/ros2_tracing.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">galactic</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2021-05-06
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <span class="label label-default">tools</span> <span class="label label-default">instrumentation</span> <span class="label label-default">ros</span> <span class="label label-default">tracing</span> <span class="label label-default">performance-analysis</span> <span class="label label-default">ros2</span> <span class="label label-default">ros2-tracing</span> 
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/ros2_tracing/#galactic-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ros2_tracing/#galactic-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ros2_tracing/#galactic-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/ros2trace">ros2trace</a></td>
                    <td>2.3.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools">tracetools</a></td>
                    <td>2.3.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_launch">tracetools_launch</a></td>
                    <td>2.3.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_read">tracetools_read</a></td>
                    <td>2.3.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_test">tracetools_test</a></td>
                    <td>2.3.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_trace">tracetools_trace</a></td>
                    <td>2.3.0</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="ros2_tracing">ros2_tracing</h1>

<p><a href="https://gitlab.com/ros-tracing/ros2_tracing/commits/master"><img src="https://gitlab.com/ros-tracing/ros2_tracing/badges/master/pipeline.svg" alt="pipeline status"></a>
<a href="https://codecov.io/gl/ros-tracing/ros2_tracing"><img src="https://codecov.io/gl/ros-tracing/ros2_tracing/branch/master/graph/badge.svg" alt="codecov"></a></p>

<p>Tracing tools for ROS 2.</p>

<h2 id="building">Building</h2>

<p>As of Foxy, these instructions also apply to an installation from the Debian packages; it will not work out-of-the-box. Also, note that tracing using <code class="language-plaintext highlighter-rouge">ros2_tracing</code> is not supported on non-Linux systems.</p>

<p>If LTTng is not found during build, or if the <a href="https://github.com/ros2/ros2_tracing/tree/galactic/#disabling-tracing"><code class="language-plaintext highlighter-rouge">TRACETOOLS_DISABLED</code> option is enabled</a>, then this package will not do anything.</p>

<p>To enable tracing:</p>

<ol>
  <li>Install <a href="https://lttng.org/docs/v2.11/">LTTng</a> (<code class="language-plaintext highlighter-rouge">&gt;=2.11.1</code>) with the Python bindings to control tracing and read traces:</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    $ sudo apt-get update
    $ sudo apt-get install lttng-tools lttng-modules-dkms liblttng-ust-dev
    $ sudo apt-get install python3-babeltrace python3-lttng
    
</code></pre></div></div>
<ol>
  <li>Build (at least up to <code class="language-plaintext highlighter-rouge">rcl</code> &amp; <code class="language-plaintext highlighter-rouge">rclcpp</code>):</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    $ colcon build
    
</code></pre></div></div>
<ol>
  <li>Source and check that tracing is enabled:</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    $ source ./install/local_setup.bash
    $ ros2 run tracetools status
    
</code></pre></div></div>

<h3 id="disabling-tracing">Disabling tracing</h3>

<p>Alternatively, to build and disable tracing, use <code class="language-plaintext highlighter-rouge">TRACETOOLS_DISABLED</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ colcon build --cmake-args " -DTRACETOOLS_DISABLED=ON"

</code></pre></div></div>

<h2 id="tracing">Tracing</h2>

<p>The steps above will not lead to trace data being generated, and thus they will have no impact on execution. LTTng has to be configured for tracing. The packages in this repo provide two options: a <a href="https://github.com/ros2/ros2_tracing/tree/galactic/#Trace-command">command</a> and a <a href="https://github.com/ros2/ros2_tracing/tree/galactic/#Launch-file-trace-action">launch file action</a>.</p>

<p>The tracing directory can be configured using command/launch action parameters, or through environment variables with the following logic:</p>

<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">$ROS_TRACE_DIR</code> if <code class="language-plaintext highlighter-rouge">ROS_TRACE_DIR</code> is set and not empty.</li>
  <li>Otherwise, use <code class="language-plaintext highlighter-rouge">$ROS_HOME/tracing</code>, using <code class="language-plaintext highlighter-rouge">~/.ros</code> for <code class="language-plaintext highlighter-rouge">ROS_HOME</code> if not set or if empty.</li>
</ul>

<h3 id="trace-command">Trace command</h3>

<p>The first option is to use the <code class="language-plaintext highlighter-rouge">ros2 trace</code> command.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 trace

</code></pre></div></div>

<p>By default, it will enable all ROS tracepoints and a few kernel tracepoints. The trace will be written to <code class="language-plaintext highlighter-rouge">~/.ros/tracing/session-YYYYMMDDHHMMSS</code>. Run the command with <code class="language-plaintext highlighter-rouge">-h</code> for more information.</p>

<h3 id="launch-file-trace-action">Launch file trace action</h3>

<p>Another option is to use the <code class="language-plaintext highlighter-rouge">Trace</code> action in a launch file along with your <code class="language-plaintext highlighter-rouge">Node</code> action(s). This way, tracing happens when launching the launch file.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 launch tracetools_launch example.launch.py

</code></pre></div></div>

<p>See <a href="https://github.com/ros2/ros2_tracing/tree/galactic/./tracetools_launch/launch/example.launch.py">this example launch file</a> and the <a href="https://github.com/ros2/ros2_tracing/tree/galactic/./tracetools_launch/tracetools_launch/action.py"><code class="language-plaintext highlighter-rouge">Trace</code> action</a> for more information.</p>

<h2 id="design">Design</h2>

<p>See the <a href="https://github.com/ros2/ros2_tracing/tree/galactic/./doc/design_ros_2.md">design document</a>.</p>

<h2 id="packages">Packages</h2>

<h3 id="ros2trace">ros2trace</h3>

<p>Package containing a <code class="language-plaintext highlighter-rouge">ros2cli</code> extension to enable tracing.</p>

<h3 id="tracetools">tracetools</h3>

<p>Library to support instrumenting ROS packages, including core packages.</p>

<p>This package claims to be in the <strong>Quality Level 1</strong> category, see the <a href="https://github.com/ros2/ros2_tracing/tree/galactic/./tracetools/QUALITY_DECLARATION.md">Quality Declaration</a> for more details.</p>

<p>See the <a href="https://ros-tracing.gitlab.io/ros2_tracing-api/">API documentation</a>.</p>

<h3 id="tracetools_launch">tracetools_launch</h3>

<p>Package containing tools to enable tracing through launch files.</p>

<h3 id="tracetools_read">tracetools_read</h3>

<p>Package containing tools to read traces.</p>

<h3 id="tracetools_test">tracetools_test</h3>

<p>Package containing system tests for <code class="language-plaintext highlighter-rouge">tracetools</code> and the tools to support them.</p>

<h3 id="tracetools_trace">tracetools_trace</h3>

<p>Package containing tools to enable tracing.</p>

<h2 id="analysis">Analysis</h2>

<p>See <a href="https://gitlab.com/ros-tracing/tracetools_analysis"><code class="language-plaintext highlighter-rouge">tracetools_analysis</code></a>.</p>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<p>Any contribution that you make to this repository will
be under the Apache 2 License, as dictated by that
<a href="http://www.apache.org/licenses/LICENSE-2.0.html">license</a>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5. Submission of Contributions. Unless You explicitly state otherwise,
   any Contribution intentionally submitted for inclusion in the Work
   by You to the Licensor shall be under the terms and conditions of
   this License, without any additional terms or conditions.
   Notwithstanding the above, nothing herein shall supersede or modify
   the terms of any separate license agreement you may have executed
   with Licensor regarding such Contributions.
</code></pre></div></div>

<p>Contributors must sign-off each commit by adding a <code class="language-plaintext highlighter-rouge">Signed-off-by: ...</code>
line to commit messages to certify that they have the right to submit
the code they are contributing to the project according to the
<a href="https://developercertificate.org/">Developer Certificate of Origin (DCO)</a>.</p>
</div>
              <hr id="galactic-contribute-lists">
              <ul class="nav nav-tabs nav-justified" id="galactic-contribute-lists-tabs">
                <li class="better-tabs active">
                  <a href="#galactic-contribute-lists-help-wanted" data-toggle="tab"><span class="contribute-lists-help-wanted-count label label-primary">0</span> Help Wanted</a>
                </li>
                <li class="better-tabs">
                  <a href="#galactic-contribute-lists-good-first-issue" data-toggle="tab"><span class="contribute-lists-good-first-issue-count label label-primary">0</span> Good First Issue</a>
                </li>
                <li class="better-tabs">
                  <a href="#galactic-contribute-lists-pull-requests" data-toggle="tab"><span class="contribute-lists-pull-requests-count label label-primary">0</span> Pull Requests to Review</a>
                </li>
              </ul>
              <div class="tab-content contribute-lists">
                <div class="tab-pane active" id="galactic-contribute-lists-help-wanted">
                  <div class="contribute-lists-help-wanted"></div>
                </div>
                <div class="tab-pane" id="galactic-contribute-lists-good-first-issue">
                  <div class="contribute-lists-good-first-issue"></div>
                </div>
                <div class="tab-pane" id="galactic-contribute-lists-pull-requests">
                  <div class="contribute-lists-pull-requests"></div>
                </div>
              </div>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-iron">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/ros2_tracing">ros2_tracing</a> <small>repository</small></h3>
        <span class="label label-default">tools</span> <span class="label label-default">instrumentation</span> <span class="label label-default">ros</span> <span class="label label-default">tracing</span> <span class="label label-default">performance-analysis</span> <span class="label label-default">ros2</span> <span class="label label-default">ros2-tracing</span> 
        
        <a class="label label-primary pkg-label" href="/p/ros2trace">ros2trace</a>
        
        <a class="label label-primary pkg-label" href="/p/test_ros2trace">test_ros2trace</a>
        
        <a class="label label-primary pkg-label" href="/p/test_tracetools">test_tracetools</a>
        
        <a class="label label-primary pkg-label" href="/p/test_tracetools_launch">test_tracetools_launch</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools">tracetools</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_launch">tracetools_launch</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_read">tracetools_read</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_test">tracetools_test</a>
        
        <a class="label label-primary pkg-label" href="/p/tracetools_trace">tracetools_trace</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-ros2-ros2_tracing
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-ros2-ros2_tracing" role="menuitem" tabindex="-1" href="/r/ros2_tracing/github-ros2-ros2_tracing" data="github-ros2-ros2_tracing">
                    <span class="glyphicon glyphicon-star"></span>
                    github-ros2-ros2_tracing
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">Tracing tools for ROS 2.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/ros2/ros2_tracing.git">https://github.com/ros2/ros2_tracing.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">iron</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2024-11-08
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <span class="label label-default">tools</span> <span class="label label-default">instrumentation</span> <span class="label label-default">ros</span> <span class="label label-default">tracing</span> <span class="label label-default">performance-analysis</span> <span class="label label-default">ros2</span> <span class="label label-default">ros2-tracing</span> 
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/ros2_tracing/#iron-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ros2_tracing/#iron-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ros2_tracing/#iron-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/ros2trace">ros2trace</a></td>
                    <td>6.3.3</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/test_ros2trace">test_ros2trace</a></td>
                    <td>6.3.3</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/test_tracetools">test_tracetools</a></td>
                    <td>6.3.3</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/test_tracetools_launch">test_tracetools_launch</a></td>
                    <td>6.3.3</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools">tracetools</a></td>
                    <td>6.3.3</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_launch">tracetools_launch</a></td>
                    <td>6.3.3</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_read">tracetools_read</a></td>
                    <td>6.3.3</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_test">tracetools_test</a></td>
                    <td>6.3.3</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/tracetools_trace">tracetools_trace</a></td>
                    <td>6.3.3</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="ros2_tracing">ros2_tracing</h1>

<p><a href="https://github.com/ros2/ros2_tracing/actions/workflows/test.yml"><img src="https://github.com/ros2/ros2_tracing/actions/workflows/test.yml/badge.svg?branch=rolling" alt="GitHub CI"></a>
<a href="https://codecov.io/gh/ros2/ros2_tracing"><img src="https://codecov.io/gh/ros2/ros2_tracing/branch/rolling/graph/badge.svg" alt="codecov"></a></p>

<p>Tracing tools for ROS 2.</p>

<h2 id="overview">Overview</h2>

<p><code class="language-plaintext highlighter-rouge">ros2_tracing</code> provides <a href="https://github.com/ros2/ros2_tracing/tree/iron/#tracetools">tracing instrumentation</a> for the core ROS 2 packages.
It also provides <a href="https://github.com/ros2/ros2_tracing/tree/iron/#tracing">tools to configure tracing</a> through <a href="https://github.com/ros2/ros2_tracing/tree/iron/#launch-file-trace-action">a launch action</a> and a <a href="https://github.com/ros2/ros2_tracing/tree/iron/#trace-command"><code class="language-plaintext highlighter-rouge">ros2</code> CLI command</a>.</p>

<p><code class="language-plaintext highlighter-rouge">ros2_tracing</code> currently only supports the <a href="https://lttng.org/">LTTng</a> tracer.
Consequently, it currently only supports Linux.</p>

<p><strong>Note</strong>: make sure to use the right branch, depending on the ROS 2 distro: <a href="https://docs.ros.org/en/rolling/The-ROS2-Project/Contributing/Developer-Guide.html#branches">use <code class="language-plaintext highlighter-rouge">rolling</code> for Rolling, <code class="language-plaintext highlighter-rouge">galactic</code> for Galactic, etc.</a></p>

<h2 id="publications--presentations">Publications &amp; presentations</h2>

<p><a href="https://arxiv.org/abs/2201.00393">Read the <code class="language-plaintext highlighter-rouge">ros2_tracing</code> paper!</a>
If you use or refer to <code class="language-plaintext highlighter-rouge">ros2_tracing</code>, please cite:</p>
<ul>
  <li>C. Bédard, I. Lütkebohle, and M. Dagenais, “ros2_tracing: Multipurpose Low-Overhead Framework for Real-Time Tracing of ROS 2,” <em>IEEE Robotics and Automation Letters</em>, vol. 7, no. 3, pp. 6511–6518, 2022.</li>
</ul>

<details>
<summary>BibTeX</summary>


```bibtex
@article{bedard2022ros2tracing,
  title={ros2\_tracing: Multipurpose Low-Overhead Framework for Real-Time Tracing of ROS 2},
  author={B{\'e}dard, Christophe and L{\"u}tkebohle, Ingo and Dagenais, Michel},
  journal={IEEE Robotics and Automation Letters},
  year={2022},
  volume={7},
  number={3},
  pages={6511--6518},
  doi={10.1109/LRA.2022.3174346}
}

```
</details>

<p>Also, check out the ROS World 2021 presentation titled “Tracing ROS 2 with ros2_tracing” (<a href="https://vimeo.com/652633418">video</a>, <a href="https://github.com/ros2/ros2_tracing/blob/rolling/doc/2021-10-20_ROS_World_2021_-_Tracing_ROS_2_with_ros2_tracing.pdf">slides</a>).
Reference:</p>
<ul>
  <li>C. Bédard, “Tracing ROS 2 with ros2_tracing,” in <em>ROS World 2021</em>. Open Robotics, October 2021. [Online]. Available: https://vimeo.com/652633418, <a href="https://github.com/ros2/ros2_tracing/blob/rolling/doc/2021-10-20_ROS_World_2021_-_Tracing_ROS_2_with_ros2_tracing.pdf">(pdf)</a>
</li>
</ul>

<h2 id="tutorials--demos">Tutorials &amp; demos</h2>

<ul>
  <li>ROS 2 documentation: <a href="https://docs.ros.org/en/rolling/How-To-Guides/Building-ROS-2-with-Tracing.html">Building ROS 2 with tracing</a>
</li>
  <li>Real-Time Working Group documentation tutorial: <a href="https://ros-realtime.github.io/Guides/ros2_tracing_trace_and_analyze.html">How to use <code class="language-plaintext highlighter-rouge">ros2_tracing</code> to trace and analyze an application</a>
</li>
  <li>ROS World 2021 demo: <a href="https://github.com/christophebedard/ros-world-2021-demo">github.com/christophebedard/ros-world-2021-demo</a>
</li>
</ul>

<h2 id="building">Building</h2>

<p>As of Iron, the LTTng tracer is a ROS 2 dependency.
Therefore, ROS 2 can be traced out-of-the-box on Linux; this package does not need to be re-built.</p>

<p>To make sure that the instrumentation and tracepoints are available:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ source /opt/ros/rolling/setup.bash  # With a binary install
$ source ./install/setup.bash  # When building from source
$ ros2 run tracetools status
Tracing enabled

</code></pre></div></div>

<p>A ROS 2 installation only includes the LTTng userspace tracer (LTTng-UST), which is all that is needed to trace ROS 2.
To trace the Linux kernel, the <a href="https://lttng.org/docs/v2.13/#doc-tracing-the-linux-kernel">LTTng kernel tracer</a> must be installed separately:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo apt-get update
$ sudo apt-get install lttng-modules-dkms

</code></pre></div></div>

<p>For more information about LTTng, <a href="https://lttng.org/docs/v2.13/">refer to its documentation</a>.</p>

<h3 id="removing-the-instrumentation">Removing the instrumentation</h3>

<p>To build and remove all instrumentation, use <code class="language-plaintext highlighter-rouge">TRACETOOLS_DISABLED</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ colcon build --cmake-args -DTRACETOOLS_DISABLED=ON

</code></pre></div></div>

<p>This will remove all instrumentation from the core ROS 2 packages, and thus they will not depend on or link against the shared library provided by the <a href="https://github.com/ros2/ros2_tracing/tree/iron/#tracetools"><code class="language-plaintext highlighter-rouge">tracetools</code> package</a>.
This also means that LTTng is not required at build-time or at runtime.</p>

<h3 id="excluding-tracepoints">Excluding tracepoints</h3>

<p>Alternatively, to only exclude the actual tracepoints, use <code class="language-plaintext highlighter-rouge">TRACETOOLS_TRACEPOINTS_EXCLUDED</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ colcon build --packages-select tracetools --cmake-clean-cache --cmake-args -DTRACETOOLS_TRACEPOINTS_EXCLUDED=ON

</code></pre></div></div>

<p>This will keep the instrumentation but remove all tracepoints.
This also means that LTTng is not required at build-time or at runtime.
This option can be useful, since tracepoints can be added back in or removed by simply replacing/re-building the shared library provided by the <a href="https://github.com/ros2/ros2_tracing/tree/iron/#tracetools"><code class="language-plaintext highlighter-rouge">tracetools</code> package</a>.</p>

<h2 id="tracing">Tracing</h2>

<p>By default, trace data will not be generated, and thus these packages will have virtually no impact on execution.
LTTng has to be configured for tracing.
The packages in this repo provide two options: a <a href="https://github.com/ros2/ros2_tracing/tree/iron/#trace-command">command</a> and a <a href="https://github.com/ros2/ros2_tracing/tree/iron/#launch-file-trace-action">launch file action</a>.</p>

<p><strong>Note</strong>: tracing must be started before the application is launched.
Metadata is recorded during the initialization phase of the application.
This metadata is needed to understand the rest of the trace data, so if tracing is started after the application started executing, then the trace data might be unusable.
For more information, refer to the <a href="https://github.com/ros2/ros2_tracing/tree/iron/./doc/design_ros_2.md#general-guidelines">design document</a>.
The <a href="https://github.com/ros2/ros2_tracing/tree/iron/#launch-file-trace-action">launch file action</a> is designed to automatically start tracing before the application launches.</p>

<p>The tracing directory can be configured using command/launch action parameters, or through environment variables with the following logic:</p>

<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">$ROS_TRACE_DIR</code> if <code class="language-plaintext highlighter-rouge">ROS_TRACE_DIR</code> is set and not empty.</li>
  <li>Otherwise, use <code class="language-plaintext highlighter-rouge">$ROS_HOME/tracing</code>, using <code class="language-plaintext highlighter-rouge">~/.ros</code> for <code class="language-plaintext highlighter-rouge">ROS_HOME</code> if not set or if empty.</li>
</ul>

<p>Additionally, <strong>if you’re using kernel tracing with a non-root user, make sure that the <a href="https://lttng.org/docs/v2.13/#doc-tracing-group"><code class="language-plaintext highlighter-rouge">tracing</code> group exists and that your user is added to it</a></strong>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Create group if it doesn't exist
$ sudo groupadd -r tracing
# Add user to the group
$ sudo usermod -aG tracing $USER

</code></pre></div></div>

<h3 id="trace-command">Trace command</h3>

<p>The first option is to use the <code class="language-plaintext highlighter-rouge">ros2 trace</code> command.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 trace

</code></pre></div></div>

<p>By default, it will enable all ROS 2 tracepoints.
The trace will be written to <code class="language-plaintext highlighter-rouge">~/.ros/tracing/session-YYYYMMDDHHMMSS</code>.
Run the command with <code class="language-plaintext highlighter-rouge">-h</code> for more information.</p>

<p>You must <a href="https://github.com/ros2/ros2_tracing/tree/iron/#building">install the kernel tracer</a> if you want to enable kernel events (using the <code class="language-plaintext highlighter-rouge">-k</code>/<code class="language-plaintext highlighter-rouge">--kernel-events</code> option).
If you have installed the kernel tracer, use kernel tracing, and still encounter an error here, make sure to <a href="https://github.com/ros2/ros2_tracing/tree/iron/#tracing">add your user to the <code class="language-plaintext highlighter-rouge">tracing</code> group</a>.</p>

<h3 id="launch-file-trace-action">Launch file trace action</h3>

<p>Another option is to use the <code class="language-plaintext highlighter-rouge">Trace</code> action in a Python, XML, or YAML launch file along with your <code class="language-plaintext highlighter-rouge">Node</code> action(s).
This way, tracing automatically starts when launching the launch file and ends when it exits or when terminated.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 launch tracetools_launch example.launch.py

</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">Trace</code> action will also set the <code class="language-plaintext highlighter-rouge">LD_PRELOAD</code> environment to preload <a href="https://lttng.org/docs/v2.13/#doc-prebuilt-ust-helpers">LTTng’s userspace tracing helper(s)</a> if the corresponding event(s) are enabled.
For more information, see <a href="https://github.com/ros2/ros2_tracing/tree/iron/./tracetools_launch/launch/example.launch.py">this example launch file</a> and the <a href="https://github.com/ros2/ros2_tracing/tree/iron/./tracetools_launch/tracetools_launch/action.py"><code class="language-plaintext highlighter-rouge">Trace</code> action</a>.</p>

<p>You must <a href="https://github.com/ros2/ros2_tracing/tree/iron/#building">install the kernel tracer</a> if you want to enable kernel events (<code class="language-plaintext highlighter-rouge">events_kernel</code> in Python, <code class="language-plaintext highlighter-rouge">events-kernel</code> in XML or YAML).
If you have installed the kernel tracer, use kernel tracing, and still encounter an error here, make sure to <a href="https://github.com/ros2/ros2_tracing/tree/iron/#tracing">add your user to the <code class="language-plaintext highlighter-rouge">tracing</code> group</a>.</p>

<h2 id="design">Design</h2>

<p>See the <a href="https://github.com/ros2/ros2_tracing/tree/iron/./doc/design_ros_2.md">design document</a>.</p>

<h2 id="real-time">Real-time</h2>

<p>LTTng-UST, the current default userspace tracer used for <a href="https://github.com/ros2/ros2_tracing/tree/iron/#overview">tracing ROS 2</a>, was designed for real-time production applications.
It is a low-overhead tracer with many important real-time compatible features:</p>

<ul>
  <li>userspace tracer completely implemented in userspace, independent from the kernel</li>
  <li>reentrant, thread-safe, signal-safe, non-blocking</li>
  <li>no system calls in the fast path</li>
  <li>no copies of the trace data</li>
</ul>

<p>However, some settings need to be tuned for it to be fully real-time safe and for performance to be optimal for your use-case:</p>

<ul>
  <li>timers<sup id="fnref:rt-1" role="doc-noteref"><a href="https://github.com/ros2/ros2_tracing/tree/iron/#fn:rt-1" class="footnote" rel="footnote">1</a></sup>: use <a href="https://lttng.org/docs/v2.13/#doc-channel-read-timer">read timer</a> to avoid a write(2) call</li>
  <li>sub-buffer<sup id="fnref:rt-1:1" role="doc-noteref"><a href="https://github.com/ros2/ros2_tracing/tree/iron/#fn:rt-1" class="footnote" rel="footnote">1</a></sup> count and size:
    <ul>
      <li>see <a href="https://lttng.org/docs/v2.13/#doc-channel-subbuf-size-vs-subbuf-count">documentation</a> for sub-buffer count and size tuning tips based on your use-case</li>
      <li>minimize sub-buffer count to minimize sub-buffer switching overhead</li>
    </ul>
  </li>
  <li>one-time memory allocation/lock/syscall per thread:
    <ul>
      <li>usually done the first time a tracepoint is executed within a thread for URCU thread registration, but registration can be manually performed to force it to be done during your application’s initialization</li>
      <li>see <a href="https://lists.lttng.org/pipermail/lttng-dev/2019-November/029409.html">this LTTng mailing list message</a>
</li>
    </ul>
  </li>
</ul>

<p>For further reading:</p>

<ul>
  <li><a href="https://lttng.org/docs/v2.13/">LTTng documentation</a></li>
  <li>
<a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.641.1965&amp;rep=rep1&amp;type=pdf#page=87">Combined Tracing of the Kernel and Applications with LTTng</a>: LTTng-UST architecture and design goals (section 3)</li>
  <li>
<a href="https://dl.acm.org/doi/abs/10.1145/3158644">Survey and Analysis of Kernel and Userspace Tracers on Linux: Design, Implementation, and Overhead</a>: LTTng-UST overhead and design compared to other kernel and userspace tracers (table 6: average latency overhead per tracepoint of 158 ns)</li>
</ul>

<p>The LTTng kernel tracer has a similar implementation, but is separate from the userspace tracer.</p>

<h2 id="packages">Packages</h2>

<h3 id="ros2trace">ros2trace</h3>

<p>Package containing a <code class="language-plaintext highlighter-rouge">ros2cli</code> extension to enable tracing.</p>

<h3 id="tracetools">tracetools</h3>

<p>Library to support instrumenting ROS packages, including core packages.</p>

<p>This package claims to be in the <strong>Quality Level 1</strong> category, see the <a href="https://github.com/ros2/ros2_tracing/tree/iron/./tracetools/QUALITY_DECLARATION.md">Quality Declaration</a> for more details.</p>

<p>See the <a href="https://docs.ros.org/en/rolling/p/tracetools/">API documentation</a>.</p>

<h3 id="tracetools_launch">tracetools_launch</h3>

<p>Package containing tools to enable tracing through launch files.</p>

<h3 id="tracetools_read">tracetools_read</h3>

<p>Package containing tools to read traces.</p>

<h3 id="tracetools_test">tracetools_test</h3>

<p>Package containing tools for tracing-related tests.</p>

<h3 id="tracetools_trace">tracetools_trace</h3>

<p>Package containing tools to enable tracing.</p>

<h3 id="test_tracetools">test_tracetools</h3>

<p>Package containing unit and system tests for <code class="language-plaintext highlighter-rouge">tracetools</code>.</p>

<h3 id="test_tracetools_launch">test_tracetools_launch</h3>

<p>Package containing system tests for <code class="language-plaintext highlighter-rouge">tracetools_launch</code>.</p>

<h2 id="analysis">Analysis</h2>

<p>See <a href="https://github.com/ros-tracing/tracetools_analysis"><code class="language-plaintext highlighter-rouge">tracetools_analysis</code></a>.</p>
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:rt-1" role="doc-endnote">
      <p>this setting cannot currently be set through the <a href="https://github.com/ros2/ros2_tracing/tree/iron/#launch-file-trace-action"><code class="language-plaintext highlighter-rouge">Trace</code> launch file action</a> or the <a href="https://github.com/ros2/ros2_tracing/tree/iron/#trace-command"><code class="language-plaintext highlighter-rouge">ros2 trace</code> command</a>, see <a href="https://github.com/ros2/ros2_tracing/issues/20">#20</a> <a href="https://github.com/ros2/ros2_tracing/tree/iron/#fnref:rt-1" class="reversefootnote" role="doc-backlink">↩</a> <a href="https://github.com/ros2/ros2_tracing/tree/iron/#fnref:rt-1:1" class="reversefootnote" role="doc-backlink">↩<sup>2</sup></a></p>
    </li>
  </ol>
</div>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<p>Any contribution that you make to this repository will
be under the Apache 2 License, as dictated by that
<a href="http://www.apache.org/licenses/LICENSE-2.0.html">license</a>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5. Submission of Contributions. Unless You explicitly state otherwise,
   any Contribution intentionally submitted for inclusion in the Work
   by You to the Licensor shall be under the terms and conditions of
   this License, without any additional terms or conditions.
   Notwithstanding the above, nothing herein shall supersede or modify
   the terms of any separate license agreement you may have executed
   with Licensor regarding such Contributions.
</code></pre></div></div>

<p>Contributors must sign-off each commit by adding a <code class="language-plaintext highlighter-rouge">Signed-off-by: ...</code>
line to commit messages to certify that they have the right to submit
the code they are contributing to the project according to the
<a href="https://developercertificate.org/">Developer Certificate of Origin (DCO)</a>.</p>
</div>
              <hr id="iron-contribute-lists">
              <ul class="nav nav-tabs nav-justified" id="iron-contribute-lists-tabs">
                <li class="better-tabs active">
                  <a href="#iron-contribute-lists-help-wanted" data-toggle="tab"><span class="contribute-lists-help-wanted-count label label-primary">0</span> Help Wanted</a>
                </li>
                <li class="better-tabs">
                  <a href="#iron-contribute-lists-good-first-issue" data-toggle="tab"><span class="contribute-lists-good-first-issue-count label label-primary">0</span> Good First Issue</a>
                </li>
                <li class="better-tabs">
                  <a href="#iron-contribute-lists-pull-requests" data-toggle="tab"><span class="contribute-lists-pull-requests-count label label-primary">0</span> Pull Requests to Review</a>
                </li>
              </ul>
              <div class="tab-content contribute-lists">
                <div class="tab-pane active" id="iron-contribute-lists-help-wanted">
                  <div class="contribute-lists-help-wanted"></div>
                </div>
                <div class="tab-pane" id="iron-contribute-lists-good-first-issue">
                  <div class="contribute-lists-good-first-issue"></div>
                </div>
                <div class="tab-pane" id="iron-contribute-lists-pull-requests">
                  <div class="contribute-lists-pull-requests"></div>
                </div>
              </div>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-melodic">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/ros2_tracing">ros2_tracing</a> <small>repository</small></h3>
        <span class="label label-default">tools</span> <span class="label label-default">instrumentation</span> <span class="label label-default">ros</span> <span class="label label-default">tracing</span> <span class="label label-default">performance-analysis</span> <span class="label label-default">ros2</span> <span class="label label-default">ros2-tracing</span> 
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-ros2-ros2_tracing
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-ros2-ros2_tracing" role="menuitem" tabindex="-1" href="/r/ros2_tracing/github-ros2-ros2_tracing" data="github-ros2-ros2_tracing">
                    <span class="glyphicon glyphicon-star"></span>
                    github-ros2-ros2_tracing
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>melodic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>


<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
  $(function() {
    setupContributeListTabLinks();
  });
  $(document).ready(function() {
    setupDistroSwitch("humble");
    setupContributeLists("https://github.com/ros2/ros2_tracing.git");
  });
</script>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="container-fluid">
      <div style="float:left;">
        
          <a href="https://github.com/rkent/rosindex" title="Find rosindex in Github">
          <span class="icon  icon--github">
            <svg viewBox="0 0 16 16">
              <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
            </svg>
          </span>

          <span class="username">rkent/rosindex</span>
        </a>
        <em class="hidden-xs">| generated on 2025-05-05</em>
      
      </div>
      <div style="float:right;">
        <p class="text"><span class="hidden-xs">a community-maintained index of robotics software
 | </span><a href="/privacy.txt">privacy</a></p>
      </div>
    </div>
  </div>

</footer>


  </body>

</html>
