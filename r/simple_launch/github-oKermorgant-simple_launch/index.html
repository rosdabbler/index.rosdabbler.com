<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Index</title>
    <meta name="description" content="a community-maintained index of robotics software
">

    
    <link rel="canonical" href="http://index.rosdabbler.com/r/simple_launch/github-oKermorgant-simple_launch/">
    
    
    <link rel="icon" sizes="any" type="image/svg+xml" href="/assets/rosindex_logo.svg">

    

    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">
    

    

    <script type="text/javascript" src=/js/jquery.js></script>
    <script src=/bootstrap/js/bootstrap.min.js type="text/javascript"></script>
    <script src=/js/jquery-cookie.js type="text/javascript"></script>
    
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EVD5Z6G6NH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EVD5Z6G6NH');
</script>

    <script type="text/javascript" src=/js/toc.js></script>

    <script src=/js/distro_switch.js></script>
  </head>

  <body>

    <header class="site-header">

  <div class="wrapper">
    <div class="container-fluid" style="margin-bottom: 10px">
      <div class="row">
        <!-- title -->
        <div class="col-xs-3" style="white-space:nowrap">
          <a class="site-title" href="/">
            <img src="/assets/rosindex_logo.svg" width="26" height="26" alt="ROS index logo" style="padding-bottom: 3px"/>
            ROS Index</a>
        </div>
        <!-- main internal links -->
        <div class="col-xs-6 text-center" style="padding:0px">
          <div class="btn-group hidden-xs" role="group" aria-label="..." style="padding: 6px">
            <div class="btn-group" role="group">
              <a href="/?search_packages=true" class="btn btn-default" role="button">Package List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/?search_repos=true" class="btn btn-default" role="button">Repository List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/search_deps" class="btn btn-default" role="button">System Dependencies</a>
            </div>
          </div>
          <div class="hidden-lg hidden-md hidden-sm">
            <button id="hLabel" class="btn btn-link dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Lists <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="hLabel">
              <li><a href="/?search_packages=true">Package List</a></li>
              <li><a href="/?search_repos=true">Repository List</a></li>
              <li><a href="/search_deps">System Dependencies</a></li>
            </ul>
          </div>
        </div>
        <!-- additional links -->
        <div class="col-xs-3 text-right" style="white-space:nowrap; padding:0px">
          <ul class="list-inline" style="margin-bottom:0px;">
            <li class="dropdown hidden-xs hidden-sm">
              <button id="rLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                ROS Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu" aria-labelledby="rLabel">
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-xs hidden-sm">
              <button id="aLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                About <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="aLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-md hidden-lg">
              <button id="qLabel" class="btn btn-link" type="button"
                      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="qLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
                <hr style="margin:7px" />
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin-top:20px">
  <div class="container-fluid">
    <div class="row">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/repos">Repos</a></li>
        <li class="active">simple_launch</li>
        <!--<li class="active">simple_launch</li>-->
      </ol>
    </div>
    <div class="row">
      

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
    <label id="humble-option" class="distro-button btn btn-xs btn-primary" href="#humble" data="humble">
      <input type="radio" name="options" id="humble-radio" autocomplete="off"> humble
    </label>
  
    <label id="jazzy-option" class="distro-button btn btn-xs btn-primary" href="#jazzy" data="jazzy">
      <input type="radio" name="options" id="jazzy-radio" autocomplete="off"> jazzy
    </label>
  
    <label id="kilted-option" class="distro-button btn btn-xs btn-primary" href="#kilted" data="kilted">
      <input type="radio" name="options" id="kilted-radio" autocomplete="off"> kilted
    </label>
  
    <label id="rolling-option" class="distro-button btn btn-xs btn-primary" href="#rolling" data="rolling">
      <input type="radio" name="options" id="rolling-radio" autocomplete="off"> rolling
    </label>
  
    <label id="github-option" class="distro-button btn btn-xs btn-default" href="#github" data="github">
      <input type="radio" name="options" id="github-radio" autocomplete="off"> github
    </label>
  
    <label id="noetic-option" class="distro-button btn btn-xs btn-default" href="#noetic" data="noetic">
      <input type="radio" name="options" id="noetic-radio" autocomplete="off"> noetic
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-primary" data-toggle="dropdown" id="older-distro-button">
        <input type="radio" name="options" autocomplete="off">
      <span id="older-label">Older</span>
      <span class="caret"></span>
    </label>
    <ul class="dropdown-menu" role="menu">
      
        <li data="galactic" id="galactic-option" class=" older-distro-option"  href="#galactic">
          <a href="#galactic" data="galactic" id="galactic-button">galactic</a>
        </li>
      
        <li data="iron" id="iron-option" class=" older-distro-option"  href="#iron">
          <a href="#iron" data="iron" id="iron-button">iron</a>
        </li>
      
        <li data="melodic" id="melodic-option" class="disabled older-distro-option"  href="#melodic">
          <a href="#melodic" data="melodic" id="melodic-button">melodic</a>
        </li>
      
    </ul>
  </div>
</div>

    </div>
    <div class="row">
      &nbsp;
    </div>
  </div>
</div>


  <div class="distro distro-humble">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/simple_launch">simple_launch</a> <small>repository</small></h3>
        
        
        <a class="label label-primary pkg-label" href="/p/simple_launch">simple_launch</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-oKermorgant-simple_launch
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-oKermorgant-simple_launch" role="menuitem" tabindex="-1" href="/r/simple_launch/github-oKermorgant-simple_launch" data="github-oKermorgant-simple_launch">
                    <span class="glyphicon glyphicon-star"></span>
                    github-oKermorgant-simple_launch
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">This package provides a Python class to help writing ROS 2 launch files.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/oKermorgant/simple_launch.git">https://github.com/oKermorgant/simple_launch.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">devel</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-02-16
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/simple_launch/#humble-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/simple_launch/#humble-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/simple_launch/#humble-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/simple_launch">simple_launch</a></td>
                    <td>1.11.0</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="simple_launch">simple_launch</h1>
<p>This package provides a Python class to help writing ROS 2 launch files.</p>

<p>The motivation behind this package is that the ROS 2 launch Python syntax may not be suited for many simple cases such as running basic nodes, spawning a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code>, and grouping nodes in namespaces or components.</p>

<p><strong>Thanks</strong>: this package is inspired by <a href="https://github.com/bponsler/ros2_launch_util">ros2_launch_util</a>.</p>

<p>The entry point is the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> class, which has several capabilities.</p>

<h2 id="basic-syntax">Basic syntax</h2>

<h3 id="namespace-and-argument-parser-initialization">Namespace and argument parser initialization</h3>

<p><code class="language-plaintext highlighter-rouge">sl = SimpleLauncher(namespace = '', use_sim_time = None, scope_included_files = False)</code></p>

<ul>
  <li>will initialize all nodes relative to the given namespace</li>
  <li>if <code class="language-plaintext highlighter-rouge">use_sim_time</code> is a Boolean, creates a <code class="language-plaintext highlighter-rouge">use_sim_time</code> launch argument with this value as the default and forwards it to all nodes, unless explicitely specified when running the node</li>
  <li>if <code class="language-plaintext highlighter-rouge">use_sim_time</code> is <code class="language-plaintext highlighter-rouge">'auto'</code>, then <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> will set it to <code class="language-plaintext highlighter-rouge">True</code> if the <code class="language-plaintext highlighter-rouge">/clock</code> topic is advertized (case of an already running simulation). <strong>This may have side effects if the <code class="language-plaintext highlighter-rouge">/clock</code> topic is advertized but you want to use this launch file with system clock</strong>.</li>
  <li>if <code class="language-plaintext highlighter-rouge">use_sim_time</code> is <code class="language-plaintext highlighter-rouge">None</code> (default) then no particular value is forwarded to the nodes</li>
  <li>if <code class="language-plaintext highlighter-rouge">scope_included_files</code> is <code class="language-plaintext highlighter-rouge">False</code> (default) then including another launch file that shares the same argument but while passing another value for this argument, will also <a href="https://robotics.stackexchange.com/questions/98997/ros2-foxy-python-launch-argument-scope-when-nesting-launch-files">modify the value of this argument after the inclusion</a>. This is the default behavior of <code class="language-plaintext highlighter-rouge">launch</code> but can be undesired. Inside an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code> the behavior is to be scoped anyway (the argument value is resolved) and <code class="language-plaintext highlighter-rouge">scope_included_files</code> has no effect.</li>
</ul>

<h3 id="node-registration">Node registration</h3>

<p><code class="language-plaintext highlighter-rouge">sl.node(package, executable, **node_args)</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">package</code> is the node package</li>
  <li>
<code class="language-plaintext highlighter-rouge">executable</code> is the name of the executable</li>
  <li>
<code class="language-plaintext highlighter-rouge">node_args</code> are any additional <code class="language-plaintext highlighter-rouge">Node</code> arguments</li>
</ul>

<h3 id="launch-file-include">Launch file include</h3>

<p><code class="language-plaintext highlighter-rouge">sl.include(package, launch_file, launch_dir = None, launch_arguments=None)</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">package</code> is the package of the included launch file</li>
  <li>
<code class="language-plaintext highlighter-rouge">launch_file</code> is the name of the launch file</li>
  <li>
<code class="language-plaintext highlighter-rouge">launch_dir</code> is its directory inside the package share (<code class="language-plaintext highlighter-rouge">None</code> to have it found)</li>
  <li>
<code class="language-plaintext highlighter-rouge">launch_arguments</code> is a dictionary of arguments to pass to the included launch file</li>
</ul>

<h3 id="call-a-service-at-launch">Call a service at launch</h3>

<p>This line runs a temporary client that waits for a service and calls it when available:</p>

<p><code class="language-plaintext highlighter-rouge">sl.call_service(server, request = None, verbosity = '')</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">server</code> is the path to some service (possibly namespaced). The service type is deduced when it becomes available.</li>
  <li>
<code class="language-plaintext highlighter-rouge">request</code> is a dictionary representing the service request. If <code class="language-plaintext highlighter-rouge">None</code> or incomplete, will use the service request default values.</li>
  <li>
<code class="language-plaintext highlighter-rouge">verbosity</code> let the underlying node describe what it is doing: <code class="language-plaintext highlighter-rouge">'req'</code> for request info, <code class="language-plaintext highlighter-rouge">'res'</code> for response info or both with <code class="language-plaintext highlighter-rouge">'reqres'</code>
</li>
</ul>

<p>If any request parameter is <code class="language-plaintext highlighter-rouge">__ns</code> it will be changed to the current namespace.</p>

<h3 id="setting-parameters">Setting parameters</h3>

<p>This line runs a temporary client that waits for a node and changes its parameters when available:</p>

<p><code class="language-plaintext highlighter-rouge">sl.set_parameters(node_name, parameters: dict = {}, verbosity = '')</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">node_name</code> is the name of the node (possibly namespaced)</li>
  <li>
<code class="language-plaintext highlighter-rouge">parameters</code> is a dictionary of (name, value) parameters to be set</li>
  <li>
<code class="language-plaintext highlighter-rouge">verbosity</code> let the underlying node describe what it is doing: <code class="language-plaintext highlighter-rouge">'req'</code> for request info, <code class="language-plaintext highlighter-rouge">'res'</code> for response info or both with <code class="language-plaintext highlighter-rouge">'reqres'</code>
</li>
</ul>

<p>This calls the <code class="language-plaintext highlighter-rouge">set_parameters</code> service of the node with the passed types. Possible errors may happen if the parameters do not exist or are of a different type.</p>

<h3 id="robust-types-for-parameters">Robust types for parameters</h3>

<p>In the launch API, differents types are expected for:</p>

<ul>
  <li>node parameters: a list of dictionaries</li>
  <li>node remappings: a list of (<code class="language-plaintext highlighter-rouge">key</code>, <code class="language-plaintext highlighter-rouge">value</code>) pairs</li>
  <li>included launch arguments: a list of (<code class="language-plaintext highlighter-rouge">key</code>, <code class="language-plaintext highlighter-rouge">value</code>) pairs</li>
  <li>xacro arguments: a concatenation of <code class="language-plaintext highlighter-rouge">key:=value</code> strings</li>
</ul>

<p>The <code class="language-plaintext highlighter-rouge">sl.include</code>, <code class="language-plaintext highlighter-rouge">sl.node</code> and <code class="language-plaintext highlighter-rouge">xacro_args</code> calls allow using any type (the simplest being a single dictionary)  and will convert to the one expected by the API.</p>

<h2 id="launch-arguments">Launch arguments</h2>

<p><code class="language-plaintext highlighter-rouge">simple_launch</code> allows declaring launch arguments and getting them in return.</p>

<h3 id="declare-a-launch-argument">Declare a launch argument</h3>

<p><code class="language-plaintext highlighter-rouge">sl.declare_arg(name, default_value, description = None)</code>: declare and returns the argument</p>

<p>Contrary to the base API, the default value is a raw Python type.</p>

<h3 id="retrieve-a-launch-argument">Retrieve a launch argument</h3>

<p><code class="language-plaintext highlighter-rouge">sl.arg(name)</code>: returns the argument <code class="language-plaintext highlighter-rouge">name</code> as a <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code></p>

<h3 id="retrieve-several-arguments-as-a-dictionary">Retrieve several arguments as a dictionary</h3>

<p><code class="language-plaintext highlighter-rouge">sl.arg_map('robot', 'x', 'y')</code>: returns <code class="language-plaintext highlighter-rouge">{'robot': &lt;robot arg value&gt;, 'x': &lt;x arg value&gt;, 'y': &lt;y arg value&gt;}</code></p>

<p>Typical when forwarding some launch arguments to a node or an included launch file.</p>

<h2 id="groups-or-scopes">Groups or scopes</h2>

<p>Groups are created through the <code class="language-plaintext highlighter-rouge">with sl.group():</code> syntax and accept, a namespace an if/unless condition and an event.</p>

<p>Actions that are added in a scope inherit from all previous defined groups.</p>

<h3 id="by-namespace">By namespace</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(ns=sub_namespace):
    sl.node(package, executable)

</code></pre></div></div>

<h3 id="from-a-condition">From a condition</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(if_condition=True):
    sl.node(package, executable)

  with sl.group(unless_condition=&lt;some expression&gt;):
    sl.node(package, executable)

</code></pre></div></div>

<ul>
  <li>Only one condition can be set in a group, nested condition must be combined first, or used in nested groups.</li>
  <li>Combining conditions coming from launch arguments can be done with <code class="language-plaintext highlighter-rouge">sl.py_eval</code> as shown below.</li>
</ul>

<h3 id="from-conditional-arguments">From conditional arguments</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(if_arg='use_gui'):
    sl.node(package, executable)

  with sl.group(unless_arg='dont_do'):
    sl.node(package, executable)

</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">if_arg</code> / <code class="language-plaintext highlighter-rouge">unless_arg</code> is expected to be the name of a launch argument. These two lines are equivalent:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(if_arg='use_gui'):
  with sl.group(if_condition=sl.arg('use_gui')):

</code></pre></div></div>
<p>If <code class="language-plaintext highlighter-rouge">if_arg</code> / <code class="language-plaintext highlighter-rouge">unless_arg</code> is not a string then it is considered as a <code class="language-plaintext highlighter-rouge">if_condition</code> / <code class="language-plaintext highlighter-rouge">unless_condition</code>.</p>

<h3 id="from-events">From events</h3>

<p>The <code class="language-plaintext highlighter-rouge">when</code> argument wraps events from the <code class="language-plaintext highlighter-rouge">launch.event_handlers</code> module. It combines an event and a delay (0 by default)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch.events import When, OnProcessStart, OnProcessExit, OnProcessIO

  my_node = sl.node(...)   # reference node

  with sl.group(when = When(my_node, OnProcessStart, 1.)):
      sl.node(...)  # will run 1 s after main node starts

  with sl.group(when = When(my_node, OnProcessExit)):
      sl.node(...)  # will run as soon as the main node exists

  with sl.group(when = When(my_node, OnProcessIO, io = 'stdout'):
      # OnProcessIO events need a function changing the event into an action
      sl.add_action(lambda event: LogInfo(msg = 'Node says "{}"'.format(
                      event.text.decode().strip())))
      # several functions can be used if needed, they will be combined in a single one
      sl.add_action(lambda event: LogInfo(msg = 'Once again, node says "{}"'.format(
                      event.text.decode().strip())))

  with sl.group(when = When(delay = 2.)):
      sl.node(...)  # will run after 2 sec

</code></pre></div></div>

<h3 id="creating-containers">Creating containers</h3>

<p>This syntax adds the <code class="language-plaintext highlighter-rouge">composition/composition::Talker</code> as a ComposableNode</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.container(name='my_container', output='screen'):
    sl.node(package='composition', plugin='Talker', name='talker')

</code></pre></div></div>

<p>Use the <code class="language-plaintext highlighter-rouge">executable</code> and <code class="language-plaintext highlighter-rouge">package</code> parameters if you want to use executors other than <code class="language-plaintext highlighter-rouge">rclcpp_components</code>â€™s <code class="language-plaintext highlighter-rouge">component_container</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.container(name='my_container', output='screen', executable='component_container_isolated'):

</code></pre></div></div>

<p><strong><em>It is currently impossible to have group blocks within a container block, as containers can only accept <code class="language-plaintext highlighter-rouge">ComposableNode</code>s</em></strong>. A <code class="language-plaintext highlighter-rouge">GroupAction</code> containing e.g. <code class="language-plaintext highlighter-rouge">PushRosNamespace</code> and a <code class="language-plaintext highlighter-rouge">ComposableNode</code> is not itself a <code class="language-plaintext highlighter-rouge">ComposableNode</code>.</p>

<h2 id="use_sim_time"><code class="language-plaintext highlighter-rouge">use_sim_time</code></h2>

<p>The current <code class="language-plaintext highlighter-rouge">use_sim_time</code> setting can be retrieved through <code class="language-plaintext highlighter-rouge">sl.sim_time</code> that may be:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">None</code>, if <code class="language-plaintext highlighter-rouge">use_sim_time</code> was not set in the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> constructor</li>
  <li>a raw Boolean, if <code class="language-plaintext highlighter-rouge">use_sim_time</code> was set to <code class="language-plaintext highlighter-rouge">'auto'</code>, depending on the <code class="language-plaintext highlighter-rouge">/clock</code> topic being advertized</li>
  <li>a Boolean launch argument, if <code class="language-plaintext highlighter-rouge">use_sim_time</code> was set to <code class="language-plaintext highlighter-rouge">True</code> or <code class="language-plaintext highlighter-rouge">False</code>
</li>
</ul>

<p>In all cases, if the <code class="language-plaintext highlighter-rouge">use_sim_time</code> parameter is explicitely given to a node, it will be used instead of the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> instance one.</p>

<h2 id="opaquefunction-with-implicit-performcontext">
<code class="language-plaintext highlighter-rouge">OpaqueFunction</code> with implicit <code class="language-plaintext highlighter-rouge">.perform(context)</code>
</h2>

<p>Most of the use cases can be dealt with substitutions and <code class="language-plaintext highlighter-rouge">with sl.group</code> blocks.
In order to design more imperative launch files, the <a href="https://discourse.ros.org/t/simplifying-launch-argument-declaration-and-initialization-in-launch-files/24204"><code class="language-plaintext highlighter-rouge">OpaqueFunction</code></a> approach can be used. The main drawback is that potential errors are harder to track.</p>

<p>To do this with <code class="language-plaintext highlighter-rouge">simple_launch</code>:</p>

<ul>
  <li>the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> instance and the argument declaration should be done in the main body of your launch file.</li>
  <li>then, define a function (e.g. <code class="language-plaintext highlighter-rouge">launch_setup</code>) that takes no argument, where the logic of the launch file resides.</li>
  <li>all arguments obtained through <code class="language-plaintext highlighter-rouge">sl.arg</code> will be basic Python types, obtained from performing the substitutions.</li>
  <li>finally just export <code class="language-plaintext highlighter-rouge">generate_launch_description = sl.launch_description(opaque_function = launch_setup)</code>.</li>
</ul>

<p>Compare <a href="https://github.com/oKermorgant/simple_launch/tree/devel/example/example_launch.py"><code class="language-plaintext highlighter-rouge">example_launch.py</code></a> and <a href="https://github.com/oKermorgant/simple_launch/tree/devel/example/example_opaque_launch.py"><code class="language-plaintext highlighter-rouge">example_opaque_launch.py</code></a> to see the two approaches on the same logic.</p>

<p>Note that inside an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code> the if/unless idiom reduces to a basic if/else:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># with substitutions
with sl.group(if_arg='some_condition'):
  # do stuff
with sl.group(unless_arg='some_condition'):
  # do other stuff

# with opaque function
if sl.arg('some_condition'):
  # do stuff
else:
  # do other stuff

</code></pre></div></div>

<h2 id="other-one-liners">Other one-liners</h2>

<p>Methods listed below return instances of <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code> that represent any Substitution, but that provides concatenation (<code class="language-plaintext highlighter-rouge">+</code>) and path concatenation (<code class="language-plaintext highlighter-rouge">/</code>) operators. It is still a <code class="language-plaintext highlighter-rouge">Substitution</code>, not a raw Python type. If run from an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code> the underlying Python variable is returned.</p>

<h3 id="string--substitution-concatenation">String / substitution concatenation</h3>

<p>The following syntax builds the <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code> corresponding to <code class="language-plaintext highlighter-rouge">&lt;robot arg&gt;.xacro</code>:</p>

<p><code class="language-plaintext highlighter-rouge">file_name = sl.arg('robot') + '.xacro'</code></p>

<p><em>deprecated</em>: <code class="language-plaintext highlighter-rouge">sl.name_join(sl.arg('robot'), '.xacro')</code></p>

<h3 id="path-concatenation">Path concatenation</h3>

<p>The following syntax builds the <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code> corresponding to <code class="language-plaintext highlighter-rouge">&lt;package_path&gt;/urdf/&lt;robot arg&gt;.xacro</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>file_name = sl.arg('robot') + '.xacro'
urdf_file = os.path.join(get_package_share_directory(package),'urdf')/file_name

</code></pre></div></div>
<p>Obviously if all the path elements are raw strings, you should use <code class="language-plaintext highlighter-rouge">os.path.join</code> all along.</p>

<p><em>deprecated</em>: <code class="language-plaintext highlighter-rouge">sl.path_join(get_package_share_directory(package), sl.arg('robot'), '.xacro')</code></p>

<h3 id="find-a-share-file">Find a share file</h3>

<p><code class="language-plaintext highlighter-rouge">path = sl.find(package, file_name = None, file_dir = None)</code> where:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">package</code> is the name of the package or <code class="language-plaintext highlighter-rouge">None</code> if <code class="language-plaintext highlighter-rouge">file_name</code> is already an absolute path</li>
  <li>
<code class="language-plaintext highlighter-rouge">file_name</code> is the name of the file to find</li>
  <li>
<code class="language-plaintext highlighter-rouge">file_dir</code> is the path inside the package</li>
</ul>

<p>If <code class="language-plaintext highlighter-rouge">file_dir</code> is <code class="language-plaintext highlighter-rouge">None</code> but <code class="language-plaintext highlighter-rouge">package</code> and <code class="language-plaintext highlighter-rouge">file_name</code> are raw strings then the <code class="language-plaintext highlighter-rouge">find</code> function will actually look for the file inside the package share, using <code class="language-plaintext highlighter-rouge">os.walk</code>.</p>

<p>If <code class="language-plaintext highlighter-rouge">file_name</code> is <code class="language-plaintext highlighter-rouge">None</code> then the function just returns the path to the package share directory (e.g. <code class="language-plaintext highlighter-rouge">get_package_share_directory(package)</code>)</p>

<h3 id="robot-state-publisher">Robot state publisher</h3>

<p>It is quite common to run a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> from a <code class="language-plaintext highlighter-rouge">urdf</code> or <code class="language-plaintext highlighter-rouge">xacro</code> file. The line below runs it at the current namespace / condition level:</p>

<p><code class="language-plaintext highlighter-rouge">sl.robot_state_publisher(package, description_file, description_dir=None, xacro_args=None, **node_args)</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">description_file</code> is a URDF or xacro file</li>
  <li>
<code class="language-plaintext highlighter-rouge">description_dir</code> is the sub-directory of the file. If omitted, let the script search for the file assuming it is a raw string</li>
  <li>
<code class="language-plaintext highlighter-rouge">xacro_args</code> is a dictionary of arguments to forward to xacro</li>
  <li>
<code class="language-plaintext highlighter-rouge">node_args</code> are any additional arguments for <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> (remappings / parameters)</li>
</ul>

<h3 id="python-expressions">Python expressions</h3>

<p><code class="language-plaintext highlighter-rouge">sl.py_eval</code> will evaluate the given arguments as a Python expression, possibly performed if in an Opaque Function.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># RGB color as a list of [0-255] integers
sl.declare_arg('color', [255,0,0])
# same color as a string of [0-1] numbers (URDF format), note the padding commas to get a string
xacro_color = "'" + sl.py_eval("' '.join(str(c/255) for c in ", sl.arg('color'), ')') + "'"

</code></pre></div></div>

<h3 id="conditions">Conditions</h3>

<p><code class="language-plaintext highlighter-rouge">sl.py_eval</code> can be used to combine conditions. It is robust to lower case <code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">false</code> and will return a <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sl.declare_arg('some_condition', True)
opposed = sl.py_eval('not ', sl.arg('some_condition'))

</code></pre></div></div>

<p>Note that <code class="language-plaintext highlighter-rouge">IfCondition</code> and <code class="language-plaintext highlighter-rouge">UnlessCondition</code> cannot be combined, <a href="https://answers.ros.org/answers/414006/revisions/">only the underlying <code class="language-plaintext highlighter-rouge">Substitution</code>s can</a>.</p>

<h3 id="joint-state-publisher">Joint state publisher</h3>

<p><code class="language-plaintext highlighter-rouge">sl.joint_state_publisher(use_gui, **node_args)</code>: fires up a <code class="language-plaintext highlighter-rouge">joint_state_publisher</code>, with or without the gui, in the current namespace.</p>

<h3 id="rviz">Rviz</h3>

<p><code class="language-plaintext highlighter-rouge">sl.rviz(config_file = None, warnings = False)</code>: runs RViz on the given configuration file. If <code class="language-plaintext highlighter-rouge">warnings</code> is <code class="language-plaintext highlighter-rouge">False</code> (default) then runs with <code class="language-plaintext highlighter-rouge">log-level FATAL</code> in order to avoid many messages in the console.</p>

<p>Classical use case: <code class="language-plaintext highlighter-rouge">sl.rviz(sl.find('my_package', 'some_rviz_config.rviz'))</code></p>

<h3 id="fallback-to-low-level-syntax">Fallback to low-level syntax</h3>

<p>If any unavailable functionality is needed, the <code class="language-plaintext highlighter-rouge">sl.add_action(action)</code> function adds any passed <code class="language-plaintext highlighter-rouge">Action</code> at the current namespace / conditional / event level.</p>

<h2 id="interaction-with-gazebo--ignition">Interaction with Gazebo / Ignition</h2>

<p><em>Note: Ignition being renamed to Gazebo, all tools in this section use Gazebo / gz names</em></p>

<p>An effort was made to be robust to Ignition versus Gazebo uses, i.e. <em>ign</em> prefix is used for <code class="language-plaintext highlighter-rouge">foxy</code> and <code class="language-plaintext highlighter-rouge">galactic</code> while <em>gz</em> prefix is used from <code class="language-plaintext highlighter-rouge">humble</code>. <code class="language-plaintext highlighter-rouge">GZ_VERSION</code> and <code class="language-plaintext highlighter-rouge">IGNITION_VERSION</code> environment variables are also used to identify which version should be preferred.</p>

<h3 id="launch-gazebo">Launch Gazebo</h3>

<p>The Gazebo launch file corresponding to the current ROS 2 distribution is launched with</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sl.gz_launch(world_file, gz_arguments, full_world = None, save_after = 5.)

</code></pre></div></div>
<p>Namely, it will redirect to either <code class="language-plaintext highlighter-rouge">ros_ign_gazebo/ign_gazebo.launch.py</code> (<code class="language-plaintext highlighter-rouge">foxy</code>, <code class="language-plaintext highlighter-rouge">galactic</code>) or <code class="language-plaintext highlighter-rouge">ros_gz_sim/gz_sim.launch.py</code> (<code class="language-plaintext highlighter-rouge">humble</code>+).
The given <code class="language-plaintext highlighter-rouge">gz_arguments</code>, if any, will be forwarded either as the <code class="language-plaintext highlighter-rouge">ign_args</code> or <code class="language-plaintext highlighter-rouge">gz_args</code>, accordingly.</p>

<p>If the world file can be parsed then <code class="language-plaintext highlighter-rouge">SimpleLaunch</code> will detect its name and forward it to <code class="language-plaintext highlighter-rouge">GazeboBridge</code> functions.</p>

<p>If <code class="language-plaintext highlighter-rouge">full_world</code> is a raw string then the world will be saved into this file after the delay. This will include any URDF that was spawned in between.</p>

<h3 id="spawn-a-model">Spawn a model</h3>

<p>The following function allows easily spawing a model from its <code class="language-plaintext highlighter-rouge">robot_description</code>:</p>

<p><code class="language-plaintext highlighter-rouge">sl.spawn_gz_model(name, topic, model_file = None, spawn_args = [], only_new = True)</code></p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">name</code> is the name this model will get in Gazebo</li>
  <li>
<code class="language-plaintext highlighter-rouge">topic</code> is the topic to obtain the model from, default is <code class="language-plaintext highlighter-rouge">robot_description</code> (relative to the current namespace)</li>
  <li>
<code class="language-plaintext highlighter-rouge">model_file</code> is the path to the (urdf or sdf) file. If defined then this will spawn this model and ignore the topic</li>
  <li>
<code class="language-plaintext highlighter-rouge">only_new</code> if True, will not spawn the model if it already exists in a running Gazebo instance</li>
  <li>
<code class="language-plaintext highlighter-rouge">spawn_args</code> are any additional spawn arguments, e.g. the initial pose</li>
</ul>

<p><strong>example:</strong> <code class="language-plaintext highlighter-rouge">sl.spawn_gz_model('my_robot', model_file = sl.find('my_pkg', 'my_model.urdf'))</code></p>

<h3 id="declare-initial-pose">Declare initial pose</h3>

<p>Calling <code class="language-plaintext highlighter-rouge">sl.declare_gazebo_axes()</code> will declare all 6 parameters <code class="language-plaintext highlighter-rouge">(x,y,z,roll,pitch,yaw)</code> with <code class="language-plaintext highlighter-rouge">0</code> as default values.
If any axis is given (e.g. <code class="language-plaintext highlighter-rouge">sl.declare_gazebo_axes(yaw = 3.14)</code> then only this parameter will be declared.</p>

<p>Such parameters can be retrieved through <code class="language-plaintext highlighter-rouge">sl.gazebo_axes_args()</code>. As a consequence, it is easy to spawn a model with:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sl.declare_gazebo_axes()
sl.robot_description(...)
sl.spawn_gz_model(name, spawn_args = sl.gazebo_axes_args())

</code></pre></div></div>

<h3 id="save-current-world">Save current world</h3>

<p>If the simulation is reset after some models have been spawned, they will disappear. A convenient way to avoid this is to generate the full SDF world from a running simulation. The Gazebo GUI is able to export the current world but cannot resolve models that were spawned from e.g. a <code class="language-plaintext highlighter-rouge">robot_description</code> topic.</p>

<p>The script <code class="language-plaintext highlighter-rouge">generate_gz_world</code> will generate a SDF corresponding to the current simulation. If some models have been spawned from URDF and topics, the script will get the corresponding description and insert it into the SDF, assuming robot <code class="language-plaintext highlighter-rouge">name</code> has its description under <code class="language-plaintext highlighter-rouge">/name/robot_description</code>. It can also be called from a launch file with (see Gazebo example):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># you might want to add a delay to be sure all models have been spawned
sl.save_gz_world(full_world.sdf, after = 1.)

</code></pre></div></div>

<p>Such a self-contained SDF world file is then compatible with a reset of the simulation. See Gazebo example for launch file that checks if the full world is available.</p>

<h3 id="gazebo-bridge">Gazebo bridge</h3>

<p>The <code class="language-plaintext highlighter-rouge">GazeboBridge</code> class allows easily creating bridges when using Gazebo.</p>

<p>An instance is created with: <code class="language-plaintext highlighter-rouge">bridge = GazeboBridge(&lt;gazebo_topic&gt;, &lt;ros_topic&gt;, &lt;ros_message&gt;, direction, &lt;gz_message&gt; = None)</code> where <code class="language-plaintext highlighter-rouge">direction</code> is either:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.gz2ros</code> for Gazebo -&gt; ROS</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.ros2gz</code> for ROS -&gt; Gazebo</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.bidirectional</code> for both</li>
</ul>

<p>The Gazebo message type is <a href="https://github.com/gazebosim/ros_gz/tree/ros2/ros_gz_bridge">deduced from the ROS message type</a> if not set. Remapping will be set to the given <code class="language-plaintext highlighter-rouge">ros_topic</code>.</p>

<p>The SimpleLauncher instance can then run a node dealing with declared bridges, as illustrated in the examples at this end of this document.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">sl.create_gz_bridge([bridges], &lt;node_name&gt;)
</code></li>
</ul>

<p>If some bridges involve <code class="language-plaintext highlighter-rouge">sensor_msgs/Image</code> then a dedicated <code class="language-plaintext highlighter-rouge">ros_gz_image</code> bridge will be used. The corresponding <code class="language-plaintext highlighter-rouge">camera_info</code> topic will be also bridged.</p>

<h3 id="interaction-with-gazebo-sim">Interaction with Gazebo sim</h3>

<p>Some bridges (e.g. <code class="language-plaintext highlighter-rouge">joint_states</code>) need to have information on the world name. This name can only be obtained while Gazebo is running, or by having a priori knowledge of the world file.</p>

<p>The <code class="language-plaintext highlighter-rouge">GazeboBridge</code> class has a few static methods to get information on the simulated world, namely:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.world()</code> returns the current world name</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.set_world_name(world)</code> imposes the world name</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.model_prefix(model)</code> builds the Gazebo topic relative to the given model <code class="language-plaintext highlighter-rouge">/world/&lt;world&gt;/model/&lt;model&gt;</code>
</li>
</ul>

<p>They can be used under these conditions:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">sl.gz_launch</code> was called first (in the same launch setup) and the world file could be parsed, in this case the world name from the file is used</li>
  <li>or <code class="language-plaintext highlighter-rouge">GazeboBridge.set_world_name(world)</code> was called first (in the same launch setup), in this case this world name is used</li>
  <li>if none of the above and a <strong>running Gazebo</strong> instance exists, in this case <code class="language-plaintext highlighter-rouge">GazeboBridge</code> will request information on the world</li>
</ul>

<p>If none of these conditions hold, the launch file will not be able to get information on the world, and launch fill probably fail.</p>

<h3 id="built-in-bridges">Built-in bridges</h3>

<p>A common instance of the bridge is the clock. This one can be:</p>

<ul>
  <li>created with <code class="language-plaintext highlighter-rouge">GazeboBridge.clock()</code>: returns a <code class="language-plaintext highlighter-rouge">GazeboBridge</code> instance, not added to any node yet</li>
  <li>or run directly with <code class="language-plaintext highlighter-rouge">sl.create_gz_clock_bridge()</code> (actually runs <code class="language-plaintext highlighter-rouge">sl.create_gz_bridge(GazeboBridge.clock())</code>)</li>
</ul>

<p>Another common but tedious bridge instance is the joint state topic of a given model. This topic includes, in Gazebo, the name of the world <em>and</em> of the model. Assuming the world name is known, the corresponding bridge can be created with:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">GazeboBridge.joint_states_bridge(model)</code></li>
  <li>actually runs <code class="language-plaintext highlighter-rouge">GazeboBridge('/world/&lt;world&gt;/model/&lt;model&gt;/joint_state', 'joint_states', 'sensor_msgs/JointState', GazeboBridge.gz2ros)</code>
</li>
</ul>

<h3 id="world-tf-publisher">World TF publisher</h3>

<p>If <code class="language-plaintext highlighter-rouge">/tf</code> is used with Gazebo, then the root frame used by Gazebo depends on the world name. This frame is usually <code class="language-plaintext highlighter-rouge">world</code> on the ROS side.
A trivial <code class="language-plaintext highlighter-rouge">static_transform_publisher</code> is run to connect these two frames if they have different names:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">sl.gz_world_tf(world_frame = None)</code>: run a <code class="language-plaintext highlighter-rouge">static_transform_publisher</code> from <code class="language-plaintext highlighter-rouge">world</code> to <code class="language-plaintext highlighter-rouge">world_frame</code>. If <code class="language-plaintext highlighter-rouge">None</code> then detect the one currently used by Gazebo.</li>
</ul>

<h2 id="examples">Examples</h2>

<p>Examples can be found in the corresponding folder.</p>

<h3 id="launch-with-arguments">Launch with arguments</h3>

<p>Here is a file spawning a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> and its <code class="language-plaintext highlighter-rouge">joint_state_publisher</code>, where:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">prefix</code>, <code class="language-plaintext highlighter-rouge">x</code> and <code class="language-plaintext highlighter-rouge">y</code> are launch arguments that are passed to xacro</li>
  <li>
<code class="language-plaintext highlighter-rouge">use_gui</code> tells whether <code class="language-plaintext highlighter-rouge">joint_state_publisher</code> should run the gui</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():
    '''
    Launch description for a single robot - runs the two nodes in their own namespace
    '''
    sl = SimpleLauncher()

    sl.declare_arg('prefix', default_value = '', description='name of the robot (+ tf prefix)')
    sl.declare_arg('x', default_value = 0, description='x-offset of the robot')
    sl.declare_arg('y', default_value = 0, description='y-offset of the robot')
    sl.declare_arg('use_gui', default_value = True, description='Use JSP gui')

    xacro_args = sl.arg_map('prefix', 'x', 'y')
    xacro_args['prefix'] += '/'  # can sum substitutions and strings

    with sl.group(ns=sl.arg('prefix')):
        sl.robot_state_publisher('simple_launch', 'turret.xacro', xacro_args = xacro_args)
        sl.joint_state_publisher(use_gui = sl.arg('use_gui'))

    return sl.launch_description()

</code></pre></div></div>

<h3 id="conditional-blocks-and-includes">Conditional blocks and includes</h3>

<p>The file below fires up either <code class="language-plaintext highlighter-rouge">robot1</code> or <code class="language-plaintext highlighter-rouge">robot2</code> (or both) and also has a boolean argument to spawn <code class="language-plaintext highlighter-rouge">RViz2</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():

    sl = SimpleLauncher()

    # conditional args
    sl.declare_arg('robot1', default_value=True, description='use robot 1')
    sl.declare_arg('robot2', default_value=True, description='use robot 2')
    sl.declare_arg('no_robot2', default_value=False, description='cancel use of robot 2')
    sl.declare_arg('rviz', default_value=True, description='Bringup RViz2')

    # numeric args
    sl.declare_arg('robot2_x', default_value=1, description='x-offset of robot 2')
    sl.declare_arg('robot2_y', default_value=1, description='y-offset of robot 2')

    with sl.group(if_arg='robot1'):
        sl.include('simple_launch', 'included_launch.py',
                   launch_arguments = {'prefix': 'robot1'})

    with sl.group(if_arg='robot2'):

        with sl.group(unless_arg='no_robot2'):

            args = {'prefix': 'robot2', 'x':sl.arg('robot2_x'), 'y': sl.arg('robot2_y')}
            sl.include('simple_launch', 'included_launch.py', launch_arguments=args)

    with sl.group(if_arg='rviz'):
        rviz_config = sl.find('simple_launch', 'turret.rviz')
        sl.node('rviz2', 'rviz2', arguments = ['-d', rviz_config])

    return sl.launch_description()

</code></pre></div></div>

<h3 id="conditions-with-opaquefunction">Conditions with OpaqueFunction</h3>

<p>The file below does the same as the previous one, but using an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

# declare simple launcher and the launch arguments in the main body
sl = SimpleLauncher()

# conditional args
sl.declare_arg('robot1', default_value=True, description='use robot 1')
sl.declare_arg('robot2', default_value=True, description='use robot 2')
sl.declare_arg('no_robot2', default_value=False, description='cancel use of robot 2')
sl.declare_arg('rviz', default_value=True, description='Bringup RViz2')

# numeric args
sl.declare_arg('robot2_x', default_value=1, description='x-offset of robot 2')
sl.declare_arg('robot2_y', default_value=1, description='y-offset of robot 2')

# string args
sl.declare_arg('included', default_value = 'included_launch')


# define the opaque function, context will be wrapped in the SimpleLauncher instance
def launch_setup():

    # we can use raw if as `robot1` argument is performed to a Boolean
    if sl.arg('robot1'):
        sl.include('simple_launch', 'included_launch.py', launch_arguments = {'prefix': 'robot1'})

    # and even combine conditions
    if sl.arg('robot2') and not sl.arg('no_robot2'):

            args = {'prefix': 'robot2', 'x':sl.arg('robot2_x'), 'y': sl.arg('robot2_y')}
            # summing up args and strings
            sl.include('simple_launch', sl.arg('included') + '.py', launch_arguments=args)

    if sl.arg('rviz'):
        rviz_config = sl.find('simple_launch', 'turret.rviz')
        sl.node('rviz2', 'rviz2', arguments = ['-d', rviz_config])

    return sl.launch_description()


# tell SimpleLauncher to rely on the opaque_function in the launch description
# /!\ no `def generate_launch_description():`

generate_launch_description = sl.launch_description(opaque_function = launch_setup)

</code></pre></div></div>

<h3 id="combining-conditions">Combining conditions</h3>

<p>The file below shows how to use <code class="language-plaintext highlighter-rouge">sl.py_eval</code> to combine conditions. We have to build a valid Python expression, not forgetting the spaces around <code class="language-plaintext highlighter-rouge">and</code>, <code class="language-plaintext highlighter-rouge">or</code>, <code class="language-plaintext highlighter-rouge">not</code>, etc.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():

    sl = SimpleLauncher()

    cond1 = sl.declare_arg('cond1', True)
    cond2 = sl.declare_arg('cond2', False)

    for logic in ('and', 'or'):

        # builds &lt;cond1&gt; &lt;logic&gt; &lt;cond2&gt; Python expression
        combined = sl.py_eval(cond1, f' {logic} ', cond2)

        sl.log_info([f'{logic} condition is ', combined])

        with sl.group(if_condition = combined):
            sl.node('demo_nodes_cpp', 'talker', name = f'talker_{logic}')

        # also works with sl.node(..., condition = IfCondition(combined))

    return sl.launch_description()

</code></pre></div></div>

<h3 id="composition">Composition</h3>

<p>The file below is another way to write the <a href="https://index.ros.org/doc/ros2/Tutorials/Composition/#composition-using-launch-actions">composition launch example</a>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():

    sl = SimpleLauncher()

    with sl.container(name='my_container', output='screen'):
        sl.node(package='composition', plugin='Talker', name='talker')
        sl.node(package='composition', plugin='Listener', name='listener')

    return sl.launch_description()

</code></pre></div></div>

<h3 id="events-and-parameters">Events and parameters</h3>

<p>This <a href="https://github.com/oKermorgant/simple_launch/tree/devel/example/event_tutorial_launch.py">example file</a> is another way to write the <a href="https://docs.ros.org/en/rolling/Tutorials/Intermediate/Launch/Using-Event-Handlers.html">event launch example</a>. If does a little more work and is a little smarter, as the passed <code class="language-plaintext highlighter-rouge">new_background_r</code> is applied as soon as it has a valid value.</p>

<h3 id="auto-sim-time">auto sim time</h3>

<p>Here we run Gazebo and force all other nodes to <code class="language-plaintext highlighter-rouge">use_sim_time:=True</code>, unless this file is included from another one with <code class="language-plaintext highlighter-rouge">use_sim_time:=False</code>.
This is unlikely as this launch file spawns a simulator.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher, GazeboBridge

def generate_launch_description():

    # all nodes in this launch file will use_sim_time:=True
    sl = SimpleLauncher(use_sim_time=True)

    # run Gazebo + clock bridge
    sl.gz_launch(&lt;path/to/some/sdf/world&gt;, '-r')
    sl.create_gz_clock_bridge()

    # run other nodes with sim time

    return sl.launch_description()


</code></pre></div></div>

<h3 id="robot-description-and-conditionnal-gazebo-bridge">Robot description and conditionnal Gazebo bridge</h3>

<p>The file below only runs by default a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> with <code class="language-plaintext highlighter-rouge">use_sim_time:=False</code>.
However, if it is included from another file with <code class="language-plaintext highlighter-rouge">use_sim_time:=True</code> then it also spawns the robot into Gazebo and runs two bridges for joint states and pose.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher, GazeboBridge

def generate_launch_description():

    sl = SimpleLauncher(use_sim_time=False)

    # namespace is a launch argument, not a Python string
    sl.declare_arg('robot', default_value = 'robot1')
    robot = sl.arg('robot')

    with sl.group(ns = robot):
        # robot_state_publisher is always run
        sl.robot_state_publisher('my_description', 'my_robot.xacro')

        with sl.group(if_condition = sl.sim_time):
            # only execute this group if use_sim_time was set to True

            # spawn in Gazebo at default pose if not already here
            sl.spawn_gz_model(robot)

            # create a bridge for joint states @ /world/&lt;world&gt;/model/&lt;robot&gt;/joint_state
            # note the relative ROS topic 'joint_states' that is actually namespaced
            gz_js_topic = GazeboBridge.model_prefix(robot)/'joint_state'
            js_bridge = GazeboBridge(gz_topic = gz_js_topic,
                                     ros_topic = 'joint_states',
                                     msg = 'sensor_msgs/JointState',
                                     direction = GazeboBridge.gz2ros)

            # pose publisher bridge @ /model/&lt;robot&gt;
            pose_bridge = GazeboBridge('/model'/robot/'/pose',
                                       'pose_gt', 'geometry_msgs/Pose', GazeboBridge.gz2ros)

            # create bridge node with these two topics with default name gz_bridge
            sl.create_gz_bridge([js_bridge, pose_bridge])

    return sl.launch_description()


</code></pre></div></div>

<h3 id="full-gazebo-simulation">Full Gazebo simulation</h3>

<p>The file <code class="language-plaintext highlighter-rouge">example/gazebo/gazebo_launch.py</code> runs a basic simulation of a turret robot with a camera, also displayed in RViz.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch simple_launch gazebo_launch.py

</code></pre></div></div>

<p>You can move the robot around with a joint velocity setpoint (<code class="language-plaintext highlighter-rouge">std_msgs/Float64</code>) on <code class="language-plaintext highlighter-rouge">/turret/joint#</code> and see the simulated camera on <code class="language-plaintext highlighter-rouge">/turret/image</code>.</p>

<h2 id="i-want-more-examples">I want more examples</h2>

<p>Other self-contained examples (and slides) have been used to teach the ROS 2 launch file system and the nav stack.</p>

<p>Various aspects of the launch systen are shown in the <a href="https://github.com/oKermorgant/anf_launch">anf_launch</a> package.</p>

<p>A simple tutorial on <code class="language-plaintext highlighter-rouge">Nav2</code>  using <code class="language-plaintext highlighter-rouge">simple_launch</code> is available in the <a href="https://github.com/oKermorgant/anf_nav">anf_nav</a> package.</p>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <em>No CONTRIBUTING.md found.</em>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-jazzy">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/simple_launch">simple_launch</a> <small>repository</small></h3>
        
        
        <a class="label label-primary pkg-label" href="/p/simple_launch">simple_launch</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-oKermorgant-simple_launch
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-oKermorgant-simple_launch" role="menuitem" tabindex="-1" href="/r/simple_launch/github-oKermorgant-simple_launch" data="github-oKermorgant-simple_launch">
                    <span class="glyphicon glyphicon-star"></span>
                    github-oKermorgant-simple_launch
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">This package provides a Python class to help writing ROS 2 launch files.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/oKermorgant/simple_launch.git">https://github.com/oKermorgant/simple_launch.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">devel</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-02-16
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/simple_launch/#jazzy-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/simple_launch/#jazzy-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/simple_launch/#jazzy-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/simple_launch">simple_launch</a></td>
                    <td>1.11.0</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="simple_launch">simple_launch</h1>
<p>This package provides a Python class to help writing ROS 2 launch files.</p>

<p>The motivation behind this package is that the ROS 2 launch Python syntax may not be suited for many simple cases such as running basic nodes, spawning a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code>, and grouping nodes in namespaces or components.</p>

<p><strong>Thanks</strong>: this package is inspired by <a href="https://github.com/bponsler/ros2_launch_util">ros2_launch_util</a>.</p>

<p>The entry point is the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> class, which has several capabilities.</p>

<h2 id="basic-syntax">Basic syntax</h2>

<h3 id="namespace-and-argument-parser-initialization">Namespace and argument parser initialization</h3>

<p><code class="language-plaintext highlighter-rouge">sl = SimpleLauncher(namespace = '', use_sim_time = None, scope_included_files = False)</code></p>

<ul>
  <li>will initialize all nodes relative to the given namespace</li>
  <li>if <code class="language-plaintext highlighter-rouge">use_sim_time</code> is a Boolean, creates a <code class="language-plaintext highlighter-rouge">use_sim_time</code> launch argument with this value as the default and forwards it to all nodes, unless explicitely specified when running the node</li>
  <li>if <code class="language-plaintext highlighter-rouge">use_sim_time</code> is <code class="language-plaintext highlighter-rouge">'auto'</code>, then <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> will set it to <code class="language-plaintext highlighter-rouge">True</code> if the <code class="language-plaintext highlighter-rouge">/clock</code> topic is advertized (case of an already running simulation). <strong>This may have side effects if the <code class="language-plaintext highlighter-rouge">/clock</code> topic is advertized but you want to use this launch file with system clock</strong>.</li>
  <li>if <code class="language-plaintext highlighter-rouge">use_sim_time</code> is <code class="language-plaintext highlighter-rouge">None</code> (default) then no particular value is forwarded to the nodes</li>
  <li>if <code class="language-plaintext highlighter-rouge">scope_included_files</code> is <code class="language-plaintext highlighter-rouge">False</code> (default) then including another launch file that shares the same argument but while passing another value for this argument, will also <a href="https://robotics.stackexchange.com/questions/98997/ros2-foxy-python-launch-argument-scope-when-nesting-launch-files">modify the value of this argument after the inclusion</a>. This is the default behavior of <code class="language-plaintext highlighter-rouge">launch</code> but can be undesired. Inside an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code> the behavior is to be scoped anyway (the argument value is resolved) and <code class="language-plaintext highlighter-rouge">scope_included_files</code> has no effect.</li>
</ul>

<h3 id="node-registration">Node registration</h3>

<p><code class="language-plaintext highlighter-rouge">sl.node(package, executable, **node_args)</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">package</code> is the node package</li>
  <li>
<code class="language-plaintext highlighter-rouge">executable</code> is the name of the executable</li>
  <li>
<code class="language-plaintext highlighter-rouge">node_args</code> are any additional <code class="language-plaintext highlighter-rouge">Node</code> arguments</li>
</ul>

<h3 id="launch-file-include">Launch file include</h3>

<p><code class="language-plaintext highlighter-rouge">sl.include(package, launch_file, launch_dir = None, launch_arguments=None)</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">package</code> is the package of the included launch file</li>
  <li>
<code class="language-plaintext highlighter-rouge">launch_file</code> is the name of the launch file</li>
  <li>
<code class="language-plaintext highlighter-rouge">launch_dir</code> is its directory inside the package share (<code class="language-plaintext highlighter-rouge">None</code> to have it found)</li>
  <li>
<code class="language-plaintext highlighter-rouge">launch_arguments</code> is a dictionary of arguments to pass to the included launch file</li>
</ul>

<h3 id="call-a-service-at-launch">Call a service at launch</h3>

<p>This line runs a temporary client that waits for a service and calls it when available:</p>

<p><code class="language-plaintext highlighter-rouge">sl.call_service(server, request = None, verbosity = '')</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">server</code> is the path to some service (possibly namespaced). The service type is deduced when it becomes available.</li>
  <li>
<code class="language-plaintext highlighter-rouge">request</code> is a dictionary representing the service request. If <code class="language-plaintext highlighter-rouge">None</code> or incomplete, will use the service request default values.</li>
  <li>
<code class="language-plaintext highlighter-rouge">verbosity</code> let the underlying node describe what it is doing: <code class="language-plaintext highlighter-rouge">'req'</code> for request info, <code class="language-plaintext highlighter-rouge">'res'</code> for response info or both with <code class="language-plaintext highlighter-rouge">'reqres'</code>
</li>
</ul>

<p>If any request parameter is <code class="language-plaintext highlighter-rouge">__ns</code> it will be changed to the current namespace.</p>

<h3 id="setting-parameters">Setting parameters</h3>

<p>This line runs a temporary client that waits for a node and changes its parameters when available:</p>

<p><code class="language-plaintext highlighter-rouge">sl.set_parameters(node_name, parameters: dict = {}, verbosity = '')</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">node_name</code> is the name of the node (possibly namespaced)</li>
  <li>
<code class="language-plaintext highlighter-rouge">parameters</code> is a dictionary of (name, value) parameters to be set</li>
  <li>
<code class="language-plaintext highlighter-rouge">verbosity</code> let the underlying node describe what it is doing: <code class="language-plaintext highlighter-rouge">'req'</code> for request info, <code class="language-plaintext highlighter-rouge">'res'</code> for response info or both with <code class="language-plaintext highlighter-rouge">'reqres'</code>
</li>
</ul>

<p>This calls the <code class="language-plaintext highlighter-rouge">set_parameters</code> service of the node with the passed types. Possible errors may happen if the parameters do not exist or are of a different type.</p>

<h3 id="robust-types-for-parameters">Robust types for parameters</h3>

<p>In the launch API, differents types are expected for:</p>

<ul>
  <li>node parameters: a list of dictionaries</li>
  <li>node remappings: a list of (<code class="language-plaintext highlighter-rouge">key</code>, <code class="language-plaintext highlighter-rouge">value</code>) pairs</li>
  <li>included launch arguments: a list of (<code class="language-plaintext highlighter-rouge">key</code>, <code class="language-plaintext highlighter-rouge">value</code>) pairs</li>
  <li>xacro arguments: a concatenation of <code class="language-plaintext highlighter-rouge">key:=value</code> strings</li>
</ul>

<p>The <code class="language-plaintext highlighter-rouge">sl.include</code>, <code class="language-plaintext highlighter-rouge">sl.node</code> and <code class="language-plaintext highlighter-rouge">xacro_args</code> calls allow using any type (the simplest being a single dictionary)  and will convert to the one expected by the API.</p>

<h2 id="launch-arguments">Launch arguments</h2>

<p><code class="language-plaintext highlighter-rouge">simple_launch</code> allows declaring launch arguments and getting them in return.</p>

<h3 id="declare-a-launch-argument">Declare a launch argument</h3>

<p><code class="language-plaintext highlighter-rouge">sl.declare_arg(name, default_value, description = None)</code>: declare and returns the argument</p>

<p>Contrary to the base API, the default value is a raw Python type.</p>

<h3 id="retrieve-a-launch-argument">Retrieve a launch argument</h3>

<p><code class="language-plaintext highlighter-rouge">sl.arg(name)</code>: returns the argument <code class="language-plaintext highlighter-rouge">name</code> as a <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code></p>

<h3 id="retrieve-several-arguments-as-a-dictionary">Retrieve several arguments as a dictionary</h3>

<p><code class="language-plaintext highlighter-rouge">sl.arg_map('robot', 'x', 'y')</code>: returns <code class="language-plaintext highlighter-rouge">{'robot': &lt;robot arg value&gt;, 'x': &lt;x arg value&gt;, 'y': &lt;y arg value&gt;}</code></p>

<p>Typical when forwarding some launch arguments to a node or an included launch file.</p>

<h2 id="groups-or-scopes">Groups or scopes</h2>

<p>Groups are created through the <code class="language-plaintext highlighter-rouge">with sl.group():</code> syntax and accept, a namespace an if/unless condition and an event.</p>

<p>Actions that are added in a scope inherit from all previous defined groups.</p>

<h3 id="by-namespace">By namespace</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(ns=sub_namespace):
    sl.node(package, executable)

</code></pre></div></div>

<h3 id="from-a-condition">From a condition</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(if_condition=True):
    sl.node(package, executable)

  with sl.group(unless_condition=&lt;some expression&gt;):
    sl.node(package, executable)

</code></pre></div></div>

<ul>
  <li>Only one condition can be set in a group, nested condition must be combined first, or used in nested groups.</li>
  <li>Combining conditions coming from launch arguments can be done with <code class="language-plaintext highlighter-rouge">sl.py_eval</code> as shown below.</li>
</ul>

<h3 id="from-conditional-arguments">From conditional arguments</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(if_arg='use_gui'):
    sl.node(package, executable)

  with sl.group(unless_arg='dont_do'):
    sl.node(package, executable)

</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">if_arg</code> / <code class="language-plaintext highlighter-rouge">unless_arg</code> is expected to be the name of a launch argument. These two lines are equivalent:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(if_arg='use_gui'):
  with sl.group(if_condition=sl.arg('use_gui')):

</code></pre></div></div>
<p>If <code class="language-plaintext highlighter-rouge">if_arg</code> / <code class="language-plaintext highlighter-rouge">unless_arg</code> is not a string then it is considered as a <code class="language-plaintext highlighter-rouge">if_condition</code> / <code class="language-plaintext highlighter-rouge">unless_condition</code>.</p>

<h3 id="from-events">From events</h3>

<p>The <code class="language-plaintext highlighter-rouge">when</code> argument wraps events from the <code class="language-plaintext highlighter-rouge">launch.event_handlers</code> module. It combines an event and a delay (0 by default)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch.events import When, OnProcessStart, OnProcessExit, OnProcessIO

  my_node = sl.node(...)   # reference node

  with sl.group(when = When(my_node, OnProcessStart, 1.)):
      sl.node(...)  # will run 1 s after main node starts

  with sl.group(when = When(my_node, OnProcessExit)):
      sl.node(...)  # will run as soon as the main node exists

  with sl.group(when = When(my_node, OnProcessIO, io = 'stdout'):
      # OnProcessIO events need a function changing the event into an action
      sl.add_action(lambda event: LogInfo(msg = 'Node says "{}"'.format(
                      event.text.decode().strip())))
      # several functions can be used if needed, they will be combined in a single one
      sl.add_action(lambda event: LogInfo(msg = 'Once again, node says "{}"'.format(
                      event.text.decode().strip())))

  with sl.group(when = When(delay = 2.)):
      sl.node(...)  # will run after 2 sec

</code></pre></div></div>

<h3 id="creating-containers">Creating containers</h3>

<p>This syntax adds the <code class="language-plaintext highlighter-rouge">composition/composition::Talker</code> as a ComposableNode</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.container(name='my_container', output='screen'):
    sl.node(package='composition', plugin='Talker', name='talker')

</code></pre></div></div>

<p>Use the <code class="language-plaintext highlighter-rouge">executable</code> and <code class="language-plaintext highlighter-rouge">package</code> parameters if you want to use executors other than <code class="language-plaintext highlighter-rouge">rclcpp_components</code>â€™s <code class="language-plaintext highlighter-rouge">component_container</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.container(name='my_container', output='screen', executable='component_container_isolated'):

</code></pre></div></div>

<p><strong><em>It is currently impossible to have group blocks within a container block, as containers can only accept <code class="language-plaintext highlighter-rouge">ComposableNode</code>s</em></strong>. A <code class="language-plaintext highlighter-rouge">GroupAction</code> containing e.g. <code class="language-plaintext highlighter-rouge">PushRosNamespace</code> and a <code class="language-plaintext highlighter-rouge">ComposableNode</code> is not itself a <code class="language-plaintext highlighter-rouge">ComposableNode</code>.</p>

<h2 id="use_sim_time"><code class="language-plaintext highlighter-rouge">use_sim_time</code></h2>

<p>The current <code class="language-plaintext highlighter-rouge">use_sim_time</code> setting can be retrieved through <code class="language-plaintext highlighter-rouge">sl.sim_time</code> that may be:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">None</code>, if <code class="language-plaintext highlighter-rouge">use_sim_time</code> was not set in the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> constructor</li>
  <li>a raw Boolean, if <code class="language-plaintext highlighter-rouge">use_sim_time</code> was set to <code class="language-plaintext highlighter-rouge">'auto'</code>, depending on the <code class="language-plaintext highlighter-rouge">/clock</code> topic being advertized</li>
  <li>a Boolean launch argument, if <code class="language-plaintext highlighter-rouge">use_sim_time</code> was set to <code class="language-plaintext highlighter-rouge">True</code> or <code class="language-plaintext highlighter-rouge">False</code>
</li>
</ul>

<p>In all cases, if the <code class="language-plaintext highlighter-rouge">use_sim_time</code> parameter is explicitely given to a node, it will be used instead of the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> instance one.</p>

<h2 id="opaquefunction-with-implicit-performcontext">
<code class="language-plaintext highlighter-rouge">OpaqueFunction</code> with implicit <code class="language-plaintext highlighter-rouge">.perform(context)</code>
</h2>

<p>Most of the use cases can be dealt with substitutions and <code class="language-plaintext highlighter-rouge">with sl.group</code> blocks.
In order to design more imperative launch files, the <a href="https://discourse.ros.org/t/simplifying-launch-argument-declaration-and-initialization-in-launch-files/24204"><code class="language-plaintext highlighter-rouge">OpaqueFunction</code></a> approach can be used. The main drawback is that potential errors are harder to track.</p>

<p>To do this with <code class="language-plaintext highlighter-rouge">simple_launch</code>:</p>

<ul>
  <li>the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> instance and the argument declaration should be done in the main body of your launch file.</li>
  <li>then, define a function (e.g. <code class="language-plaintext highlighter-rouge">launch_setup</code>) that takes no argument, where the logic of the launch file resides.</li>
  <li>all arguments obtained through <code class="language-plaintext highlighter-rouge">sl.arg</code> will be basic Python types, obtained from performing the substitutions.</li>
  <li>finally just export <code class="language-plaintext highlighter-rouge">generate_launch_description = sl.launch_description(opaque_function = launch_setup)</code>.</li>
</ul>

<p>Compare <a href="https://github.com/oKermorgant/simple_launch/tree/devel/example/example_launch.py"><code class="language-plaintext highlighter-rouge">example_launch.py</code></a> and <a href="https://github.com/oKermorgant/simple_launch/tree/devel/example/example_opaque_launch.py"><code class="language-plaintext highlighter-rouge">example_opaque_launch.py</code></a> to see the two approaches on the same logic.</p>

<p>Note that inside an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code> the if/unless idiom reduces to a basic if/else:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># with substitutions
with sl.group(if_arg='some_condition'):
  # do stuff
with sl.group(unless_arg='some_condition'):
  # do other stuff

# with opaque function
if sl.arg('some_condition'):
  # do stuff
else:
  # do other stuff

</code></pre></div></div>

<h2 id="other-one-liners">Other one-liners</h2>

<p>Methods listed below return instances of <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code> that represent any Substitution, but that provides concatenation (<code class="language-plaintext highlighter-rouge">+</code>) and path concatenation (<code class="language-plaintext highlighter-rouge">/</code>) operators. It is still a <code class="language-plaintext highlighter-rouge">Substitution</code>, not a raw Python type. If run from an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code> the underlying Python variable is returned.</p>

<h3 id="string--substitution-concatenation">String / substitution concatenation</h3>

<p>The following syntax builds the <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code> corresponding to <code class="language-plaintext highlighter-rouge">&lt;robot arg&gt;.xacro</code>:</p>

<p><code class="language-plaintext highlighter-rouge">file_name = sl.arg('robot') + '.xacro'</code></p>

<p><em>deprecated</em>: <code class="language-plaintext highlighter-rouge">sl.name_join(sl.arg('robot'), '.xacro')</code></p>

<h3 id="path-concatenation">Path concatenation</h3>

<p>The following syntax builds the <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code> corresponding to <code class="language-plaintext highlighter-rouge">&lt;package_path&gt;/urdf/&lt;robot arg&gt;.xacro</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>file_name = sl.arg('robot') + '.xacro'
urdf_file = os.path.join(get_package_share_directory(package),'urdf')/file_name

</code></pre></div></div>
<p>Obviously if all the path elements are raw strings, you should use <code class="language-plaintext highlighter-rouge">os.path.join</code> all along.</p>

<p><em>deprecated</em>: <code class="language-plaintext highlighter-rouge">sl.path_join(get_package_share_directory(package), sl.arg('robot'), '.xacro')</code></p>

<h3 id="find-a-share-file">Find a share file</h3>

<p><code class="language-plaintext highlighter-rouge">path = sl.find(package, file_name = None, file_dir = None)</code> where:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">package</code> is the name of the package or <code class="language-plaintext highlighter-rouge">None</code> if <code class="language-plaintext highlighter-rouge">file_name</code> is already an absolute path</li>
  <li>
<code class="language-plaintext highlighter-rouge">file_name</code> is the name of the file to find</li>
  <li>
<code class="language-plaintext highlighter-rouge">file_dir</code> is the path inside the package</li>
</ul>

<p>If <code class="language-plaintext highlighter-rouge">file_dir</code> is <code class="language-plaintext highlighter-rouge">None</code> but <code class="language-plaintext highlighter-rouge">package</code> and <code class="language-plaintext highlighter-rouge">file_name</code> are raw strings then the <code class="language-plaintext highlighter-rouge">find</code> function will actually look for the file inside the package share, using <code class="language-plaintext highlighter-rouge">os.walk</code>.</p>

<p>If <code class="language-plaintext highlighter-rouge">file_name</code> is <code class="language-plaintext highlighter-rouge">None</code> then the function just returns the path to the package share directory (e.g. <code class="language-plaintext highlighter-rouge">get_package_share_directory(package)</code>)</p>

<h3 id="robot-state-publisher">Robot state publisher</h3>

<p>It is quite common to run a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> from a <code class="language-plaintext highlighter-rouge">urdf</code> or <code class="language-plaintext highlighter-rouge">xacro</code> file. The line below runs it at the current namespace / condition level:</p>

<p><code class="language-plaintext highlighter-rouge">sl.robot_state_publisher(package, description_file, description_dir=None, xacro_args=None, **node_args)</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">description_file</code> is a URDF or xacro file</li>
  <li>
<code class="language-plaintext highlighter-rouge">description_dir</code> is the sub-directory of the file. If omitted, let the script search for the file assuming it is a raw string</li>
  <li>
<code class="language-plaintext highlighter-rouge">xacro_args</code> is a dictionary of arguments to forward to xacro</li>
  <li>
<code class="language-plaintext highlighter-rouge">node_args</code> are any additional arguments for <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> (remappings / parameters)</li>
</ul>

<h3 id="python-expressions">Python expressions</h3>

<p><code class="language-plaintext highlighter-rouge">sl.py_eval</code> will evaluate the given arguments as a Python expression, possibly performed if in an Opaque Function.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># RGB color as a list of [0-255] integers
sl.declare_arg('color', [255,0,0])
# same color as a string of [0-1] numbers (URDF format), note the padding commas to get a string
xacro_color = "'" + sl.py_eval("' '.join(str(c/255) for c in ", sl.arg('color'), ')') + "'"

</code></pre></div></div>

<h3 id="conditions">Conditions</h3>

<p><code class="language-plaintext highlighter-rouge">sl.py_eval</code> can be used to combine conditions. It is robust to lower case <code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">false</code> and will return a <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sl.declare_arg('some_condition', True)
opposed = sl.py_eval('not ', sl.arg('some_condition'))

</code></pre></div></div>

<p>Note that <code class="language-plaintext highlighter-rouge">IfCondition</code> and <code class="language-plaintext highlighter-rouge">UnlessCondition</code> cannot be combined, <a href="https://answers.ros.org/answers/414006/revisions/">only the underlying <code class="language-plaintext highlighter-rouge">Substitution</code>s can</a>.</p>

<h3 id="joint-state-publisher">Joint state publisher</h3>

<p><code class="language-plaintext highlighter-rouge">sl.joint_state_publisher(use_gui, **node_args)</code>: fires up a <code class="language-plaintext highlighter-rouge">joint_state_publisher</code>, with or without the gui, in the current namespace.</p>

<h3 id="rviz">Rviz</h3>

<p><code class="language-plaintext highlighter-rouge">sl.rviz(config_file = None, warnings = False)</code>: runs RViz on the given configuration file. If <code class="language-plaintext highlighter-rouge">warnings</code> is <code class="language-plaintext highlighter-rouge">False</code> (default) then runs with <code class="language-plaintext highlighter-rouge">log-level FATAL</code> in order to avoid many messages in the console.</p>

<p>Classical use case: <code class="language-plaintext highlighter-rouge">sl.rviz(sl.find('my_package', 'some_rviz_config.rviz'))</code></p>

<h3 id="fallback-to-low-level-syntax">Fallback to low-level syntax</h3>

<p>If any unavailable functionality is needed, the <code class="language-plaintext highlighter-rouge">sl.add_action(action)</code> function adds any passed <code class="language-plaintext highlighter-rouge">Action</code> at the current namespace / conditional / event level.</p>

<h2 id="interaction-with-gazebo--ignition">Interaction with Gazebo / Ignition</h2>

<p><em>Note: Ignition being renamed to Gazebo, all tools in this section use Gazebo / gz names</em></p>

<p>An effort was made to be robust to Ignition versus Gazebo uses, i.e. <em>ign</em> prefix is used for <code class="language-plaintext highlighter-rouge">foxy</code> and <code class="language-plaintext highlighter-rouge">galactic</code> while <em>gz</em> prefix is used from <code class="language-plaintext highlighter-rouge">humble</code>. <code class="language-plaintext highlighter-rouge">GZ_VERSION</code> and <code class="language-plaintext highlighter-rouge">IGNITION_VERSION</code> environment variables are also used to identify which version should be preferred.</p>

<h3 id="launch-gazebo">Launch Gazebo</h3>

<p>The Gazebo launch file corresponding to the current ROS 2 distribution is launched with</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sl.gz_launch(world_file, gz_arguments, full_world = None, save_after = 5.)

</code></pre></div></div>
<p>Namely, it will redirect to either <code class="language-plaintext highlighter-rouge">ros_ign_gazebo/ign_gazebo.launch.py</code> (<code class="language-plaintext highlighter-rouge">foxy</code>, <code class="language-plaintext highlighter-rouge">galactic</code>) or <code class="language-plaintext highlighter-rouge">ros_gz_sim/gz_sim.launch.py</code> (<code class="language-plaintext highlighter-rouge">humble</code>+).
The given <code class="language-plaintext highlighter-rouge">gz_arguments</code>, if any, will be forwarded either as the <code class="language-plaintext highlighter-rouge">ign_args</code> or <code class="language-plaintext highlighter-rouge">gz_args</code>, accordingly.</p>

<p>If the world file can be parsed then <code class="language-plaintext highlighter-rouge">SimpleLaunch</code> will detect its name and forward it to <code class="language-plaintext highlighter-rouge">GazeboBridge</code> functions.</p>

<p>If <code class="language-plaintext highlighter-rouge">full_world</code> is a raw string then the world will be saved into this file after the delay. This will include any URDF that was spawned in between.</p>

<h3 id="spawn-a-model">Spawn a model</h3>

<p>The following function allows easily spawing a model from its <code class="language-plaintext highlighter-rouge">robot_description</code>:</p>

<p><code class="language-plaintext highlighter-rouge">sl.spawn_gz_model(name, topic, model_file = None, spawn_args = [], only_new = True)</code></p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">name</code> is the name this model will get in Gazebo</li>
  <li>
<code class="language-plaintext highlighter-rouge">topic</code> is the topic to obtain the model from, default is <code class="language-plaintext highlighter-rouge">robot_description</code> (relative to the current namespace)</li>
  <li>
<code class="language-plaintext highlighter-rouge">model_file</code> is the path to the (urdf or sdf) file. If defined then this will spawn this model and ignore the topic</li>
  <li>
<code class="language-plaintext highlighter-rouge">only_new</code> if True, will not spawn the model if it already exists in a running Gazebo instance</li>
  <li>
<code class="language-plaintext highlighter-rouge">spawn_args</code> are any additional spawn arguments, e.g. the initial pose</li>
</ul>

<p><strong>example:</strong> <code class="language-plaintext highlighter-rouge">sl.spawn_gz_model('my_robot', model_file = sl.find('my_pkg', 'my_model.urdf'))</code></p>

<h3 id="declare-initial-pose">Declare initial pose</h3>

<p>Calling <code class="language-plaintext highlighter-rouge">sl.declare_gazebo_axes()</code> will declare all 6 parameters <code class="language-plaintext highlighter-rouge">(x,y,z,roll,pitch,yaw)</code> with <code class="language-plaintext highlighter-rouge">0</code> as default values.
If any axis is given (e.g. <code class="language-plaintext highlighter-rouge">sl.declare_gazebo_axes(yaw = 3.14)</code> then only this parameter will be declared.</p>

<p>Such parameters can be retrieved through <code class="language-plaintext highlighter-rouge">sl.gazebo_axes_args()</code>. As a consequence, it is easy to spawn a model with:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sl.declare_gazebo_axes()
sl.robot_description(...)
sl.spawn_gz_model(name, spawn_args = sl.gazebo_axes_args())

</code></pre></div></div>

<h3 id="save-current-world">Save current world</h3>

<p>If the simulation is reset after some models have been spawned, they will disappear. A convenient way to avoid this is to generate the full SDF world from a running simulation. The Gazebo GUI is able to export the current world but cannot resolve models that were spawned from e.g. a <code class="language-plaintext highlighter-rouge">robot_description</code> topic.</p>

<p>The script <code class="language-plaintext highlighter-rouge">generate_gz_world</code> will generate a SDF corresponding to the current simulation. If some models have been spawned from URDF and topics, the script will get the corresponding description and insert it into the SDF, assuming robot <code class="language-plaintext highlighter-rouge">name</code> has its description under <code class="language-plaintext highlighter-rouge">/name/robot_description</code>. It can also be called from a launch file with (see Gazebo example):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># you might want to add a delay to be sure all models have been spawned
sl.save_gz_world(full_world.sdf, after = 1.)

</code></pre></div></div>

<p>Such a self-contained SDF world file is then compatible with a reset of the simulation. See Gazebo example for launch file that checks if the full world is available.</p>

<h3 id="gazebo-bridge">Gazebo bridge</h3>

<p>The <code class="language-plaintext highlighter-rouge">GazeboBridge</code> class allows easily creating bridges when using Gazebo.</p>

<p>An instance is created with: <code class="language-plaintext highlighter-rouge">bridge = GazeboBridge(&lt;gazebo_topic&gt;, &lt;ros_topic&gt;, &lt;ros_message&gt;, direction, &lt;gz_message&gt; = None)</code> where <code class="language-plaintext highlighter-rouge">direction</code> is either:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.gz2ros</code> for Gazebo -&gt; ROS</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.ros2gz</code> for ROS -&gt; Gazebo</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.bidirectional</code> for both</li>
</ul>

<p>The Gazebo message type is <a href="https://github.com/gazebosim/ros_gz/tree/ros2/ros_gz_bridge">deduced from the ROS message type</a> if not set. Remapping will be set to the given <code class="language-plaintext highlighter-rouge">ros_topic</code>.</p>

<p>The SimpleLauncher instance can then run a node dealing with declared bridges, as illustrated in the examples at this end of this document.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">sl.create_gz_bridge([bridges], &lt;node_name&gt;)
</code></li>
</ul>

<p>If some bridges involve <code class="language-plaintext highlighter-rouge">sensor_msgs/Image</code> then a dedicated <code class="language-plaintext highlighter-rouge">ros_gz_image</code> bridge will be used. The corresponding <code class="language-plaintext highlighter-rouge">camera_info</code> topic will be also bridged.</p>

<h3 id="interaction-with-gazebo-sim">Interaction with Gazebo sim</h3>

<p>Some bridges (e.g. <code class="language-plaintext highlighter-rouge">joint_states</code>) need to have information on the world name. This name can only be obtained while Gazebo is running, or by having a priori knowledge of the world file.</p>

<p>The <code class="language-plaintext highlighter-rouge">GazeboBridge</code> class has a few static methods to get information on the simulated world, namely:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.world()</code> returns the current world name</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.set_world_name(world)</code> imposes the world name</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.model_prefix(model)</code> builds the Gazebo topic relative to the given model <code class="language-plaintext highlighter-rouge">/world/&lt;world&gt;/model/&lt;model&gt;</code>
</li>
</ul>

<p>They can be used under these conditions:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">sl.gz_launch</code> was called first (in the same launch setup) and the world file could be parsed, in this case the world name from the file is used</li>
  <li>or <code class="language-plaintext highlighter-rouge">GazeboBridge.set_world_name(world)</code> was called first (in the same launch setup), in this case this world name is used</li>
  <li>if none of the above and a <strong>running Gazebo</strong> instance exists, in this case <code class="language-plaintext highlighter-rouge">GazeboBridge</code> will request information on the world</li>
</ul>

<p>If none of these conditions hold, the launch file will not be able to get information on the world, and launch fill probably fail.</p>

<h3 id="built-in-bridges">Built-in bridges</h3>

<p>A common instance of the bridge is the clock. This one can be:</p>

<ul>
  <li>created with <code class="language-plaintext highlighter-rouge">GazeboBridge.clock()</code>: returns a <code class="language-plaintext highlighter-rouge">GazeboBridge</code> instance, not added to any node yet</li>
  <li>or run directly with <code class="language-plaintext highlighter-rouge">sl.create_gz_clock_bridge()</code> (actually runs <code class="language-plaintext highlighter-rouge">sl.create_gz_bridge(GazeboBridge.clock())</code>)</li>
</ul>

<p>Another common but tedious bridge instance is the joint state topic of a given model. This topic includes, in Gazebo, the name of the world <em>and</em> of the model. Assuming the world name is known, the corresponding bridge can be created with:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">GazeboBridge.joint_states_bridge(model)</code></li>
  <li>actually runs <code class="language-plaintext highlighter-rouge">GazeboBridge('/world/&lt;world&gt;/model/&lt;model&gt;/joint_state', 'joint_states', 'sensor_msgs/JointState', GazeboBridge.gz2ros)</code>
</li>
</ul>

<h3 id="world-tf-publisher">World TF publisher</h3>

<p>If <code class="language-plaintext highlighter-rouge">/tf</code> is used with Gazebo, then the root frame used by Gazebo depends on the world name. This frame is usually <code class="language-plaintext highlighter-rouge">world</code> on the ROS side.
A trivial <code class="language-plaintext highlighter-rouge">static_transform_publisher</code> is run to connect these two frames if they have different names:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">sl.gz_world_tf(world_frame = None)</code>: run a <code class="language-plaintext highlighter-rouge">static_transform_publisher</code> from <code class="language-plaintext highlighter-rouge">world</code> to <code class="language-plaintext highlighter-rouge">world_frame</code>. If <code class="language-plaintext highlighter-rouge">None</code> then detect the one currently used by Gazebo.</li>
</ul>

<h2 id="examples">Examples</h2>

<p>Examples can be found in the corresponding folder.</p>

<h3 id="launch-with-arguments">Launch with arguments</h3>

<p>Here is a file spawning a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> and its <code class="language-plaintext highlighter-rouge">joint_state_publisher</code>, where:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">prefix</code>, <code class="language-plaintext highlighter-rouge">x</code> and <code class="language-plaintext highlighter-rouge">y</code> are launch arguments that are passed to xacro</li>
  <li>
<code class="language-plaintext highlighter-rouge">use_gui</code> tells whether <code class="language-plaintext highlighter-rouge">joint_state_publisher</code> should run the gui</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():
    '''
    Launch description for a single robot - runs the two nodes in their own namespace
    '''
    sl = SimpleLauncher()

    sl.declare_arg('prefix', default_value = '', description='name of the robot (+ tf prefix)')
    sl.declare_arg('x', default_value = 0, description='x-offset of the robot')
    sl.declare_arg('y', default_value = 0, description='y-offset of the robot')
    sl.declare_arg('use_gui', default_value = True, description='Use JSP gui')

    xacro_args = sl.arg_map('prefix', 'x', 'y')
    xacro_args['prefix'] += '/'  # can sum substitutions and strings

    with sl.group(ns=sl.arg('prefix')):
        sl.robot_state_publisher('simple_launch', 'turret.xacro', xacro_args = xacro_args)
        sl.joint_state_publisher(use_gui = sl.arg('use_gui'))

    return sl.launch_description()

</code></pre></div></div>

<h3 id="conditional-blocks-and-includes">Conditional blocks and includes</h3>

<p>The file below fires up either <code class="language-plaintext highlighter-rouge">robot1</code> or <code class="language-plaintext highlighter-rouge">robot2</code> (or both) and also has a boolean argument to spawn <code class="language-plaintext highlighter-rouge">RViz2</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():

    sl = SimpleLauncher()

    # conditional args
    sl.declare_arg('robot1', default_value=True, description='use robot 1')
    sl.declare_arg('robot2', default_value=True, description='use robot 2')
    sl.declare_arg('no_robot2', default_value=False, description='cancel use of robot 2')
    sl.declare_arg('rviz', default_value=True, description='Bringup RViz2')

    # numeric args
    sl.declare_arg('robot2_x', default_value=1, description='x-offset of robot 2')
    sl.declare_arg('robot2_y', default_value=1, description='y-offset of robot 2')

    with sl.group(if_arg='robot1'):
        sl.include('simple_launch', 'included_launch.py',
                   launch_arguments = {'prefix': 'robot1'})

    with sl.group(if_arg='robot2'):

        with sl.group(unless_arg='no_robot2'):

            args = {'prefix': 'robot2', 'x':sl.arg('robot2_x'), 'y': sl.arg('robot2_y')}
            sl.include('simple_launch', 'included_launch.py', launch_arguments=args)

    with sl.group(if_arg='rviz'):
        rviz_config = sl.find('simple_launch', 'turret.rviz')
        sl.node('rviz2', 'rviz2', arguments = ['-d', rviz_config])

    return sl.launch_description()

</code></pre></div></div>

<h3 id="conditions-with-opaquefunction">Conditions with OpaqueFunction</h3>

<p>The file below does the same as the previous one, but using an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

# declare simple launcher and the launch arguments in the main body
sl = SimpleLauncher()

# conditional args
sl.declare_arg('robot1', default_value=True, description='use robot 1')
sl.declare_arg('robot2', default_value=True, description='use robot 2')
sl.declare_arg('no_robot2', default_value=False, description='cancel use of robot 2')
sl.declare_arg('rviz', default_value=True, description='Bringup RViz2')

# numeric args
sl.declare_arg('robot2_x', default_value=1, description='x-offset of robot 2')
sl.declare_arg('robot2_y', default_value=1, description='y-offset of robot 2')

# string args
sl.declare_arg('included', default_value = 'included_launch')


# define the opaque function, context will be wrapped in the SimpleLauncher instance
def launch_setup():

    # we can use raw if as `robot1` argument is performed to a Boolean
    if sl.arg('robot1'):
        sl.include('simple_launch', 'included_launch.py', launch_arguments = {'prefix': 'robot1'})

    # and even combine conditions
    if sl.arg('robot2') and not sl.arg('no_robot2'):

            args = {'prefix': 'robot2', 'x':sl.arg('robot2_x'), 'y': sl.arg('robot2_y')}
            # summing up args and strings
            sl.include('simple_launch', sl.arg('included') + '.py', launch_arguments=args)

    if sl.arg('rviz'):
        rviz_config = sl.find('simple_launch', 'turret.rviz')
        sl.node('rviz2', 'rviz2', arguments = ['-d', rviz_config])

    return sl.launch_description()


# tell SimpleLauncher to rely on the opaque_function in the launch description
# /!\ no `def generate_launch_description():`

generate_launch_description = sl.launch_description(opaque_function = launch_setup)

</code></pre></div></div>

<h3 id="combining-conditions">Combining conditions</h3>

<p>The file below shows how to use <code class="language-plaintext highlighter-rouge">sl.py_eval</code> to combine conditions. We have to build a valid Python expression, not forgetting the spaces around <code class="language-plaintext highlighter-rouge">and</code>, <code class="language-plaintext highlighter-rouge">or</code>, <code class="language-plaintext highlighter-rouge">not</code>, etc.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():

    sl = SimpleLauncher()

    cond1 = sl.declare_arg('cond1', True)
    cond2 = sl.declare_arg('cond2', False)

    for logic in ('and', 'or'):

        # builds &lt;cond1&gt; &lt;logic&gt; &lt;cond2&gt; Python expression
        combined = sl.py_eval(cond1, f' {logic} ', cond2)

        sl.log_info([f'{logic} condition is ', combined])

        with sl.group(if_condition = combined):
            sl.node('demo_nodes_cpp', 'talker', name = f'talker_{logic}')

        # also works with sl.node(..., condition = IfCondition(combined))

    return sl.launch_description()

</code></pre></div></div>

<h3 id="composition">Composition</h3>

<p>The file below is another way to write the <a href="https://index.ros.org/doc/ros2/Tutorials/Composition/#composition-using-launch-actions">composition launch example</a>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():

    sl = SimpleLauncher()

    with sl.container(name='my_container', output='screen'):
        sl.node(package='composition', plugin='Talker', name='talker')
        sl.node(package='composition', plugin='Listener', name='listener')

    return sl.launch_description()

</code></pre></div></div>

<h3 id="events-and-parameters">Events and parameters</h3>

<p>This <a href="https://github.com/oKermorgant/simple_launch/tree/devel/example/event_tutorial_launch.py">example file</a> is another way to write the <a href="https://docs.ros.org/en/rolling/Tutorials/Intermediate/Launch/Using-Event-Handlers.html">event launch example</a>. If does a little more work and is a little smarter, as the passed <code class="language-plaintext highlighter-rouge">new_background_r</code> is applied as soon as it has a valid value.</p>

<h3 id="auto-sim-time">auto sim time</h3>

<p>Here we run Gazebo and force all other nodes to <code class="language-plaintext highlighter-rouge">use_sim_time:=True</code>, unless this file is included from another one with <code class="language-plaintext highlighter-rouge">use_sim_time:=False</code>.
This is unlikely as this launch file spawns a simulator.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher, GazeboBridge

def generate_launch_description():

    # all nodes in this launch file will use_sim_time:=True
    sl = SimpleLauncher(use_sim_time=True)

    # run Gazebo + clock bridge
    sl.gz_launch(&lt;path/to/some/sdf/world&gt;, '-r')
    sl.create_gz_clock_bridge()

    # run other nodes with sim time

    return sl.launch_description()


</code></pre></div></div>

<h3 id="robot-description-and-conditionnal-gazebo-bridge">Robot description and conditionnal Gazebo bridge</h3>

<p>The file below only runs by default a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> with <code class="language-plaintext highlighter-rouge">use_sim_time:=False</code>.
However, if it is included from another file with <code class="language-plaintext highlighter-rouge">use_sim_time:=True</code> then it also spawns the robot into Gazebo and runs two bridges for joint states and pose.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher, GazeboBridge

def generate_launch_description():

    sl = SimpleLauncher(use_sim_time=False)

    # namespace is a launch argument, not a Python string
    sl.declare_arg('robot', default_value = 'robot1')
    robot = sl.arg('robot')

    with sl.group(ns = robot):
        # robot_state_publisher is always run
        sl.robot_state_publisher('my_description', 'my_robot.xacro')

        with sl.group(if_condition = sl.sim_time):
            # only execute this group if use_sim_time was set to True

            # spawn in Gazebo at default pose if not already here
            sl.spawn_gz_model(robot)

            # create a bridge for joint states @ /world/&lt;world&gt;/model/&lt;robot&gt;/joint_state
            # note the relative ROS topic 'joint_states' that is actually namespaced
            gz_js_topic = GazeboBridge.model_prefix(robot)/'joint_state'
            js_bridge = GazeboBridge(gz_topic = gz_js_topic,
                                     ros_topic = 'joint_states',
                                     msg = 'sensor_msgs/JointState',
                                     direction = GazeboBridge.gz2ros)

            # pose publisher bridge @ /model/&lt;robot&gt;
            pose_bridge = GazeboBridge('/model'/robot/'/pose',
                                       'pose_gt', 'geometry_msgs/Pose', GazeboBridge.gz2ros)

            # create bridge node with these two topics with default name gz_bridge
            sl.create_gz_bridge([js_bridge, pose_bridge])

    return sl.launch_description()


</code></pre></div></div>

<h3 id="full-gazebo-simulation">Full Gazebo simulation</h3>

<p>The file <code class="language-plaintext highlighter-rouge">example/gazebo/gazebo_launch.py</code> runs a basic simulation of a turret robot with a camera, also displayed in RViz.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch simple_launch gazebo_launch.py

</code></pre></div></div>

<p>You can move the robot around with a joint velocity setpoint (<code class="language-plaintext highlighter-rouge">std_msgs/Float64</code>) on <code class="language-plaintext highlighter-rouge">/turret/joint#</code> and see the simulated camera on <code class="language-plaintext highlighter-rouge">/turret/image</code>.</p>

<h2 id="i-want-more-examples">I want more examples</h2>

<p>Other self-contained examples (and slides) have been used to teach the ROS 2 launch file system and the nav stack.</p>

<p>Various aspects of the launch systen are shown in the <a href="https://github.com/oKermorgant/anf_launch">anf_launch</a> package.</p>

<p>A simple tutorial on <code class="language-plaintext highlighter-rouge">Nav2</code>  using <code class="language-plaintext highlighter-rouge">simple_launch</code> is available in the <a href="https://github.com/oKermorgant/anf_nav">anf_nav</a> package.</p>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <em>No CONTRIBUTING.md found.</em>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-kilted">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/simple_launch">simple_launch</a> <small>repository</small></h3>
        
        
        <a class="label label-primary pkg-label" href="/p/simple_launch">simple_launch</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-oKermorgant-simple_launch
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-oKermorgant-simple_launch" role="menuitem" tabindex="-1" href="/r/simple_launch/github-oKermorgant-simple_launch" data="github-oKermorgant-simple_launch">
                    <span class="glyphicon glyphicon-star"></span>
                    github-oKermorgant-simple_launch
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">This package provides a Python class to help writing ROS 2 launch files.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/oKermorgant/simple_launch.git">https://github.com/oKermorgant/simple_launch.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">devel</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-02-16
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/simple_launch/#kilted-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/simple_launch/#kilted-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/simple_launch/#kilted-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/simple_launch">simple_launch</a></td>
                    <td>1.11.0</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="simple_launch">simple_launch</h1>
<p>This package provides a Python class to help writing ROS 2 launch files.</p>

<p>The motivation behind this package is that the ROS 2 launch Python syntax may not be suited for many simple cases such as running basic nodes, spawning a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code>, and grouping nodes in namespaces or components.</p>

<p><strong>Thanks</strong>: this package is inspired by <a href="https://github.com/bponsler/ros2_launch_util">ros2_launch_util</a>.</p>

<p>The entry point is the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> class, which has several capabilities.</p>

<h2 id="basic-syntax">Basic syntax</h2>

<h3 id="namespace-and-argument-parser-initialization">Namespace and argument parser initialization</h3>

<p><code class="language-plaintext highlighter-rouge">sl = SimpleLauncher(namespace = '', use_sim_time = None, scope_included_files = False)</code></p>

<ul>
  <li>will initialize all nodes relative to the given namespace</li>
  <li>if <code class="language-plaintext highlighter-rouge">use_sim_time</code> is a Boolean, creates a <code class="language-plaintext highlighter-rouge">use_sim_time</code> launch argument with this value as the default and forwards it to all nodes, unless explicitely specified when running the node</li>
  <li>if <code class="language-plaintext highlighter-rouge">use_sim_time</code> is <code class="language-plaintext highlighter-rouge">'auto'</code>, then <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> will set it to <code class="language-plaintext highlighter-rouge">True</code> if the <code class="language-plaintext highlighter-rouge">/clock</code> topic is advertized (case of an already running simulation). <strong>This may have side effects if the <code class="language-plaintext highlighter-rouge">/clock</code> topic is advertized but you want to use this launch file with system clock</strong>.</li>
  <li>if <code class="language-plaintext highlighter-rouge">use_sim_time</code> is <code class="language-plaintext highlighter-rouge">None</code> (default) then no particular value is forwarded to the nodes</li>
  <li>if <code class="language-plaintext highlighter-rouge">scope_included_files</code> is <code class="language-plaintext highlighter-rouge">False</code> (default) then including another launch file that shares the same argument but while passing another value for this argument, will also <a href="https://robotics.stackexchange.com/questions/98997/ros2-foxy-python-launch-argument-scope-when-nesting-launch-files">modify the value of this argument after the inclusion</a>. This is the default behavior of <code class="language-plaintext highlighter-rouge">launch</code> but can be undesired. Inside an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code> the behavior is to be scoped anyway (the argument value is resolved) and <code class="language-plaintext highlighter-rouge">scope_included_files</code> has no effect.</li>
</ul>

<h3 id="node-registration">Node registration</h3>

<p><code class="language-plaintext highlighter-rouge">sl.node(package, executable, **node_args)</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">package</code> is the node package</li>
  <li>
<code class="language-plaintext highlighter-rouge">executable</code> is the name of the executable</li>
  <li>
<code class="language-plaintext highlighter-rouge">node_args</code> are any additional <code class="language-plaintext highlighter-rouge">Node</code> arguments</li>
</ul>

<h3 id="launch-file-include">Launch file include</h3>

<p><code class="language-plaintext highlighter-rouge">sl.include(package, launch_file, launch_dir = None, launch_arguments=None)</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">package</code> is the package of the included launch file</li>
  <li>
<code class="language-plaintext highlighter-rouge">launch_file</code> is the name of the launch file</li>
  <li>
<code class="language-plaintext highlighter-rouge">launch_dir</code> is its directory inside the package share (<code class="language-plaintext highlighter-rouge">None</code> to have it found)</li>
  <li>
<code class="language-plaintext highlighter-rouge">launch_arguments</code> is a dictionary of arguments to pass to the included launch file</li>
</ul>

<h3 id="call-a-service-at-launch">Call a service at launch</h3>

<p>This line runs a temporary client that waits for a service and calls it when available:</p>

<p><code class="language-plaintext highlighter-rouge">sl.call_service(server, request = None, verbosity = '')</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">server</code> is the path to some service (possibly namespaced). The service type is deduced when it becomes available.</li>
  <li>
<code class="language-plaintext highlighter-rouge">request</code> is a dictionary representing the service request. If <code class="language-plaintext highlighter-rouge">None</code> or incomplete, will use the service request default values.</li>
  <li>
<code class="language-plaintext highlighter-rouge">verbosity</code> let the underlying node describe what it is doing: <code class="language-plaintext highlighter-rouge">'req'</code> for request info, <code class="language-plaintext highlighter-rouge">'res'</code> for response info or both with <code class="language-plaintext highlighter-rouge">'reqres'</code>
</li>
</ul>

<p>If any request parameter is <code class="language-plaintext highlighter-rouge">__ns</code> it will be changed to the current namespace.</p>

<h3 id="setting-parameters">Setting parameters</h3>

<p>This line runs a temporary client that waits for a node and changes its parameters when available:</p>

<p><code class="language-plaintext highlighter-rouge">sl.set_parameters(node_name, parameters: dict = {}, verbosity = '')</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">node_name</code> is the name of the node (possibly namespaced)</li>
  <li>
<code class="language-plaintext highlighter-rouge">parameters</code> is a dictionary of (name, value) parameters to be set</li>
  <li>
<code class="language-plaintext highlighter-rouge">verbosity</code> let the underlying node describe what it is doing: <code class="language-plaintext highlighter-rouge">'req'</code> for request info, <code class="language-plaintext highlighter-rouge">'res'</code> for response info or both with <code class="language-plaintext highlighter-rouge">'reqres'</code>
</li>
</ul>

<p>This calls the <code class="language-plaintext highlighter-rouge">set_parameters</code> service of the node with the passed types. Possible errors may happen if the parameters do not exist or are of a different type.</p>

<h3 id="robust-types-for-parameters">Robust types for parameters</h3>

<p>In the launch API, differents types are expected for:</p>

<ul>
  <li>node parameters: a list of dictionaries</li>
  <li>node remappings: a list of (<code class="language-plaintext highlighter-rouge">key</code>, <code class="language-plaintext highlighter-rouge">value</code>) pairs</li>
  <li>included launch arguments: a list of (<code class="language-plaintext highlighter-rouge">key</code>, <code class="language-plaintext highlighter-rouge">value</code>) pairs</li>
  <li>xacro arguments: a concatenation of <code class="language-plaintext highlighter-rouge">key:=value</code> strings</li>
</ul>

<p>The <code class="language-plaintext highlighter-rouge">sl.include</code>, <code class="language-plaintext highlighter-rouge">sl.node</code> and <code class="language-plaintext highlighter-rouge">xacro_args</code> calls allow using any type (the simplest being a single dictionary)  and will convert to the one expected by the API.</p>

<h2 id="launch-arguments">Launch arguments</h2>

<p><code class="language-plaintext highlighter-rouge">simple_launch</code> allows declaring launch arguments and getting them in return.</p>

<h3 id="declare-a-launch-argument">Declare a launch argument</h3>

<p><code class="language-plaintext highlighter-rouge">sl.declare_arg(name, default_value, description = None)</code>: declare and returns the argument</p>

<p>Contrary to the base API, the default value is a raw Python type.</p>

<h3 id="retrieve-a-launch-argument">Retrieve a launch argument</h3>

<p><code class="language-plaintext highlighter-rouge">sl.arg(name)</code>: returns the argument <code class="language-plaintext highlighter-rouge">name</code> as a <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code></p>

<h3 id="retrieve-several-arguments-as-a-dictionary">Retrieve several arguments as a dictionary</h3>

<p><code class="language-plaintext highlighter-rouge">sl.arg_map('robot', 'x', 'y')</code>: returns <code class="language-plaintext highlighter-rouge">{'robot': &lt;robot arg value&gt;, 'x': &lt;x arg value&gt;, 'y': &lt;y arg value&gt;}</code></p>

<p>Typical when forwarding some launch arguments to a node or an included launch file.</p>

<h2 id="groups-or-scopes">Groups or scopes</h2>

<p>Groups are created through the <code class="language-plaintext highlighter-rouge">with sl.group():</code> syntax and accept, a namespace an if/unless condition and an event.</p>

<p>Actions that are added in a scope inherit from all previous defined groups.</p>

<h3 id="by-namespace">By namespace</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(ns=sub_namespace):
    sl.node(package, executable)

</code></pre></div></div>

<h3 id="from-a-condition">From a condition</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(if_condition=True):
    sl.node(package, executable)

  with sl.group(unless_condition=&lt;some expression&gt;):
    sl.node(package, executable)

</code></pre></div></div>

<ul>
  <li>Only one condition can be set in a group, nested condition must be combined first, or used in nested groups.</li>
  <li>Combining conditions coming from launch arguments can be done with <code class="language-plaintext highlighter-rouge">sl.py_eval</code> as shown below.</li>
</ul>

<h3 id="from-conditional-arguments">From conditional arguments</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(if_arg='use_gui'):
    sl.node(package, executable)

  with sl.group(unless_arg='dont_do'):
    sl.node(package, executable)

</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">if_arg</code> / <code class="language-plaintext highlighter-rouge">unless_arg</code> is expected to be the name of a launch argument. These two lines are equivalent:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(if_arg='use_gui'):
  with sl.group(if_condition=sl.arg('use_gui')):

</code></pre></div></div>
<p>If <code class="language-plaintext highlighter-rouge">if_arg</code> / <code class="language-plaintext highlighter-rouge">unless_arg</code> is not a string then it is considered as a <code class="language-plaintext highlighter-rouge">if_condition</code> / <code class="language-plaintext highlighter-rouge">unless_condition</code>.</p>

<h3 id="from-events">From events</h3>

<p>The <code class="language-plaintext highlighter-rouge">when</code> argument wraps events from the <code class="language-plaintext highlighter-rouge">launch.event_handlers</code> module. It combines an event and a delay (0 by default)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch.events import When, OnProcessStart, OnProcessExit, OnProcessIO

  my_node = sl.node(...)   # reference node

  with sl.group(when = When(my_node, OnProcessStart, 1.)):
      sl.node(...)  # will run 1 s after main node starts

  with sl.group(when = When(my_node, OnProcessExit)):
      sl.node(...)  # will run as soon as the main node exists

  with sl.group(when = When(my_node, OnProcessIO, io = 'stdout'):
      # OnProcessIO events need a function changing the event into an action
      sl.add_action(lambda event: LogInfo(msg = 'Node says "{}"'.format(
                      event.text.decode().strip())))
      # several functions can be used if needed, they will be combined in a single one
      sl.add_action(lambda event: LogInfo(msg = 'Once again, node says "{}"'.format(
                      event.text.decode().strip())))

  with sl.group(when = When(delay = 2.)):
      sl.node(...)  # will run after 2 sec

</code></pre></div></div>

<h3 id="creating-containers">Creating containers</h3>

<p>This syntax adds the <code class="language-plaintext highlighter-rouge">composition/composition::Talker</code> as a ComposableNode</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.container(name='my_container', output='screen'):
    sl.node(package='composition', plugin='Talker', name='talker')

</code></pre></div></div>

<p>Use the <code class="language-plaintext highlighter-rouge">executable</code> and <code class="language-plaintext highlighter-rouge">package</code> parameters if you want to use executors other than <code class="language-plaintext highlighter-rouge">rclcpp_components</code>â€™s <code class="language-plaintext highlighter-rouge">component_container</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.container(name='my_container', output='screen', executable='component_container_isolated'):

</code></pre></div></div>

<p><strong><em>It is currently impossible to have group blocks within a container block, as containers can only accept <code class="language-plaintext highlighter-rouge">ComposableNode</code>s</em></strong>. A <code class="language-plaintext highlighter-rouge">GroupAction</code> containing e.g. <code class="language-plaintext highlighter-rouge">PushRosNamespace</code> and a <code class="language-plaintext highlighter-rouge">ComposableNode</code> is not itself a <code class="language-plaintext highlighter-rouge">ComposableNode</code>.</p>

<h2 id="use_sim_time"><code class="language-plaintext highlighter-rouge">use_sim_time</code></h2>

<p>The current <code class="language-plaintext highlighter-rouge">use_sim_time</code> setting can be retrieved through <code class="language-plaintext highlighter-rouge">sl.sim_time</code> that may be:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">None</code>, if <code class="language-plaintext highlighter-rouge">use_sim_time</code> was not set in the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> constructor</li>
  <li>a raw Boolean, if <code class="language-plaintext highlighter-rouge">use_sim_time</code> was set to <code class="language-plaintext highlighter-rouge">'auto'</code>, depending on the <code class="language-plaintext highlighter-rouge">/clock</code> topic being advertized</li>
  <li>a Boolean launch argument, if <code class="language-plaintext highlighter-rouge">use_sim_time</code> was set to <code class="language-plaintext highlighter-rouge">True</code> or <code class="language-plaintext highlighter-rouge">False</code>
</li>
</ul>

<p>In all cases, if the <code class="language-plaintext highlighter-rouge">use_sim_time</code> parameter is explicitely given to a node, it will be used instead of the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> instance one.</p>

<h2 id="opaquefunction-with-implicit-performcontext">
<code class="language-plaintext highlighter-rouge">OpaqueFunction</code> with implicit <code class="language-plaintext highlighter-rouge">.perform(context)</code>
</h2>

<p>Most of the use cases can be dealt with substitutions and <code class="language-plaintext highlighter-rouge">with sl.group</code> blocks.
In order to design more imperative launch files, the <a href="https://discourse.ros.org/t/simplifying-launch-argument-declaration-and-initialization-in-launch-files/24204"><code class="language-plaintext highlighter-rouge">OpaqueFunction</code></a> approach can be used. The main drawback is that potential errors are harder to track.</p>

<p>To do this with <code class="language-plaintext highlighter-rouge">simple_launch</code>:</p>

<ul>
  <li>the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> instance and the argument declaration should be done in the main body of your launch file.</li>
  <li>then, define a function (e.g. <code class="language-plaintext highlighter-rouge">launch_setup</code>) that takes no argument, where the logic of the launch file resides.</li>
  <li>all arguments obtained through <code class="language-plaintext highlighter-rouge">sl.arg</code> will be basic Python types, obtained from performing the substitutions.</li>
  <li>finally just export <code class="language-plaintext highlighter-rouge">generate_launch_description = sl.launch_description(opaque_function = launch_setup)</code>.</li>
</ul>

<p>Compare <a href="https://github.com/oKermorgant/simple_launch/tree/devel/example/example_launch.py"><code class="language-plaintext highlighter-rouge">example_launch.py</code></a> and <a href="https://github.com/oKermorgant/simple_launch/tree/devel/example/example_opaque_launch.py"><code class="language-plaintext highlighter-rouge">example_opaque_launch.py</code></a> to see the two approaches on the same logic.</p>

<p>Note that inside an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code> the if/unless idiom reduces to a basic if/else:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># with substitutions
with sl.group(if_arg='some_condition'):
  # do stuff
with sl.group(unless_arg='some_condition'):
  # do other stuff

# with opaque function
if sl.arg('some_condition'):
  # do stuff
else:
  # do other stuff

</code></pre></div></div>

<h2 id="other-one-liners">Other one-liners</h2>

<p>Methods listed below return instances of <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code> that represent any Substitution, but that provides concatenation (<code class="language-plaintext highlighter-rouge">+</code>) and path concatenation (<code class="language-plaintext highlighter-rouge">/</code>) operators. It is still a <code class="language-plaintext highlighter-rouge">Substitution</code>, not a raw Python type. If run from an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code> the underlying Python variable is returned.</p>

<h3 id="string--substitution-concatenation">String / substitution concatenation</h3>

<p>The following syntax builds the <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code> corresponding to <code class="language-plaintext highlighter-rouge">&lt;robot arg&gt;.xacro</code>:</p>

<p><code class="language-plaintext highlighter-rouge">file_name = sl.arg('robot') + '.xacro'</code></p>

<p><em>deprecated</em>: <code class="language-plaintext highlighter-rouge">sl.name_join(sl.arg('robot'), '.xacro')</code></p>

<h3 id="path-concatenation">Path concatenation</h3>

<p>The following syntax builds the <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code> corresponding to <code class="language-plaintext highlighter-rouge">&lt;package_path&gt;/urdf/&lt;robot arg&gt;.xacro</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>file_name = sl.arg('robot') + '.xacro'
urdf_file = os.path.join(get_package_share_directory(package),'urdf')/file_name

</code></pre></div></div>
<p>Obviously if all the path elements are raw strings, you should use <code class="language-plaintext highlighter-rouge">os.path.join</code> all along.</p>

<p><em>deprecated</em>: <code class="language-plaintext highlighter-rouge">sl.path_join(get_package_share_directory(package), sl.arg('robot'), '.xacro')</code></p>

<h3 id="find-a-share-file">Find a share file</h3>

<p><code class="language-plaintext highlighter-rouge">path = sl.find(package, file_name = None, file_dir = None)</code> where:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">package</code> is the name of the package or <code class="language-plaintext highlighter-rouge">None</code> if <code class="language-plaintext highlighter-rouge">file_name</code> is already an absolute path</li>
  <li>
<code class="language-plaintext highlighter-rouge">file_name</code> is the name of the file to find</li>
  <li>
<code class="language-plaintext highlighter-rouge">file_dir</code> is the path inside the package</li>
</ul>

<p>If <code class="language-plaintext highlighter-rouge">file_dir</code> is <code class="language-plaintext highlighter-rouge">None</code> but <code class="language-plaintext highlighter-rouge">package</code> and <code class="language-plaintext highlighter-rouge">file_name</code> are raw strings then the <code class="language-plaintext highlighter-rouge">find</code> function will actually look for the file inside the package share, using <code class="language-plaintext highlighter-rouge">os.walk</code>.</p>

<p>If <code class="language-plaintext highlighter-rouge">file_name</code> is <code class="language-plaintext highlighter-rouge">None</code> then the function just returns the path to the package share directory (e.g. <code class="language-plaintext highlighter-rouge">get_package_share_directory(package)</code>)</p>

<h3 id="robot-state-publisher">Robot state publisher</h3>

<p>It is quite common to run a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> from a <code class="language-plaintext highlighter-rouge">urdf</code> or <code class="language-plaintext highlighter-rouge">xacro</code> file. The line below runs it at the current namespace / condition level:</p>

<p><code class="language-plaintext highlighter-rouge">sl.robot_state_publisher(package, description_file, description_dir=None, xacro_args=None, **node_args)</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">description_file</code> is a URDF or xacro file</li>
  <li>
<code class="language-plaintext highlighter-rouge">description_dir</code> is the sub-directory of the file. If omitted, let the script search for the file assuming it is a raw string</li>
  <li>
<code class="language-plaintext highlighter-rouge">xacro_args</code> is a dictionary of arguments to forward to xacro</li>
  <li>
<code class="language-plaintext highlighter-rouge">node_args</code> are any additional arguments for <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> (remappings / parameters)</li>
</ul>

<h3 id="python-expressions">Python expressions</h3>

<p><code class="language-plaintext highlighter-rouge">sl.py_eval</code> will evaluate the given arguments as a Python expression, possibly performed if in an Opaque Function.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># RGB color as a list of [0-255] integers
sl.declare_arg('color', [255,0,0])
# same color as a string of [0-1] numbers (URDF format), note the padding commas to get a string
xacro_color = "'" + sl.py_eval("' '.join(str(c/255) for c in ", sl.arg('color'), ')') + "'"

</code></pre></div></div>

<h3 id="conditions">Conditions</h3>

<p><code class="language-plaintext highlighter-rouge">sl.py_eval</code> can be used to combine conditions. It is robust to lower case <code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">false</code> and will return a <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sl.declare_arg('some_condition', True)
opposed = sl.py_eval('not ', sl.arg('some_condition'))

</code></pre></div></div>

<p>Note that <code class="language-plaintext highlighter-rouge">IfCondition</code> and <code class="language-plaintext highlighter-rouge">UnlessCondition</code> cannot be combined, <a href="https://answers.ros.org/answers/414006/revisions/">only the underlying <code class="language-plaintext highlighter-rouge">Substitution</code>s can</a>.</p>

<h3 id="joint-state-publisher">Joint state publisher</h3>

<p><code class="language-plaintext highlighter-rouge">sl.joint_state_publisher(use_gui, **node_args)</code>: fires up a <code class="language-plaintext highlighter-rouge">joint_state_publisher</code>, with or without the gui, in the current namespace.</p>

<h3 id="rviz">Rviz</h3>

<p><code class="language-plaintext highlighter-rouge">sl.rviz(config_file = None, warnings = False)</code>: runs RViz on the given configuration file. If <code class="language-plaintext highlighter-rouge">warnings</code> is <code class="language-plaintext highlighter-rouge">False</code> (default) then runs with <code class="language-plaintext highlighter-rouge">log-level FATAL</code> in order to avoid many messages in the console.</p>

<p>Classical use case: <code class="language-plaintext highlighter-rouge">sl.rviz(sl.find('my_package', 'some_rviz_config.rviz'))</code></p>

<h3 id="fallback-to-low-level-syntax">Fallback to low-level syntax</h3>

<p>If any unavailable functionality is needed, the <code class="language-plaintext highlighter-rouge">sl.add_action(action)</code> function adds any passed <code class="language-plaintext highlighter-rouge">Action</code> at the current namespace / conditional / event level.</p>

<h2 id="interaction-with-gazebo--ignition">Interaction with Gazebo / Ignition</h2>

<p><em>Note: Ignition being renamed to Gazebo, all tools in this section use Gazebo / gz names</em></p>

<p>An effort was made to be robust to Ignition versus Gazebo uses, i.e. <em>ign</em> prefix is used for <code class="language-plaintext highlighter-rouge">foxy</code> and <code class="language-plaintext highlighter-rouge">galactic</code> while <em>gz</em> prefix is used from <code class="language-plaintext highlighter-rouge">humble</code>. <code class="language-plaintext highlighter-rouge">GZ_VERSION</code> and <code class="language-plaintext highlighter-rouge">IGNITION_VERSION</code> environment variables are also used to identify which version should be preferred.</p>

<h3 id="launch-gazebo">Launch Gazebo</h3>

<p>The Gazebo launch file corresponding to the current ROS 2 distribution is launched with</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sl.gz_launch(world_file, gz_arguments, full_world = None, save_after = 5.)

</code></pre></div></div>
<p>Namely, it will redirect to either <code class="language-plaintext highlighter-rouge">ros_ign_gazebo/ign_gazebo.launch.py</code> (<code class="language-plaintext highlighter-rouge">foxy</code>, <code class="language-plaintext highlighter-rouge">galactic</code>) or <code class="language-plaintext highlighter-rouge">ros_gz_sim/gz_sim.launch.py</code> (<code class="language-plaintext highlighter-rouge">humble</code>+).
The given <code class="language-plaintext highlighter-rouge">gz_arguments</code>, if any, will be forwarded either as the <code class="language-plaintext highlighter-rouge">ign_args</code> or <code class="language-plaintext highlighter-rouge">gz_args</code>, accordingly.</p>

<p>If the world file can be parsed then <code class="language-plaintext highlighter-rouge">SimpleLaunch</code> will detect its name and forward it to <code class="language-plaintext highlighter-rouge">GazeboBridge</code> functions.</p>

<p>If <code class="language-plaintext highlighter-rouge">full_world</code> is a raw string then the world will be saved into this file after the delay. This will include any URDF that was spawned in between.</p>

<h3 id="spawn-a-model">Spawn a model</h3>

<p>The following function allows easily spawing a model from its <code class="language-plaintext highlighter-rouge">robot_description</code>:</p>

<p><code class="language-plaintext highlighter-rouge">sl.spawn_gz_model(name, topic, model_file = None, spawn_args = [], only_new = True)</code></p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">name</code> is the name this model will get in Gazebo</li>
  <li>
<code class="language-plaintext highlighter-rouge">topic</code> is the topic to obtain the model from, default is <code class="language-plaintext highlighter-rouge">robot_description</code> (relative to the current namespace)</li>
  <li>
<code class="language-plaintext highlighter-rouge">model_file</code> is the path to the (urdf or sdf) file. If defined then this will spawn this model and ignore the topic</li>
  <li>
<code class="language-plaintext highlighter-rouge">only_new</code> if True, will not spawn the model if it already exists in a running Gazebo instance</li>
  <li>
<code class="language-plaintext highlighter-rouge">spawn_args</code> are any additional spawn arguments, e.g. the initial pose</li>
</ul>

<p><strong>example:</strong> <code class="language-plaintext highlighter-rouge">sl.spawn_gz_model('my_robot', model_file = sl.find('my_pkg', 'my_model.urdf'))</code></p>

<h3 id="declare-initial-pose">Declare initial pose</h3>

<p>Calling <code class="language-plaintext highlighter-rouge">sl.declare_gazebo_axes()</code> will declare all 6 parameters <code class="language-plaintext highlighter-rouge">(x,y,z,roll,pitch,yaw)</code> with <code class="language-plaintext highlighter-rouge">0</code> as default values.
If any axis is given (e.g. <code class="language-plaintext highlighter-rouge">sl.declare_gazebo_axes(yaw = 3.14)</code> then only this parameter will be declared.</p>

<p>Such parameters can be retrieved through <code class="language-plaintext highlighter-rouge">sl.gazebo_axes_args()</code>. As a consequence, it is easy to spawn a model with:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sl.declare_gazebo_axes()
sl.robot_description(...)
sl.spawn_gz_model(name, spawn_args = sl.gazebo_axes_args())

</code></pre></div></div>

<h3 id="save-current-world">Save current world</h3>

<p>If the simulation is reset after some models have been spawned, they will disappear. A convenient way to avoid this is to generate the full SDF world from a running simulation. The Gazebo GUI is able to export the current world but cannot resolve models that were spawned from e.g. a <code class="language-plaintext highlighter-rouge">robot_description</code> topic.</p>

<p>The script <code class="language-plaintext highlighter-rouge">generate_gz_world</code> will generate a SDF corresponding to the current simulation. If some models have been spawned from URDF and topics, the script will get the corresponding description and insert it into the SDF, assuming robot <code class="language-plaintext highlighter-rouge">name</code> has its description under <code class="language-plaintext highlighter-rouge">/name/robot_description</code>. It can also be called from a launch file with (see Gazebo example):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># you might want to add a delay to be sure all models have been spawned
sl.save_gz_world(full_world.sdf, after = 1.)

</code></pre></div></div>

<p>Such a self-contained SDF world file is then compatible with a reset of the simulation. See Gazebo example for launch file that checks if the full world is available.</p>

<h3 id="gazebo-bridge">Gazebo bridge</h3>

<p>The <code class="language-plaintext highlighter-rouge">GazeboBridge</code> class allows easily creating bridges when using Gazebo.</p>

<p>An instance is created with: <code class="language-plaintext highlighter-rouge">bridge = GazeboBridge(&lt;gazebo_topic&gt;, &lt;ros_topic&gt;, &lt;ros_message&gt;, direction, &lt;gz_message&gt; = None)</code> where <code class="language-plaintext highlighter-rouge">direction</code> is either:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.gz2ros</code> for Gazebo -&gt; ROS</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.ros2gz</code> for ROS -&gt; Gazebo</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.bidirectional</code> for both</li>
</ul>

<p>The Gazebo message type is <a href="https://github.com/gazebosim/ros_gz/tree/ros2/ros_gz_bridge">deduced from the ROS message type</a> if not set. Remapping will be set to the given <code class="language-plaintext highlighter-rouge">ros_topic</code>.</p>

<p>The SimpleLauncher instance can then run a node dealing with declared bridges, as illustrated in the examples at this end of this document.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">sl.create_gz_bridge([bridges], &lt;node_name&gt;)
</code></li>
</ul>

<p>If some bridges involve <code class="language-plaintext highlighter-rouge">sensor_msgs/Image</code> then a dedicated <code class="language-plaintext highlighter-rouge">ros_gz_image</code> bridge will be used. The corresponding <code class="language-plaintext highlighter-rouge">camera_info</code> topic will be also bridged.</p>

<h3 id="interaction-with-gazebo-sim">Interaction with Gazebo sim</h3>

<p>Some bridges (e.g. <code class="language-plaintext highlighter-rouge">joint_states</code>) need to have information on the world name. This name can only be obtained while Gazebo is running, or by having a priori knowledge of the world file.</p>

<p>The <code class="language-plaintext highlighter-rouge">GazeboBridge</code> class has a few static methods to get information on the simulated world, namely:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.world()</code> returns the current world name</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.set_world_name(world)</code> imposes the world name</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.model_prefix(model)</code> builds the Gazebo topic relative to the given model <code class="language-plaintext highlighter-rouge">/world/&lt;world&gt;/model/&lt;model&gt;</code>
</li>
</ul>

<p>They can be used under these conditions:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">sl.gz_launch</code> was called first (in the same launch setup) and the world file could be parsed, in this case the world name from the file is used</li>
  <li>or <code class="language-plaintext highlighter-rouge">GazeboBridge.set_world_name(world)</code> was called first (in the same launch setup), in this case this world name is used</li>
  <li>if none of the above and a <strong>running Gazebo</strong> instance exists, in this case <code class="language-plaintext highlighter-rouge">GazeboBridge</code> will request information on the world</li>
</ul>

<p>If none of these conditions hold, the launch file will not be able to get information on the world, and launch fill probably fail.</p>

<h3 id="built-in-bridges">Built-in bridges</h3>

<p>A common instance of the bridge is the clock. This one can be:</p>

<ul>
  <li>created with <code class="language-plaintext highlighter-rouge">GazeboBridge.clock()</code>: returns a <code class="language-plaintext highlighter-rouge">GazeboBridge</code> instance, not added to any node yet</li>
  <li>or run directly with <code class="language-plaintext highlighter-rouge">sl.create_gz_clock_bridge()</code> (actually runs <code class="language-plaintext highlighter-rouge">sl.create_gz_bridge(GazeboBridge.clock())</code>)</li>
</ul>

<p>Another common but tedious bridge instance is the joint state topic of a given model. This topic includes, in Gazebo, the name of the world <em>and</em> of the model. Assuming the world name is known, the corresponding bridge can be created with:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">GazeboBridge.joint_states_bridge(model)</code></li>
  <li>actually runs <code class="language-plaintext highlighter-rouge">GazeboBridge('/world/&lt;world&gt;/model/&lt;model&gt;/joint_state', 'joint_states', 'sensor_msgs/JointState', GazeboBridge.gz2ros)</code>
</li>
</ul>

<h3 id="world-tf-publisher">World TF publisher</h3>

<p>If <code class="language-plaintext highlighter-rouge">/tf</code> is used with Gazebo, then the root frame used by Gazebo depends on the world name. This frame is usually <code class="language-plaintext highlighter-rouge">world</code> on the ROS side.
A trivial <code class="language-plaintext highlighter-rouge">static_transform_publisher</code> is run to connect these two frames if they have different names:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">sl.gz_world_tf(world_frame = None)</code>: run a <code class="language-plaintext highlighter-rouge">static_transform_publisher</code> from <code class="language-plaintext highlighter-rouge">world</code> to <code class="language-plaintext highlighter-rouge">world_frame</code>. If <code class="language-plaintext highlighter-rouge">None</code> then detect the one currently used by Gazebo.</li>
</ul>

<h2 id="examples">Examples</h2>

<p>Examples can be found in the corresponding folder.</p>

<h3 id="launch-with-arguments">Launch with arguments</h3>

<p>Here is a file spawning a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> and its <code class="language-plaintext highlighter-rouge">joint_state_publisher</code>, where:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">prefix</code>, <code class="language-plaintext highlighter-rouge">x</code> and <code class="language-plaintext highlighter-rouge">y</code> are launch arguments that are passed to xacro</li>
  <li>
<code class="language-plaintext highlighter-rouge">use_gui</code> tells whether <code class="language-plaintext highlighter-rouge">joint_state_publisher</code> should run the gui</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():
    '''
    Launch description for a single robot - runs the two nodes in their own namespace
    '''
    sl = SimpleLauncher()

    sl.declare_arg('prefix', default_value = '', description='name of the robot (+ tf prefix)')
    sl.declare_arg('x', default_value = 0, description='x-offset of the robot')
    sl.declare_arg('y', default_value = 0, description='y-offset of the robot')
    sl.declare_arg('use_gui', default_value = True, description='Use JSP gui')

    xacro_args = sl.arg_map('prefix', 'x', 'y')
    xacro_args['prefix'] += '/'  # can sum substitutions and strings

    with sl.group(ns=sl.arg('prefix')):
        sl.robot_state_publisher('simple_launch', 'turret.xacro', xacro_args = xacro_args)
        sl.joint_state_publisher(use_gui = sl.arg('use_gui'))

    return sl.launch_description()

</code></pre></div></div>

<h3 id="conditional-blocks-and-includes">Conditional blocks and includes</h3>

<p>The file below fires up either <code class="language-plaintext highlighter-rouge">robot1</code> or <code class="language-plaintext highlighter-rouge">robot2</code> (or both) and also has a boolean argument to spawn <code class="language-plaintext highlighter-rouge">RViz2</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():

    sl = SimpleLauncher()

    # conditional args
    sl.declare_arg('robot1', default_value=True, description='use robot 1')
    sl.declare_arg('robot2', default_value=True, description='use robot 2')
    sl.declare_arg('no_robot2', default_value=False, description='cancel use of robot 2')
    sl.declare_arg('rviz', default_value=True, description='Bringup RViz2')

    # numeric args
    sl.declare_arg('robot2_x', default_value=1, description='x-offset of robot 2')
    sl.declare_arg('robot2_y', default_value=1, description='y-offset of robot 2')

    with sl.group(if_arg='robot1'):
        sl.include('simple_launch', 'included_launch.py',
                   launch_arguments = {'prefix': 'robot1'})

    with sl.group(if_arg='robot2'):

        with sl.group(unless_arg='no_robot2'):

            args = {'prefix': 'robot2', 'x':sl.arg('robot2_x'), 'y': sl.arg('robot2_y')}
            sl.include('simple_launch', 'included_launch.py', launch_arguments=args)

    with sl.group(if_arg='rviz'):
        rviz_config = sl.find('simple_launch', 'turret.rviz')
        sl.node('rviz2', 'rviz2', arguments = ['-d', rviz_config])

    return sl.launch_description()

</code></pre></div></div>

<h3 id="conditions-with-opaquefunction">Conditions with OpaqueFunction</h3>

<p>The file below does the same as the previous one, but using an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

# declare simple launcher and the launch arguments in the main body
sl = SimpleLauncher()

# conditional args
sl.declare_arg('robot1', default_value=True, description='use robot 1')
sl.declare_arg('robot2', default_value=True, description='use robot 2')
sl.declare_arg('no_robot2', default_value=False, description='cancel use of robot 2')
sl.declare_arg('rviz', default_value=True, description='Bringup RViz2')

# numeric args
sl.declare_arg('robot2_x', default_value=1, description='x-offset of robot 2')
sl.declare_arg('robot2_y', default_value=1, description='y-offset of robot 2')

# string args
sl.declare_arg('included', default_value = 'included_launch')


# define the opaque function, context will be wrapped in the SimpleLauncher instance
def launch_setup():

    # we can use raw if as `robot1` argument is performed to a Boolean
    if sl.arg('robot1'):
        sl.include('simple_launch', 'included_launch.py', launch_arguments = {'prefix': 'robot1'})

    # and even combine conditions
    if sl.arg('robot2') and not sl.arg('no_robot2'):

            args = {'prefix': 'robot2', 'x':sl.arg('robot2_x'), 'y': sl.arg('robot2_y')}
            # summing up args and strings
            sl.include('simple_launch', sl.arg('included') + '.py', launch_arguments=args)

    if sl.arg('rviz'):
        rviz_config = sl.find('simple_launch', 'turret.rviz')
        sl.node('rviz2', 'rviz2', arguments = ['-d', rviz_config])

    return sl.launch_description()


# tell SimpleLauncher to rely on the opaque_function in the launch description
# /!\ no `def generate_launch_description():`

generate_launch_description = sl.launch_description(opaque_function = launch_setup)

</code></pre></div></div>

<h3 id="combining-conditions">Combining conditions</h3>

<p>The file below shows how to use <code class="language-plaintext highlighter-rouge">sl.py_eval</code> to combine conditions. We have to build a valid Python expression, not forgetting the spaces around <code class="language-plaintext highlighter-rouge">and</code>, <code class="language-plaintext highlighter-rouge">or</code>, <code class="language-plaintext highlighter-rouge">not</code>, etc.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():

    sl = SimpleLauncher()

    cond1 = sl.declare_arg('cond1', True)
    cond2 = sl.declare_arg('cond2', False)

    for logic in ('and', 'or'):

        # builds &lt;cond1&gt; &lt;logic&gt; &lt;cond2&gt; Python expression
        combined = sl.py_eval(cond1, f' {logic} ', cond2)

        sl.log_info([f'{logic} condition is ', combined])

        with sl.group(if_condition = combined):
            sl.node('demo_nodes_cpp', 'talker', name = f'talker_{logic}')

        # also works with sl.node(..., condition = IfCondition(combined))

    return sl.launch_description()

</code></pre></div></div>

<h3 id="composition">Composition</h3>

<p>The file below is another way to write the <a href="https://index.ros.org/doc/ros2/Tutorials/Composition/#composition-using-launch-actions">composition launch example</a>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():

    sl = SimpleLauncher()

    with sl.container(name='my_container', output='screen'):
        sl.node(package='composition', plugin='Talker', name='talker')
        sl.node(package='composition', plugin='Listener', name='listener')

    return sl.launch_description()

</code></pre></div></div>

<h3 id="events-and-parameters">Events and parameters</h3>

<p>This <a href="https://github.com/oKermorgant/simple_launch/tree/devel/example/event_tutorial_launch.py">example file</a> is another way to write the <a href="https://docs.ros.org/en/rolling/Tutorials/Intermediate/Launch/Using-Event-Handlers.html">event launch example</a>. If does a little more work and is a little smarter, as the passed <code class="language-plaintext highlighter-rouge">new_background_r</code> is applied as soon as it has a valid value.</p>

<h3 id="auto-sim-time">auto sim time</h3>

<p>Here we run Gazebo and force all other nodes to <code class="language-plaintext highlighter-rouge">use_sim_time:=True</code>, unless this file is included from another one with <code class="language-plaintext highlighter-rouge">use_sim_time:=False</code>.
This is unlikely as this launch file spawns a simulator.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher, GazeboBridge

def generate_launch_description():

    # all nodes in this launch file will use_sim_time:=True
    sl = SimpleLauncher(use_sim_time=True)

    # run Gazebo + clock bridge
    sl.gz_launch(&lt;path/to/some/sdf/world&gt;, '-r')
    sl.create_gz_clock_bridge()

    # run other nodes with sim time

    return sl.launch_description()


</code></pre></div></div>

<h3 id="robot-description-and-conditionnal-gazebo-bridge">Robot description and conditionnal Gazebo bridge</h3>

<p>The file below only runs by default a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> with <code class="language-plaintext highlighter-rouge">use_sim_time:=False</code>.
However, if it is included from another file with <code class="language-plaintext highlighter-rouge">use_sim_time:=True</code> then it also spawns the robot into Gazebo and runs two bridges for joint states and pose.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher, GazeboBridge

def generate_launch_description():

    sl = SimpleLauncher(use_sim_time=False)

    # namespace is a launch argument, not a Python string
    sl.declare_arg('robot', default_value = 'robot1')
    robot = sl.arg('robot')

    with sl.group(ns = robot):
        # robot_state_publisher is always run
        sl.robot_state_publisher('my_description', 'my_robot.xacro')

        with sl.group(if_condition = sl.sim_time):
            # only execute this group if use_sim_time was set to True

            # spawn in Gazebo at default pose if not already here
            sl.spawn_gz_model(robot)

            # create a bridge for joint states @ /world/&lt;world&gt;/model/&lt;robot&gt;/joint_state
            # note the relative ROS topic 'joint_states' that is actually namespaced
            gz_js_topic = GazeboBridge.model_prefix(robot)/'joint_state'
            js_bridge = GazeboBridge(gz_topic = gz_js_topic,
                                     ros_topic = 'joint_states',
                                     msg = 'sensor_msgs/JointState',
                                     direction = GazeboBridge.gz2ros)

            # pose publisher bridge @ /model/&lt;robot&gt;
            pose_bridge = GazeboBridge('/model'/robot/'/pose',
                                       'pose_gt', 'geometry_msgs/Pose', GazeboBridge.gz2ros)

            # create bridge node with these two topics with default name gz_bridge
            sl.create_gz_bridge([js_bridge, pose_bridge])

    return sl.launch_description()


</code></pre></div></div>

<h3 id="full-gazebo-simulation">Full Gazebo simulation</h3>

<p>The file <code class="language-plaintext highlighter-rouge">example/gazebo/gazebo_launch.py</code> runs a basic simulation of a turret robot with a camera, also displayed in RViz.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch simple_launch gazebo_launch.py

</code></pre></div></div>

<p>You can move the robot around with a joint velocity setpoint (<code class="language-plaintext highlighter-rouge">std_msgs/Float64</code>) on <code class="language-plaintext highlighter-rouge">/turret/joint#</code> and see the simulated camera on <code class="language-plaintext highlighter-rouge">/turret/image</code>.</p>

<h2 id="i-want-more-examples">I want more examples</h2>

<p>Other self-contained examples (and slides) have been used to teach the ROS 2 launch file system and the nav stack.</p>

<p>Various aspects of the launch systen are shown in the <a href="https://github.com/oKermorgant/anf_launch">anf_launch</a> package.</p>

<p>A simple tutorial on <code class="language-plaintext highlighter-rouge">Nav2</code>  using <code class="language-plaintext highlighter-rouge">simple_launch</code> is available in the <a href="https://github.com/oKermorgant/anf_nav">anf_nav</a> package.</p>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <em>No CONTRIBUTING.md found.</em>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-rolling">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/simple_launch">simple_launch</a> <small>repository</small></h3>
        
        
        <a class="label label-primary pkg-label" href="/p/simple_launch">simple_launch</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-oKermorgant-simple_launch
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-oKermorgant-simple_launch" role="menuitem" tabindex="-1" href="/r/simple_launch/github-oKermorgant-simple_launch" data="github-oKermorgant-simple_launch">
                    <span class="glyphicon glyphicon-star"></span>
                    github-oKermorgant-simple_launch
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">This package provides a Python class to help writing ROS 2 launch files.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/oKermorgant/simple_launch.git">https://github.com/oKermorgant/simple_launch.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">devel</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-02-16
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/simple_launch/#rolling-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/simple_launch/#rolling-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/simple_launch/#rolling-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/simple_launch">simple_launch</a></td>
                    <td>1.11.0</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="simple_launch">simple_launch</h1>
<p>This package provides a Python class to help writing ROS 2 launch files.</p>

<p>The motivation behind this package is that the ROS 2 launch Python syntax may not be suited for many simple cases such as running basic nodes, spawning a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code>, and grouping nodes in namespaces or components.</p>

<p><strong>Thanks</strong>: this package is inspired by <a href="https://github.com/bponsler/ros2_launch_util">ros2_launch_util</a>.</p>

<p>The entry point is the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> class, which has several capabilities.</p>

<h2 id="basic-syntax">Basic syntax</h2>

<h3 id="namespace-and-argument-parser-initialization">Namespace and argument parser initialization</h3>

<p><code class="language-plaintext highlighter-rouge">sl = SimpleLauncher(namespace = '', use_sim_time = None, scope_included_files = False)</code></p>

<ul>
  <li>will initialize all nodes relative to the given namespace</li>
  <li>if <code class="language-plaintext highlighter-rouge">use_sim_time</code> is a Boolean, creates a <code class="language-plaintext highlighter-rouge">use_sim_time</code> launch argument with this value as the default and forwards it to all nodes, unless explicitely specified when running the node</li>
  <li>if <code class="language-plaintext highlighter-rouge">use_sim_time</code> is <code class="language-plaintext highlighter-rouge">'auto'</code>, then <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> will set it to <code class="language-plaintext highlighter-rouge">True</code> if the <code class="language-plaintext highlighter-rouge">/clock</code> topic is advertized (case of an already running simulation). <strong>This may have side effects if the <code class="language-plaintext highlighter-rouge">/clock</code> topic is advertized but you want to use this launch file with system clock</strong>.</li>
  <li>if <code class="language-plaintext highlighter-rouge">use_sim_time</code> is <code class="language-plaintext highlighter-rouge">None</code> (default) then no particular value is forwarded to the nodes</li>
  <li>if <code class="language-plaintext highlighter-rouge">scope_included_files</code> is <code class="language-plaintext highlighter-rouge">False</code> (default) then including another launch file that shares the same argument but while passing another value for this argument, will also <a href="https://robotics.stackexchange.com/questions/98997/ros2-foxy-python-launch-argument-scope-when-nesting-launch-files">modify the value of this argument after the inclusion</a>. This is the default behavior of <code class="language-plaintext highlighter-rouge">launch</code> but can be undesired. Inside an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code> the behavior is to be scoped anyway (the argument value is resolved) and <code class="language-plaintext highlighter-rouge">scope_included_files</code> has no effect.</li>
</ul>

<h3 id="node-registration">Node registration</h3>

<p><code class="language-plaintext highlighter-rouge">sl.node(package, executable, **node_args)</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">package</code> is the node package</li>
  <li>
<code class="language-plaintext highlighter-rouge">executable</code> is the name of the executable</li>
  <li>
<code class="language-plaintext highlighter-rouge">node_args</code> are any additional <code class="language-plaintext highlighter-rouge">Node</code> arguments</li>
</ul>

<h3 id="launch-file-include">Launch file include</h3>

<p><code class="language-plaintext highlighter-rouge">sl.include(package, launch_file, launch_dir = None, launch_arguments=None)</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">package</code> is the package of the included launch file</li>
  <li>
<code class="language-plaintext highlighter-rouge">launch_file</code> is the name of the launch file</li>
  <li>
<code class="language-plaintext highlighter-rouge">launch_dir</code> is its directory inside the package share (<code class="language-plaintext highlighter-rouge">None</code> to have it found)</li>
  <li>
<code class="language-plaintext highlighter-rouge">launch_arguments</code> is a dictionary of arguments to pass to the included launch file</li>
</ul>

<h3 id="call-a-service-at-launch">Call a service at launch</h3>

<p>This line runs a temporary client that waits for a service and calls it when available:</p>

<p><code class="language-plaintext highlighter-rouge">sl.call_service(server, request = None, verbosity = '')</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">server</code> is the path to some service (possibly namespaced). The service type is deduced when it becomes available.</li>
  <li>
<code class="language-plaintext highlighter-rouge">request</code> is a dictionary representing the service request. If <code class="language-plaintext highlighter-rouge">None</code> or incomplete, will use the service request default values.</li>
  <li>
<code class="language-plaintext highlighter-rouge">verbosity</code> let the underlying node describe what it is doing: <code class="language-plaintext highlighter-rouge">'req'</code> for request info, <code class="language-plaintext highlighter-rouge">'res'</code> for response info or both with <code class="language-plaintext highlighter-rouge">'reqres'</code>
</li>
</ul>

<p>If any request parameter is <code class="language-plaintext highlighter-rouge">__ns</code> it will be changed to the current namespace.</p>

<h3 id="setting-parameters">Setting parameters</h3>

<p>This line runs a temporary client that waits for a node and changes its parameters when available:</p>

<p><code class="language-plaintext highlighter-rouge">sl.set_parameters(node_name, parameters: dict = {}, verbosity = '')</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">node_name</code> is the name of the node (possibly namespaced)</li>
  <li>
<code class="language-plaintext highlighter-rouge">parameters</code> is a dictionary of (name, value) parameters to be set</li>
  <li>
<code class="language-plaintext highlighter-rouge">verbosity</code> let the underlying node describe what it is doing: <code class="language-plaintext highlighter-rouge">'req'</code> for request info, <code class="language-plaintext highlighter-rouge">'res'</code> for response info or both with <code class="language-plaintext highlighter-rouge">'reqres'</code>
</li>
</ul>

<p>This calls the <code class="language-plaintext highlighter-rouge">set_parameters</code> service of the node with the passed types. Possible errors may happen if the parameters do not exist or are of a different type.</p>

<h3 id="robust-types-for-parameters">Robust types for parameters</h3>

<p>In the launch API, differents types are expected for:</p>

<ul>
  <li>node parameters: a list of dictionaries</li>
  <li>node remappings: a list of (<code class="language-plaintext highlighter-rouge">key</code>, <code class="language-plaintext highlighter-rouge">value</code>) pairs</li>
  <li>included launch arguments: a list of (<code class="language-plaintext highlighter-rouge">key</code>, <code class="language-plaintext highlighter-rouge">value</code>) pairs</li>
  <li>xacro arguments: a concatenation of <code class="language-plaintext highlighter-rouge">key:=value</code> strings</li>
</ul>

<p>The <code class="language-plaintext highlighter-rouge">sl.include</code>, <code class="language-plaintext highlighter-rouge">sl.node</code> and <code class="language-plaintext highlighter-rouge">xacro_args</code> calls allow using any type (the simplest being a single dictionary)  and will convert to the one expected by the API.</p>

<h2 id="launch-arguments">Launch arguments</h2>

<p><code class="language-plaintext highlighter-rouge">simple_launch</code> allows declaring launch arguments and getting them in return.</p>

<h3 id="declare-a-launch-argument">Declare a launch argument</h3>

<p><code class="language-plaintext highlighter-rouge">sl.declare_arg(name, default_value, description = None)</code>: declare and returns the argument</p>

<p>Contrary to the base API, the default value is a raw Python type.</p>

<h3 id="retrieve-a-launch-argument">Retrieve a launch argument</h3>

<p><code class="language-plaintext highlighter-rouge">sl.arg(name)</code>: returns the argument <code class="language-plaintext highlighter-rouge">name</code> as a <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code></p>

<h3 id="retrieve-several-arguments-as-a-dictionary">Retrieve several arguments as a dictionary</h3>

<p><code class="language-plaintext highlighter-rouge">sl.arg_map('robot', 'x', 'y')</code>: returns <code class="language-plaintext highlighter-rouge">{'robot': &lt;robot arg value&gt;, 'x': &lt;x arg value&gt;, 'y': &lt;y arg value&gt;}</code></p>

<p>Typical when forwarding some launch arguments to a node or an included launch file.</p>

<h2 id="groups-or-scopes">Groups or scopes</h2>

<p>Groups are created through the <code class="language-plaintext highlighter-rouge">with sl.group():</code> syntax and accept, a namespace an if/unless condition and an event.</p>

<p>Actions that are added in a scope inherit from all previous defined groups.</p>

<h3 id="by-namespace">By namespace</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(ns=sub_namespace):
    sl.node(package, executable)

</code></pre></div></div>

<h3 id="from-a-condition">From a condition</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(if_condition=True):
    sl.node(package, executable)

  with sl.group(unless_condition=&lt;some expression&gt;):
    sl.node(package, executable)

</code></pre></div></div>

<ul>
  <li>Only one condition can be set in a group, nested condition must be combined first, or used in nested groups.</li>
  <li>Combining conditions coming from launch arguments can be done with <code class="language-plaintext highlighter-rouge">sl.py_eval</code> as shown below.</li>
</ul>

<h3 id="from-conditional-arguments">From conditional arguments</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(if_arg='use_gui'):
    sl.node(package, executable)

  with sl.group(unless_arg='dont_do'):
    sl.node(package, executable)

</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">if_arg</code> / <code class="language-plaintext highlighter-rouge">unless_arg</code> is expected to be the name of a launch argument. These two lines are equivalent:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(if_arg='use_gui'):
  with sl.group(if_condition=sl.arg('use_gui')):

</code></pre></div></div>
<p>If <code class="language-plaintext highlighter-rouge">if_arg</code> / <code class="language-plaintext highlighter-rouge">unless_arg</code> is not a string then it is considered as a <code class="language-plaintext highlighter-rouge">if_condition</code> / <code class="language-plaintext highlighter-rouge">unless_condition</code>.</p>

<h3 id="from-events">From events</h3>

<p>The <code class="language-plaintext highlighter-rouge">when</code> argument wraps events from the <code class="language-plaintext highlighter-rouge">launch.event_handlers</code> module. It combines an event and a delay (0 by default)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch.events import When, OnProcessStart, OnProcessExit, OnProcessIO

  my_node = sl.node(...)   # reference node

  with sl.group(when = When(my_node, OnProcessStart, 1.)):
      sl.node(...)  # will run 1 s after main node starts

  with sl.group(when = When(my_node, OnProcessExit)):
      sl.node(...)  # will run as soon as the main node exists

  with sl.group(when = When(my_node, OnProcessIO, io = 'stdout'):
      # OnProcessIO events need a function changing the event into an action
      sl.add_action(lambda event: LogInfo(msg = 'Node says "{}"'.format(
                      event.text.decode().strip())))
      # several functions can be used if needed, they will be combined in a single one
      sl.add_action(lambda event: LogInfo(msg = 'Once again, node says "{}"'.format(
                      event.text.decode().strip())))

  with sl.group(when = When(delay = 2.)):
      sl.node(...)  # will run after 2 sec

</code></pre></div></div>

<h3 id="creating-containers">Creating containers</h3>

<p>This syntax adds the <code class="language-plaintext highlighter-rouge">composition/composition::Talker</code> as a ComposableNode</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.container(name='my_container', output='screen'):
    sl.node(package='composition', plugin='Talker', name='talker')

</code></pre></div></div>

<p>Use the <code class="language-plaintext highlighter-rouge">executable</code> and <code class="language-plaintext highlighter-rouge">package</code> parameters if you want to use executors other than <code class="language-plaintext highlighter-rouge">rclcpp_components</code>â€™s <code class="language-plaintext highlighter-rouge">component_container</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.container(name='my_container', output='screen', executable='component_container_isolated'):

</code></pre></div></div>

<p><strong><em>It is currently impossible to have group blocks within a container block, as containers can only accept <code class="language-plaintext highlighter-rouge">ComposableNode</code>s</em></strong>. A <code class="language-plaintext highlighter-rouge">GroupAction</code> containing e.g. <code class="language-plaintext highlighter-rouge">PushRosNamespace</code> and a <code class="language-plaintext highlighter-rouge">ComposableNode</code> is not itself a <code class="language-plaintext highlighter-rouge">ComposableNode</code>.</p>

<h2 id="use_sim_time"><code class="language-plaintext highlighter-rouge">use_sim_time</code></h2>

<p>The current <code class="language-plaintext highlighter-rouge">use_sim_time</code> setting can be retrieved through <code class="language-plaintext highlighter-rouge">sl.sim_time</code> that may be:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">None</code>, if <code class="language-plaintext highlighter-rouge">use_sim_time</code> was not set in the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> constructor</li>
  <li>a raw Boolean, if <code class="language-plaintext highlighter-rouge">use_sim_time</code> was set to <code class="language-plaintext highlighter-rouge">'auto'</code>, depending on the <code class="language-plaintext highlighter-rouge">/clock</code> topic being advertized</li>
  <li>a Boolean launch argument, if <code class="language-plaintext highlighter-rouge">use_sim_time</code> was set to <code class="language-plaintext highlighter-rouge">True</code> or <code class="language-plaintext highlighter-rouge">False</code>
</li>
</ul>

<p>In all cases, if the <code class="language-plaintext highlighter-rouge">use_sim_time</code> parameter is explicitely given to a node, it will be used instead of the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> instance one.</p>

<h2 id="opaquefunction-with-implicit-performcontext">
<code class="language-plaintext highlighter-rouge">OpaqueFunction</code> with implicit <code class="language-plaintext highlighter-rouge">.perform(context)</code>
</h2>

<p>Most of the use cases can be dealt with substitutions and <code class="language-plaintext highlighter-rouge">with sl.group</code> blocks.
In order to design more imperative launch files, the <a href="https://discourse.ros.org/t/simplifying-launch-argument-declaration-and-initialization-in-launch-files/24204"><code class="language-plaintext highlighter-rouge">OpaqueFunction</code></a> approach can be used. The main drawback is that potential errors are harder to track.</p>

<p>To do this with <code class="language-plaintext highlighter-rouge">simple_launch</code>:</p>

<ul>
  <li>the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> instance and the argument declaration should be done in the main body of your launch file.</li>
  <li>then, define a function (e.g. <code class="language-plaintext highlighter-rouge">launch_setup</code>) that takes no argument, where the logic of the launch file resides.</li>
  <li>all arguments obtained through <code class="language-plaintext highlighter-rouge">sl.arg</code> will be basic Python types, obtained from performing the substitutions.</li>
  <li>finally just export <code class="language-plaintext highlighter-rouge">generate_launch_description = sl.launch_description(opaque_function = launch_setup)</code>.</li>
</ul>

<p>Compare <a href="https://github.com/oKermorgant/simple_launch/tree/devel/example/example_launch.py"><code class="language-plaintext highlighter-rouge">example_launch.py</code></a> and <a href="https://github.com/oKermorgant/simple_launch/tree/devel/example/example_opaque_launch.py"><code class="language-plaintext highlighter-rouge">example_opaque_launch.py</code></a> to see the two approaches on the same logic.</p>

<p>Note that inside an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code> the if/unless idiom reduces to a basic if/else:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># with substitutions
with sl.group(if_arg='some_condition'):
  # do stuff
with sl.group(unless_arg='some_condition'):
  # do other stuff

# with opaque function
if sl.arg('some_condition'):
  # do stuff
else:
  # do other stuff

</code></pre></div></div>

<h2 id="other-one-liners">Other one-liners</h2>

<p>Methods listed below return instances of <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code> that represent any Substitution, but that provides concatenation (<code class="language-plaintext highlighter-rouge">+</code>) and path concatenation (<code class="language-plaintext highlighter-rouge">/</code>) operators. It is still a <code class="language-plaintext highlighter-rouge">Substitution</code>, not a raw Python type. If run from an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code> the underlying Python variable is returned.</p>

<h3 id="string--substitution-concatenation">String / substitution concatenation</h3>

<p>The following syntax builds the <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code> corresponding to <code class="language-plaintext highlighter-rouge">&lt;robot arg&gt;.xacro</code>:</p>

<p><code class="language-plaintext highlighter-rouge">file_name = sl.arg('robot') + '.xacro'</code></p>

<p><em>deprecated</em>: <code class="language-plaintext highlighter-rouge">sl.name_join(sl.arg('robot'), '.xacro')</code></p>

<h3 id="path-concatenation">Path concatenation</h3>

<p>The following syntax builds the <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code> corresponding to <code class="language-plaintext highlighter-rouge">&lt;package_path&gt;/urdf/&lt;robot arg&gt;.xacro</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>file_name = sl.arg('robot') + '.xacro'
urdf_file = os.path.join(get_package_share_directory(package),'urdf')/file_name

</code></pre></div></div>
<p>Obviously if all the path elements are raw strings, you should use <code class="language-plaintext highlighter-rouge">os.path.join</code> all along.</p>

<p><em>deprecated</em>: <code class="language-plaintext highlighter-rouge">sl.path_join(get_package_share_directory(package), sl.arg('robot'), '.xacro')</code></p>

<h3 id="find-a-share-file">Find a share file</h3>

<p><code class="language-plaintext highlighter-rouge">path = sl.find(package, file_name = None, file_dir = None)</code> where:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">package</code> is the name of the package or <code class="language-plaintext highlighter-rouge">None</code> if <code class="language-plaintext highlighter-rouge">file_name</code> is already an absolute path</li>
  <li>
<code class="language-plaintext highlighter-rouge">file_name</code> is the name of the file to find</li>
  <li>
<code class="language-plaintext highlighter-rouge">file_dir</code> is the path inside the package</li>
</ul>

<p>If <code class="language-plaintext highlighter-rouge">file_dir</code> is <code class="language-plaintext highlighter-rouge">None</code> but <code class="language-plaintext highlighter-rouge">package</code> and <code class="language-plaintext highlighter-rouge">file_name</code> are raw strings then the <code class="language-plaintext highlighter-rouge">find</code> function will actually look for the file inside the package share, using <code class="language-plaintext highlighter-rouge">os.walk</code>.</p>

<p>If <code class="language-plaintext highlighter-rouge">file_name</code> is <code class="language-plaintext highlighter-rouge">None</code> then the function just returns the path to the package share directory (e.g. <code class="language-plaintext highlighter-rouge">get_package_share_directory(package)</code>)</p>

<h3 id="robot-state-publisher">Robot state publisher</h3>

<p>It is quite common to run a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> from a <code class="language-plaintext highlighter-rouge">urdf</code> or <code class="language-plaintext highlighter-rouge">xacro</code> file. The line below runs it at the current namespace / condition level:</p>

<p><code class="language-plaintext highlighter-rouge">sl.robot_state_publisher(package, description_file, description_dir=None, xacro_args=None, **node_args)</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">description_file</code> is a URDF or xacro file</li>
  <li>
<code class="language-plaintext highlighter-rouge">description_dir</code> is the sub-directory of the file. If omitted, let the script search for the file assuming it is a raw string</li>
  <li>
<code class="language-plaintext highlighter-rouge">xacro_args</code> is a dictionary of arguments to forward to xacro</li>
  <li>
<code class="language-plaintext highlighter-rouge">node_args</code> are any additional arguments for <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> (remappings / parameters)</li>
</ul>

<h3 id="python-expressions">Python expressions</h3>

<p><code class="language-plaintext highlighter-rouge">sl.py_eval</code> will evaluate the given arguments as a Python expression, possibly performed if in an Opaque Function.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># RGB color as a list of [0-255] integers
sl.declare_arg('color', [255,0,0])
# same color as a string of [0-1] numbers (URDF format), note the padding commas to get a string
xacro_color = "'" + sl.py_eval("' '.join(str(c/255) for c in ", sl.arg('color'), ')') + "'"

</code></pre></div></div>

<h3 id="conditions">Conditions</h3>

<p><code class="language-plaintext highlighter-rouge">sl.py_eval</code> can be used to combine conditions. It is robust to lower case <code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">false</code> and will return a <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sl.declare_arg('some_condition', True)
opposed = sl.py_eval('not ', sl.arg('some_condition'))

</code></pre></div></div>

<p>Note that <code class="language-plaintext highlighter-rouge">IfCondition</code> and <code class="language-plaintext highlighter-rouge">UnlessCondition</code> cannot be combined, <a href="https://answers.ros.org/answers/414006/revisions/">only the underlying <code class="language-plaintext highlighter-rouge">Substitution</code>s can</a>.</p>

<h3 id="joint-state-publisher">Joint state publisher</h3>

<p><code class="language-plaintext highlighter-rouge">sl.joint_state_publisher(use_gui, **node_args)</code>: fires up a <code class="language-plaintext highlighter-rouge">joint_state_publisher</code>, with or without the gui, in the current namespace.</p>

<h3 id="rviz">Rviz</h3>

<p><code class="language-plaintext highlighter-rouge">sl.rviz(config_file = None, warnings = False)</code>: runs RViz on the given configuration file. If <code class="language-plaintext highlighter-rouge">warnings</code> is <code class="language-plaintext highlighter-rouge">False</code> (default) then runs with <code class="language-plaintext highlighter-rouge">log-level FATAL</code> in order to avoid many messages in the console.</p>

<p>Classical use case: <code class="language-plaintext highlighter-rouge">sl.rviz(sl.find('my_package', 'some_rviz_config.rviz'))</code></p>

<h3 id="fallback-to-low-level-syntax">Fallback to low-level syntax</h3>

<p>If any unavailable functionality is needed, the <code class="language-plaintext highlighter-rouge">sl.add_action(action)</code> function adds any passed <code class="language-plaintext highlighter-rouge">Action</code> at the current namespace / conditional / event level.</p>

<h2 id="interaction-with-gazebo--ignition">Interaction with Gazebo / Ignition</h2>

<p><em>Note: Ignition being renamed to Gazebo, all tools in this section use Gazebo / gz names</em></p>

<p>An effort was made to be robust to Ignition versus Gazebo uses, i.e. <em>ign</em> prefix is used for <code class="language-plaintext highlighter-rouge">foxy</code> and <code class="language-plaintext highlighter-rouge">galactic</code> while <em>gz</em> prefix is used from <code class="language-plaintext highlighter-rouge">humble</code>. <code class="language-plaintext highlighter-rouge">GZ_VERSION</code> and <code class="language-plaintext highlighter-rouge">IGNITION_VERSION</code> environment variables are also used to identify which version should be preferred.</p>

<h3 id="launch-gazebo">Launch Gazebo</h3>

<p>The Gazebo launch file corresponding to the current ROS 2 distribution is launched with</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sl.gz_launch(world_file, gz_arguments, full_world = None, save_after = 5.)

</code></pre></div></div>
<p>Namely, it will redirect to either <code class="language-plaintext highlighter-rouge">ros_ign_gazebo/ign_gazebo.launch.py</code> (<code class="language-plaintext highlighter-rouge">foxy</code>, <code class="language-plaintext highlighter-rouge">galactic</code>) or <code class="language-plaintext highlighter-rouge">ros_gz_sim/gz_sim.launch.py</code> (<code class="language-plaintext highlighter-rouge">humble</code>+).
The given <code class="language-plaintext highlighter-rouge">gz_arguments</code>, if any, will be forwarded either as the <code class="language-plaintext highlighter-rouge">ign_args</code> or <code class="language-plaintext highlighter-rouge">gz_args</code>, accordingly.</p>

<p>If the world file can be parsed then <code class="language-plaintext highlighter-rouge">SimpleLaunch</code> will detect its name and forward it to <code class="language-plaintext highlighter-rouge">GazeboBridge</code> functions.</p>

<p>If <code class="language-plaintext highlighter-rouge">full_world</code> is a raw string then the world will be saved into this file after the delay. This will include any URDF that was spawned in between.</p>

<h3 id="spawn-a-model">Spawn a model</h3>

<p>The following function allows easily spawing a model from its <code class="language-plaintext highlighter-rouge">robot_description</code>:</p>

<p><code class="language-plaintext highlighter-rouge">sl.spawn_gz_model(name, topic, model_file = None, spawn_args = [], only_new = True)</code></p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">name</code> is the name this model will get in Gazebo</li>
  <li>
<code class="language-plaintext highlighter-rouge">topic</code> is the topic to obtain the model from, default is <code class="language-plaintext highlighter-rouge">robot_description</code> (relative to the current namespace)</li>
  <li>
<code class="language-plaintext highlighter-rouge">model_file</code> is the path to the (urdf or sdf) file. If defined then this will spawn this model and ignore the topic</li>
  <li>
<code class="language-plaintext highlighter-rouge">only_new</code> if True, will not spawn the model if it already exists in a running Gazebo instance</li>
  <li>
<code class="language-plaintext highlighter-rouge">spawn_args</code> are any additional spawn arguments, e.g. the initial pose</li>
</ul>

<p><strong>example:</strong> <code class="language-plaintext highlighter-rouge">sl.spawn_gz_model('my_robot', model_file = sl.find('my_pkg', 'my_model.urdf'))</code></p>

<h3 id="declare-initial-pose">Declare initial pose</h3>

<p>Calling <code class="language-plaintext highlighter-rouge">sl.declare_gazebo_axes()</code> will declare all 6 parameters <code class="language-plaintext highlighter-rouge">(x,y,z,roll,pitch,yaw)</code> with <code class="language-plaintext highlighter-rouge">0</code> as default values.
If any axis is given (e.g. <code class="language-plaintext highlighter-rouge">sl.declare_gazebo_axes(yaw = 3.14)</code> then only this parameter will be declared.</p>

<p>Such parameters can be retrieved through <code class="language-plaintext highlighter-rouge">sl.gazebo_axes_args()</code>. As a consequence, it is easy to spawn a model with:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sl.declare_gazebo_axes()
sl.robot_description(...)
sl.spawn_gz_model(name, spawn_args = sl.gazebo_axes_args())

</code></pre></div></div>

<h3 id="save-current-world">Save current world</h3>

<p>If the simulation is reset after some models have been spawned, they will disappear. A convenient way to avoid this is to generate the full SDF world from a running simulation. The Gazebo GUI is able to export the current world but cannot resolve models that were spawned from e.g. a <code class="language-plaintext highlighter-rouge">robot_description</code> topic.</p>

<p>The script <code class="language-plaintext highlighter-rouge">generate_gz_world</code> will generate a SDF corresponding to the current simulation. If some models have been spawned from URDF and topics, the script will get the corresponding description and insert it into the SDF, assuming robot <code class="language-plaintext highlighter-rouge">name</code> has its description under <code class="language-plaintext highlighter-rouge">/name/robot_description</code>. It can also be called from a launch file with (see Gazebo example):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># you might want to add a delay to be sure all models have been spawned
sl.save_gz_world(full_world.sdf, after = 1.)

</code></pre></div></div>

<p>Such a self-contained SDF world file is then compatible with a reset of the simulation. See Gazebo example for launch file that checks if the full world is available.</p>

<h3 id="gazebo-bridge">Gazebo bridge</h3>

<p>The <code class="language-plaintext highlighter-rouge">GazeboBridge</code> class allows easily creating bridges when using Gazebo.</p>

<p>An instance is created with: <code class="language-plaintext highlighter-rouge">bridge = GazeboBridge(&lt;gazebo_topic&gt;, &lt;ros_topic&gt;, &lt;ros_message&gt;, direction, &lt;gz_message&gt; = None)</code> where <code class="language-plaintext highlighter-rouge">direction</code> is either:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.gz2ros</code> for Gazebo -&gt; ROS</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.ros2gz</code> for ROS -&gt; Gazebo</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.bidirectional</code> for both</li>
</ul>

<p>The Gazebo message type is <a href="https://github.com/gazebosim/ros_gz/tree/ros2/ros_gz_bridge">deduced from the ROS message type</a> if not set. Remapping will be set to the given <code class="language-plaintext highlighter-rouge">ros_topic</code>.</p>

<p>The SimpleLauncher instance can then run a node dealing with declared bridges, as illustrated in the examples at this end of this document.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">sl.create_gz_bridge([bridges], &lt;node_name&gt;)
</code></li>
</ul>

<p>If some bridges involve <code class="language-plaintext highlighter-rouge">sensor_msgs/Image</code> then a dedicated <code class="language-plaintext highlighter-rouge">ros_gz_image</code> bridge will be used. The corresponding <code class="language-plaintext highlighter-rouge">camera_info</code> topic will be also bridged.</p>

<h3 id="interaction-with-gazebo-sim">Interaction with Gazebo sim</h3>

<p>Some bridges (e.g. <code class="language-plaintext highlighter-rouge">joint_states</code>) need to have information on the world name. This name can only be obtained while Gazebo is running, or by having a priori knowledge of the world file.</p>

<p>The <code class="language-plaintext highlighter-rouge">GazeboBridge</code> class has a few static methods to get information on the simulated world, namely:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.world()</code> returns the current world name</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.set_world_name(world)</code> imposes the world name</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.model_prefix(model)</code> builds the Gazebo topic relative to the given model <code class="language-plaintext highlighter-rouge">/world/&lt;world&gt;/model/&lt;model&gt;</code>
</li>
</ul>

<p>They can be used under these conditions:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">sl.gz_launch</code> was called first (in the same launch setup) and the world file could be parsed, in this case the world name from the file is used</li>
  <li>or <code class="language-plaintext highlighter-rouge">GazeboBridge.set_world_name(world)</code> was called first (in the same launch setup), in this case this world name is used</li>
  <li>if none of the above and a <strong>running Gazebo</strong> instance exists, in this case <code class="language-plaintext highlighter-rouge">GazeboBridge</code> will request information on the world</li>
</ul>

<p>If none of these conditions hold, the launch file will not be able to get information on the world, and launch fill probably fail.</p>

<h3 id="built-in-bridges">Built-in bridges</h3>

<p>A common instance of the bridge is the clock. This one can be:</p>

<ul>
  <li>created with <code class="language-plaintext highlighter-rouge">GazeboBridge.clock()</code>: returns a <code class="language-plaintext highlighter-rouge">GazeboBridge</code> instance, not added to any node yet</li>
  <li>or run directly with <code class="language-plaintext highlighter-rouge">sl.create_gz_clock_bridge()</code> (actually runs <code class="language-plaintext highlighter-rouge">sl.create_gz_bridge(GazeboBridge.clock())</code>)</li>
</ul>

<p>Another common but tedious bridge instance is the joint state topic of a given model. This topic includes, in Gazebo, the name of the world <em>and</em> of the model. Assuming the world name is known, the corresponding bridge can be created with:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">GazeboBridge.joint_states_bridge(model)</code></li>
  <li>actually runs <code class="language-plaintext highlighter-rouge">GazeboBridge('/world/&lt;world&gt;/model/&lt;model&gt;/joint_state', 'joint_states', 'sensor_msgs/JointState', GazeboBridge.gz2ros)</code>
</li>
</ul>

<h3 id="world-tf-publisher">World TF publisher</h3>

<p>If <code class="language-plaintext highlighter-rouge">/tf</code> is used with Gazebo, then the root frame used by Gazebo depends on the world name. This frame is usually <code class="language-plaintext highlighter-rouge">world</code> on the ROS side.
A trivial <code class="language-plaintext highlighter-rouge">static_transform_publisher</code> is run to connect these two frames if they have different names:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">sl.gz_world_tf(world_frame = None)</code>: run a <code class="language-plaintext highlighter-rouge">static_transform_publisher</code> from <code class="language-plaintext highlighter-rouge">world</code> to <code class="language-plaintext highlighter-rouge">world_frame</code>. If <code class="language-plaintext highlighter-rouge">None</code> then detect the one currently used by Gazebo.</li>
</ul>

<h2 id="examples">Examples</h2>

<p>Examples can be found in the corresponding folder.</p>

<h3 id="launch-with-arguments">Launch with arguments</h3>

<p>Here is a file spawning a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> and its <code class="language-plaintext highlighter-rouge">joint_state_publisher</code>, where:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">prefix</code>, <code class="language-plaintext highlighter-rouge">x</code> and <code class="language-plaintext highlighter-rouge">y</code> are launch arguments that are passed to xacro</li>
  <li>
<code class="language-plaintext highlighter-rouge">use_gui</code> tells whether <code class="language-plaintext highlighter-rouge">joint_state_publisher</code> should run the gui</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():
    '''
    Launch description for a single robot - runs the two nodes in their own namespace
    '''
    sl = SimpleLauncher()

    sl.declare_arg('prefix', default_value = '', description='name of the robot (+ tf prefix)')
    sl.declare_arg('x', default_value = 0, description='x-offset of the robot')
    sl.declare_arg('y', default_value = 0, description='y-offset of the robot')
    sl.declare_arg('use_gui', default_value = True, description='Use JSP gui')

    xacro_args = sl.arg_map('prefix', 'x', 'y')
    xacro_args['prefix'] += '/'  # can sum substitutions and strings

    with sl.group(ns=sl.arg('prefix')):
        sl.robot_state_publisher('simple_launch', 'turret.xacro', xacro_args = xacro_args)
        sl.joint_state_publisher(use_gui = sl.arg('use_gui'))

    return sl.launch_description()

</code></pre></div></div>

<h3 id="conditional-blocks-and-includes">Conditional blocks and includes</h3>

<p>The file below fires up either <code class="language-plaintext highlighter-rouge">robot1</code> or <code class="language-plaintext highlighter-rouge">robot2</code> (or both) and also has a boolean argument to spawn <code class="language-plaintext highlighter-rouge">RViz2</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():

    sl = SimpleLauncher()

    # conditional args
    sl.declare_arg('robot1', default_value=True, description='use robot 1')
    sl.declare_arg('robot2', default_value=True, description='use robot 2')
    sl.declare_arg('no_robot2', default_value=False, description='cancel use of robot 2')
    sl.declare_arg('rviz', default_value=True, description='Bringup RViz2')

    # numeric args
    sl.declare_arg('robot2_x', default_value=1, description='x-offset of robot 2')
    sl.declare_arg('robot2_y', default_value=1, description='y-offset of robot 2')

    with sl.group(if_arg='robot1'):
        sl.include('simple_launch', 'included_launch.py',
                   launch_arguments = {'prefix': 'robot1'})

    with sl.group(if_arg='robot2'):

        with sl.group(unless_arg='no_robot2'):

            args = {'prefix': 'robot2', 'x':sl.arg('robot2_x'), 'y': sl.arg('robot2_y')}
            sl.include('simple_launch', 'included_launch.py', launch_arguments=args)

    with sl.group(if_arg='rviz'):
        rviz_config = sl.find('simple_launch', 'turret.rviz')
        sl.node('rviz2', 'rviz2', arguments = ['-d', rviz_config])

    return sl.launch_description()

</code></pre></div></div>

<h3 id="conditions-with-opaquefunction">Conditions with OpaqueFunction</h3>

<p>The file below does the same as the previous one, but using an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

# declare simple launcher and the launch arguments in the main body
sl = SimpleLauncher()

# conditional args
sl.declare_arg('robot1', default_value=True, description='use robot 1')
sl.declare_arg('robot2', default_value=True, description='use robot 2')
sl.declare_arg('no_robot2', default_value=False, description='cancel use of robot 2')
sl.declare_arg('rviz', default_value=True, description='Bringup RViz2')

# numeric args
sl.declare_arg('robot2_x', default_value=1, description='x-offset of robot 2')
sl.declare_arg('robot2_y', default_value=1, description='y-offset of robot 2')

# string args
sl.declare_arg('included', default_value = 'included_launch')


# define the opaque function, context will be wrapped in the SimpleLauncher instance
def launch_setup():

    # we can use raw if as `robot1` argument is performed to a Boolean
    if sl.arg('robot1'):
        sl.include('simple_launch', 'included_launch.py', launch_arguments = {'prefix': 'robot1'})

    # and even combine conditions
    if sl.arg('robot2') and not sl.arg('no_robot2'):

            args = {'prefix': 'robot2', 'x':sl.arg('robot2_x'), 'y': sl.arg('robot2_y')}
            # summing up args and strings
            sl.include('simple_launch', sl.arg('included') + '.py', launch_arguments=args)

    if sl.arg('rviz'):
        rviz_config = sl.find('simple_launch', 'turret.rviz')
        sl.node('rviz2', 'rviz2', arguments = ['-d', rviz_config])

    return sl.launch_description()


# tell SimpleLauncher to rely on the opaque_function in the launch description
# /!\ no `def generate_launch_description():`

generate_launch_description = sl.launch_description(opaque_function = launch_setup)

</code></pre></div></div>

<h3 id="combining-conditions">Combining conditions</h3>

<p>The file below shows how to use <code class="language-plaintext highlighter-rouge">sl.py_eval</code> to combine conditions. We have to build a valid Python expression, not forgetting the spaces around <code class="language-plaintext highlighter-rouge">and</code>, <code class="language-plaintext highlighter-rouge">or</code>, <code class="language-plaintext highlighter-rouge">not</code>, etc.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():

    sl = SimpleLauncher()

    cond1 = sl.declare_arg('cond1', True)
    cond2 = sl.declare_arg('cond2', False)

    for logic in ('and', 'or'):

        # builds &lt;cond1&gt; &lt;logic&gt; &lt;cond2&gt; Python expression
        combined = sl.py_eval(cond1, f' {logic} ', cond2)

        sl.log_info([f'{logic} condition is ', combined])

        with sl.group(if_condition = combined):
            sl.node('demo_nodes_cpp', 'talker', name = f'talker_{logic}')

        # also works with sl.node(..., condition = IfCondition(combined))

    return sl.launch_description()

</code></pre></div></div>

<h3 id="composition">Composition</h3>

<p>The file below is another way to write the <a href="https://index.ros.org/doc/ros2/Tutorials/Composition/#composition-using-launch-actions">composition launch example</a>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():

    sl = SimpleLauncher()

    with sl.container(name='my_container', output='screen'):
        sl.node(package='composition', plugin='Talker', name='talker')
        sl.node(package='composition', plugin='Listener', name='listener')

    return sl.launch_description()

</code></pre></div></div>

<h3 id="events-and-parameters">Events and parameters</h3>

<p>This <a href="https://github.com/oKermorgant/simple_launch/tree/devel/example/event_tutorial_launch.py">example file</a> is another way to write the <a href="https://docs.ros.org/en/rolling/Tutorials/Intermediate/Launch/Using-Event-Handlers.html">event launch example</a>. If does a little more work and is a little smarter, as the passed <code class="language-plaintext highlighter-rouge">new_background_r</code> is applied as soon as it has a valid value.</p>

<h3 id="auto-sim-time">auto sim time</h3>

<p>Here we run Gazebo and force all other nodes to <code class="language-plaintext highlighter-rouge">use_sim_time:=True</code>, unless this file is included from another one with <code class="language-plaintext highlighter-rouge">use_sim_time:=False</code>.
This is unlikely as this launch file spawns a simulator.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher, GazeboBridge

def generate_launch_description():

    # all nodes in this launch file will use_sim_time:=True
    sl = SimpleLauncher(use_sim_time=True)

    # run Gazebo + clock bridge
    sl.gz_launch(&lt;path/to/some/sdf/world&gt;, '-r')
    sl.create_gz_clock_bridge()

    # run other nodes with sim time

    return sl.launch_description()


</code></pre></div></div>

<h3 id="robot-description-and-conditionnal-gazebo-bridge">Robot description and conditionnal Gazebo bridge</h3>

<p>The file below only runs by default a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> with <code class="language-plaintext highlighter-rouge">use_sim_time:=False</code>.
However, if it is included from another file with <code class="language-plaintext highlighter-rouge">use_sim_time:=True</code> then it also spawns the robot into Gazebo and runs two bridges for joint states and pose.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher, GazeboBridge

def generate_launch_description():

    sl = SimpleLauncher(use_sim_time=False)

    # namespace is a launch argument, not a Python string
    sl.declare_arg('robot', default_value = 'robot1')
    robot = sl.arg('robot')

    with sl.group(ns = robot):
        # robot_state_publisher is always run
        sl.robot_state_publisher('my_description', 'my_robot.xacro')

        with sl.group(if_condition = sl.sim_time):
            # only execute this group if use_sim_time was set to True

            # spawn in Gazebo at default pose if not already here
            sl.spawn_gz_model(robot)

            # create a bridge for joint states @ /world/&lt;world&gt;/model/&lt;robot&gt;/joint_state
            # note the relative ROS topic 'joint_states' that is actually namespaced
            gz_js_topic = GazeboBridge.model_prefix(robot)/'joint_state'
            js_bridge = GazeboBridge(gz_topic = gz_js_topic,
                                     ros_topic = 'joint_states',
                                     msg = 'sensor_msgs/JointState',
                                     direction = GazeboBridge.gz2ros)

            # pose publisher bridge @ /model/&lt;robot&gt;
            pose_bridge = GazeboBridge('/model'/robot/'/pose',
                                       'pose_gt', 'geometry_msgs/Pose', GazeboBridge.gz2ros)

            # create bridge node with these two topics with default name gz_bridge
            sl.create_gz_bridge([js_bridge, pose_bridge])

    return sl.launch_description()


</code></pre></div></div>

<h3 id="full-gazebo-simulation">Full Gazebo simulation</h3>

<p>The file <code class="language-plaintext highlighter-rouge">example/gazebo/gazebo_launch.py</code> runs a basic simulation of a turret robot with a camera, also displayed in RViz.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch simple_launch gazebo_launch.py

</code></pre></div></div>

<p>You can move the robot around with a joint velocity setpoint (<code class="language-plaintext highlighter-rouge">std_msgs/Float64</code>) on <code class="language-plaintext highlighter-rouge">/turret/joint#</code> and see the simulated camera on <code class="language-plaintext highlighter-rouge">/turret/image</code>.</p>

<h2 id="i-want-more-examples">I want more examples</h2>

<p>Other self-contained examples (and slides) have been used to teach the ROS 2 launch file system and the nav stack.</p>

<p>Various aspects of the launch systen are shown in the <a href="https://github.com/oKermorgant/anf_launch">anf_launch</a> package.</p>

<p>A simple tutorial on <code class="language-plaintext highlighter-rouge">Nav2</code>  using <code class="language-plaintext highlighter-rouge">simple_launch</code> is available in the <a href="https://github.com/oKermorgant/anf_nav">anf_nav</a> package.</p>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <em>No CONTRIBUTING.md found.</em>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-github">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/simple_launch">simple_launch</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-oKermorgant-simple_launch
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-oKermorgant-simple_launch" role="menuitem" tabindex="-1" href="/r/simple_launch/github-oKermorgant-simple_launch" data="github-oKermorgant-simple_launch">
                    <span class="glyphicon glyphicon-star"></span>
                    github-oKermorgant-simple_launch
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>github</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-noetic">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/simple_launch">simple_launch</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-oKermorgant-simple_launch
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-oKermorgant-simple_launch" role="menuitem" tabindex="-1" href="/r/simple_launch/github-oKermorgant-simple_launch" data="github-oKermorgant-simple_launch">
                    <span class="glyphicon glyphicon-star"></span>
                    github-oKermorgant-simple_launch
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>noetic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-galactic">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/simple_launch">simple_launch</a> <small>repository</small></h3>
        
        
        <a class="label label-primary pkg-label" href="/p/simple_launch">simple_launch</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-oKermorgant-simple_launch
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-oKermorgant-simple_launch" role="menuitem" tabindex="-1" href="/r/simple_launch/github-oKermorgant-simple_launch" data="github-oKermorgant-simple_launch">
                    <span class="glyphicon glyphicon-star"></span>
                    github-oKermorgant-simple_launch
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">This package provides a Python class to help writing ROS 2 launch files.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/oKermorgant/simple_launch.git">https://github.com/oKermorgant/simple_launch.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">devel</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-02-16
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/simple_launch/#galactic-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/simple_launch/#galactic-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/simple_launch/#galactic-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/simple_launch">simple_launch</a></td>
                    <td>1.11.0</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="simple_launch">simple_launch</h1>
<p>This package provides a Python class to help writing ROS 2 launch files.</p>

<p>The motivation behind this package is that the ROS 2 launch Python syntax may not be suited for many simple cases such as running basic nodes, spawning a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code>, and grouping nodes in namespaces or components.</p>

<p><strong>Thanks</strong>: this package is inspired by <a href="https://github.com/bponsler/ros2_launch_util">ros2_launch_util</a>.</p>

<p>The entry point is the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> class, which has several capabilities.</p>

<h2 id="basic-syntax">Basic syntax</h2>

<h3 id="namespace-and-argument-parser-initialization">Namespace and argument parser initialization</h3>

<p><code class="language-plaintext highlighter-rouge">sl = SimpleLauncher(namespace = '', use_sim_time = None, scope_included_files = False)</code></p>

<ul>
  <li>will initialize all nodes relative to the given namespace</li>
  <li>if <code class="language-plaintext highlighter-rouge">use_sim_time</code> is a Boolean, creates a <code class="language-plaintext highlighter-rouge">use_sim_time</code> launch argument with this value as the default and forwards it to all nodes, unless explicitely specified when running the node</li>
  <li>if <code class="language-plaintext highlighter-rouge">use_sim_time</code> is <code class="language-plaintext highlighter-rouge">'auto'</code>, then <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> will set it to <code class="language-plaintext highlighter-rouge">True</code> if the <code class="language-plaintext highlighter-rouge">/clock</code> topic is advertized (case of an already running simulation). <strong>This may have side effects if the <code class="language-plaintext highlighter-rouge">/clock</code> topic is advertized but you want to use this launch file with system clock</strong>.</li>
  <li>if <code class="language-plaintext highlighter-rouge">use_sim_time</code> is <code class="language-plaintext highlighter-rouge">None</code> (default) then no particular value is forwarded to the nodes</li>
  <li>if <code class="language-plaintext highlighter-rouge">scope_included_files</code> is <code class="language-plaintext highlighter-rouge">False</code> (default) then including another launch file that shares the same argument but while passing another value for this argument, will also <a href="https://robotics.stackexchange.com/questions/98997/ros2-foxy-python-launch-argument-scope-when-nesting-launch-files">modify the value of this argument after the inclusion</a>. This is the default behavior of <code class="language-plaintext highlighter-rouge">launch</code> but can be undesired. Inside an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code> the behavior is to be scoped anyway (the argument value is resolved) and <code class="language-plaintext highlighter-rouge">scope_included_files</code> has no effect.</li>
</ul>

<h3 id="node-registration">Node registration</h3>

<p><code class="language-plaintext highlighter-rouge">sl.node(package, executable, **node_args)</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">package</code> is the node package</li>
  <li>
<code class="language-plaintext highlighter-rouge">executable</code> is the name of the executable</li>
  <li>
<code class="language-plaintext highlighter-rouge">node_args</code> are any additional <code class="language-plaintext highlighter-rouge">Node</code> arguments</li>
</ul>

<h3 id="launch-file-include">Launch file include</h3>

<p><code class="language-plaintext highlighter-rouge">sl.include(package, launch_file, launch_dir = None, launch_arguments=None)</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">package</code> is the package of the included launch file</li>
  <li>
<code class="language-plaintext highlighter-rouge">launch_file</code> is the name of the launch file</li>
  <li>
<code class="language-plaintext highlighter-rouge">launch_dir</code> is its directory inside the package share (<code class="language-plaintext highlighter-rouge">None</code> to have it found)</li>
  <li>
<code class="language-plaintext highlighter-rouge">launch_arguments</code> is a dictionary of arguments to pass to the included launch file</li>
</ul>

<h3 id="call-a-service-at-launch">Call a service at launch</h3>

<p>This line runs a temporary client that waits for a service and calls it when available:</p>

<p><code class="language-plaintext highlighter-rouge">sl.call_service(server, request = None, verbosity = '')</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">server</code> is the path to some service (possibly namespaced). The service type is deduced when it becomes available.</li>
  <li>
<code class="language-plaintext highlighter-rouge">request</code> is a dictionary representing the service request. If <code class="language-plaintext highlighter-rouge">None</code> or incomplete, will use the service request default values.</li>
  <li>
<code class="language-plaintext highlighter-rouge">verbosity</code> let the underlying node describe what it is doing: <code class="language-plaintext highlighter-rouge">'req'</code> for request info, <code class="language-plaintext highlighter-rouge">'res'</code> for response info or both with <code class="language-plaintext highlighter-rouge">'reqres'</code>
</li>
</ul>

<p>If any request parameter is <code class="language-plaintext highlighter-rouge">__ns</code> it will be changed to the current namespace.</p>

<h3 id="setting-parameters">Setting parameters</h3>

<p>This line runs a temporary client that waits for a node and changes its parameters when available:</p>

<p><code class="language-plaintext highlighter-rouge">sl.set_parameters(node_name, parameters: dict = {}, verbosity = '')</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">node_name</code> is the name of the node (possibly namespaced)</li>
  <li>
<code class="language-plaintext highlighter-rouge">parameters</code> is a dictionary of (name, value) parameters to be set</li>
  <li>
<code class="language-plaintext highlighter-rouge">verbosity</code> let the underlying node describe what it is doing: <code class="language-plaintext highlighter-rouge">'req'</code> for request info, <code class="language-plaintext highlighter-rouge">'res'</code> for response info or both with <code class="language-plaintext highlighter-rouge">'reqres'</code>
</li>
</ul>

<p>This calls the <code class="language-plaintext highlighter-rouge">set_parameters</code> service of the node with the passed types. Possible errors may happen if the parameters do not exist or are of a different type.</p>

<h3 id="robust-types-for-parameters">Robust types for parameters</h3>

<p>In the launch API, differents types are expected for:</p>

<ul>
  <li>node parameters: a list of dictionaries</li>
  <li>node remappings: a list of (<code class="language-plaintext highlighter-rouge">key</code>, <code class="language-plaintext highlighter-rouge">value</code>) pairs</li>
  <li>included launch arguments: a list of (<code class="language-plaintext highlighter-rouge">key</code>, <code class="language-plaintext highlighter-rouge">value</code>) pairs</li>
  <li>xacro arguments: a concatenation of <code class="language-plaintext highlighter-rouge">key:=value</code> strings</li>
</ul>

<p>The <code class="language-plaintext highlighter-rouge">sl.include</code>, <code class="language-plaintext highlighter-rouge">sl.node</code> and <code class="language-plaintext highlighter-rouge">xacro_args</code> calls allow using any type (the simplest being a single dictionary)  and will convert to the one expected by the API.</p>

<h2 id="launch-arguments">Launch arguments</h2>

<p><code class="language-plaintext highlighter-rouge">simple_launch</code> allows declaring launch arguments and getting them in return.</p>

<h3 id="declare-a-launch-argument">Declare a launch argument</h3>

<p><code class="language-plaintext highlighter-rouge">sl.declare_arg(name, default_value, description = None)</code>: declare and returns the argument</p>

<p>Contrary to the base API, the default value is a raw Python type.</p>

<h3 id="retrieve-a-launch-argument">Retrieve a launch argument</h3>

<p><code class="language-plaintext highlighter-rouge">sl.arg(name)</code>: returns the argument <code class="language-plaintext highlighter-rouge">name</code> as a <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code></p>

<h3 id="retrieve-several-arguments-as-a-dictionary">Retrieve several arguments as a dictionary</h3>

<p><code class="language-plaintext highlighter-rouge">sl.arg_map('robot', 'x', 'y')</code>: returns <code class="language-plaintext highlighter-rouge">{'robot': &lt;robot arg value&gt;, 'x': &lt;x arg value&gt;, 'y': &lt;y arg value&gt;}</code></p>

<p>Typical when forwarding some launch arguments to a node or an included launch file.</p>

<h2 id="groups-or-scopes">Groups or scopes</h2>

<p>Groups are created through the <code class="language-plaintext highlighter-rouge">with sl.group():</code> syntax and accept, a namespace an if/unless condition and an event.</p>

<p>Actions that are added in a scope inherit from all previous defined groups.</p>

<h3 id="by-namespace">By namespace</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(ns=sub_namespace):
    sl.node(package, executable)

</code></pre></div></div>

<h3 id="from-a-condition">From a condition</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(if_condition=True):
    sl.node(package, executable)

  with sl.group(unless_condition=&lt;some expression&gt;):
    sl.node(package, executable)

</code></pre></div></div>

<ul>
  <li>Only one condition can be set in a group, nested condition must be combined first, or used in nested groups.</li>
  <li>Combining conditions coming from launch arguments can be done with <code class="language-plaintext highlighter-rouge">sl.py_eval</code> as shown below.</li>
</ul>

<h3 id="from-conditional-arguments">From conditional arguments</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(if_arg='use_gui'):
    sl.node(package, executable)

  with sl.group(unless_arg='dont_do'):
    sl.node(package, executable)

</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">if_arg</code> / <code class="language-plaintext highlighter-rouge">unless_arg</code> is expected to be the name of a launch argument. These two lines are equivalent:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(if_arg='use_gui'):
  with sl.group(if_condition=sl.arg('use_gui')):

</code></pre></div></div>
<p>If <code class="language-plaintext highlighter-rouge">if_arg</code> / <code class="language-plaintext highlighter-rouge">unless_arg</code> is not a string then it is considered as a <code class="language-plaintext highlighter-rouge">if_condition</code> / <code class="language-plaintext highlighter-rouge">unless_condition</code>.</p>

<h3 id="from-events">From events</h3>

<p>The <code class="language-plaintext highlighter-rouge">when</code> argument wraps events from the <code class="language-plaintext highlighter-rouge">launch.event_handlers</code> module. It combines an event and a delay (0 by default)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch.events import When, OnProcessStart, OnProcessExit, OnProcessIO

  my_node = sl.node(...)   # reference node

  with sl.group(when = When(my_node, OnProcessStart, 1.)):
      sl.node(...)  # will run 1 s after main node starts

  with sl.group(when = When(my_node, OnProcessExit)):
      sl.node(...)  # will run as soon as the main node exists

  with sl.group(when = When(my_node, OnProcessIO, io = 'stdout'):
      # OnProcessIO events need a function changing the event into an action
      sl.add_action(lambda event: LogInfo(msg = 'Node says "{}"'.format(
                      event.text.decode().strip())))
      # several functions can be used if needed, they will be combined in a single one
      sl.add_action(lambda event: LogInfo(msg = 'Once again, node says "{}"'.format(
                      event.text.decode().strip())))

  with sl.group(when = When(delay = 2.)):
      sl.node(...)  # will run after 2 sec

</code></pre></div></div>

<h3 id="creating-containers">Creating containers</h3>

<p>This syntax adds the <code class="language-plaintext highlighter-rouge">composition/composition::Talker</code> as a ComposableNode</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.container(name='my_container', output='screen'):
    sl.node(package='composition', plugin='Talker', name='talker')

</code></pre></div></div>

<p>Use the <code class="language-plaintext highlighter-rouge">executable</code> and <code class="language-plaintext highlighter-rouge">package</code> parameters if you want to use executors other than <code class="language-plaintext highlighter-rouge">rclcpp_components</code>â€™s <code class="language-plaintext highlighter-rouge">component_container</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.container(name='my_container', output='screen', executable='component_container_isolated'):

</code></pre></div></div>

<p><strong><em>It is currently impossible to have group blocks within a container block, as containers can only accept <code class="language-plaintext highlighter-rouge">ComposableNode</code>s</em></strong>. A <code class="language-plaintext highlighter-rouge">GroupAction</code> containing e.g. <code class="language-plaintext highlighter-rouge">PushRosNamespace</code> and a <code class="language-plaintext highlighter-rouge">ComposableNode</code> is not itself a <code class="language-plaintext highlighter-rouge">ComposableNode</code>.</p>

<h2 id="use_sim_time"><code class="language-plaintext highlighter-rouge">use_sim_time</code></h2>

<p>The current <code class="language-plaintext highlighter-rouge">use_sim_time</code> setting can be retrieved through <code class="language-plaintext highlighter-rouge">sl.sim_time</code> that may be:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">None</code>, if <code class="language-plaintext highlighter-rouge">use_sim_time</code> was not set in the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> constructor</li>
  <li>a raw Boolean, if <code class="language-plaintext highlighter-rouge">use_sim_time</code> was set to <code class="language-plaintext highlighter-rouge">'auto'</code>, depending on the <code class="language-plaintext highlighter-rouge">/clock</code> topic being advertized</li>
  <li>a Boolean launch argument, if <code class="language-plaintext highlighter-rouge">use_sim_time</code> was set to <code class="language-plaintext highlighter-rouge">True</code> or <code class="language-plaintext highlighter-rouge">False</code>
</li>
</ul>

<p>In all cases, if the <code class="language-plaintext highlighter-rouge">use_sim_time</code> parameter is explicitely given to a node, it will be used instead of the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> instance one.</p>

<h2 id="opaquefunction-with-implicit-performcontext">
<code class="language-plaintext highlighter-rouge">OpaqueFunction</code> with implicit <code class="language-plaintext highlighter-rouge">.perform(context)</code>
</h2>

<p>Most of the use cases can be dealt with substitutions and <code class="language-plaintext highlighter-rouge">with sl.group</code> blocks.
In order to design more imperative launch files, the <a href="https://discourse.ros.org/t/simplifying-launch-argument-declaration-and-initialization-in-launch-files/24204"><code class="language-plaintext highlighter-rouge">OpaqueFunction</code></a> approach can be used. The main drawback is that potential errors are harder to track.</p>

<p>To do this with <code class="language-plaintext highlighter-rouge">simple_launch</code>:</p>

<ul>
  <li>the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> instance and the argument declaration should be done in the main body of your launch file.</li>
  <li>then, define a function (e.g. <code class="language-plaintext highlighter-rouge">launch_setup</code>) that takes no argument, where the logic of the launch file resides.</li>
  <li>all arguments obtained through <code class="language-plaintext highlighter-rouge">sl.arg</code> will be basic Python types, obtained from performing the substitutions.</li>
  <li>finally just export <code class="language-plaintext highlighter-rouge">generate_launch_description = sl.launch_description(opaque_function = launch_setup)</code>.</li>
</ul>

<p>Compare <a href="https://github.com/oKermorgant/simple_launch/tree/devel/example/example_launch.py"><code class="language-plaintext highlighter-rouge">example_launch.py</code></a> and <a href="https://github.com/oKermorgant/simple_launch/tree/devel/example/example_opaque_launch.py"><code class="language-plaintext highlighter-rouge">example_opaque_launch.py</code></a> to see the two approaches on the same logic.</p>

<p>Note that inside an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code> the if/unless idiom reduces to a basic if/else:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># with substitutions
with sl.group(if_arg='some_condition'):
  # do stuff
with sl.group(unless_arg='some_condition'):
  # do other stuff

# with opaque function
if sl.arg('some_condition'):
  # do stuff
else:
  # do other stuff

</code></pre></div></div>

<h2 id="other-one-liners">Other one-liners</h2>

<p>Methods listed below return instances of <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code> that represent any Substitution, but that provides concatenation (<code class="language-plaintext highlighter-rouge">+</code>) and path concatenation (<code class="language-plaintext highlighter-rouge">/</code>) operators. It is still a <code class="language-plaintext highlighter-rouge">Substitution</code>, not a raw Python type. If run from an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code> the underlying Python variable is returned.</p>

<h3 id="string--substitution-concatenation">String / substitution concatenation</h3>

<p>The following syntax builds the <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code> corresponding to <code class="language-plaintext highlighter-rouge">&lt;robot arg&gt;.xacro</code>:</p>

<p><code class="language-plaintext highlighter-rouge">file_name = sl.arg('robot') + '.xacro'</code></p>

<p><em>deprecated</em>: <code class="language-plaintext highlighter-rouge">sl.name_join(sl.arg('robot'), '.xacro')</code></p>

<h3 id="path-concatenation">Path concatenation</h3>

<p>The following syntax builds the <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code> corresponding to <code class="language-plaintext highlighter-rouge">&lt;package_path&gt;/urdf/&lt;robot arg&gt;.xacro</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>file_name = sl.arg('robot') + '.xacro'
urdf_file = os.path.join(get_package_share_directory(package),'urdf')/file_name

</code></pre></div></div>
<p>Obviously if all the path elements are raw strings, you should use <code class="language-plaintext highlighter-rouge">os.path.join</code> all along.</p>

<p><em>deprecated</em>: <code class="language-plaintext highlighter-rouge">sl.path_join(get_package_share_directory(package), sl.arg('robot'), '.xacro')</code></p>

<h3 id="find-a-share-file">Find a share file</h3>

<p><code class="language-plaintext highlighter-rouge">path = sl.find(package, file_name = None, file_dir = None)</code> where:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">package</code> is the name of the package or <code class="language-plaintext highlighter-rouge">None</code> if <code class="language-plaintext highlighter-rouge">file_name</code> is already an absolute path</li>
  <li>
<code class="language-plaintext highlighter-rouge">file_name</code> is the name of the file to find</li>
  <li>
<code class="language-plaintext highlighter-rouge">file_dir</code> is the path inside the package</li>
</ul>

<p>If <code class="language-plaintext highlighter-rouge">file_dir</code> is <code class="language-plaintext highlighter-rouge">None</code> but <code class="language-plaintext highlighter-rouge">package</code> and <code class="language-plaintext highlighter-rouge">file_name</code> are raw strings then the <code class="language-plaintext highlighter-rouge">find</code> function will actually look for the file inside the package share, using <code class="language-plaintext highlighter-rouge">os.walk</code>.</p>

<p>If <code class="language-plaintext highlighter-rouge">file_name</code> is <code class="language-plaintext highlighter-rouge">None</code> then the function just returns the path to the package share directory (e.g. <code class="language-plaintext highlighter-rouge">get_package_share_directory(package)</code>)</p>

<h3 id="robot-state-publisher">Robot state publisher</h3>

<p>It is quite common to run a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> from a <code class="language-plaintext highlighter-rouge">urdf</code> or <code class="language-plaintext highlighter-rouge">xacro</code> file. The line below runs it at the current namespace / condition level:</p>

<p><code class="language-plaintext highlighter-rouge">sl.robot_state_publisher(package, description_file, description_dir=None, xacro_args=None, **node_args)</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">description_file</code> is a URDF or xacro file</li>
  <li>
<code class="language-plaintext highlighter-rouge">description_dir</code> is the sub-directory of the file. If omitted, let the script search for the file assuming it is a raw string</li>
  <li>
<code class="language-plaintext highlighter-rouge">xacro_args</code> is a dictionary of arguments to forward to xacro</li>
  <li>
<code class="language-plaintext highlighter-rouge">node_args</code> are any additional arguments for <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> (remappings / parameters)</li>
</ul>

<h3 id="python-expressions">Python expressions</h3>

<p><code class="language-plaintext highlighter-rouge">sl.py_eval</code> will evaluate the given arguments as a Python expression, possibly performed if in an Opaque Function.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># RGB color as a list of [0-255] integers
sl.declare_arg('color', [255,0,0])
# same color as a string of [0-1] numbers (URDF format), note the padding commas to get a string
xacro_color = "'" + sl.py_eval("' '.join(str(c/255) for c in ", sl.arg('color'), ')') + "'"

</code></pre></div></div>

<h3 id="conditions">Conditions</h3>

<p><code class="language-plaintext highlighter-rouge">sl.py_eval</code> can be used to combine conditions. It is robust to lower case <code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">false</code> and will return a <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sl.declare_arg('some_condition', True)
opposed = sl.py_eval('not ', sl.arg('some_condition'))

</code></pre></div></div>

<p>Note that <code class="language-plaintext highlighter-rouge">IfCondition</code> and <code class="language-plaintext highlighter-rouge">UnlessCondition</code> cannot be combined, <a href="https://answers.ros.org/answers/414006/revisions/">only the underlying <code class="language-plaintext highlighter-rouge">Substitution</code>s can</a>.</p>

<h3 id="joint-state-publisher">Joint state publisher</h3>

<p><code class="language-plaintext highlighter-rouge">sl.joint_state_publisher(use_gui, **node_args)</code>: fires up a <code class="language-plaintext highlighter-rouge">joint_state_publisher</code>, with or without the gui, in the current namespace.</p>

<h3 id="rviz">Rviz</h3>

<p><code class="language-plaintext highlighter-rouge">sl.rviz(config_file = None, warnings = False)</code>: runs RViz on the given configuration file. If <code class="language-plaintext highlighter-rouge">warnings</code> is <code class="language-plaintext highlighter-rouge">False</code> (default) then runs with <code class="language-plaintext highlighter-rouge">log-level FATAL</code> in order to avoid many messages in the console.</p>

<p>Classical use case: <code class="language-plaintext highlighter-rouge">sl.rviz(sl.find('my_package', 'some_rviz_config.rviz'))</code></p>

<h3 id="fallback-to-low-level-syntax">Fallback to low-level syntax</h3>

<p>If any unavailable functionality is needed, the <code class="language-plaintext highlighter-rouge">sl.add_action(action)</code> function adds any passed <code class="language-plaintext highlighter-rouge">Action</code> at the current namespace / conditional / event level.</p>

<h2 id="interaction-with-gazebo--ignition">Interaction with Gazebo / Ignition</h2>

<p><em>Note: Ignition being renamed to Gazebo, all tools in this section use Gazebo / gz names</em></p>

<p>An effort was made to be robust to Ignition versus Gazebo uses, i.e. <em>ign</em> prefix is used for <code class="language-plaintext highlighter-rouge">foxy</code> and <code class="language-plaintext highlighter-rouge">galactic</code> while <em>gz</em> prefix is used from <code class="language-plaintext highlighter-rouge">humble</code>. <code class="language-plaintext highlighter-rouge">GZ_VERSION</code> and <code class="language-plaintext highlighter-rouge">IGNITION_VERSION</code> environment variables are also used to identify which version should be preferred.</p>

<h3 id="launch-gazebo">Launch Gazebo</h3>

<p>The Gazebo launch file corresponding to the current ROS 2 distribution is launched with</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sl.gz_launch(world_file, gz_arguments, full_world = None, save_after = 5.)

</code></pre></div></div>
<p>Namely, it will redirect to either <code class="language-plaintext highlighter-rouge">ros_ign_gazebo/ign_gazebo.launch.py</code> (<code class="language-plaintext highlighter-rouge">foxy</code>, <code class="language-plaintext highlighter-rouge">galactic</code>) or <code class="language-plaintext highlighter-rouge">ros_gz_sim/gz_sim.launch.py</code> (<code class="language-plaintext highlighter-rouge">humble</code>+).
The given <code class="language-plaintext highlighter-rouge">gz_arguments</code>, if any, will be forwarded either as the <code class="language-plaintext highlighter-rouge">ign_args</code> or <code class="language-plaintext highlighter-rouge">gz_args</code>, accordingly.</p>

<p>If the world file can be parsed then <code class="language-plaintext highlighter-rouge">SimpleLaunch</code> will detect its name and forward it to <code class="language-plaintext highlighter-rouge">GazeboBridge</code> functions.</p>

<p>If <code class="language-plaintext highlighter-rouge">full_world</code> is a raw string then the world will be saved into this file after the delay. This will include any URDF that was spawned in between.</p>

<h3 id="spawn-a-model">Spawn a model</h3>

<p>The following function allows easily spawing a model from its <code class="language-plaintext highlighter-rouge">robot_description</code>:</p>

<p><code class="language-plaintext highlighter-rouge">sl.spawn_gz_model(name, topic, model_file = None, spawn_args = [], only_new = True)</code></p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">name</code> is the name this model will get in Gazebo</li>
  <li>
<code class="language-plaintext highlighter-rouge">topic</code> is the topic to obtain the model from, default is <code class="language-plaintext highlighter-rouge">robot_description</code> (relative to the current namespace)</li>
  <li>
<code class="language-plaintext highlighter-rouge">model_file</code> is the path to the (urdf or sdf) file. If defined then this will spawn this model and ignore the topic</li>
  <li>
<code class="language-plaintext highlighter-rouge">only_new</code> if True, will not spawn the model if it already exists in a running Gazebo instance</li>
  <li>
<code class="language-plaintext highlighter-rouge">spawn_args</code> are any additional spawn arguments, e.g. the initial pose</li>
</ul>

<p><strong>example:</strong> <code class="language-plaintext highlighter-rouge">sl.spawn_gz_model('my_robot', model_file = sl.find('my_pkg', 'my_model.urdf'))</code></p>

<h3 id="declare-initial-pose">Declare initial pose</h3>

<p>Calling <code class="language-plaintext highlighter-rouge">sl.declare_gazebo_axes()</code> will declare all 6 parameters <code class="language-plaintext highlighter-rouge">(x,y,z,roll,pitch,yaw)</code> with <code class="language-plaintext highlighter-rouge">0</code> as default values.
If any axis is given (e.g. <code class="language-plaintext highlighter-rouge">sl.declare_gazebo_axes(yaw = 3.14)</code> then only this parameter will be declared.</p>

<p>Such parameters can be retrieved through <code class="language-plaintext highlighter-rouge">sl.gazebo_axes_args()</code>. As a consequence, it is easy to spawn a model with:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sl.declare_gazebo_axes()
sl.robot_description(...)
sl.spawn_gz_model(name, spawn_args = sl.gazebo_axes_args())

</code></pre></div></div>

<h3 id="save-current-world">Save current world</h3>

<p>If the simulation is reset after some models have been spawned, they will disappear. A convenient way to avoid this is to generate the full SDF world from a running simulation. The Gazebo GUI is able to export the current world but cannot resolve models that were spawned from e.g. a <code class="language-plaintext highlighter-rouge">robot_description</code> topic.</p>

<p>The script <code class="language-plaintext highlighter-rouge">generate_gz_world</code> will generate a SDF corresponding to the current simulation. If some models have been spawned from URDF and topics, the script will get the corresponding description and insert it into the SDF, assuming robot <code class="language-plaintext highlighter-rouge">name</code> has its description under <code class="language-plaintext highlighter-rouge">/name/robot_description</code>. It can also be called from a launch file with (see Gazebo example):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># you might want to add a delay to be sure all models have been spawned
sl.save_gz_world(full_world.sdf, after = 1.)

</code></pre></div></div>

<p>Such a self-contained SDF world file is then compatible with a reset of the simulation. See Gazebo example for launch file that checks if the full world is available.</p>

<h3 id="gazebo-bridge">Gazebo bridge</h3>

<p>The <code class="language-plaintext highlighter-rouge">GazeboBridge</code> class allows easily creating bridges when using Gazebo.</p>

<p>An instance is created with: <code class="language-plaintext highlighter-rouge">bridge = GazeboBridge(&lt;gazebo_topic&gt;, &lt;ros_topic&gt;, &lt;ros_message&gt;, direction, &lt;gz_message&gt; = None)</code> where <code class="language-plaintext highlighter-rouge">direction</code> is either:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.gz2ros</code> for Gazebo -&gt; ROS</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.ros2gz</code> for ROS -&gt; Gazebo</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.bidirectional</code> for both</li>
</ul>

<p>The Gazebo message type is <a href="https://github.com/gazebosim/ros_gz/tree/ros2/ros_gz_bridge">deduced from the ROS message type</a> if not set. Remapping will be set to the given <code class="language-plaintext highlighter-rouge">ros_topic</code>.</p>

<p>The SimpleLauncher instance can then run a node dealing with declared bridges, as illustrated in the examples at this end of this document.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">sl.create_gz_bridge([bridges], &lt;node_name&gt;)
</code></li>
</ul>

<p>If some bridges involve <code class="language-plaintext highlighter-rouge">sensor_msgs/Image</code> then a dedicated <code class="language-plaintext highlighter-rouge">ros_gz_image</code> bridge will be used. The corresponding <code class="language-plaintext highlighter-rouge">camera_info</code> topic will be also bridged.</p>

<h3 id="interaction-with-gazebo-sim">Interaction with Gazebo sim</h3>

<p>Some bridges (e.g. <code class="language-plaintext highlighter-rouge">joint_states</code>) need to have information on the world name. This name can only be obtained while Gazebo is running, or by having a priori knowledge of the world file.</p>

<p>The <code class="language-plaintext highlighter-rouge">GazeboBridge</code> class has a few static methods to get information on the simulated world, namely:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.world()</code> returns the current world name</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.set_world_name(world)</code> imposes the world name</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.model_prefix(model)</code> builds the Gazebo topic relative to the given model <code class="language-plaintext highlighter-rouge">/world/&lt;world&gt;/model/&lt;model&gt;</code>
</li>
</ul>

<p>They can be used under these conditions:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">sl.gz_launch</code> was called first (in the same launch setup) and the world file could be parsed, in this case the world name from the file is used</li>
  <li>or <code class="language-plaintext highlighter-rouge">GazeboBridge.set_world_name(world)</code> was called first (in the same launch setup), in this case this world name is used</li>
  <li>if none of the above and a <strong>running Gazebo</strong> instance exists, in this case <code class="language-plaintext highlighter-rouge">GazeboBridge</code> will request information on the world</li>
</ul>

<p>If none of these conditions hold, the launch file will not be able to get information on the world, and launch fill probably fail.</p>

<h3 id="built-in-bridges">Built-in bridges</h3>

<p>A common instance of the bridge is the clock. This one can be:</p>

<ul>
  <li>created with <code class="language-plaintext highlighter-rouge">GazeboBridge.clock()</code>: returns a <code class="language-plaintext highlighter-rouge">GazeboBridge</code> instance, not added to any node yet</li>
  <li>or run directly with <code class="language-plaintext highlighter-rouge">sl.create_gz_clock_bridge()</code> (actually runs <code class="language-plaintext highlighter-rouge">sl.create_gz_bridge(GazeboBridge.clock())</code>)</li>
</ul>

<p>Another common but tedious bridge instance is the joint state topic of a given model. This topic includes, in Gazebo, the name of the world <em>and</em> of the model. Assuming the world name is known, the corresponding bridge can be created with:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">GazeboBridge.joint_states_bridge(model)</code></li>
  <li>actually runs <code class="language-plaintext highlighter-rouge">GazeboBridge('/world/&lt;world&gt;/model/&lt;model&gt;/joint_state', 'joint_states', 'sensor_msgs/JointState', GazeboBridge.gz2ros)</code>
</li>
</ul>

<h3 id="world-tf-publisher">World TF publisher</h3>

<p>If <code class="language-plaintext highlighter-rouge">/tf</code> is used with Gazebo, then the root frame used by Gazebo depends on the world name. This frame is usually <code class="language-plaintext highlighter-rouge">world</code> on the ROS side.
A trivial <code class="language-plaintext highlighter-rouge">static_transform_publisher</code> is run to connect these two frames if they have different names:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">sl.gz_world_tf(world_frame = None)</code>: run a <code class="language-plaintext highlighter-rouge">static_transform_publisher</code> from <code class="language-plaintext highlighter-rouge">world</code> to <code class="language-plaintext highlighter-rouge">world_frame</code>. If <code class="language-plaintext highlighter-rouge">None</code> then detect the one currently used by Gazebo.</li>
</ul>

<h2 id="examples">Examples</h2>

<p>Examples can be found in the corresponding folder.</p>

<h3 id="launch-with-arguments">Launch with arguments</h3>

<p>Here is a file spawning a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> and its <code class="language-plaintext highlighter-rouge">joint_state_publisher</code>, where:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">prefix</code>, <code class="language-plaintext highlighter-rouge">x</code> and <code class="language-plaintext highlighter-rouge">y</code> are launch arguments that are passed to xacro</li>
  <li>
<code class="language-plaintext highlighter-rouge">use_gui</code> tells whether <code class="language-plaintext highlighter-rouge">joint_state_publisher</code> should run the gui</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():
    '''
    Launch description for a single robot - runs the two nodes in their own namespace
    '''
    sl = SimpleLauncher()

    sl.declare_arg('prefix', default_value = '', description='name of the robot (+ tf prefix)')
    sl.declare_arg('x', default_value = 0, description='x-offset of the robot')
    sl.declare_arg('y', default_value = 0, description='y-offset of the robot')
    sl.declare_arg('use_gui', default_value = True, description='Use JSP gui')

    xacro_args = sl.arg_map('prefix', 'x', 'y')
    xacro_args['prefix'] += '/'  # can sum substitutions and strings

    with sl.group(ns=sl.arg('prefix')):
        sl.robot_state_publisher('simple_launch', 'turret.xacro', xacro_args = xacro_args)
        sl.joint_state_publisher(use_gui = sl.arg('use_gui'))

    return sl.launch_description()

</code></pre></div></div>

<h3 id="conditional-blocks-and-includes">Conditional blocks and includes</h3>

<p>The file below fires up either <code class="language-plaintext highlighter-rouge">robot1</code> or <code class="language-plaintext highlighter-rouge">robot2</code> (or both) and also has a boolean argument to spawn <code class="language-plaintext highlighter-rouge">RViz2</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():

    sl = SimpleLauncher()

    # conditional args
    sl.declare_arg('robot1', default_value=True, description='use robot 1')
    sl.declare_arg('robot2', default_value=True, description='use robot 2')
    sl.declare_arg('no_robot2', default_value=False, description='cancel use of robot 2')
    sl.declare_arg('rviz', default_value=True, description='Bringup RViz2')

    # numeric args
    sl.declare_arg('robot2_x', default_value=1, description='x-offset of robot 2')
    sl.declare_arg('robot2_y', default_value=1, description='y-offset of robot 2')

    with sl.group(if_arg='robot1'):
        sl.include('simple_launch', 'included_launch.py',
                   launch_arguments = {'prefix': 'robot1'})

    with sl.group(if_arg='robot2'):

        with sl.group(unless_arg='no_robot2'):

            args = {'prefix': 'robot2', 'x':sl.arg('robot2_x'), 'y': sl.arg('robot2_y')}
            sl.include('simple_launch', 'included_launch.py', launch_arguments=args)

    with sl.group(if_arg='rviz'):
        rviz_config = sl.find('simple_launch', 'turret.rviz')
        sl.node('rviz2', 'rviz2', arguments = ['-d', rviz_config])

    return sl.launch_description()

</code></pre></div></div>

<h3 id="conditions-with-opaquefunction">Conditions with OpaqueFunction</h3>

<p>The file below does the same as the previous one, but using an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

# declare simple launcher and the launch arguments in the main body
sl = SimpleLauncher()

# conditional args
sl.declare_arg('robot1', default_value=True, description='use robot 1')
sl.declare_arg('robot2', default_value=True, description='use robot 2')
sl.declare_arg('no_robot2', default_value=False, description='cancel use of robot 2')
sl.declare_arg('rviz', default_value=True, description='Bringup RViz2')

# numeric args
sl.declare_arg('robot2_x', default_value=1, description='x-offset of robot 2')
sl.declare_arg('robot2_y', default_value=1, description='y-offset of robot 2')

# string args
sl.declare_arg('included', default_value = 'included_launch')


# define the opaque function, context will be wrapped in the SimpleLauncher instance
def launch_setup():

    # we can use raw if as `robot1` argument is performed to a Boolean
    if sl.arg('robot1'):
        sl.include('simple_launch', 'included_launch.py', launch_arguments = {'prefix': 'robot1'})

    # and even combine conditions
    if sl.arg('robot2') and not sl.arg('no_robot2'):

            args = {'prefix': 'robot2', 'x':sl.arg('robot2_x'), 'y': sl.arg('robot2_y')}
            # summing up args and strings
            sl.include('simple_launch', sl.arg('included') + '.py', launch_arguments=args)

    if sl.arg('rviz'):
        rviz_config = sl.find('simple_launch', 'turret.rviz')
        sl.node('rviz2', 'rviz2', arguments = ['-d', rviz_config])

    return sl.launch_description()


# tell SimpleLauncher to rely on the opaque_function in the launch description
# /!\ no `def generate_launch_description():`

generate_launch_description = sl.launch_description(opaque_function = launch_setup)

</code></pre></div></div>

<h3 id="combining-conditions">Combining conditions</h3>

<p>The file below shows how to use <code class="language-plaintext highlighter-rouge">sl.py_eval</code> to combine conditions. We have to build a valid Python expression, not forgetting the spaces around <code class="language-plaintext highlighter-rouge">and</code>, <code class="language-plaintext highlighter-rouge">or</code>, <code class="language-plaintext highlighter-rouge">not</code>, etc.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():

    sl = SimpleLauncher()

    cond1 = sl.declare_arg('cond1', True)
    cond2 = sl.declare_arg('cond2', False)

    for logic in ('and', 'or'):

        # builds &lt;cond1&gt; &lt;logic&gt; &lt;cond2&gt; Python expression
        combined = sl.py_eval(cond1, f' {logic} ', cond2)

        sl.log_info([f'{logic} condition is ', combined])

        with sl.group(if_condition = combined):
            sl.node('demo_nodes_cpp', 'talker', name = f'talker_{logic}')

        # also works with sl.node(..., condition = IfCondition(combined))

    return sl.launch_description()

</code></pre></div></div>

<h3 id="composition">Composition</h3>

<p>The file below is another way to write the <a href="https://index.ros.org/doc/ros2/Tutorials/Composition/#composition-using-launch-actions">composition launch example</a>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():

    sl = SimpleLauncher()

    with sl.container(name='my_container', output='screen'):
        sl.node(package='composition', plugin='Talker', name='talker')
        sl.node(package='composition', plugin='Listener', name='listener')

    return sl.launch_description()

</code></pre></div></div>

<h3 id="events-and-parameters">Events and parameters</h3>

<p>This <a href="https://github.com/oKermorgant/simple_launch/tree/devel/example/event_tutorial_launch.py">example file</a> is another way to write the <a href="https://docs.ros.org/en/rolling/Tutorials/Intermediate/Launch/Using-Event-Handlers.html">event launch example</a>. If does a little more work and is a little smarter, as the passed <code class="language-plaintext highlighter-rouge">new_background_r</code> is applied as soon as it has a valid value.</p>

<h3 id="auto-sim-time">auto sim time</h3>

<p>Here we run Gazebo and force all other nodes to <code class="language-plaintext highlighter-rouge">use_sim_time:=True</code>, unless this file is included from another one with <code class="language-plaintext highlighter-rouge">use_sim_time:=False</code>.
This is unlikely as this launch file spawns a simulator.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher, GazeboBridge

def generate_launch_description():

    # all nodes in this launch file will use_sim_time:=True
    sl = SimpleLauncher(use_sim_time=True)

    # run Gazebo + clock bridge
    sl.gz_launch(&lt;path/to/some/sdf/world&gt;, '-r')
    sl.create_gz_clock_bridge()

    # run other nodes with sim time

    return sl.launch_description()


</code></pre></div></div>

<h3 id="robot-description-and-conditionnal-gazebo-bridge">Robot description and conditionnal Gazebo bridge</h3>

<p>The file below only runs by default a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> with <code class="language-plaintext highlighter-rouge">use_sim_time:=False</code>.
However, if it is included from another file with <code class="language-plaintext highlighter-rouge">use_sim_time:=True</code> then it also spawns the robot into Gazebo and runs two bridges for joint states and pose.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher, GazeboBridge

def generate_launch_description():

    sl = SimpleLauncher(use_sim_time=False)

    # namespace is a launch argument, not a Python string
    sl.declare_arg('robot', default_value = 'robot1')
    robot = sl.arg('robot')

    with sl.group(ns = robot):
        # robot_state_publisher is always run
        sl.robot_state_publisher('my_description', 'my_robot.xacro')

        with sl.group(if_condition = sl.sim_time):
            # only execute this group if use_sim_time was set to True

            # spawn in Gazebo at default pose if not already here
            sl.spawn_gz_model(robot)

            # create a bridge for joint states @ /world/&lt;world&gt;/model/&lt;robot&gt;/joint_state
            # note the relative ROS topic 'joint_states' that is actually namespaced
            gz_js_topic = GazeboBridge.model_prefix(robot)/'joint_state'
            js_bridge = GazeboBridge(gz_topic = gz_js_topic,
                                     ros_topic = 'joint_states',
                                     msg = 'sensor_msgs/JointState',
                                     direction = GazeboBridge.gz2ros)

            # pose publisher bridge @ /model/&lt;robot&gt;
            pose_bridge = GazeboBridge('/model'/robot/'/pose',
                                       'pose_gt', 'geometry_msgs/Pose', GazeboBridge.gz2ros)

            # create bridge node with these two topics with default name gz_bridge
            sl.create_gz_bridge([js_bridge, pose_bridge])

    return sl.launch_description()


</code></pre></div></div>

<h3 id="full-gazebo-simulation">Full Gazebo simulation</h3>

<p>The file <code class="language-plaintext highlighter-rouge">example/gazebo/gazebo_launch.py</code> runs a basic simulation of a turret robot with a camera, also displayed in RViz.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch simple_launch gazebo_launch.py

</code></pre></div></div>

<p>You can move the robot around with a joint velocity setpoint (<code class="language-plaintext highlighter-rouge">std_msgs/Float64</code>) on <code class="language-plaintext highlighter-rouge">/turret/joint#</code> and see the simulated camera on <code class="language-plaintext highlighter-rouge">/turret/image</code>.</p>

<h2 id="i-want-more-examples">I want more examples</h2>

<p>Other self-contained examples (and slides) have been used to teach the ROS 2 launch file system and the nav stack.</p>

<p>Various aspects of the launch systen are shown in the <a href="https://github.com/oKermorgant/anf_launch">anf_launch</a> package.</p>

<p>A simple tutorial on <code class="language-plaintext highlighter-rouge">Nav2</code>  using <code class="language-plaintext highlighter-rouge">simple_launch</code> is available in the <a href="https://github.com/oKermorgant/anf_nav">anf_nav</a> package.</p>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <em>No CONTRIBUTING.md found.</em>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-iron">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/simple_launch">simple_launch</a> <small>repository</small></h3>
        
        
        <a class="label label-primary pkg-label" href="/p/simple_launch">simple_launch</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-oKermorgant-simple_launch
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-oKermorgant-simple_launch" role="menuitem" tabindex="-1" href="/r/simple_launch/github-oKermorgant-simple_launch" data="github-oKermorgant-simple_launch">
                    <span class="glyphicon glyphicon-star"></span>
                    github-oKermorgant-simple_launch
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">This package provides a Python class to help writing ROS 2 launch files.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/oKermorgant/simple_launch.git">https://github.com/oKermorgant/simple_launch.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">devel</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-02-16
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/simple_launch/#iron-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/simple_launch/#iron-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/simple_launch/#iron-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/simple_launch">simple_launch</a></td>
                    <td>1.11.0</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="simple_launch">simple_launch</h1>
<p>This package provides a Python class to help writing ROS 2 launch files.</p>

<p>The motivation behind this package is that the ROS 2 launch Python syntax may not be suited for many simple cases such as running basic nodes, spawning a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code>, and grouping nodes in namespaces or components.</p>

<p><strong>Thanks</strong>: this package is inspired by <a href="https://github.com/bponsler/ros2_launch_util">ros2_launch_util</a>.</p>

<p>The entry point is the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> class, which has several capabilities.</p>

<h2 id="basic-syntax">Basic syntax</h2>

<h3 id="namespace-and-argument-parser-initialization">Namespace and argument parser initialization</h3>

<p><code class="language-plaintext highlighter-rouge">sl = SimpleLauncher(namespace = '', use_sim_time = None, scope_included_files = False)</code></p>

<ul>
  <li>will initialize all nodes relative to the given namespace</li>
  <li>if <code class="language-plaintext highlighter-rouge">use_sim_time</code> is a Boolean, creates a <code class="language-plaintext highlighter-rouge">use_sim_time</code> launch argument with this value as the default and forwards it to all nodes, unless explicitely specified when running the node</li>
  <li>if <code class="language-plaintext highlighter-rouge">use_sim_time</code> is <code class="language-plaintext highlighter-rouge">'auto'</code>, then <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> will set it to <code class="language-plaintext highlighter-rouge">True</code> if the <code class="language-plaintext highlighter-rouge">/clock</code> topic is advertized (case of an already running simulation). <strong>This may have side effects if the <code class="language-plaintext highlighter-rouge">/clock</code> topic is advertized but you want to use this launch file with system clock</strong>.</li>
  <li>if <code class="language-plaintext highlighter-rouge">use_sim_time</code> is <code class="language-plaintext highlighter-rouge">None</code> (default) then no particular value is forwarded to the nodes</li>
  <li>if <code class="language-plaintext highlighter-rouge">scope_included_files</code> is <code class="language-plaintext highlighter-rouge">False</code> (default) then including another launch file that shares the same argument but while passing another value for this argument, will also <a href="https://robotics.stackexchange.com/questions/98997/ros2-foxy-python-launch-argument-scope-when-nesting-launch-files">modify the value of this argument after the inclusion</a>. This is the default behavior of <code class="language-plaintext highlighter-rouge">launch</code> but can be undesired. Inside an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code> the behavior is to be scoped anyway (the argument value is resolved) and <code class="language-plaintext highlighter-rouge">scope_included_files</code> has no effect.</li>
</ul>

<h3 id="node-registration">Node registration</h3>

<p><code class="language-plaintext highlighter-rouge">sl.node(package, executable, **node_args)</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">package</code> is the node package</li>
  <li>
<code class="language-plaintext highlighter-rouge">executable</code> is the name of the executable</li>
  <li>
<code class="language-plaintext highlighter-rouge">node_args</code> are any additional <code class="language-plaintext highlighter-rouge">Node</code> arguments</li>
</ul>

<h3 id="launch-file-include">Launch file include</h3>

<p><code class="language-plaintext highlighter-rouge">sl.include(package, launch_file, launch_dir = None, launch_arguments=None)</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">package</code> is the package of the included launch file</li>
  <li>
<code class="language-plaintext highlighter-rouge">launch_file</code> is the name of the launch file</li>
  <li>
<code class="language-plaintext highlighter-rouge">launch_dir</code> is its directory inside the package share (<code class="language-plaintext highlighter-rouge">None</code> to have it found)</li>
  <li>
<code class="language-plaintext highlighter-rouge">launch_arguments</code> is a dictionary of arguments to pass to the included launch file</li>
</ul>

<h3 id="call-a-service-at-launch">Call a service at launch</h3>

<p>This line runs a temporary client that waits for a service and calls it when available:</p>

<p><code class="language-plaintext highlighter-rouge">sl.call_service(server, request = None, verbosity = '')</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">server</code> is the path to some service (possibly namespaced). The service type is deduced when it becomes available.</li>
  <li>
<code class="language-plaintext highlighter-rouge">request</code> is a dictionary representing the service request. If <code class="language-plaintext highlighter-rouge">None</code> or incomplete, will use the service request default values.</li>
  <li>
<code class="language-plaintext highlighter-rouge">verbosity</code> let the underlying node describe what it is doing: <code class="language-plaintext highlighter-rouge">'req'</code> for request info, <code class="language-plaintext highlighter-rouge">'res'</code> for response info or both with <code class="language-plaintext highlighter-rouge">'reqres'</code>
</li>
</ul>

<p>If any request parameter is <code class="language-plaintext highlighter-rouge">__ns</code> it will be changed to the current namespace.</p>

<h3 id="setting-parameters">Setting parameters</h3>

<p>This line runs a temporary client that waits for a node and changes its parameters when available:</p>

<p><code class="language-plaintext highlighter-rouge">sl.set_parameters(node_name, parameters: dict = {}, verbosity = '')</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">node_name</code> is the name of the node (possibly namespaced)</li>
  <li>
<code class="language-plaintext highlighter-rouge">parameters</code> is a dictionary of (name, value) parameters to be set</li>
  <li>
<code class="language-plaintext highlighter-rouge">verbosity</code> let the underlying node describe what it is doing: <code class="language-plaintext highlighter-rouge">'req'</code> for request info, <code class="language-plaintext highlighter-rouge">'res'</code> for response info or both with <code class="language-plaintext highlighter-rouge">'reqres'</code>
</li>
</ul>

<p>This calls the <code class="language-plaintext highlighter-rouge">set_parameters</code> service of the node with the passed types. Possible errors may happen if the parameters do not exist or are of a different type.</p>

<h3 id="robust-types-for-parameters">Robust types for parameters</h3>

<p>In the launch API, differents types are expected for:</p>

<ul>
  <li>node parameters: a list of dictionaries</li>
  <li>node remappings: a list of (<code class="language-plaintext highlighter-rouge">key</code>, <code class="language-plaintext highlighter-rouge">value</code>) pairs</li>
  <li>included launch arguments: a list of (<code class="language-plaintext highlighter-rouge">key</code>, <code class="language-plaintext highlighter-rouge">value</code>) pairs</li>
  <li>xacro arguments: a concatenation of <code class="language-plaintext highlighter-rouge">key:=value</code> strings</li>
</ul>

<p>The <code class="language-plaintext highlighter-rouge">sl.include</code>, <code class="language-plaintext highlighter-rouge">sl.node</code> and <code class="language-plaintext highlighter-rouge">xacro_args</code> calls allow using any type (the simplest being a single dictionary)  and will convert to the one expected by the API.</p>

<h2 id="launch-arguments">Launch arguments</h2>

<p><code class="language-plaintext highlighter-rouge">simple_launch</code> allows declaring launch arguments and getting them in return.</p>

<h3 id="declare-a-launch-argument">Declare a launch argument</h3>

<p><code class="language-plaintext highlighter-rouge">sl.declare_arg(name, default_value, description = None)</code>: declare and returns the argument</p>

<p>Contrary to the base API, the default value is a raw Python type.</p>

<h3 id="retrieve-a-launch-argument">Retrieve a launch argument</h3>

<p><code class="language-plaintext highlighter-rouge">sl.arg(name)</code>: returns the argument <code class="language-plaintext highlighter-rouge">name</code> as a <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code></p>

<h3 id="retrieve-several-arguments-as-a-dictionary">Retrieve several arguments as a dictionary</h3>

<p><code class="language-plaintext highlighter-rouge">sl.arg_map('robot', 'x', 'y')</code>: returns <code class="language-plaintext highlighter-rouge">{'robot': &lt;robot arg value&gt;, 'x': &lt;x arg value&gt;, 'y': &lt;y arg value&gt;}</code></p>

<p>Typical when forwarding some launch arguments to a node or an included launch file.</p>

<h2 id="groups-or-scopes">Groups or scopes</h2>

<p>Groups are created through the <code class="language-plaintext highlighter-rouge">with sl.group():</code> syntax and accept, a namespace an if/unless condition and an event.</p>

<p>Actions that are added in a scope inherit from all previous defined groups.</p>

<h3 id="by-namespace">By namespace</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(ns=sub_namespace):
    sl.node(package, executable)

</code></pre></div></div>

<h3 id="from-a-condition">From a condition</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(if_condition=True):
    sl.node(package, executable)

  with sl.group(unless_condition=&lt;some expression&gt;):
    sl.node(package, executable)

</code></pre></div></div>

<ul>
  <li>Only one condition can be set in a group, nested condition must be combined first, or used in nested groups.</li>
  <li>Combining conditions coming from launch arguments can be done with <code class="language-plaintext highlighter-rouge">sl.py_eval</code> as shown below.</li>
</ul>

<h3 id="from-conditional-arguments">From conditional arguments</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(if_arg='use_gui'):
    sl.node(package, executable)

  with sl.group(unless_arg='dont_do'):
    sl.node(package, executable)

</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">if_arg</code> / <code class="language-plaintext highlighter-rouge">unless_arg</code> is expected to be the name of a launch argument. These two lines are equivalent:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.group(if_arg='use_gui'):
  with sl.group(if_condition=sl.arg('use_gui')):

</code></pre></div></div>
<p>If <code class="language-plaintext highlighter-rouge">if_arg</code> / <code class="language-plaintext highlighter-rouge">unless_arg</code> is not a string then it is considered as a <code class="language-plaintext highlighter-rouge">if_condition</code> / <code class="language-plaintext highlighter-rouge">unless_condition</code>.</p>

<h3 id="from-events">From events</h3>

<p>The <code class="language-plaintext highlighter-rouge">when</code> argument wraps events from the <code class="language-plaintext highlighter-rouge">launch.event_handlers</code> module. It combines an event and a delay (0 by default)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch.events import When, OnProcessStart, OnProcessExit, OnProcessIO

  my_node = sl.node(...)   # reference node

  with sl.group(when = When(my_node, OnProcessStart, 1.)):
      sl.node(...)  # will run 1 s after main node starts

  with sl.group(when = When(my_node, OnProcessExit)):
      sl.node(...)  # will run as soon as the main node exists

  with sl.group(when = When(my_node, OnProcessIO, io = 'stdout'):
      # OnProcessIO events need a function changing the event into an action
      sl.add_action(lambda event: LogInfo(msg = 'Node says "{}"'.format(
                      event.text.decode().strip())))
      # several functions can be used if needed, they will be combined in a single one
      sl.add_action(lambda event: LogInfo(msg = 'Once again, node says "{}"'.format(
                      event.text.decode().strip())))

  with sl.group(when = When(delay = 2.)):
      sl.node(...)  # will run after 2 sec

</code></pre></div></div>

<h3 id="creating-containers">Creating containers</h3>

<p>This syntax adds the <code class="language-plaintext highlighter-rouge">composition/composition::Talker</code> as a ComposableNode</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.container(name='my_container', output='screen'):
    sl.node(package='composition', plugin='Talker', name='talker')

</code></pre></div></div>

<p>Use the <code class="language-plaintext highlighter-rouge">executable</code> and <code class="language-plaintext highlighter-rouge">package</code> parameters if you want to use executors other than <code class="language-plaintext highlighter-rouge">rclcpp_components</code>â€™s <code class="language-plaintext highlighter-rouge">component_container</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  with sl.container(name='my_container', output='screen', executable='component_container_isolated'):

</code></pre></div></div>

<p><strong><em>It is currently impossible to have group blocks within a container block, as containers can only accept <code class="language-plaintext highlighter-rouge">ComposableNode</code>s</em></strong>. A <code class="language-plaintext highlighter-rouge">GroupAction</code> containing e.g. <code class="language-plaintext highlighter-rouge">PushRosNamespace</code> and a <code class="language-plaintext highlighter-rouge">ComposableNode</code> is not itself a <code class="language-plaintext highlighter-rouge">ComposableNode</code>.</p>

<h2 id="use_sim_time"><code class="language-plaintext highlighter-rouge">use_sim_time</code></h2>

<p>The current <code class="language-plaintext highlighter-rouge">use_sim_time</code> setting can be retrieved through <code class="language-plaintext highlighter-rouge">sl.sim_time</code> that may be:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">None</code>, if <code class="language-plaintext highlighter-rouge">use_sim_time</code> was not set in the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> constructor</li>
  <li>a raw Boolean, if <code class="language-plaintext highlighter-rouge">use_sim_time</code> was set to <code class="language-plaintext highlighter-rouge">'auto'</code>, depending on the <code class="language-plaintext highlighter-rouge">/clock</code> topic being advertized</li>
  <li>a Boolean launch argument, if <code class="language-plaintext highlighter-rouge">use_sim_time</code> was set to <code class="language-plaintext highlighter-rouge">True</code> or <code class="language-plaintext highlighter-rouge">False</code>
</li>
</ul>

<p>In all cases, if the <code class="language-plaintext highlighter-rouge">use_sim_time</code> parameter is explicitely given to a node, it will be used instead of the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> instance one.</p>

<h2 id="opaquefunction-with-implicit-performcontext">
<code class="language-plaintext highlighter-rouge">OpaqueFunction</code> with implicit <code class="language-plaintext highlighter-rouge">.perform(context)</code>
</h2>

<p>Most of the use cases can be dealt with substitutions and <code class="language-plaintext highlighter-rouge">with sl.group</code> blocks.
In order to design more imperative launch files, the <a href="https://discourse.ros.org/t/simplifying-launch-argument-declaration-and-initialization-in-launch-files/24204"><code class="language-plaintext highlighter-rouge">OpaqueFunction</code></a> approach can be used. The main drawback is that potential errors are harder to track.</p>

<p>To do this with <code class="language-plaintext highlighter-rouge">simple_launch</code>:</p>

<ul>
  <li>the <code class="language-plaintext highlighter-rouge">SimpleLauncher</code> instance and the argument declaration should be done in the main body of your launch file.</li>
  <li>then, define a function (e.g. <code class="language-plaintext highlighter-rouge">launch_setup</code>) that takes no argument, where the logic of the launch file resides.</li>
  <li>all arguments obtained through <code class="language-plaintext highlighter-rouge">sl.arg</code> will be basic Python types, obtained from performing the substitutions.</li>
  <li>finally just export <code class="language-plaintext highlighter-rouge">generate_launch_description = sl.launch_description(opaque_function = launch_setup)</code>.</li>
</ul>

<p>Compare <a href="https://github.com/oKermorgant/simple_launch/tree/devel/example/example_launch.py"><code class="language-plaintext highlighter-rouge">example_launch.py</code></a> and <a href="https://github.com/oKermorgant/simple_launch/tree/devel/example/example_opaque_launch.py"><code class="language-plaintext highlighter-rouge">example_opaque_launch.py</code></a> to see the two approaches on the same logic.</p>

<p>Note that inside an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code> the if/unless idiom reduces to a basic if/else:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># with substitutions
with sl.group(if_arg='some_condition'):
  # do stuff
with sl.group(unless_arg='some_condition'):
  # do other stuff

# with opaque function
if sl.arg('some_condition'):
  # do stuff
else:
  # do other stuff

</code></pre></div></div>

<h2 id="other-one-liners">Other one-liners</h2>

<p>Methods listed below return instances of <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code> that represent any Substitution, but that provides concatenation (<code class="language-plaintext highlighter-rouge">+</code>) and path concatenation (<code class="language-plaintext highlighter-rouge">/</code>) operators. It is still a <code class="language-plaintext highlighter-rouge">Substitution</code>, not a raw Python type. If run from an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code> the underlying Python variable is returned.</p>

<h3 id="string--substitution-concatenation">String / substitution concatenation</h3>

<p>The following syntax builds the <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code> corresponding to <code class="language-plaintext highlighter-rouge">&lt;robot arg&gt;.xacro</code>:</p>

<p><code class="language-plaintext highlighter-rouge">file_name = sl.arg('robot') + '.xacro'</code></p>

<p><em>deprecated</em>: <code class="language-plaintext highlighter-rouge">sl.name_join(sl.arg('robot'), '.xacro')</code></p>

<h3 id="path-concatenation">Path concatenation</h3>

<p>The following syntax builds the <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code> corresponding to <code class="language-plaintext highlighter-rouge">&lt;package_path&gt;/urdf/&lt;robot arg&gt;.xacro</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>file_name = sl.arg('robot') + '.xacro'
urdf_file = os.path.join(get_package_share_directory(package),'urdf')/file_name

</code></pre></div></div>
<p>Obviously if all the path elements are raw strings, you should use <code class="language-plaintext highlighter-rouge">os.path.join</code> all along.</p>

<p><em>deprecated</em>: <code class="language-plaintext highlighter-rouge">sl.path_join(get_package_share_directory(package), sl.arg('robot'), '.xacro')</code></p>

<h3 id="find-a-share-file">Find a share file</h3>

<p><code class="language-plaintext highlighter-rouge">path = sl.find(package, file_name = None, file_dir = None)</code> where:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">package</code> is the name of the package or <code class="language-plaintext highlighter-rouge">None</code> if <code class="language-plaintext highlighter-rouge">file_name</code> is already an absolute path</li>
  <li>
<code class="language-plaintext highlighter-rouge">file_name</code> is the name of the file to find</li>
  <li>
<code class="language-plaintext highlighter-rouge">file_dir</code> is the path inside the package</li>
</ul>

<p>If <code class="language-plaintext highlighter-rouge">file_dir</code> is <code class="language-plaintext highlighter-rouge">None</code> but <code class="language-plaintext highlighter-rouge">package</code> and <code class="language-plaintext highlighter-rouge">file_name</code> are raw strings then the <code class="language-plaintext highlighter-rouge">find</code> function will actually look for the file inside the package share, using <code class="language-plaintext highlighter-rouge">os.walk</code>.</p>

<p>If <code class="language-plaintext highlighter-rouge">file_name</code> is <code class="language-plaintext highlighter-rouge">None</code> then the function just returns the path to the package share directory (e.g. <code class="language-plaintext highlighter-rouge">get_package_share_directory(package)</code>)</p>

<h3 id="robot-state-publisher">Robot state publisher</h3>

<p>It is quite common to run a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> from a <code class="language-plaintext highlighter-rouge">urdf</code> or <code class="language-plaintext highlighter-rouge">xacro</code> file. The line below runs it at the current namespace / condition level:</p>

<p><code class="language-plaintext highlighter-rouge">sl.robot_state_publisher(package, description_file, description_dir=None, xacro_args=None, **node_args)</code> where</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">description_file</code> is a URDF or xacro file</li>
  <li>
<code class="language-plaintext highlighter-rouge">description_dir</code> is the sub-directory of the file. If omitted, let the script search for the file assuming it is a raw string</li>
  <li>
<code class="language-plaintext highlighter-rouge">xacro_args</code> is a dictionary of arguments to forward to xacro</li>
  <li>
<code class="language-plaintext highlighter-rouge">node_args</code> are any additional arguments for <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> (remappings / parameters)</li>
</ul>

<h3 id="python-expressions">Python expressions</h3>

<p><code class="language-plaintext highlighter-rouge">sl.py_eval</code> will evaluate the given arguments as a Python expression, possibly performed if in an Opaque Function.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># RGB color as a list of [0-255] integers
sl.declare_arg('color', [255,0,0])
# same color as a string of [0-1] numbers (URDF format), note the padding commas to get a string
xacro_color = "'" + sl.py_eval("' '.join(str(c/255) for c in ", sl.arg('color'), ')') + "'"

</code></pre></div></div>

<h3 id="conditions">Conditions</h3>

<p><code class="language-plaintext highlighter-rouge">sl.py_eval</code> can be used to combine conditions. It is robust to lower case <code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">false</code> and will return a <code class="language-plaintext highlighter-rouge">SimpleSubstitution</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sl.declare_arg('some_condition', True)
opposed = sl.py_eval('not ', sl.arg('some_condition'))

</code></pre></div></div>

<p>Note that <code class="language-plaintext highlighter-rouge">IfCondition</code> and <code class="language-plaintext highlighter-rouge">UnlessCondition</code> cannot be combined, <a href="https://answers.ros.org/answers/414006/revisions/">only the underlying <code class="language-plaintext highlighter-rouge">Substitution</code>s can</a>.</p>

<h3 id="joint-state-publisher">Joint state publisher</h3>

<p><code class="language-plaintext highlighter-rouge">sl.joint_state_publisher(use_gui, **node_args)</code>: fires up a <code class="language-plaintext highlighter-rouge">joint_state_publisher</code>, with or without the gui, in the current namespace.</p>

<h3 id="rviz">Rviz</h3>

<p><code class="language-plaintext highlighter-rouge">sl.rviz(config_file = None, warnings = False)</code>: runs RViz on the given configuration file. If <code class="language-plaintext highlighter-rouge">warnings</code> is <code class="language-plaintext highlighter-rouge">False</code> (default) then runs with <code class="language-plaintext highlighter-rouge">log-level FATAL</code> in order to avoid many messages in the console.</p>

<p>Classical use case: <code class="language-plaintext highlighter-rouge">sl.rviz(sl.find('my_package', 'some_rviz_config.rviz'))</code></p>

<h3 id="fallback-to-low-level-syntax">Fallback to low-level syntax</h3>

<p>If any unavailable functionality is needed, the <code class="language-plaintext highlighter-rouge">sl.add_action(action)</code> function adds any passed <code class="language-plaintext highlighter-rouge">Action</code> at the current namespace / conditional / event level.</p>

<h2 id="interaction-with-gazebo--ignition">Interaction with Gazebo / Ignition</h2>

<p><em>Note: Ignition being renamed to Gazebo, all tools in this section use Gazebo / gz names</em></p>

<p>An effort was made to be robust to Ignition versus Gazebo uses, i.e. <em>ign</em> prefix is used for <code class="language-plaintext highlighter-rouge">foxy</code> and <code class="language-plaintext highlighter-rouge">galactic</code> while <em>gz</em> prefix is used from <code class="language-plaintext highlighter-rouge">humble</code>. <code class="language-plaintext highlighter-rouge">GZ_VERSION</code> and <code class="language-plaintext highlighter-rouge">IGNITION_VERSION</code> environment variables are also used to identify which version should be preferred.</p>

<h3 id="launch-gazebo">Launch Gazebo</h3>

<p>The Gazebo launch file corresponding to the current ROS 2 distribution is launched with</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sl.gz_launch(world_file, gz_arguments, full_world = None, save_after = 5.)

</code></pre></div></div>
<p>Namely, it will redirect to either <code class="language-plaintext highlighter-rouge">ros_ign_gazebo/ign_gazebo.launch.py</code> (<code class="language-plaintext highlighter-rouge">foxy</code>, <code class="language-plaintext highlighter-rouge">galactic</code>) or <code class="language-plaintext highlighter-rouge">ros_gz_sim/gz_sim.launch.py</code> (<code class="language-plaintext highlighter-rouge">humble</code>+).
The given <code class="language-plaintext highlighter-rouge">gz_arguments</code>, if any, will be forwarded either as the <code class="language-plaintext highlighter-rouge">ign_args</code> or <code class="language-plaintext highlighter-rouge">gz_args</code>, accordingly.</p>

<p>If the world file can be parsed then <code class="language-plaintext highlighter-rouge">SimpleLaunch</code> will detect its name and forward it to <code class="language-plaintext highlighter-rouge">GazeboBridge</code> functions.</p>

<p>If <code class="language-plaintext highlighter-rouge">full_world</code> is a raw string then the world will be saved into this file after the delay. This will include any URDF that was spawned in between.</p>

<h3 id="spawn-a-model">Spawn a model</h3>

<p>The following function allows easily spawing a model from its <code class="language-plaintext highlighter-rouge">robot_description</code>:</p>

<p><code class="language-plaintext highlighter-rouge">sl.spawn_gz_model(name, topic, model_file = None, spawn_args = [], only_new = True)</code></p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">name</code> is the name this model will get in Gazebo</li>
  <li>
<code class="language-plaintext highlighter-rouge">topic</code> is the topic to obtain the model from, default is <code class="language-plaintext highlighter-rouge">robot_description</code> (relative to the current namespace)</li>
  <li>
<code class="language-plaintext highlighter-rouge">model_file</code> is the path to the (urdf or sdf) file. If defined then this will spawn this model and ignore the topic</li>
  <li>
<code class="language-plaintext highlighter-rouge">only_new</code> if True, will not spawn the model if it already exists in a running Gazebo instance</li>
  <li>
<code class="language-plaintext highlighter-rouge">spawn_args</code> are any additional spawn arguments, e.g. the initial pose</li>
</ul>

<p><strong>example:</strong> <code class="language-plaintext highlighter-rouge">sl.spawn_gz_model('my_robot', model_file = sl.find('my_pkg', 'my_model.urdf'))</code></p>

<h3 id="declare-initial-pose">Declare initial pose</h3>

<p>Calling <code class="language-plaintext highlighter-rouge">sl.declare_gazebo_axes()</code> will declare all 6 parameters <code class="language-plaintext highlighter-rouge">(x,y,z,roll,pitch,yaw)</code> with <code class="language-plaintext highlighter-rouge">0</code> as default values.
If any axis is given (e.g. <code class="language-plaintext highlighter-rouge">sl.declare_gazebo_axes(yaw = 3.14)</code> then only this parameter will be declared.</p>

<p>Such parameters can be retrieved through <code class="language-plaintext highlighter-rouge">sl.gazebo_axes_args()</code>. As a consequence, it is easy to spawn a model with:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sl.declare_gazebo_axes()
sl.robot_description(...)
sl.spawn_gz_model(name, spawn_args = sl.gazebo_axes_args())

</code></pre></div></div>

<h3 id="save-current-world">Save current world</h3>

<p>If the simulation is reset after some models have been spawned, they will disappear. A convenient way to avoid this is to generate the full SDF world from a running simulation. The Gazebo GUI is able to export the current world but cannot resolve models that were spawned from e.g. a <code class="language-plaintext highlighter-rouge">robot_description</code> topic.</p>

<p>The script <code class="language-plaintext highlighter-rouge">generate_gz_world</code> will generate a SDF corresponding to the current simulation. If some models have been spawned from URDF and topics, the script will get the corresponding description and insert it into the SDF, assuming robot <code class="language-plaintext highlighter-rouge">name</code> has its description under <code class="language-plaintext highlighter-rouge">/name/robot_description</code>. It can also be called from a launch file with (see Gazebo example):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># you might want to add a delay to be sure all models have been spawned
sl.save_gz_world(full_world.sdf, after = 1.)

</code></pre></div></div>

<p>Such a self-contained SDF world file is then compatible with a reset of the simulation. See Gazebo example for launch file that checks if the full world is available.</p>

<h3 id="gazebo-bridge">Gazebo bridge</h3>

<p>The <code class="language-plaintext highlighter-rouge">GazeboBridge</code> class allows easily creating bridges when using Gazebo.</p>

<p>An instance is created with: <code class="language-plaintext highlighter-rouge">bridge = GazeboBridge(&lt;gazebo_topic&gt;, &lt;ros_topic&gt;, &lt;ros_message&gt;, direction, &lt;gz_message&gt; = None)</code> where <code class="language-plaintext highlighter-rouge">direction</code> is either:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.gz2ros</code> for Gazebo -&gt; ROS</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.ros2gz</code> for ROS -&gt; Gazebo</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.bidirectional</code> for both</li>
</ul>

<p>The Gazebo message type is <a href="https://github.com/gazebosim/ros_gz/tree/ros2/ros_gz_bridge">deduced from the ROS message type</a> if not set. Remapping will be set to the given <code class="language-plaintext highlighter-rouge">ros_topic</code>.</p>

<p>The SimpleLauncher instance can then run a node dealing with declared bridges, as illustrated in the examples at this end of this document.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">sl.create_gz_bridge([bridges], &lt;node_name&gt;)
</code></li>
</ul>

<p>If some bridges involve <code class="language-plaintext highlighter-rouge">sensor_msgs/Image</code> then a dedicated <code class="language-plaintext highlighter-rouge">ros_gz_image</code> bridge will be used. The corresponding <code class="language-plaintext highlighter-rouge">camera_info</code> topic will be also bridged.</p>

<h3 id="interaction-with-gazebo-sim">Interaction with Gazebo sim</h3>

<p>Some bridges (e.g. <code class="language-plaintext highlighter-rouge">joint_states</code>) need to have information on the world name. This name can only be obtained while Gazebo is running, or by having a priori knowledge of the world file.</p>

<p>The <code class="language-plaintext highlighter-rouge">GazeboBridge</code> class has a few static methods to get information on the simulated world, namely:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.world()</code> returns the current world name</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.set_world_name(world)</code> imposes the world name</li>
  <li>
<code class="language-plaintext highlighter-rouge">GazeboBridge.model_prefix(model)</code> builds the Gazebo topic relative to the given model <code class="language-plaintext highlighter-rouge">/world/&lt;world&gt;/model/&lt;model&gt;</code>
</li>
</ul>

<p>They can be used under these conditions:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">sl.gz_launch</code> was called first (in the same launch setup) and the world file could be parsed, in this case the world name from the file is used</li>
  <li>or <code class="language-plaintext highlighter-rouge">GazeboBridge.set_world_name(world)</code> was called first (in the same launch setup), in this case this world name is used</li>
  <li>if none of the above and a <strong>running Gazebo</strong> instance exists, in this case <code class="language-plaintext highlighter-rouge">GazeboBridge</code> will request information on the world</li>
</ul>

<p>If none of these conditions hold, the launch file will not be able to get information on the world, and launch fill probably fail.</p>

<h3 id="built-in-bridges">Built-in bridges</h3>

<p>A common instance of the bridge is the clock. This one can be:</p>

<ul>
  <li>created with <code class="language-plaintext highlighter-rouge">GazeboBridge.clock()</code>: returns a <code class="language-plaintext highlighter-rouge">GazeboBridge</code> instance, not added to any node yet</li>
  <li>or run directly with <code class="language-plaintext highlighter-rouge">sl.create_gz_clock_bridge()</code> (actually runs <code class="language-plaintext highlighter-rouge">sl.create_gz_bridge(GazeboBridge.clock())</code>)</li>
</ul>

<p>Another common but tedious bridge instance is the joint state topic of a given model. This topic includes, in Gazebo, the name of the world <em>and</em> of the model. Assuming the world name is known, the corresponding bridge can be created with:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">GazeboBridge.joint_states_bridge(model)</code></li>
  <li>actually runs <code class="language-plaintext highlighter-rouge">GazeboBridge('/world/&lt;world&gt;/model/&lt;model&gt;/joint_state', 'joint_states', 'sensor_msgs/JointState', GazeboBridge.gz2ros)</code>
</li>
</ul>

<h3 id="world-tf-publisher">World TF publisher</h3>

<p>If <code class="language-plaintext highlighter-rouge">/tf</code> is used with Gazebo, then the root frame used by Gazebo depends on the world name. This frame is usually <code class="language-plaintext highlighter-rouge">world</code> on the ROS side.
A trivial <code class="language-plaintext highlighter-rouge">static_transform_publisher</code> is run to connect these two frames if they have different names:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">sl.gz_world_tf(world_frame = None)</code>: run a <code class="language-plaintext highlighter-rouge">static_transform_publisher</code> from <code class="language-plaintext highlighter-rouge">world</code> to <code class="language-plaintext highlighter-rouge">world_frame</code>. If <code class="language-plaintext highlighter-rouge">None</code> then detect the one currently used by Gazebo.</li>
</ul>

<h2 id="examples">Examples</h2>

<p>Examples can be found in the corresponding folder.</p>

<h3 id="launch-with-arguments">Launch with arguments</h3>

<p>Here is a file spawning a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> and its <code class="language-plaintext highlighter-rouge">joint_state_publisher</code>, where:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">prefix</code>, <code class="language-plaintext highlighter-rouge">x</code> and <code class="language-plaintext highlighter-rouge">y</code> are launch arguments that are passed to xacro</li>
  <li>
<code class="language-plaintext highlighter-rouge">use_gui</code> tells whether <code class="language-plaintext highlighter-rouge">joint_state_publisher</code> should run the gui</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():
    '''
    Launch description for a single robot - runs the two nodes in their own namespace
    '''
    sl = SimpleLauncher()

    sl.declare_arg('prefix', default_value = '', description='name of the robot (+ tf prefix)')
    sl.declare_arg('x', default_value = 0, description='x-offset of the robot')
    sl.declare_arg('y', default_value = 0, description='y-offset of the robot')
    sl.declare_arg('use_gui', default_value = True, description='Use JSP gui')

    xacro_args = sl.arg_map('prefix', 'x', 'y')
    xacro_args['prefix'] += '/'  # can sum substitutions and strings

    with sl.group(ns=sl.arg('prefix')):
        sl.robot_state_publisher('simple_launch', 'turret.xacro', xacro_args = xacro_args)
        sl.joint_state_publisher(use_gui = sl.arg('use_gui'))

    return sl.launch_description()

</code></pre></div></div>

<h3 id="conditional-blocks-and-includes">Conditional blocks and includes</h3>

<p>The file below fires up either <code class="language-plaintext highlighter-rouge">robot1</code> or <code class="language-plaintext highlighter-rouge">robot2</code> (or both) and also has a boolean argument to spawn <code class="language-plaintext highlighter-rouge">RViz2</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():

    sl = SimpleLauncher()

    # conditional args
    sl.declare_arg('robot1', default_value=True, description='use robot 1')
    sl.declare_arg('robot2', default_value=True, description='use robot 2')
    sl.declare_arg('no_robot2', default_value=False, description='cancel use of robot 2')
    sl.declare_arg('rviz', default_value=True, description='Bringup RViz2')

    # numeric args
    sl.declare_arg('robot2_x', default_value=1, description='x-offset of robot 2')
    sl.declare_arg('robot2_y', default_value=1, description='y-offset of robot 2')

    with sl.group(if_arg='robot1'):
        sl.include('simple_launch', 'included_launch.py',
                   launch_arguments = {'prefix': 'robot1'})

    with sl.group(if_arg='robot2'):

        with sl.group(unless_arg='no_robot2'):

            args = {'prefix': 'robot2', 'x':sl.arg('robot2_x'), 'y': sl.arg('robot2_y')}
            sl.include('simple_launch', 'included_launch.py', launch_arguments=args)

    with sl.group(if_arg='rviz'):
        rviz_config = sl.find('simple_launch', 'turret.rviz')
        sl.node('rviz2', 'rviz2', arguments = ['-d', rviz_config])

    return sl.launch_description()

</code></pre></div></div>

<h3 id="conditions-with-opaquefunction">Conditions with OpaqueFunction</h3>

<p>The file below does the same as the previous one, but using an <code class="language-plaintext highlighter-rouge">OpaqueFunction</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

# declare simple launcher and the launch arguments in the main body
sl = SimpleLauncher()

# conditional args
sl.declare_arg('robot1', default_value=True, description='use robot 1')
sl.declare_arg('robot2', default_value=True, description='use robot 2')
sl.declare_arg('no_robot2', default_value=False, description='cancel use of robot 2')
sl.declare_arg('rviz', default_value=True, description='Bringup RViz2')

# numeric args
sl.declare_arg('robot2_x', default_value=1, description='x-offset of robot 2')
sl.declare_arg('robot2_y', default_value=1, description='y-offset of robot 2')

# string args
sl.declare_arg('included', default_value = 'included_launch')


# define the opaque function, context will be wrapped in the SimpleLauncher instance
def launch_setup():

    # we can use raw if as `robot1` argument is performed to a Boolean
    if sl.arg('robot1'):
        sl.include('simple_launch', 'included_launch.py', launch_arguments = {'prefix': 'robot1'})

    # and even combine conditions
    if sl.arg('robot2') and not sl.arg('no_robot2'):

            args = {'prefix': 'robot2', 'x':sl.arg('robot2_x'), 'y': sl.arg('robot2_y')}
            # summing up args and strings
            sl.include('simple_launch', sl.arg('included') + '.py', launch_arguments=args)

    if sl.arg('rviz'):
        rviz_config = sl.find('simple_launch', 'turret.rviz')
        sl.node('rviz2', 'rviz2', arguments = ['-d', rviz_config])

    return sl.launch_description()


# tell SimpleLauncher to rely on the opaque_function in the launch description
# /!\ no `def generate_launch_description():`

generate_launch_description = sl.launch_description(opaque_function = launch_setup)

</code></pre></div></div>

<h3 id="combining-conditions">Combining conditions</h3>

<p>The file below shows how to use <code class="language-plaintext highlighter-rouge">sl.py_eval</code> to combine conditions. We have to build a valid Python expression, not forgetting the spaces around <code class="language-plaintext highlighter-rouge">and</code>, <code class="language-plaintext highlighter-rouge">or</code>, <code class="language-plaintext highlighter-rouge">not</code>, etc.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():

    sl = SimpleLauncher()

    cond1 = sl.declare_arg('cond1', True)
    cond2 = sl.declare_arg('cond2', False)

    for logic in ('and', 'or'):

        # builds &lt;cond1&gt; &lt;logic&gt; &lt;cond2&gt; Python expression
        combined = sl.py_eval(cond1, f' {logic} ', cond2)

        sl.log_info([f'{logic} condition is ', combined])

        with sl.group(if_condition = combined):
            sl.node('demo_nodes_cpp', 'talker', name = f'talker_{logic}')

        # also works with sl.node(..., condition = IfCondition(combined))

    return sl.launch_description()

</code></pre></div></div>

<h3 id="composition">Composition</h3>

<p>The file below is another way to write the <a href="https://index.ros.org/doc/ros2/Tutorials/Composition/#composition-using-launch-actions">composition launch example</a>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher

def generate_launch_description():

    sl = SimpleLauncher()

    with sl.container(name='my_container', output='screen'):
        sl.node(package='composition', plugin='Talker', name='talker')
        sl.node(package='composition', plugin='Listener', name='listener')

    return sl.launch_description()

</code></pre></div></div>

<h3 id="events-and-parameters">Events and parameters</h3>

<p>This <a href="https://github.com/oKermorgant/simple_launch/tree/devel/example/event_tutorial_launch.py">example file</a> is another way to write the <a href="https://docs.ros.org/en/rolling/Tutorials/Intermediate/Launch/Using-Event-Handlers.html">event launch example</a>. If does a little more work and is a little smarter, as the passed <code class="language-plaintext highlighter-rouge">new_background_r</code> is applied as soon as it has a valid value.</p>

<h3 id="auto-sim-time">auto sim time</h3>

<p>Here we run Gazebo and force all other nodes to <code class="language-plaintext highlighter-rouge">use_sim_time:=True</code>, unless this file is included from another one with <code class="language-plaintext highlighter-rouge">use_sim_time:=False</code>.
This is unlikely as this launch file spawns a simulator.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher, GazeboBridge

def generate_launch_description():

    # all nodes in this launch file will use_sim_time:=True
    sl = SimpleLauncher(use_sim_time=True)

    # run Gazebo + clock bridge
    sl.gz_launch(&lt;path/to/some/sdf/world&gt;, '-r')
    sl.create_gz_clock_bridge()

    # run other nodes with sim time

    return sl.launch_description()


</code></pre></div></div>

<h3 id="robot-description-and-conditionnal-gazebo-bridge">Robot description and conditionnal Gazebo bridge</h3>

<p>The file below only runs by default a <code class="language-plaintext highlighter-rouge">robot_state_publisher</code> with <code class="language-plaintext highlighter-rouge">use_sim_time:=False</code>.
However, if it is included from another file with <code class="language-plaintext highlighter-rouge">use_sim_time:=True</code> then it also spawns the robot into Gazebo and runs two bridges for joint states and pose.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from simple_launch import SimpleLauncher, GazeboBridge

def generate_launch_description():

    sl = SimpleLauncher(use_sim_time=False)

    # namespace is a launch argument, not a Python string
    sl.declare_arg('robot', default_value = 'robot1')
    robot = sl.arg('robot')

    with sl.group(ns = robot):
        # robot_state_publisher is always run
        sl.robot_state_publisher('my_description', 'my_robot.xacro')

        with sl.group(if_condition = sl.sim_time):
            # only execute this group if use_sim_time was set to True

            # spawn in Gazebo at default pose if not already here
            sl.spawn_gz_model(robot)

            # create a bridge for joint states @ /world/&lt;world&gt;/model/&lt;robot&gt;/joint_state
            # note the relative ROS topic 'joint_states' that is actually namespaced
            gz_js_topic = GazeboBridge.model_prefix(robot)/'joint_state'
            js_bridge = GazeboBridge(gz_topic = gz_js_topic,
                                     ros_topic = 'joint_states',
                                     msg = 'sensor_msgs/JointState',
                                     direction = GazeboBridge.gz2ros)

            # pose publisher bridge @ /model/&lt;robot&gt;
            pose_bridge = GazeboBridge('/model'/robot/'/pose',
                                       'pose_gt', 'geometry_msgs/Pose', GazeboBridge.gz2ros)

            # create bridge node with these two topics with default name gz_bridge
            sl.create_gz_bridge([js_bridge, pose_bridge])

    return sl.launch_description()


</code></pre></div></div>

<h3 id="full-gazebo-simulation">Full Gazebo simulation</h3>

<p>The file <code class="language-plaintext highlighter-rouge">example/gazebo/gazebo_launch.py</code> runs a basic simulation of a turret robot with a camera, also displayed in RViz.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch simple_launch gazebo_launch.py

</code></pre></div></div>

<p>You can move the robot around with a joint velocity setpoint (<code class="language-plaintext highlighter-rouge">std_msgs/Float64</code>) on <code class="language-plaintext highlighter-rouge">/turret/joint#</code> and see the simulated camera on <code class="language-plaintext highlighter-rouge">/turret/image</code>.</p>

<h2 id="i-want-more-examples">I want more examples</h2>

<p>Other self-contained examples (and slides) have been used to teach the ROS 2 launch file system and the nav stack.</p>

<p>Various aspects of the launch systen are shown in the <a href="https://github.com/oKermorgant/anf_launch">anf_launch</a> package.</p>

<p>A simple tutorial on <code class="language-plaintext highlighter-rouge">Nav2</code>  using <code class="language-plaintext highlighter-rouge">simple_launch</code> is available in the <a href="https://github.com/oKermorgant/anf_nav">anf_nav</a> package.</p>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <em>No CONTRIBUTING.md found.</em>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-melodic">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/simple_launch">simple_launch</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-oKermorgant-simple_launch
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-oKermorgant-simple_launch" role="menuitem" tabindex="-1" href="/r/simple_launch/github-oKermorgant-simple_launch" data="github-oKermorgant-simple_launch">
                    <span class="glyphicon glyphicon-star"></span>
                    github-oKermorgant-simple_launch
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>melodic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>


<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
  $(function() {
    setupContributeListTabLinks();
  });
  $(document).ready(function() {
    setupDistroSwitch("humble");
    setupContributeLists("https://github.com/oKermorgant/simple_launch.git");
  });
</script>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="container-fluid">
      <div style="float:left;">
        
          <a href="https://github.com/rkent/rosindex" title="Find rosindex in Github">
          <span class="icon  icon--github">
            <svg viewBox="0 0 16 16">
              <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
            </svg>
          </span>

          <span class="username">rkent/rosindex</span>
        </a>
        <em class="hidden-xs">| generated on 2025-05-05</em>
      
      </div>
      <div style="float:right;">
        <p class="text"><span class="hidden-xs">a community-maintained index of robotics software
 | </span><a href="/privacy.txt">privacy</a></p>
      </div>
    </div>
  </div>

</footer>


  </body>

</html>
