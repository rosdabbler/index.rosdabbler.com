<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Index</title>
    <meta name="description" content="a community-maintained index of robotics software
">

    
    <link rel="canonical" href="http://index.rosdabbler.com/r/ublox_dgnss/">
    
    
    <link rel="icon" sizes="any" type="image/svg+xml" href="/assets/rosindex_logo.svg">

    

    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">
    

    

    <script type="text/javascript" src=/js/jquery.js></script>
    <script src=/bootstrap/js/bootstrap.min.js type="text/javascript"></script>
    <script src=/js/jquery-cookie.js type="text/javascript"></script>
    
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EVD5Z6G6NH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EVD5Z6G6NH');
</script>

    <script type="text/javascript" src=/js/toc.js></script>

    <script src=/js/distro_switch.js></script>
  </head>

  <body>

    <header class="site-header">

  <div class="wrapper">
    <div class="container-fluid" style="margin-bottom: 10px">
      <div class="row">
        <!-- title -->
        <div class="col-xs-3" style="white-space:nowrap">
          <a class="site-title" href="/">
            <img src="/assets/rosindex_logo.svg" width="26" height="26" alt="ROS index logo" style="padding-bottom: 3px"/>
            ROS Index</a>
        </div>
        <!-- main internal links -->
        <div class="col-xs-6 text-center" style="padding:0px">
          <div class="btn-group hidden-xs" role="group" aria-label="..." style="padding: 6px">
            <div class="btn-group" role="group">
              <a href="/?search_packages=true" class="btn btn-default" role="button">Package List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/?search_repos=true" class="btn btn-default" role="button">Repository List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/search_deps" class="btn btn-default" role="button">System Dependencies</a>
            </div>
          </div>
          <div class="hidden-lg hidden-md hidden-sm">
            <button id="hLabel" class="btn btn-link dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Lists <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="hLabel">
              <li><a href="/?search_packages=true">Package List</a></li>
              <li><a href="/?search_repos=true">Repository List</a></li>
              <li><a href="/search_deps">System Dependencies</a></li>
            </ul>
          </div>
        </div>
        <!-- additional links -->
        <div class="col-xs-3 text-right" style="white-space:nowrap; padding:0px">
          <ul class="list-inline" style="margin-bottom:0px;">
            <li class="dropdown hidden-xs hidden-sm">
              <button id="rLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                ROS Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu" aria-labelledby="rLabel">
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-xs hidden-sm">
              <button id="aLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                About <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="aLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-md hidden-lg">
              <button id="qLabel" class="btn btn-link" type="button"
                      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="qLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
                <hr style="margin:7px" />
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin-top:20px">
  <div class="container-fluid">
    <div class="row">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/repos">Repos</a></li>
        <li class="active">ublox_dgnss</li>
        <!--<li class="active">ublox_dgnss</li>-->
      </ol>
    </div>
    <div class="row">
      

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
    <label id="humble-option" class="distro-button btn btn-xs btn-primary" href="#humble" data="humble">
      <input type="radio" name="options" id="humble-radio" autocomplete="off"> humble
    </label>
  
    <label id="jazzy-option" class="distro-button btn btn-xs btn-primary" href="#jazzy" data="jazzy">
      <input type="radio" name="options" id="jazzy-radio" autocomplete="off"> jazzy
    </label>
  
    <label id="kilted-option" class="distro-button btn btn-xs btn-primary" href="#kilted" data="kilted">
      <input type="radio" name="options" id="kilted-radio" autocomplete="off"> kilted
    </label>
  
    <label id="rolling-option" class="distro-button btn btn-xs btn-primary" href="#rolling" data="rolling">
      <input type="radio" name="options" id="rolling-radio" autocomplete="off"> rolling
    </label>
  
    <label id="github-option" class="distro-button btn btn-xs btn-default" href="#github" data="github">
      <input type="radio" name="options" id="github-radio" autocomplete="off"> github
    </label>
  
    <label id="noetic-option" class="distro-button btn btn-xs btn-default" href="#noetic" data="noetic">
      <input type="radio" name="options" id="noetic-radio" autocomplete="off"> noetic
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-primary" data-toggle="dropdown" id="older-distro-button">
        <input type="radio" name="options" autocomplete="off">
      <span id="older-label">Older</span>
      <span class="caret"></span>
    </label>
    <ul class="dropdown-menu" role="menu">
      
        <li data="galactic" id="galactic-option" class=" older-distro-option"  href="#galactic">
          <a href="#galactic" data="galactic" id="galactic-button">galactic</a>
        </li>
      
        <li data="iron" id="iron-option" class=" older-distro-option"  href="#iron">
          <a href="#iron" data="iron" id="iron-button">iron</a>
        </li>
      
        <li data="melodic" id="melodic-option" class="disabled older-distro-option"  href="#melodic">
          <a href="#melodic" data="melodic" id="melodic-button">melodic</a>
        </li>
      
    </ul>
  </div>
</div>

    </div>
    <div class="row">
      &nbsp;
    </div>
  </div>
</div>


  <div class="distro distro-humble">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/ublox_dgnss">ublox_dgnss</a> <small>repository</small></h3>
        <span class="label label-default">gps</span> <span class="label label-default">ublox</span> <span class="label label-default">ubx</span> <span class="label label-default">gps-location</span> <span class="label label-default">gps-data</span> <span class="label label-default">ros2</span> <span class="label label-default">high-precision</span> <span class="label label-default">ntripcaster</span> <span class="label label-default">dgnss</span> <span class="label label-default">ntripclient</span> 
        
        <a class="label label-primary pkg-label" href="/p/ntrip_client_node">ntrip_client_node</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_dgnss">ublox_dgnss</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_dgnss_node">ublox_dgnss_node</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_nav_sat_fix_hp_node">ublox_nav_sat_fix_hp_node</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_ubx_interfaces">ublox_ubx_interfaces</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_ubx_msgs">ublox_ubx_msgs</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-aussierobots-ublox_dgnss
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-aussierobots-ublox_dgnss" role="menuitem" tabindex="-1" href="/r/ublox_dgnss/github-aussierobots-ublox_dgnss" data="github-aussierobots-ublox_dgnss">
                    <span class="glyphicon glyphicon-star"></span>
                    github-aussierobots-ublox_dgnss
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">This usb based ROS2 driver is focused on UBLOX Generation 9 UBX messaging, for a DGNSS rover. High precision data is available.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/aussierobots/ublox_dgnss.git">https://github.com/aussierobots/ublox_dgnss.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">main</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-02-27
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <span class="label label-default">gps</span> <span class="label label-default">ublox</span> <span class="label label-default">ubx</span> <span class="label label-default">gps-location</span> <span class="label label-default">gps-data</span> <span class="label label-default">ros2</span> <span class="label label-default">high-precision</span> <span class="label label-default">ntripcaster</span> <span class="label label-default">dgnss</span> <span class="label label-default">ntripclient</span> 
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/ublox_dgnss/#humble-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ublox_dgnss/#humble-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ublox_dgnss/#humble-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/ntrip_client_node">ntrip_client_node</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_dgnss">ublox_dgnss</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_dgnss_node">ublox_dgnss_node</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_nav_sat_fix_hp_node">ublox_nav_sat_fix_hp_node</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_ubx_interfaces">ublox_ubx_interfaces</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_ubx_msgs">ublox_ubx_msgs</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="ublox-dgnss">ublox-dgnss</h1>

<p>This usb based driver is focused on UBLOX Generation 9 UBX messaging, for a DGNSS rover. High precision data is available. A moving base station configuration has been added. This package also supports a fixed base station and moving rover use case.</p>

<p>RTCM messages can be delivered externally. Alternately the ntrip_client_node can be utilised to retrieve RTCM messages from a castor to publish <code class="language-plaintext highlighter-rouge">/ntrip_client/rtcm</code> messages which will be received by the ublox_dgnss_node.</p>

<p>Work has started on SPARTN support - basic commands are available to enable it on the device and to confirm that the messages are being used (when delivered to the device).</p>

<p>This driver will only work with later generation ublox devices. Testing and development was performed against a ZED-F9P and a ZED-F9R connected via USB, under Ubuntu 22.04/24.04. The driver uses libusb api 1.0.</p>

<p>This release works with Rolling, Jazzy, Iron and Humble.</p>

<p>You may need to create a udev rule as follows:</p>

<p>/etc/udev/rules.d/99-ublox-gnss.rules</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  #UBLOX ZED-F9
  ATTRS{idVendor}=="1546", ATTRS{idProduct}=="01a9", MODE="0666", GROUP="plugdev"

</code></pre></div></div>

<p>This driver follows the UBX standards used for the ZED-F9P/F9R as documented in the <a href="https://content.u-blox.com/sites/default/files/documents/u-blox-F9-HPG-1.32_InterfaceDescription_UBX-22008968.pdf">F9P interface description</a> and <a href="https://content.u-blox.com/sites/default/files/documents/u-blox-F9-HPS-1.30_InterfaceDescription_UBX-22010984.pdf">F9R interface description</a>.</p>

<p>It implements a subset of the specification related to achieving high precision output as a rover. U-center can be used to alter settings. Any configuration parameter changed by this driver, will be applied only in RAM. Upon a restart (hot, cold or warm) or after a hot plug usb attach event, the configuration stored in the driver will be sent to the device.</p>

<h2 id="start-commands">Start commands</h2>

<p>There are multiple ways to start the node. Its been built using composition. An executable is provider. An example follows which turns off NMEA output at startup.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 run ublox_dgnss_node ublox_dgnss_node --ros-args -p CFG_USBOUTPROT_NMEA:=False

</code></pre></div></div>
<p>Parameters can be set at launch and some examples are provided to launch high precision pos ecef|llh</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch ublox_dgnss ublox_rover_hpposecef.launch.py

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch ublox_dgnss ublox_rover_hpposllh.launch.py

</code></pre></div></div>

<h2 id="services">Services</h2>

<p>Four services are provided to reset odo, cold start, warm start and hot start.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/reset_odo ublox_ubx_interfaces/srv/ResetODO

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/cold_start ublox_ubx_interfaces/srv/ColdStart '{reset_type: 1}'

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/warm_start ublox_ubx_interfaces/srv/WarmStart '{reset_type: 1}'

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/hot_start ublox_ubx_interfaces/srv/HotStart '{reset_type: 1}'

</code></pre></div></div>

<h2 id="parameters">Parameters</h2>

<p>Parameter values can be set at any time or passed when the node starts</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 param set /ublox_dgnss CFG_RATE_NAV 2

</code></pre></div></div>
<p>or the current value retrieved</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 param get /ublox_dgnss CFG_RATE_NAV

</code></pre></div></div>
<h3 id="ubx-parameters">UBX Parameters</h3>

<p>The following parameters may be set. Its a subset of the full UBX Gen 9 configuration parameter list.</p>

<p>Values will be as described in the integration manual (without scaling applied). Changing a CFG_MSGOUT_* type parameter to a value &gt;0 will cause the corresponding ublox_ubx_msgs to be published.</p>

<p>CFG_INFMSG_NMEA_USB
  CFG_INFMSG_UBX_USB
  CFG_MSGOUT_UBX_NAV_CLOCK_USB
  CFG_MSGOUT_UBX_NAV_COV_USB
  CFG_MSGOUT_UBX_NAV_DOP_USB
  CFG_MSGOUT_UBX_NAV_EOE_USB
  CFG_MSGOUT_UBX_NAV_HPPOSECEF_USB
  CFG_MSGOUT_UBX_NAV_HPPOSLLH_USB
  CFG_MSGOUT_UBX_NAV_ODO_USB
  CFG_MSGOUT_UBX_NAV_ORB_USB
  CFG_MSGOUT_UBX_NAV_SAT_USB
  CFG_MSGOUT_UBX_NAV_SIG_USB
  CFG_MSGOUT_UBX_NAV_POSECEF_USB
  CFG_MSGOUT_UBX_NAV_POSLLH_USB
  CFG_MSGOUT_UBX_NAV_PVT_USB
  CFG_MSGOUT_UBX_NAV_RELPOSNED_USB
  CFG_MSGOUT_UBX_NAV_STATUS_USB
  CFG_MSGOUT_UBX_NAV_TIMEUTC_USB
  CFG_MSGOUT_UBX_NAV_VELECEF_USB
  CFG_MSGOUT_UBX_NAV_VELNED_USB
  CFG_MSGOUT_UBX_RXM_COR_USB
  CFG_MSGOUT_UBX_RXM_RTCM_USB
  CFG_MSGOUT_UBX_RXM_MEASX_USB
  CFG_MSGOUT_UBX_RXM_RAWX_USB
  CFG_MSGOUT_UBX_RXM_SPARTN_USB
  CFG_MSGOUT_UBX_MON_COMMS_USB
  CFG_MSGOUT_UBX_ESF_MEAS_USB
  CFG_MSGOUT_UBX_ESF_STATUS_USB
  CFG_MSGOUT_UBX_SEC_SIG_USB
  CFG_MSGOUT_UBX_SEC_SIGLOG_USB
  CFG_NAVHPG_DGNSSMODE
  CFG_NAVSPG_DYNMODEL
  CFG_NAVSPG_FIXMODE
  CFG_NAVSPG_INIFIX3D
  CFG_NAVSPG_UTCSTANDARD
  CFG_ODO_COGLPGAIN
  CFG_ODO_COGMAXPOSACC
  CFG_ODO_COGMAXSPEED
  CFG_ODO_OUTLPCOG
  CFG_ODO_OUTLPVEL
  CFG_ODO_PROFILE
  CFG_ODO_USE_COG
  CFG_ODO_USE_ODO
  CFG_ODO_VALLPGAIN
  CFG_RATE_MEAS
  CFG_RATE_NAV
  CFG_RATE_TIMEREF
  CFG_TMODE_MODE
  CFG_TMODE_POS_TYPE
  CFG_UART1INPROT_NMEA
  CFG_UART1INPROT_RTCM3X
  CFG_UART1INPROT_SPARTN
  CFG_UART1INPROT_UBX
  CFG_UART1OUTPROT_NMEA
  CFG_UART1OUTPROT_RTCM3X
  CFG_UART1OUTPROT_UBX
  CFG_UART2INPROT_NMEA
  CFG_UART2INPROT_RTCM3X
  CFG_UART2INPROT_SPARTN
  CFG_UART2INPROT_UBX
  CFG_UART2OUTPROT_NMEA
  CFG_UART2OUTPROT_RTCM3X
  CFG_UART2OUTPROT_UBX
  CFG_USBINPROT_NMEA
  CFG_USBINPROT_RTCM3X
  CFG_USBINPROT_UBX
  CFG_USBOUTPROT_NMEA
  CFG_USBOUTPROT_RTCM3X
  CFG_USBOUTPROT_UBX</p>

<p>CFG_SPARTN_USE_SOURCE</p>

<p>CFG_SFIMU_AUTO_MNTALG_ENA
  CFG_SFIMU_IMU_MNTALG_YAW
  CFG_SFIMU_IMU_MNTALG_PITCH
  CFG_SFIMU_IMU_MNTALG_ROLL</p>

<p>CFG_SFODO_COMBINE_TICKS
  CFG_SFODO_COUNT_MAX
  CFG_SFODO_DIS_AUTOCOUNTMAX
  CFG_SFODO_DIS_AUTODIRPINPOL
  CFG_SFODO_FACTOR
  CFG_SFODO_LATENCY
  CFG_SFODO_QUANT_ERROR</p>

<h3 id="device-identification-parameters">Device Identification Parameters</h3>

<p>aka Use with Multiple Devices</p>

<p>By default, the ublox_dgnss node will search for and connect to the first device which matches the ublox USB ID’s (vendor ID of 0x1546 and product ID of 0x01a9).  If multiple devices are connected simultaneously, the remaining devices will be ignored.  In this situation you have no control over which device is used, since the order in which they are found may depend on the order in which they were physically attached to the host.</p>

<p>If you have multiple ublox devices attached simultaneously and wish to connect to a specific device, you can specify a launch parameter “DEVICE_SERIAL_STRING”.  The node will then search for and connect to the first device with this matching serial string.  The device serial string “CFG-USB-SERIAL_NO_STRx” itself should be programmed into the ublox device beforehand using u-center software.</p>

<p>The frame ID used in ROS2 messages for that device can also be specified using the launch parameter “FRAME_ID”.</p>

<p>Note: these parameters are not written to the device.  They only instruct the node on how to behave.</p>

<h1 id="ros2-ubx-nav-messages">ROS2 UBX NAV Messages</h1>

<p>The following messages may be outputted. They included a <code class="language-plaintext highlighter-rouge">std_msgs/Header header</code> with the remainder of the fields matching the UBX output. Note that field names use different notation as the UBX field name notation is not compliant with the ROS IDL field names.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/ubx_esf_meas

/ubx_esf_status
/ubx_mon_comms
/ubx_nav_clock
/ubx_nav_cov
/ubx_nav_dop
/ubx_nav_eoe
/ubx_nav_hp_pos_ecef
/ubx_nav_hp_pos_llh
/ubx_nav_odo
/ubx_nav_orb
/ubx_nav_sat
/ubx_nav_sig
/ubx_nav_pos_ecef
/ubx_nav_pos_llh
/ubx_nav_pvt
/ubx_nav_rel_pos_ned
/ubx_nav_status
/ubx_nav_time_utc
/ubx_nav_vel_ecef
/ubx_nav_vel_ned
/ubx_rxm_cor
/ubx_rxm_rtcm
/ubx_rxm_measx
/ubx_rxm_rawx
/ubx_sec_sig
/ubx_sec_sig_log


</code></pre></div></div>

<p>The following topics are subscribed to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/ubx_esf_meas_to_device
/ntrip_client/rtcm

</code></pre></div></div>

<h1 id="ros2-navsatfix-messages">ROS2 NAVSATFIX Messages</h1>

<p>In addition to the UBX NAV messages shown above, <a href="https://docs.ros2.org/latest/api/sensor_msgs/msg/NavSatFix.html">NavSatFix messages</a> can also be published on topic /fix.</p>

<p>Note that this node relies on (and hence subscribes to) three UBX Nav messages, namely /ubx_nav_hp_pos_llh, /ubx_nav_cov, /ubx_nav_status.</p>

<p>If the ublox device is not configured to publish these three messages, the navsatfix message will likewise not be published.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/fix

</code></pre></div></div>

<h1 id="ntrip-client---rtcm-messages">NTRIP Client - RTCM messages</h1>

<p>A basic NTRIP client is provided, that focuses in binary RTCM data. Its purpose is to acquire the RTCM data from an internet based NTRIP Castor and publish <a href="https://index.ros.org/p/rtcm_msgs/">RTCM Messages</a>.</p>

<p>An example launch file is provided. You will need to set values appropriate for the NTRIP Castor intended to be used</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch ublox_dgnss ntrip_client.launch.py use_https:=true host:=ntrip.data.gnss.ga.gov.au port:=443 mountpoint:=MBCH00AUS0 username:=username password:=password

</code></pre></div></div>
<p>Note the launch file has been configured to also use environment variables <code class="language-plaintext highlighter-rouge">NTRIP_USERNAME</code> &amp; <code class="language-plaintext highlighter-rouge">NTRIP_PASSWORD</code> such that you dont need credentials in the launch scripts.</p>

<h1 id="fixed-base-and-rover">Fixed Base and Rover</h1>

<p>This package supports the use case where a fixed base station is setup to emit RTCM data and a moving rover consumes the emitted RTCM data for improved location accuracy as it moves. The base is setup to perform the survey-in procedure and, once finished, emit RTCM messages.</p>

<p>Example launch files are provided for this use case. Run <code class="language-plaintext highlighter-rouge">ublox_fb+r_base.launch.py</code> for the fixed base and <code class="language-plaintext highlighter-rouge">ublox_fb+r_rover.launch.py</code> for the moving rover.</p>

<h1 id="moving-base-and-rover">Moving Base and Rover</h1>

<p>The ZED-F9P devices support the “moving base and rover” mode of operation, using two devices on a mobile vehicle to provide both position and orientation data.  Further information on this mode, including physical connections between the two devices and the host machine are included in the following ublox application note.</p>

<p>https://www.u-blox.com/sites/default/files/documents/ZED-F9P-MovingBase_AppNote_UBX-19009093.pdf</p>

<p>Note: the ZED-F9R device does not support this mode.</p>

<p>Example launch configuration files are included as “ublox_mb+r_base.launch.py” and “ublox_mb+r_rover.launch.py” for the base and rover devices respectively.  The base and rover are physically connected similar to that described in Section 2.2.1 “Wired connection between base and rover” in the ublox app note, with UART2 used for the wired connection between base and rover.  Both base and rover connect to the host machine via USB.  Device configuration is similar to that described in Section 2.3.2 “5 Hz navigation rate application” in the app note.</p>

<p>Both base and rover will output position data which can be used to publish NavSatFix messages (as described above).  The rover also outputs heading data via UBX-NAV-RELPOSNED messages.  Refer to Section 2.4 “Using the heading output” in the app note for more information.</p>

<p>Note: as this mode required two ZED-F9P devices connected simultaneously, you will need to configure each device with a different serial string and specify these in the launch files.  See description above on device identification parameters.</p>

<h1 id="helpful-tips">Helpful tips</h1>

<h2 id="did-the-f9-device-receive-and-use-the-rtcm-data">Did the F9 device receive and use the RTCM data?</h2>
<p>If you want to see if the UBX device has received and processed the RTCM data run this, after ensuring that CFG_MSGOUT_UBX_RXM_RTCM_USB is set to 1 via <code class="language-plaintext highlighter-rouge">rqt</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 topic echo /ubx_rxm_rtcm

</code></pre></div></div>
<p>If <code class="language-plaintext highlighter-rouge">msg_used</code> shows 2 then the RTCM message has been used by the device.</p>

<p>This <a href="https://www.use-snip.com/kb/knowledge-base/an-rtcm-message-cheat-sheet/">RTCM 3 Message cheat sheet</a> can be used to determine wha the <code class="language-plaintext highlighter-rouge">msg_type</code> field represents eg GPS, GLONASS, Galileo, SBAS, QZSS or BeiDou.</p>

<h2 id="was-a-high-precision-location-calculated">Was a high precision location calculated?</h2>

<p>Ensure CFG_MSGOUT_UBX_NAV_STATUS_USB is set to 1. It is lower priority message but can be used to determine what type of GPS fix and the type of differential error correction that has been supplied.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 topic echo /ubx_nav_status

</code></pre></div></div>

<p>should output a message similar to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>header:
  stamp:
    sec: 1684907069
    nanosec: 214298394
  frame_id: ubx
itow: 279887200
gps_fix:
  fix_type: 3
gps_fix_ok: true
diff_soln: true
wkn_set: true
tow_set: true
diff_corr: true
carr_soln_valid: true
map_matching:
  status: 0
psm:
  state: 0
spoof_det:
  state: 2
carr_soln:
  status: 0
ttff: 709
msss: 3416912

</code></pre></div></div>

<p>If the <code class="language-plaintext highlighter-rouge">gps_fix.fix_type</code> = 3, it means its a 3D fix. The <code class="language-plaintext highlighter-rouge">diff_soln</code> and <code class="language-plaintext highlighter-rouge">diff_corr</code> implies that the differential error correction has occurred.</p>

<h2 id="how-precise-is-my-solution">How precise is my solution?</h2>

<p>After making sure that the deivce is processing RTCM messages and assuming that you have launched the node with <code class="language-plaintext highlighter-rouge">ros2 launch ublox_dgnss ublox_rover_hpposllh.launch.py</code>, run the following the command</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 topic echo /ubx_nav_hp_pos_llh

</code></pre></div></div>
<p>You should see something similiar to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>header:
  stamp:
    sec: 1684907675
    nanosec: 765881914
  frame_id: ubx
version: 0
invalid_lon: false
invalid_lat: false
invalid_height: false
invalid_hmsl: false
invalid_lon_hp: false
invalid_lat_hp: false
invalid_height_hp: false
invalid_hmsl_hp: false
itow: 280493800
lon: 1534256850
lat: -280021154
height: 87232
hmsl: 49963
lon_hp: 31
lat_hp: -7
height_hp: -1
hmsl_hp: 1
h_acc: 169
v_acc: 123

</code></pre></div></div>

<p>The driver output the raw UBX data into the message so some interpreting is required.</p>

<p><code class="language-plaintext highlighter-rouge">h_acc</code> and <code class="language-plaintext highlighter-rouge">v_acc</code> are in millimeters but need to be scaled by 0.1 - <code class="language-plaintext highlighter-rouge">h_acc: 16.9 mm</code> and <code class="language-plaintext highlighter-rouge">v_acc: 12.3 mm</code> per the above. Such that there is centimeter level accuracy.</p>

<p>If in doubt as to what the scaling is, please look at the F9 interface description for an explanation. All debug log output have had scaling applied.</p>

<p>If you would like to calculate the high precision lon, lat and height values use the following code as a guide</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   // Extract the LLH and high-precision components
    double lat = ubx_hppos_llh_msg-&gt;lat * 1e-7 + ubx_hppos_llh_msg-&gt;lat_hp * 1e-9;
    double lon = ubx_hppos_llh_msg-&gt;lon * 1e-7 + ubx_hppos_llh_msg-&gt;lon_hp * 1e-9;
    double alt = ubx_hppos_llh_msg-&gt;height * 1e-3 + ubx_hppos_llh_msg-&gt;height_hp * 1e-4;

</code></pre></div></div>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <em>No CONTRIBUTING.md found.</em>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-jazzy">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/ublox_dgnss">ublox_dgnss</a> <small>repository</small></h3>
        <span class="label label-default">gps</span> <span class="label label-default">ublox</span> <span class="label label-default">ubx</span> <span class="label label-default">gps-location</span> <span class="label label-default">gps-data</span> <span class="label label-default">ros2</span> <span class="label label-default">high-precision</span> <span class="label label-default">ntripcaster</span> <span class="label label-default">dgnss</span> <span class="label label-default">ntripclient</span> 
        
        <a class="label label-primary pkg-label" href="/p/ntrip_client_node">ntrip_client_node</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_dgnss">ublox_dgnss</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_dgnss_node">ublox_dgnss_node</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_nav_sat_fix_hp_node">ublox_nav_sat_fix_hp_node</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_ubx_interfaces">ublox_ubx_interfaces</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_ubx_msgs">ublox_ubx_msgs</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-aussierobots-ublox_dgnss
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-aussierobots-ublox_dgnss" role="menuitem" tabindex="-1" href="/r/ublox_dgnss/github-aussierobots-ublox_dgnss" data="github-aussierobots-ublox_dgnss">
                    <span class="glyphicon glyphicon-star"></span>
                    github-aussierobots-ublox_dgnss
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">This usb based ROS2 driver is focused on UBLOX Generation 9 UBX messaging, for a DGNSS rover. High precision data is available.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/aussierobots/ublox_dgnss.git">https://github.com/aussierobots/ublox_dgnss.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">main</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-02-27
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <span class="label label-default">gps</span> <span class="label label-default">ublox</span> <span class="label label-default">ubx</span> <span class="label label-default">gps-location</span> <span class="label label-default">gps-data</span> <span class="label label-default">ros2</span> <span class="label label-default">high-precision</span> <span class="label label-default">ntripcaster</span> <span class="label label-default">dgnss</span> <span class="label label-default">ntripclient</span> 
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/ublox_dgnss/#jazzy-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ublox_dgnss/#jazzy-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ublox_dgnss/#jazzy-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/ntrip_client_node">ntrip_client_node</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_dgnss">ublox_dgnss</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_dgnss_node">ublox_dgnss_node</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_nav_sat_fix_hp_node">ublox_nav_sat_fix_hp_node</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_ubx_interfaces">ublox_ubx_interfaces</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_ubx_msgs">ublox_ubx_msgs</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="ublox-dgnss">ublox-dgnss</h1>

<p>This usb based driver is focused on UBLOX Generation 9 UBX messaging, for a DGNSS rover. High precision data is available. A moving base station configuration has been added. This package also supports a fixed base station and moving rover use case.</p>

<p>RTCM messages can be delivered externally. Alternately the ntrip_client_node can be utilised to retrieve RTCM messages from a castor to publish <code class="language-plaintext highlighter-rouge">/ntrip_client/rtcm</code> messages which will be received by the ublox_dgnss_node.</p>

<p>Work has started on SPARTN support - basic commands are available to enable it on the device and to confirm that the messages are being used (when delivered to the device).</p>

<p>This driver will only work with later generation ublox devices. Testing and development was performed against a ZED-F9P and a ZED-F9R connected via USB, under Ubuntu 22.04/24.04. The driver uses libusb api 1.0.</p>

<p>This release works with Rolling, Jazzy, Iron and Humble.</p>

<p>You may need to create a udev rule as follows:</p>

<p>/etc/udev/rules.d/99-ublox-gnss.rules</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  #UBLOX ZED-F9
  ATTRS{idVendor}=="1546", ATTRS{idProduct}=="01a9", MODE="0666", GROUP="plugdev"

</code></pre></div></div>

<p>This driver follows the UBX standards used for the ZED-F9P/F9R as documented in the <a href="https://content.u-blox.com/sites/default/files/documents/u-blox-F9-HPG-1.32_InterfaceDescription_UBX-22008968.pdf">F9P interface description</a> and <a href="https://content.u-blox.com/sites/default/files/documents/u-blox-F9-HPS-1.30_InterfaceDescription_UBX-22010984.pdf">F9R interface description</a>.</p>

<p>It implements a subset of the specification related to achieving high precision output as a rover. U-center can be used to alter settings. Any configuration parameter changed by this driver, will be applied only in RAM. Upon a restart (hot, cold or warm) or after a hot plug usb attach event, the configuration stored in the driver will be sent to the device.</p>

<h2 id="start-commands">Start commands</h2>

<p>There are multiple ways to start the node. Its been built using composition. An executable is provider. An example follows which turns off NMEA output at startup.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 run ublox_dgnss_node ublox_dgnss_node --ros-args -p CFG_USBOUTPROT_NMEA:=False

</code></pre></div></div>
<p>Parameters can be set at launch and some examples are provided to launch high precision pos ecef|llh</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch ublox_dgnss ublox_rover_hpposecef.launch.py

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch ublox_dgnss ublox_rover_hpposllh.launch.py

</code></pre></div></div>

<h2 id="services">Services</h2>

<p>Four services are provided to reset odo, cold start, warm start and hot start.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/reset_odo ublox_ubx_interfaces/srv/ResetODO

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/cold_start ublox_ubx_interfaces/srv/ColdStart '{reset_type: 1}'

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/warm_start ublox_ubx_interfaces/srv/WarmStart '{reset_type: 1}'

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/hot_start ublox_ubx_interfaces/srv/HotStart '{reset_type: 1}'

</code></pre></div></div>

<h2 id="parameters">Parameters</h2>

<p>Parameter values can be set at any time or passed when the node starts</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 param set /ublox_dgnss CFG_RATE_NAV 2

</code></pre></div></div>
<p>or the current value retrieved</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 param get /ublox_dgnss CFG_RATE_NAV

</code></pre></div></div>
<h3 id="ubx-parameters">UBX Parameters</h3>

<p>The following parameters may be set. Its a subset of the full UBX Gen 9 configuration parameter list.</p>

<p>Values will be as described in the integration manual (without scaling applied). Changing a CFG_MSGOUT_* type parameter to a value &gt;0 will cause the corresponding ublox_ubx_msgs to be published.</p>

<p>CFG_INFMSG_NMEA_USB
  CFG_INFMSG_UBX_USB
  CFG_MSGOUT_UBX_NAV_CLOCK_USB
  CFG_MSGOUT_UBX_NAV_COV_USB
  CFG_MSGOUT_UBX_NAV_DOP_USB
  CFG_MSGOUT_UBX_NAV_EOE_USB
  CFG_MSGOUT_UBX_NAV_HPPOSECEF_USB
  CFG_MSGOUT_UBX_NAV_HPPOSLLH_USB
  CFG_MSGOUT_UBX_NAV_ODO_USB
  CFG_MSGOUT_UBX_NAV_ORB_USB
  CFG_MSGOUT_UBX_NAV_SAT_USB
  CFG_MSGOUT_UBX_NAV_SIG_USB
  CFG_MSGOUT_UBX_NAV_POSECEF_USB
  CFG_MSGOUT_UBX_NAV_POSLLH_USB
  CFG_MSGOUT_UBX_NAV_PVT_USB
  CFG_MSGOUT_UBX_NAV_RELPOSNED_USB
  CFG_MSGOUT_UBX_NAV_STATUS_USB
  CFG_MSGOUT_UBX_NAV_TIMEUTC_USB
  CFG_MSGOUT_UBX_NAV_VELECEF_USB
  CFG_MSGOUT_UBX_NAV_VELNED_USB
  CFG_MSGOUT_UBX_RXM_COR_USB
  CFG_MSGOUT_UBX_RXM_RTCM_USB
  CFG_MSGOUT_UBX_RXM_MEASX_USB
  CFG_MSGOUT_UBX_RXM_RAWX_USB
  CFG_MSGOUT_UBX_RXM_SPARTN_USB
  CFG_MSGOUT_UBX_MON_COMMS_USB
  CFG_MSGOUT_UBX_ESF_MEAS_USB
  CFG_MSGOUT_UBX_ESF_STATUS_USB
  CFG_MSGOUT_UBX_SEC_SIG_USB
  CFG_MSGOUT_UBX_SEC_SIGLOG_USB
  CFG_NAVHPG_DGNSSMODE
  CFG_NAVSPG_DYNMODEL
  CFG_NAVSPG_FIXMODE
  CFG_NAVSPG_INIFIX3D
  CFG_NAVSPG_UTCSTANDARD
  CFG_ODO_COGLPGAIN
  CFG_ODO_COGMAXPOSACC
  CFG_ODO_COGMAXSPEED
  CFG_ODO_OUTLPCOG
  CFG_ODO_OUTLPVEL
  CFG_ODO_PROFILE
  CFG_ODO_USE_COG
  CFG_ODO_USE_ODO
  CFG_ODO_VALLPGAIN
  CFG_RATE_MEAS
  CFG_RATE_NAV
  CFG_RATE_TIMEREF
  CFG_TMODE_MODE
  CFG_TMODE_POS_TYPE
  CFG_UART1INPROT_NMEA
  CFG_UART1INPROT_RTCM3X
  CFG_UART1INPROT_SPARTN
  CFG_UART1INPROT_UBX
  CFG_UART1OUTPROT_NMEA
  CFG_UART1OUTPROT_RTCM3X
  CFG_UART1OUTPROT_UBX
  CFG_UART2INPROT_NMEA
  CFG_UART2INPROT_RTCM3X
  CFG_UART2INPROT_SPARTN
  CFG_UART2INPROT_UBX
  CFG_UART2OUTPROT_NMEA
  CFG_UART2OUTPROT_RTCM3X
  CFG_UART2OUTPROT_UBX
  CFG_USBINPROT_NMEA
  CFG_USBINPROT_RTCM3X
  CFG_USBINPROT_UBX
  CFG_USBOUTPROT_NMEA
  CFG_USBOUTPROT_RTCM3X
  CFG_USBOUTPROT_UBX</p>

<p>CFG_SPARTN_USE_SOURCE</p>

<p>CFG_SFIMU_AUTO_MNTALG_ENA
  CFG_SFIMU_IMU_MNTALG_YAW
  CFG_SFIMU_IMU_MNTALG_PITCH
  CFG_SFIMU_IMU_MNTALG_ROLL</p>

<p>CFG_SFODO_COMBINE_TICKS
  CFG_SFODO_COUNT_MAX
  CFG_SFODO_DIS_AUTOCOUNTMAX
  CFG_SFODO_DIS_AUTODIRPINPOL
  CFG_SFODO_FACTOR
  CFG_SFODO_LATENCY
  CFG_SFODO_QUANT_ERROR</p>

<h3 id="device-identification-parameters">Device Identification Parameters</h3>

<p>aka Use with Multiple Devices</p>

<p>By default, the ublox_dgnss node will search for and connect to the first device which matches the ublox USB ID’s (vendor ID of 0x1546 and product ID of 0x01a9).  If multiple devices are connected simultaneously, the remaining devices will be ignored.  In this situation you have no control over which device is used, since the order in which they are found may depend on the order in which they were physically attached to the host.</p>

<p>If you have multiple ublox devices attached simultaneously and wish to connect to a specific device, you can specify a launch parameter “DEVICE_SERIAL_STRING”.  The node will then search for and connect to the first device with this matching serial string.  The device serial string “CFG-USB-SERIAL_NO_STRx” itself should be programmed into the ublox device beforehand using u-center software.</p>

<p>The frame ID used in ROS2 messages for that device can also be specified using the launch parameter “FRAME_ID”.</p>

<p>Note: these parameters are not written to the device.  They only instruct the node on how to behave.</p>

<h1 id="ros2-ubx-nav-messages">ROS2 UBX NAV Messages</h1>

<p>The following messages may be outputted. They included a <code class="language-plaintext highlighter-rouge">std_msgs/Header header</code> with the remainder of the fields matching the UBX output. Note that field names use different notation as the UBX field name notation is not compliant with the ROS IDL field names.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/ubx_esf_meas

/ubx_esf_status
/ubx_mon_comms
/ubx_nav_clock
/ubx_nav_cov
/ubx_nav_dop
/ubx_nav_eoe
/ubx_nav_hp_pos_ecef
/ubx_nav_hp_pos_llh
/ubx_nav_odo
/ubx_nav_orb
/ubx_nav_sat
/ubx_nav_sig
/ubx_nav_pos_ecef
/ubx_nav_pos_llh
/ubx_nav_pvt
/ubx_nav_rel_pos_ned
/ubx_nav_status
/ubx_nav_time_utc
/ubx_nav_vel_ecef
/ubx_nav_vel_ned
/ubx_rxm_cor
/ubx_rxm_rtcm
/ubx_rxm_measx
/ubx_rxm_rawx
/ubx_sec_sig
/ubx_sec_sig_log


</code></pre></div></div>

<p>The following topics are subscribed to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/ubx_esf_meas_to_device
/ntrip_client/rtcm

</code></pre></div></div>

<h1 id="ros2-navsatfix-messages">ROS2 NAVSATFIX Messages</h1>

<p>In addition to the UBX NAV messages shown above, <a href="https://docs.ros2.org/latest/api/sensor_msgs/msg/NavSatFix.html">NavSatFix messages</a> can also be published on topic /fix.</p>

<p>Note that this node relies on (and hence subscribes to) three UBX Nav messages, namely /ubx_nav_hp_pos_llh, /ubx_nav_cov, /ubx_nav_status.</p>

<p>If the ublox device is not configured to publish these three messages, the navsatfix message will likewise not be published.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/fix

</code></pre></div></div>

<h1 id="ntrip-client---rtcm-messages">NTRIP Client - RTCM messages</h1>

<p>A basic NTRIP client is provided, that focuses in binary RTCM data. Its purpose is to acquire the RTCM data from an internet based NTRIP Castor and publish <a href="https://index.ros.org/p/rtcm_msgs/">RTCM Messages</a>.</p>

<p>An example launch file is provided. You will need to set values appropriate for the NTRIP Castor intended to be used</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch ublox_dgnss ntrip_client.launch.py use_https:=true host:=ntrip.data.gnss.ga.gov.au port:=443 mountpoint:=MBCH00AUS0 username:=username password:=password

</code></pre></div></div>
<p>Note the launch file has been configured to also use environment variables <code class="language-plaintext highlighter-rouge">NTRIP_USERNAME</code> &amp; <code class="language-plaintext highlighter-rouge">NTRIP_PASSWORD</code> such that you dont need credentials in the launch scripts.</p>

<h1 id="fixed-base-and-rover">Fixed Base and Rover</h1>

<p>This package supports the use case where a fixed base station is setup to emit RTCM data and a moving rover consumes the emitted RTCM data for improved location accuracy as it moves. The base is setup to perform the survey-in procedure and, once finished, emit RTCM messages.</p>

<p>Example launch files are provided for this use case. Run <code class="language-plaintext highlighter-rouge">ublox_fb+r_base.launch.py</code> for the fixed base and <code class="language-plaintext highlighter-rouge">ublox_fb+r_rover.launch.py</code> for the moving rover.</p>

<h1 id="moving-base-and-rover">Moving Base and Rover</h1>

<p>The ZED-F9P devices support the “moving base and rover” mode of operation, using two devices on a mobile vehicle to provide both position and orientation data.  Further information on this mode, including physical connections between the two devices and the host machine are included in the following ublox application note.</p>

<p>https://www.u-blox.com/sites/default/files/documents/ZED-F9P-MovingBase_AppNote_UBX-19009093.pdf</p>

<p>Note: the ZED-F9R device does not support this mode.</p>

<p>Example launch configuration files are included as “ublox_mb+r_base.launch.py” and “ublox_mb+r_rover.launch.py” for the base and rover devices respectively.  The base and rover are physically connected similar to that described in Section 2.2.1 “Wired connection between base and rover” in the ublox app note, with UART2 used for the wired connection between base and rover.  Both base and rover connect to the host machine via USB.  Device configuration is similar to that described in Section 2.3.2 “5 Hz navigation rate application” in the app note.</p>

<p>Both base and rover will output position data which can be used to publish NavSatFix messages (as described above).  The rover also outputs heading data via UBX-NAV-RELPOSNED messages.  Refer to Section 2.4 “Using the heading output” in the app note for more information.</p>

<p>Note: as this mode required two ZED-F9P devices connected simultaneously, you will need to configure each device with a different serial string and specify these in the launch files.  See description above on device identification parameters.</p>

<h1 id="helpful-tips">Helpful tips</h1>

<h2 id="did-the-f9-device-receive-and-use-the-rtcm-data">Did the F9 device receive and use the RTCM data?</h2>
<p>If you want to see if the UBX device has received and processed the RTCM data run this, after ensuring that CFG_MSGOUT_UBX_RXM_RTCM_USB is set to 1 via <code class="language-plaintext highlighter-rouge">rqt</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 topic echo /ubx_rxm_rtcm

</code></pre></div></div>
<p>If <code class="language-plaintext highlighter-rouge">msg_used</code> shows 2 then the RTCM message has been used by the device.</p>

<p>This <a href="https://www.use-snip.com/kb/knowledge-base/an-rtcm-message-cheat-sheet/">RTCM 3 Message cheat sheet</a> can be used to determine wha the <code class="language-plaintext highlighter-rouge">msg_type</code> field represents eg GPS, GLONASS, Galileo, SBAS, QZSS or BeiDou.</p>

<h2 id="was-a-high-precision-location-calculated">Was a high precision location calculated?</h2>

<p>Ensure CFG_MSGOUT_UBX_NAV_STATUS_USB is set to 1. It is lower priority message but can be used to determine what type of GPS fix and the type of differential error correction that has been supplied.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 topic echo /ubx_nav_status

</code></pre></div></div>

<p>should output a message similar to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>header:
  stamp:
    sec: 1684907069
    nanosec: 214298394
  frame_id: ubx
itow: 279887200
gps_fix:
  fix_type: 3
gps_fix_ok: true
diff_soln: true
wkn_set: true
tow_set: true
diff_corr: true
carr_soln_valid: true
map_matching:
  status: 0
psm:
  state: 0
spoof_det:
  state: 2
carr_soln:
  status: 0
ttff: 709
msss: 3416912

</code></pre></div></div>

<p>If the <code class="language-plaintext highlighter-rouge">gps_fix.fix_type</code> = 3, it means its a 3D fix. The <code class="language-plaintext highlighter-rouge">diff_soln</code> and <code class="language-plaintext highlighter-rouge">diff_corr</code> implies that the differential error correction has occurred.</p>

<h2 id="how-precise-is-my-solution">How precise is my solution?</h2>

<p>After making sure that the deivce is processing RTCM messages and assuming that you have launched the node with <code class="language-plaintext highlighter-rouge">ros2 launch ublox_dgnss ublox_rover_hpposllh.launch.py</code>, run the following the command</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 topic echo /ubx_nav_hp_pos_llh

</code></pre></div></div>
<p>You should see something similiar to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>header:
  stamp:
    sec: 1684907675
    nanosec: 765881914
  frame_id: ubx
version: 0
invalid_lon: false
invalid_lat: false
invalid_height: false
invalid_hmsl: false
invalid_lon_hp: false
invalid_lat_hp: false
invalid_height_hp: false
invalid_hmsl_hp: false
itow: 280493800
lon: 1534256850
lat: -280021154
height: 87232
hmsl: 49963
lon_hp: 31
lat_hp: -7
height_hp: -1
hmsl_hp: 1
h_acc: 169
v_acc: 123

</code></pre></div></div>

<p>The driver output the raw UBX data into the message so some interpreting is required.</p>

<p><code class="language-plaintext highlighter-rouge">h_acc</code> and <code class="language-plaintext highlighter-rouge">v_acc</code> are in millimeters but need to be scaled by 0.1 - <code class="language-plaintext highlighter-rouge">h_acc: 16.9 mm</code> and <code class="language-plaintext highlighter-rouge">v_acc: 12.3 mm</code> per the above. Such that there is centimeter level accuracy.</p>

<p>If in doubt as to what the scaling is, please look at the F9 interface description for an explanation. All debug log output have had scaling applied.</p>

<p>If you would like to calculate the high precision lon, lat and height values use the following code as a guide</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   // Extract the LLH and high-precision components
    double lat = ubx_hppos_llh_msg-&gt;lat * 1e-7 + ubx_hppos_llh_msg-&gt;lat_hp * 1e-9;
    double lon = ubx_hppos_llh_msg-&gt;lon * 1e-7 + ubx_hppos_llh_msg-&gt;lon_hp * 1e-9;
    double alt = ubx_hppos_llh_msg-&gt;height * 1e-3 + ubx_hppos_llh_msg-&gt;height_hp * 1e-4;

</code></pre></div></div>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <em>No CONTRIBUTING.md found.</em>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-kilted">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/ublox_dgnss">ublox_dgnss</a> <small>repository</small></h3>
        <span class="label label-default">gps</span> <span class="label label-default">ublox</span> <span class="label label-default">ubx</span> <span class="label label-default">gps-location</span> <span class="label label-default">gps-data</span> <span class="label label-default">ros2</span> <span class="label label-default">high-precision</span> <span class="label label-default">ntripcaster</span> <span class="label label-default">dgnss</span> <span class="label label-default">ntripclient</span> 
        
        <a class="label label-primary pkg-label" href="/p/ntrip_client_node">ntrip_client_node</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_dgnss">ublox_dgnss</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_dgnss_node">ublox_dgnss_node</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_nav_sat_fix_hp_node">ublox_nav_sat_fix_hp_node</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_ubx_interfaces">ublox_ubx_interfaces</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_ubx_msgs">ublox_ubx_msgs</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-aussierobots-ublox_dgnss
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-aussierobots-ublox_dgnss" role="menuitem" tabindex="-1" href="/r/ublox_dgnss/github-aussierobots-ublox_dgnss" data="github-aussierobots-ublox_dgnss">
                    <span class="glyphicon glyphicon-star"></span>
                    github-aussierobots-ublox_dgnss
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">This usb based ROS2 driver is focused on UBLOX Generation 9 UBX messaging, for a DGNSS rover. High precision data is available.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/aussierobots/ublox_dgnss.git">https://github.com/aussierobots/ublox_dgnss.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">main</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-02-27
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <span class="label label-default">gps</span> <span class="label label-default">ublox</span> <span class="label label-default">ubx</span> <span class="label label-default">gps-location</span> <span class="label label-default">gps-data</span> <span class="label label-default">ros2</span> <span class="label label-default">high-precision</span> <span class="label label-default">ntripcaster</span> <span class="label label-default">dgnss</span> <span class="label label-default">ntripclient</span> 
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/ublox_dgnss/#kilted-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ublox_dgnss/#kilted-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ublox_dgnss/#kilted-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/ntrip_client_node">ntrip_client_node</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_dgnss">ublox_dgnss</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_dgnss_node">ublox_dgnss_node</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_nav_sat_fix_hp_node">ublox_nav_sat_fix_hp_node</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_ubx_interfaces">ublox_ubx_interfaces</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_ubx_msgs">ublox_ubx_msgs</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="ublox-dgnss">ublox-dgnss</h1>

<p>This usb based driver is focused on UBLOX Generation 9 UBX messaging, for a DGNSS rover. High precision data is available. A moving base station configuration has been added. This package also supports a fixed base station and moving rover use case.</p>

<p>RTCM messages can be delivered externally. Alternately the ntrip_client_node can be utilised to retrieve RTCM messages from a castor to publish <code class="language-plaintext highlighter-rouge">/ntrip_client/rtcm</code> messages which will be received by the ublox_dgnss_node.</p>

<p>Work has started on SPARTN support - basic commands are available to enable it on the device and to confirm that the messages are being used (when delivered to the device).</p>

<p>This driver will only work with later generation ublox devices. Testing and development was performed against a ZED-F9P and a ZED-F9R connected via USB, under Ubuntu 22.04/24.04. The driver uses libusb api 1.0.</p>

<p>This release works with Rolling, Jazzy, Iron and Humble.</p>

<p>You may need to create a udev rule as follows:</p>

<p>/etc/udev/rules.d/99-ublox-gnss.rules</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  #UBLOX ZED-F9
  ATTRS{idVendor}=="1546", ATTRS{idProduct}=="01a9", MODE="0666", GROUP="plugdev"

</code></pre></div></div>

<p>This driver follows the UBX standards used for the ZED-F9P/F9R as documented in the <a href="https://content.u-blox.com/sites/default/files/documents/u-blox-F9-HPG-1.32_InterfaceDescription_UBX-22008968.pdf">F9P interface description</a> and <a href="https://content.u-blox.com/sites/default/files/documents/u-blox-F9-HPS-1.30_InterfaceDescription_UBX-22010984.pdf">F9R interface description</a>.</p>

<p>It implements a subset of the specification related to achieving high precision output as a rover. U-center can be used to alter settings. Any configuration parameter changed by this driver, will be applied only in RAM. Upon a restart (hot, cold or warm) or after a hot plug usb attach event, the configuration stored in the driver will be sent to the device.</p>

<h2 id="start-commands">Start commands</h2>

<p>There are multiple ways to start the node. Its been built using composition. An executable is provider. An example follows which turns off NMEA output at startup.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 run ublox_dgnss_node ublox_dgnss_node --ros-args -p CFG_USBOUTPROT_NMEA:=False

</code></pre></div></div>
<p>Parameters can be set at launch and some examples are provided to launch high precision pos ecef|llh</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch ublox_dgnss ublox_rover_hpposecef.launch.py

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch ublox_dgnss ublox_rover_hpposllh.launch.py

</code></pre></div></div>

<h2 id="services">Services</h2>

<p>Four services are provided to reset odo, cold start, warm start and hot start.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/reset_odo ublox_ubx_interfaces/srv/ResetODO

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/cold_start ublox_ubx_interfaces/srv/ColdStart '{reset_type: 1}'

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/warm_start ublox_ubx_interfaces/srv/WarmStart '{reset_type: 1}'

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/hot_start ublox_ubx_interfaces/srv/HotStart '{reset_type: 1}'

</code></pre></div></div>

<h2 id="parameters">Parameters</h2>

<p>Parameter values can be set at any time or passed when the node starts</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 param set /ublox_dgnss CFG_RATE_NAV 2

</code></pre></div></div>
<p>or the current value retrieved</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 param get /ublox_dgnss CFG_RATE_NAV

</code></pre></div></div>
<h3 id="ubx-parameters">UBX Parameters</h3>

<p>The following parameters may be set. Its a subset of the full UBX Gen 9 configuration parameter list.</p>

<p>Values will be as described in the integration manual (without scaling applied). Changing a CFG_MSGOUT_* type parameter to a value &gt;0 will cause the corresponding ublox_ubx_msgs to be published.</p>

<p>CFG_INFMSG_NMEA_USB
  CFG_INFMSG_UBX_USB
  CFG_MSGOUT_UBX_NAV_CLOCK_USB
  CFG_MSGOUT_UBX_NAV_COV_USB
  CFG_MSGOUT_UBX_NAV_DOP_USB
  CFG_MSGOUT_UBX_NAV_EOE_USB
  CFG_MSGOUT_UBX_NAV_HPPOSECEF_USB
  CFG_MSGOUT_UBX_NAV_HPPOSLLH_USB
  CFG_MSGOUT_UBX_NAV_ODO_USB
  CFG_MSGOUT_UBX_NAV_ORB_USB
  CFG_MSGOUT_UBX_NAV_SAT_USB
  CFG_MSGOUT_UBX_NAV_SIG_USB
  CFG_MSGOUT_UBX_NAV_POSECEF_USB
  CFG_MSGOUT_UBX_NAV_POSLLH_USB
  CFG_MSGOUT_UBX_NAV_PVT_USB
  CFG_MSGOUT_UBX_NAV_RELPOSNED_USB
  CFG_MSGOUT_UBX_NAV_STATUS_USB
  CFG_MSGOUT_UBX_NAV_TIMEUTC_USB
  CFG_MSGOUT_UBX_NAV_VELECEF_USB
  CFG_MSGOUT_UBX_NAV_VELNED_USB
  CFG_MSGOUT_UBX_RXM_COR_USB
  CFG_MSGOUT_UBX_RXM_RTCM_USB
  CFG_MSGOUT_UBX_RXM_MEASX_USB
  CFG_MSGOUT_UBX_RXM_RAWX_USB
  CFG_MSGOUT_UBX_RXM_SPARTN_USB
  CFG_MSGOUT_UBX_MON_COMMS_USB
  CFG_MSGOUT_UBX_ESF_MEAS_USB
  CFG_MSGOUT_UBX_ESF_STATUS_USB
  CFG_MSGOUT_UBX_SEC_SIG_USB
  CFG_MSGOUT_UBX_SEC_SIGLOG_USB
  CFG_NAVHPG_DGNSSMODE
  CFG_NAVSPG_DYNMODEL
  CFG_NAVSPG_FIXMODE
  CFG_NAVSPG_INIFIX3D
  CFG_NAVSPG_UTCSTANDARD
  CFG_ODO_COGLPGAIN
  CFG_ODO_COGMAXPOSACC
  CFG_ODO_COGMAXSPEED
  CFG_ODO_OUTLPCOG
  CFG_ODO_OUTLPVEL
  CFG_ODO_PROFILE
  CFG_ODO_USE_COG
  CFG_ODO_USE_ODO
  CFG_ODO_VALLPGAIN
  CFG_RATE_MEAS
  CFG_RATE_NAV
  CFG_RATE_TIMEREF
  CFG_TMODE_MODE
  CFG_TMODE_POS_TYPE
  CFG_UART1INPROT_NMEA
  CFG_UART1INPROT_RTCM3X
  CFG_UART1INPROT_SPARTN
  CFG_UART1INPROT_UBX
  CFG_UART1OUTPROT_NMEA
  CFG_UART1OUTPROT_RTCM3X
  CFG_UART1OUTPROT_UBX
  CFG_UART2INPROT_NMEA
  CFG_UART2INPROT_RTCM3X
  CFG_UART2INPROT_SPARTN
  CFG_UART2INPROT_UBX
  CFG_UART2OUTPROT_NMEA
  CFG_UART2OUTPROT_RTCM3X
  CFG_UART2OUTPROT_UBX
  CFG_USBINPROT_NMEA
  CFG_USBINPROT_RTCM3X
  CFG_USBINPROT_UBX
  CFG_USBOUTPROT_NMEA
  CFG_USBOUTPROT_RTCM3X
  CFG_USBOUTPROT_UBX</p>

<p>CFG_SPARTN_USE_SOURCE</p>

<p>CFG_SFIMU_AUTO_MNTALG_ENA
  CFG_SFIMU_IMU_MNTALG_YAW
  CFG_SFIMU_IMU_MNTALG_PITCH
  CFG_SFIMU_IMU_MNTALG_ROLL</p>

<p>CFG_SFODO_COMBINE_TICKS
  CFG_SFODO_COUNT_MAX
  CFG_SFODO_DIS_AUTOCOUNTMAX
  CFG_SFODO_DIS_AUTODIRPINPOL
  CFG_SFODO_FACTOR
  CFG_SFODO_LATENCY
  CFG_SFODO_QUANT_ERROR</p>

<h3 id="device-identification-parameters">Device Identification Parameters</h3>

<p>aka Use with Multiple Devices</p>

<p>By default, the ublox_dgnss node will search for and connect to the first device which matches the ublox USB ID’s (vendor ID of 0x1546 and product ID of 0x01a9).  If multiple devices are connected simultaneously, the remaining devices will be ignored.  In this situation you have no control over which device is used, since the order in which they are found may depend on the order in which they were physically attached to the host.</p>

<p>If you have multiple ublox devices attached simultaneously and wish to connect to a specific device, you can specify a launch parameter “DEVICE_SERIAL_STRING”.  The node will then search for and connect to the first device with this matching serial string.  The device serial string “CFG-USB-SERIAL_NO_STRx” itself should be programmed into the ublox device beforehand using u-center software.</p>

<p>The frame ID used in ROS2 messages for that device can also be specified using the launch parameter “FRAME_ID”.</p>

<p>Note: these parameters are not written to the device.  They only instruct the node on how to behave.</p>

<h1 id="ros2-ubx-nav-messages">ROS2 UBX NAV Messages</h1>

<p>The following messages may be outputted. They included a <code class="language-plaintext highlighter-rouge">std_msgs/Header header</code> with the remainder of the fields matching the UBX output. Note that field names use different notation as the UBX field name notation is not compliant with the ROS IDL field names.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/ubx_esf_meas

/ubx_esf_status
/ubx_mon_comms
/ubx_nav_clock
/ubx_nav_cov
/ubx_nav_dop
/ubx_nav_eoe
/ubx_nav_hp_pos_ecef
/ubx_nav_hp_pos_llh
/ubx_nav_odo
/ubx_nav_orb
/ubx_nav_sat
/ubx_nav_sig
/ubx_nav_pos_ecef
/ubx_nav_pos_llh
/ubx_nav_pvt
/ubx_nav_rel_pos_ned
/ubx_nav_status
/ubx_nav_time_utc
/ubx_nav_vel_ecef
/ubx_nav_vel_ned
/ubx_rxm_cor
/ubx_rxm_rtcm
/ubx_rxm_measx
/ubx_rxm_rawx
/ubx_sec_sig
/ubx_sec_sig_log


</code></pre></div></div>

<p>The following topics are subscribed to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/ubx_esf_meas_to_device
/ntrip_client/rtcm

</code></pre></div></div>

<h1 id="ros2-navsatfix-messages">ROS2 NAVSATFIX Messages</h1>

<p>In addition to the UBX NAV messages shown above, <a href="https://docs.ros2.org/latest/api/sensor_msgs/msg/NavSatFix.html">NavSatFix messages</a> can also be published on topic /fix.</p>

<p>Note that this node relies on (and hence subscribes to) three UBX Nav messages, namely /ubx_nav_hp_pos_llh, /ubx_nav_cov, /ubx_nav_status.</p>

<p>If the ublox device is not configured to publish these three messages, the navsatfix message will likewise not be published.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/fix

</code></pre></div></div>

<h1 id="ntrip-client---rtcm-messages">NTRIP Client - RTCM messages</h1>

<p>A basic NTRIP client is provided, that focuses in binary RTCM data. Its purpose is to acquire the RTCM data from an internet based NTRIP Castor and publish <a href="https://index.ros.org/p/rtcm_msgs/">RTCM Messages</a>.</p>

<p>An example launch file is provided. You will need to set values appropriate for the NTRIP Castor intended to be used</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch ublox_dgnss ntrip_client.launch.py use_https:=true host:=ntrip.data.gnss.ga.gov.au port:=443 mountpoint:=MBCH00AUS0 username:=username password:=password

</code></pre></div></div>
<p>Note the launch file has been configured to also use environment variables <code class="language-plaintext highlighter-rouge">NTRIP_USERNAME</code> &amp; <code class="language-plaintext highlighter-rouge">NTRIP_PASSWORD</code> such that you dont need credentials in the launch scripts.</p>

<h1 id="fixed-base-and-rover">Fixed Base and Rover</h1>

<p>This package supports the use case where a fixed base station is setup to emit RTCM data and a moving rover consumes the emitted RTCM data for improved location accuracy as it moves. The base is setup to perform the survey-in procedure and, once finished, emit RTCM messages.</p>

<p>Example launch files are provided for this use case. Run <code class="language-plaintext highlighter-rouge">ublox_fb+r_base.launch.py</code> for the fixed base and <code class="language-plaintext highlighter-rouge">ublox_fb+r_rover.launch.py</code> for the moving rover.</p>

<h1 id="moving-base-and-rover">Moving Base and Rover</h1>

<p>The ZED-F9P devices support the “moving base and rover” mode of operation, using two devices on a mobile vehicle to provide both position and orientation data.  Further information on this mode, including physical connections between the two devices and the host machine are included in the following ublox application note.</p>

<p>https://www.u-blox.com/sites/default/files/documents/ZED-F9P-MovingBase_AppNote_UBX-19009093.pdf</p>

<p>Note: the ZED-F9R device does not support this mode.</p>

<p>Example launch configuration files are included as “ublox_mb+r_base.launch.py” and “ublox_mb+r_rover.launch.py” for the base and rover devices respectively.  The base and rover are physically connected similar to that described in Section 2.2.1 “Wired connection between base and rover” in the ublox app note, with UART2 used for the wired connection between base and rover.  Both base and rover connect to the host machine via USB.  Device configuration is similar to that described in Section 2.3.2 “5 Hz navigation rate application” in the app note.</p>

<p>Both base and rover will output position data which can be used to publish NavSatFix messages (as described above).  The rover also outputs heading data via UBX-NAV-RELPOSNED messages.  Refer to Section 2.4 “Using the heading output” in the app note for more information.</p>

<p>Note: as this mode required two ZED-F9P devices connected simultaneously, you will need to configure each device with a different serial string and specify these in the launch files.  See description above on device identification parameters.</p>

<h1 id="helpful-tips">Helpful tips</h1>

<h2 id="did-the-f9-device-receive-and-use-the-rtcm-data">Did the F9 device receive and use the RTCM data?</h2>
<p>If you want to see if the UBX device has received and processed the RTCM data run this, after ensuring that CFG_MSGOUT_UBX_RXM_RTCM_USB is set to 1 via <code class="language-plaintext highlighter-rouge">rqt</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 topic echo /ubx_rxm_rtcm

</code></pre></div></div>
<p>If <code class="language-plaintext highlighter-rouge">msg_used</code> shows 2 then the RTCM message has been used by the device.</p>

<p>This <a href="https://www.use-snip.com/kb/knowledge-base/an-rtcm-message-cheat-sheet/">RTCM 3 Message cheat sheet</a> can be used to determine wha the <code class="language-plaintext highlighter-rouge">msg_type</code> field represents eg GPS, GLONASS, Galileo, SBAS, QZSS or BeiDou.</p>

<h2 id="was-a-high-precision-location-calculated">Was a high precision location calculated?</h2>

<p>Ensure CFG_MSGOUT_UBX_NAV_STATUS_USB is set to 1. It is lower priority message but can be used to determine what type of GPS fix and the type of differential error correction that has been supplied.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 topic echo /ubx_nav_status

</code></pre></div></div>

<p>should output a message similar to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>header:
  stamp:
    sec: 1684907069
    nanosec: 214298394
  frame_id: ubx
itow: 279887200
gps_fix:
  fix_type: 3
gps_fix_ok: true
diff_soln: true
wkn_set: true
tow_set: true
diff_corr: true
carr_soln_valid: true
map_matching:
  status: 0
psm:
  state: 0
spoof_det:
  state: 2
carr_soln:
  status: 0
ttff: 709
msss: 3416912

</code></pre></div></div>

<p>If the <code class="language-plaintext highlighter-rouge">gps_fix.fix_type</code> = 3, it means its a 3D fix. The <code class="language-plaintext highlighter-rouge">diff_soln</code> and <code class="language-plaintext highlighter-rouge">diff_corr</code> implies that the differential error correction has occurred.</p>

<h2 id="how-precise-is-my-solution">How precise is my solution?</h2>

<p>After making sure that the deivce is processing RTCM messages and assuming that you have launched the node with <code class="language-plaintext highlighter-rouge">ros2 launch ublox_dgnss ublox_rover_hpposllh.launch.py</code>, run the following the command</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 topic echo /ubx_nav_hp_pos_llh

</code></pre></div></div>
<p>You should see something similiar to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>header:
  stamp:
    sec: 1684907675
    nanosec: 765881914
  frame_id: ubx
version: 0
invalid_lon: false
invalid_lat: false
invalid_height: false
invalid_hmsl: false
invalid_lon_hp: false
invalid_lat_hp: false
invalid_height_hp: false
invalid_hmsl_hp: false
itow: 280493800
lon: 1534256850
lat: -280021154
height: 87232
hmsl: 49963
lon_hp: 31
lat_hp: -7
height_hp: -1
hmsl_hp: 1
h_acc: 169
v_acc: 123

</code></pre></div></div>

<p>The driver output the raw UBX data into the message so some interpreting is required.</p>

<p><code class="language-plaintext highlighter-rouge">h_acc</code> and <code class="language-plaintext highlighter-rouge">v_acc</code> are in millimeters but need to be scaled by 0.1 - <code class="language-plaintext highlighter-rouge">h_acc: 16.9 mm</code> and <code class="language-plaintext highlighter-rouge">v_acc: 12.3 mm</code> per the above. Such that there is centimeter level accuracy.</p>

<p>If in doubt as to what the scaling is, please look at the F9 interface description for an explanation. All debug log output have had scaling applied.</p>

<p>If you would like to calculate the high precision lon, lat and height values use the following code as a guide</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   // Extract the LLH and high-precision components
    double lat = ubx_hppos_llh_msg-&gt;lat * 1e-7 + ubx_hppos_llh_msg-&gt;lat_hp * 1e-9;
    double lon = ubx_hppos_llh_msg-&gt;lon * 1e-7 + ubx_hppos_llh_msg-&gt;lon_hp * 1e-9;
    double alt = ubx_hppos_llh_msg-&gt;height * 1e-3 + ubx_hppos_llh_msg-&gt;height_hp * 1e-4;

</code></pre></div></div>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <em>No CONTRIBUTING.md found.</em>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-rolling">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/ublox_dgnss">ublox_dgnss</a> <small>repository</small></h3>
        <span class="label label-default">gps</span> <span class="label label-default">ublox</span> <span class="label label-default">ubx</span> <span class="label label-default">gps-location</span> <span class="label label-default">gps-data</span> <span class="label label-default">ros2</span> <span class="label label-default">high-precision</span> <span class="label label-default">ntripcaster</span> <span class="label label-default">dgnss</span> <span class="label label-default">ntripclient</span> 
        
        <a class="label label-primary pkg-label" href="/p/ntrip_client_node">ntrip_client_node</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_dgnss">ublox_dgnss</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_dgnss_node">ublox_dgnss_node</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_nav_sat_fix_hp_node">ublox_nav_sat_fix_hp_node</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_ubx_interfaces">ublox_ubx_interfaces</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_ubx_msgs">ublox_ubx_msgs</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-aussierobots-ublox_dgnss
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-aussierobots-ublox_dgnss" role="menuitem" tabindex="-1" href="/r/ublox_dgnss/github-aussierobots-ublox_dgnss" data="github-aussierobots-ublox_dgnss">
                    <span class="glyphicon glyphicon-star"></span>
                    github-aussierobots-ublox_dgnss
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">This usb based ROS2 driver is focused on UBLOX Generation 9 UBX messaging, for a DGNSS rover. High precision data is available.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/aussierobots/ublox_dgnss.git">https://github.com/aussierobots/ublox_dgnss.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">main</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-02-27
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <span class="label label-default">gps</span> <span class="label label-default">ublox</span> <span class="label label-default">ubx</span> <span class="label label-default">gps-location</span> <span class="label label-default">gps-data</span> <span class="label label-default">ros2</span> <span class="label label-default">high-precision</span> <span class="label label-default">ntripcaster</span> <span class="label label-default">dgnss</span> <span class="label label-default">ntripclient</span> 
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/ublox_dgnss/#rolling-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ublox_dgnss/#rolling-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ublox_dgnss/#rolling-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/ntrip_client_node">ntrip_client_node</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_dgnss">ublox_dgnss</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_dgnss_node">ublox_dgnss_node</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_nav_sat_fix_hp_node">ublox_nav_sat_fix_hp_node</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_ubx_interfaces">ublox_ubx_interfaces</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_ubx_msgs">ublox_ubx_msgs</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="ublox-dgnss">ublox-dgnss</h1>

<p>This usb based driver is focused on UBLOX Generation 9 UBX messaging, for a DGNSS rover. High precision data is available. A moving base station configuration has been added. This package also supports a fixed base station and moving rover use case.</p>

<p>RTCM messages can be delivered externally. Alternately the ntrip_client_node can be utilised to retrieve RTCM messages from a castor to publish <code class="language-plaintext highlighter-rouge">/ntrip_client/rtcm</code> messages which will be received by the ublox_dgnss_node.</p>

<p>Work has started on SPARTN support - basic commands are available to enable it on the device and to confirm that the messages are being used (when delivered to the device).</p>

<p>This driver will only work with later generation ublox devices. Testing and development was performed against a ZED-F9P and a ZED-F9R connected via USB, under Ubuntu 22.04/24.04. The driver uses libusb api 1.0.</p>

<p>This release works with Rolling, Jazzy, Iron and Humble.</p>

<p>You may need to create a udev rule as follows:</p>

<p>/etc/udev/rules.d/99-ublox-gnss.rules</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  #UBLOX ZED-F9
  ATTRS{idVendor}=="1546", ATTRS{idProduct}=="01a9", MODE="0666", GROUP="plugdev"

</code></pre></div></div>

<p>This driver follows the UBX standards used for the ZED-F9P/F9R as documented in the <a href="https://content.u-blox.com/sites/default/files/documents/u-blox-F9-HPG-1.32_InterfaceDescription_UBX-22008968.pdf">F9P interface description</a> and <a href="https://content.u-blox.com/sites/default/files/documents/u-blox-F9-HPS-1.30_InterfaceDescription_UBX-22010984.pdf">F9R interface description</a>.</p>

<p>It implements a subset of the specification related to achieving high precision output as a rover. U-center can be used to alter settings. Any configuration parameter changed by this driver, will be applied only in RAM. Upon a restart (hot, cold or warm) or after a hot plug usb attach event, the configuration stored in the driver will be sent to the device.</p>

<h2 id="start-commands">Start commands</h2>

<p>There are multiple ways to start the node. Its been built using composition. An executable is provider. An example follows which turns off NMEA output at startup.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 run ublox_dgnss_node ublox_dgnss_node --ros-args -p CFG_USBOUTPROT_NMEA:=False

</code></pre></div></div>
<p>Parameters can be set at launch and some examples are provided to launch high precision pos ecef|llh</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch ublox_dgnss ublox_rover_hpposecef.launch.py

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch ublox_dgnss ublox_rover_hpposllh.launch.py

</code></pre></div></div>

<h2 id="services">Services</h2>

<p>Four services are provided to reset odo, cold start, warm start and hot start.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/reset_odo ublox_ubx_interfaces/srv/ResetODO

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/cold_start ublox_ubx_interfaces/srv/ColdStart '{reset_type: 1}'

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/warm_start ublox_ubx_interfaces/srv/WarmStart '{reset_type: 1}'

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/hot_start ublox_ubx_interfaces/srv/HotStart '{reset_type: 1}'

</code></pre></div></div>

<h2 id="parameters">Parameters</h2>

<p>Parameter values can be set at any time or passed when the node starts</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 param set /ublox_dgnss CFG_RATE_NAV 2

</code></pre></div></div>
<p>or the current value retrieved</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 param get /ublox_dgnss CFG_RATE_NAV

</code></pre></div></div>
<h3 id="ubx-parameters">UBX Parameters</h3>

<p>The following parameters may be set. Its a subset of the full UBX Gen 9 configuration parameter list.</p>

<p>Values will be as described in the integration manual (without scaling applied). Changing a CFG_MSGOUT_* type parameter to a value &gt;0 will cause the corresponding ublox_ubx_msgs to be published.</p>

<p>CFG_INFMSG_NMEA_USB
  CFG_INFMSG_UBX_USB
  CFG_MSGOUT_UBX_NAV_CLOCK_USB
  CFG_MSGOUT_UBX_NAV_COV_USB
  CFG_MSGOUT_UBX_NAV_DOP_USB
  CFG_MSGOUT_UBX_NAV_EOE_USB
  CFG_MSGOUT_UBX_NAV_HPPOSECEF_USB
  CFG_MSGOUT_UBX_NAV_HPPOSLLH_USB
  CFG_MSGOUT_UBX_NAV_ODO_USB
  CFG_MSGOUT_UBX_NAV_ORB_USB
  CFG_MSGOUT_UBX_NAV_SAT_USB
  CFG_MSGOUT_UBX_NAV_SIG_USB
  CFG_MSGOUT_UBX_NAV_POSECEF_USB
  CFG_MSGOUT_UBX_NAV_POSLLH_USB
  CFG_MSGOUT_UBX_NAV_PVT_USB
  CFG_MSGOUT_UBX_NAV_RELPOSNED_USB
  CFG_MSGOUT_UBX_NAV_STATUS_USB
  CFG_MSGOUT_UBX_NAV_TIMEUTC_USB
  CFG_MSGOUT_UBX_NAV_VELECEF_USB
  CFG_MSGOUT_UBX_NAV_VELNED_USB
  CFG_MSGOUT_UBX_RXM_COR_USB
  CFG_MSGOUT_UBX_RXM_RTCM_USB
  CFG_MSGOUT_UBX_RXM_MEASX_USB
  CFG_MSGOUT_UBX_RXM_RAWX_USB
  CFG_MSGOUT_UBX_RXM_SPARTN_USB
  CFG_MSGOUT_UBX_MON_COMMS_USB
  CFG_MSGOUT_UBX_ESF_MEAS_USB
  CFG_MSGOUT_UBX_ESF_STATUS_USB
  CFG_MSGOUT_UBX_SEC_SIG_USB
  CFG_MSGOUT_UBX_SEC_SIGLOG_USB
  CFG_NAVHPG_DGNSSMODE
  CFG_NAVSPG_DYNMODEL
  CFG_NAVSPG_FIXMODE
  CFG_NAVSPG_INIFIX3D
  CFG_NAVSPG_UTCSTANDARD
  CFG_ODO_COGLPGAIN
  CFG_ODO_COGMAXPOSACC
  CFG_ODO_COGMAXSPEED
  CFG_ODO_OUTLPCOG
  CFG_ODO_OUTLPVEL
  CFG_ODO_PROFILE
  CFG_ODO_USE_COG
  CFG_ODO_USE_ODO
  CFG_ODO_VALLPGAIN
  CFG_RATE_MEAS
  CFG_RATE_NAV
  CFG_RATE_TIMEREF
  CFG_TMODE_MODE
  CFG_TMODE_POS_TYPE
  CFG_UART1INPROT_NMEA
  CFG_UART1INPROT_RTCM3X
  CFG_UART1INPROT_SPARTN
  CFG_UART1INPROT_UBX
  CFG_UART1OUTPROT_NMEA
  CFG_UART1OUTPROT_RTCM3X
  CFG_UART1OUTPROT_UBX
  CFG_UART2INPROT_NMEA
  CFG_UART2INPROT_RTCM3X
  CFG_UART2INPROT_SPARTN
  CFG_UART2INPROT_UBX
  CFG_UART2OUTPROT_NMEA
  CFG_UART2OUTPROT_RTCM3X
  CFG_UART2OUTPROT_UBX
  CFG_USBINPROT_NMEA
  CFG_USBINPROT_RTCM3X
  CFG_USBINPROT_UBX
  CFG_USBOUTPROT_NMEA
  CFG_USBOUTPROT_RTCM3X
  CFG_USBOUTPROT_UBX</p>

<p>CFG_SPARTN_USE_SOURCE</p>

<p>CFG_SFIMU_AUTO_MNTALG_ENA
  CFG_SFIMU_IMU_MNTALG_YAW
  CFG_SFIMU_IMU_MNTALG_PITCH
  CFG_SFIMU_IMU_MNTALG_ROLL</p>

<p>CFG_SFODO_COMBINE_TICKS
  CFG_SFODO_COUNT_MAX
  CFG_SFODO_DIS_AUTOCOUNTMAX
  CFG_SFODO_DIS_AUTODIRPINPOL
  CFG_SFODO_FACTOR
  CFG_SFODO_LATENCY
  CFG_SFODO_QUANT_ERROR</p>

<h3 id="device-identification-parameters">Device Identification Parameters</h3>

<p>aka Use with Multiple Devices</p>

<p>By default, the ublox_dgnss node will search for and connect to the first device which matches the ublox USB ID’s (vendor ID of 0x1546 and product ID of 0x01a9).  If multiple devices are connected simultaneously, the remaining devices will be ignored.  In this situation you have no control over which device is used, since the order in which they are found may depend on the order in which they were physically attached to the host.</p>

<p>If you have multiple ublox devices attached simultaneously and wish to connect to a specific device, you can specify a launch parameter “DEVICE_SERIAL_STRING”.  The node will then search for and connect to the first device with this matching serial string.  The device serial string “CFG-USB-SERIAL_NO_STRx” itself should be programmed into the ublox device beforehand using u-center software.</p>

<p>The frame ID used in ROS2 messages for that device can also be specified using the launch parameter “FRAME_ID”.</p>

<p>Note: these parameters are not written to the device.  They only instruct the node on how to behave.</p>

<h1 id="ros2-ubx-nav-messages">ROS2 UBX NAV Messages</h1>

<p>The following messages may be outputted. They included a <code class="language-plaintext highlighter-rouge">std_msgs/Header header</code> with the remainder of the fields matching the UBX output. Note that field names use different notation as the UBX field name notation is not compliant with the ROS IDL field names.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/ubx_esf_meas

/ubx_esf_status
/ubx_mon_comms
/ubx_nav_clock
/ubx_nav_cov
/ubx_nav_dop
/ubx_nav_eoe
/ubx_nav_hp_pos_ecef
/ubx_nav_hp_pos_llh
/ubx_nav_odo
/ubx_nav_orb
/ubx_nav_sat
/ubx_nav_sig
/ubx_nav_pos_ecef
/ubx_nav_pos_llh
/ubx_nav_pvt
/ubx_nav_rel_pos_ned
/ubx_nav_status
/ubx_nav_time_utc
/ubx_nav_vel_ecef
/ubx_nav_vel_ned
/ubx_rxm_cor
/ubx_rxm_rtcm
/ubx_rxm_measx
/ubx_rxm_rawx
/ubx_sec_sig
/ubx_sec_sig_log


</code></pre></div></div>

<p>The following topics are subscribed to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/ubx_esf_meas_to_device
/ntrip_client/rtcm

</code></pre></div></div>

<h1 id="ros2-navsatfix-messages">ROS2 NAVSATFIX Messages</h1>

<p>In addition to the UBX NAV messages shown above, <a href="https://docs.ros2.org/latest/api/sensor_msgs/msg/NavSatFix.html">NavSatFix messages</a> can also be published on topic /fix.</p>

<p>Note that this node relies on (and hence subscribes to) three UBX Nav messages, namely /ubx_nav_hp_pos_llh, /ubx_nav_cov, /ubx_nav_status.</p>

<p>If the ublox device is not configured to publish these three messages, the navsatfix message will likewise not be published.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/fix

</code></pre></div></div>

<h1 id="ntrip-client---rtcm-messages">NTRIP Client - RTCM messages</h1>

<p>A basic NTRIP client is provided, that focuses in binary RTCM data. Its purpose is to acquire the RTCM data from an internet based NTRIP Castor and publish <a href="https://index.ros.org/p/rtcm_msgs/">RTCM Messages</a>.</p>

<p>An example launch file is provided. You will need to set values appropriate for the NTRIP Castor intended to be used</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch ublox_dgnss ntrip_client.launch.py use_https:=true host:=ntrip.data.gnss.ga.gov.au port:=443 mountpoint:=MBCH00AUS0 username:=username password:=password

</code></pre></div></div>
<p>Note the launch file has been configured to also use environment variables <code class="language-plaintext highlighter-rouge">NTRIP_USERNAME</code> &amp; <code class="language-plaintext highlighter-rouge">NTRIP_PASSWORD</code> such that you dont need credentials in the launch scripts.</p>

<h1 id="fixed-base-and-rover">Fixed Base and Rover</h1>

<p>This package supports the use case where a fixed base station is setup to emit RTCM data and a moving rover consumes the emitted RTCM data for improved location accuracy as it moves. The base is setup to perform the survey-in procedure and, once finished, emit RTCM messages.</p>

<p>Example launch files are provided for this use case. Run <code class="language-plaintext highlighter-rouge">ublox_fb+r_base.launch.py</code> for the fixed base and <code class="language-plaintext highlighter-rouge">ublox_fb+r_rover.launch.py</code> for the moving rover.</p>

<h1 id="moving-base-and-rover">Moving Base and Rover</h1>

<p>The ZED-F9P devices support the “moving base and rover” mode of operation, using two devices on a mobile vehicle to provide both position and orientation data.  Further information on this mode, including physical connections between the two devices and the host machine are included in the following ublox application note.</p>

<p>https://www.u-blox.com/sites/default/files/documents/ZED-F9P-MovingBase_AppNote_UBX-19009093.pdf</p>

<p>Note: the ZED-F9R device does not support this mode.</p>

<p>Example launch configuration files are included as “ublox_mb+r_base.launch.py” and “ublox_mb+r_rover.launch.py” for the base and rover devices respectively.  The base and rover are physically connected similar to that described in Section 2.2.1 “Wired connection between base and rover” in the ublox app note, with UART2 used for the wired connection between base and rover.  Both base and rover connect to the host machine via USB.  Device configuration is similar to that described in Section 2.3.2 “5 Hz navigation rate application” in the app note.</p>

<p>Both base and rover will output position data which can be used to publish NavSatFix messages (as described above).  The rover also outputs heading data via UBX-NAV-RELPOSNED messages.  Refer to Section 2.4 “Using the heading output” in the app note for more information.</p>

<p>Note: as this mode required two ZED-F9P devices connected simultaneously, you will need to configure each device with a different serial string and specify these in the launch files.  See description above on device identification parameters.</p>

<h1 id="helpful-tips">Helpful tips</h1>

<h2 id="did-the-f9-device-receive-and-use-the-rtcm-data">Did the F9 device receive and use the RTCM data?</h2>
<p>If you want to see if the UBX device has received and processed the RTCM data run this, after ensuring that CFG_MSGOUT_UBX_RXM_RTCM_USB is set to 1 via <code class="language-plaintext highlighter-rouge">rqt</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 topic echo /ubx_rxm_rtcm

</code></pre></div></div>
<p>If <code class="language-plaintext highlighter-rouge">msg_used</code> shows 2 then the RTCM message has been used by the device.</p>

<p>This <a href="https://www.use-snip.com/kb/knowledge-base/an-rtcm-message-cheat-sheet/">RTCM 3 Message cheat sheet</a> can be used to determine wha the <code class="language-plaintext highlighter-rouge">msg_type</code> field represents eg GPS, GLONASS, Galileo, SBAS, QZSS or BeiDou.</p>

<h2 id="was-a-high-precision-location-calculated">Was a high precision location calculated?</h2>

<p>Ensure CFG_MSGOUT_UBX_NAV_STATUS_USB is set to 1. It is lower priority message but can be used to determine what type of GPS fix and the type of differential error correction that has been supplied.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 topic echo /ubx_nav_status

</code></pre></div></div>

<p>should output a message similar to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>header:
  stamp:
    sec: 1684907069
    nanosec: 214298394
  frame_id: ubx
itow: 279887200
gps_fix:
  fix_type: 3
gps_fix_ok: true
diff_soln: true
wkn_set: true
tow_set: true
diff_corr: true
carr_soln_valid: true
map_matching:
  status: 0
psm:
  state: 0
spoof_det:
  state: 2
carr_soln:
  status: 0
ttff: 709
msss: 3416912

</code></pre></div></div>

<p>If the <code class="language-plaintext highlighter-rouge">gps_fix.fix_type</code> = 3, it means its a 3D fix. The <code class="language-plaintext highlighter-rouge">diff_soln</code> and <code class="language-plaintext highlighter-rouge">diff_corr</code> implies that the differential error correction has occurred.</p>

<h2 id="how-precise-is-my-solution">How precise is my solution?</h2>

<p>After making sure that the deivce is processing RTCM messages and assuming that you have launched the node with <code class="language-plaintext highlighter-rouge">ros2 launch ublox_dgnss ublox_rover_hpposllh.launch.py</code>, run the following the command</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 topic echo /ubx_nav_hp_pos_llh

</code></pre></div></div>
<p>You should see something similiar to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>header:
  stamp:
    sec: 1684907675
    nanosec: 765881914
  frame_id: ubx
version: 0
invalid_lon: false
invalid_lat: false
invalid_height: false
invalid_hmsl: false
invalid_lon_hp: false
invalid_lat_hp: false
invalid_height_hp: false
invalid_hmsl_hp: false
itow: 280493800
lon: 1534256850
lat: -280021154
height: 87232
hmsl: 49963
lon_hp: 31
lat_hp: -7
height_hp: -1
hmsl_hp: 1
h_acc: 169
v_acc: 123

</code></pre></div></div>

<p>The driver output the raw UBX data into the message so some interpreting is required.</p>

<p><code class="language-plaintext highlighter-rouge">h_acc</code> and <code class="language-plaintext highlighter-rouge">v_acc</code> are in millimeters but need to be scaled by 0.1 - <code class="language-plaintext highlighter-rouge">h_acc: 16.9 mm</code> and <code class="language-plaintext highlighter-rouge">v_acc: 12.3 mm</code> per the above. Such that there is centimeter level accuracy.</p>

<p>If in doubt as to what the scaling is, please look at the F9 interface description for an explanation. All debug log output have had scaling applied.</p>

<p>If you would like to calculate the high precision lon, lat and height values use the following code as a guide</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   // Extract the LLH and high-precision components
    double lat = ubx_hppos_llh_msg-&gt;lat * 1e-7 + ubx_hppos_llh_msg-&gt;lat_hp * 1e-9;
    double lon = ubx_hppos_llh_msg-&gt;lon * 1e-7 + ubx_hppos_llh_msg-&gt;lon_hp * 1e-9;
    double alt = ubx_hppos_llh_msg-&gt;height * 1e-3 + ubx_hppos_llh_msg-&gt;height_hp * 1e-4;

</code></pre></div></div>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <em>No CONTRIBUTING.md found.</em>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-github">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/ublox_dgnss">ublox_dgnss</a> <small>repository</small></h3>
        <span class="label label-default">gps</span> <span class="label label-default">ublox</span> <span class="label label-default">ubx</span> <span class="label label-default">gps-location</span> <span class="label label-default">gps-data</span> <span class="label label-default">ros2</span> <span class="label label-default">high-precision</span> <span class="label label-default">ntripcaster</span> <span class="label label-default">dgnss</span> <span class="label label-default">ntripclient</span> 
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-aussierobots-ublox_dgnss
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-aussierobots-ublox_dgnss" role="menuitem" tabindex="-1" href="/r/ublox_dgnss/github-aussierobots-ublox_dgnss" data="github-aussierobots-ublox_dgnss">
                    <span class="glyphicon glyphicon-star"></span>
                    github-aussierobots-ublox_dgnss
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>github</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-noetic">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/ublox_dgnss">ublox_dgnss</a> <small>repository</small></h3>
        <span class="label label-default">gps</span> <span class="label label-default">ublox</span> <span class="label label-default">ubx</span> <span class="label label-default">gps-location</span> <span class="label label-default">gps-data</span> <span class="label label-default">ros2</span> <span class="label label-default">high-precision</span> <span class="label label-default">ntripcaster</span> <span class="label label-default">dgnss</span> <span class="label label-default">ntripclient</span> 
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-aussierobots-ublox_dgnss
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-aussierobots-ublox_dgnss" role="menuitem" tabindex="-1" href="/r/ublox_dgnss/github-aussierobots-ublox_dgnss" data="github-aussierobots-ublox_dgnss">
                    <span class="glyphicon glyphicon-star"></span>
                    github-aussierobots-ublox_dgnss
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>noetic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-galactic">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/ublox_dgnss">ublox_dgnss</a> <small>repository</small></h3>
        <span class="label label-default">gps</span> <span class="label label-default">ublox</span> <span class="label label-default">ubx</span> <span class="label label-default">gps-location</span> <span class="label label-default">gps-data</span> <span class="label label-default">ros2</span> <span class="label label-default">high-precision</span> <span class="label label-default">ntripcaster</span> <span class="label label-default">dgnss</span> <span class="label label-default">ntripclient</span> 
        
        <a class="label label-primary pkg-label" href="/p/ntrip_client_node">ntrip_client_node</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_dgnss">ublox_dgnss</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_dgnss_node">ublox_dgnss_node</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_nav_sat_fix_hp_node">ublox_nav_sat_fix_hp_node</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_ubx_interfaces">ublox_ubx_interfaces</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_ubx_msgs">ublox_ubx_msgs</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-aussierobots-ublox_dgnss
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-aussierobots-ublox_dgnss" role="menuitem" tabindex="-1" href="/r/ublox_dgnss/github-aussierobots-ublox_dgnss" data="github-aussierobots-ublox_dgnss">
                    <span class="glyphicon glyphicon-star"></span>
                    github-aussierobots-ublox_dgnss
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">This usb based ROS2 driver is focused on UBLOX Generation 9 UBX messaging, for a DGNSS rover. High precision data is available.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/aussierobots/ublox_dgnss.git">https://github.com/aussierobots/ublox_dgnss.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">main</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-02-27
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <span class="label label-default">gps</span> <span class="label label-default">ublox</span> <span class="label label-default">ubx</span> <span class="label label-default">gps-location</span> <span class="label label-default">gps-data</span> <span class="label label-default">ros2</span> <span class="label label-default">high-precision</span> <span class="label label-default">ntripcaster</span> <span class="label label-default">dgnss</span> <span class="label label-default">ntripclient</span> 
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/ublox_dgnss/#galactic-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ublox_dgnss/#galactic-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ublox_dgnss/#galactic-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/ntrip_client_node">ntrip_client_node</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_dgnss">ublox_dgnss</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_dgnss_node">ublox_dgnss_node</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_nav_sat_fix_hp_node">ublox_nav_sat_fix_hp_node</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_ubx_interfaces">ublox_ubx_interfaces</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_ubx_msgs">ublox_ubx_msgs</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="ublox-dgnss">ublox-dgnss</h1>

<p>This usb based driver is focused on UBLOX Generation 9 UBX messaging, for a DGNSS rover. High precision data is available. A moving base station configuration has been added. This package also supports a fixed base station and moving rover use case.</p>

<p>RTCM messages can be delivered externally. Alternately the ntrip_client_node can be utilised to retrieve RTCM messages from a castor to publish <code class="language-plaintext highlighter-rouge">/ntrip_client/rtcm</code> messages which will be received by the ublox_dgnss_node.</p>

<p>Work has started on SPARTN support - basic commands are available to enable it on the device and to confirm that the messages are being used (when delivered to the device).</p>

<p>This driver will only work with later generation ublox devices. Testing and development was performed against a ZED-F9P and a ZED-F9R connected via USB, under Ubuntu 22.04/24.04. The driver uses libusb api 1.0.</p>

<p>This release works with Rolling, Jazzy, Iron and Humble.</p>

<p>You may need to create a udev rule as follows:</p>

<p>/etc/udev/rules.d/99-ublox-gnss.rules</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  #UBLOX ZED-F9
  ATTRS{idVendor}=="1546", ATTRS{idProduct}=="01a9", MODE="0666", GROUP="plugdev"

</code></pre></div></div>

<p>This driver follows the UBX standards used for the ZED-F9P/F9R as documented in the <a href="https://content.u-blox.com/sites/default/files/documents/u-blox-F9-HPG-1.32_InterfaceDescription_UBX-22008968.pdf">F9P interface description</a> and <a href="https://content.u-blox.com/sites/default/files/documents/u-blox-F9-HPS-1.30_InterfaceDescription_UBX-22010984.pdf">F9R interface description</a>.</p>

<p>It implements a subset of the specification related to achieving high precision output as a rover. U-center can be used to alter settings. Any configuration parameter changed by this driver, will be applied only in RAM. Upon a restart (hot, cold or warm) or after a hot plug usb attach event, the configuration stored in the driver will be sent to the device.</p>

<h2 id="start-commands">Start commands</h2>

<p>There are multiple ways to start the node. Its been built using composition. An executable is provider. An example follows which turns off NMEA output at startup.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 run ublox_dgnss_node ublox_dgnss_node --ros-args -p CFG_USBOUTPROT_NMEA:=False

</code></pre></div></div>
<p>Parameters can be set at launch and some examples are provided to launch high precision pos ecef|llh</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch ublox_dgnss ublox_rover_hpposecef.launch.py

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch ublox_dgnss ublox_rover_hpposllh.launch.py

</code></pre></div></div>

<h2 id="services">Services</h2>

<p>Four services are provided to reset odo, cold start, warm start and hot start.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/reset_odo ublox_ubx_interfaces/srv/ResetODO

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/cold_start ublox_ubx_interfaces/srv/ColdStart '{reset_type: 1}'

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/warm_start ublox_ubx_interfaces/srv/WarmStart '{reset_type: 1}'

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/hot_start ublox_ubx_interfaces/srv/HotStart '{reset_type: 1}'

</code></pre></div></div>

<h2 id="parameters">Parameters</h2>

<p>Parameter values can be set at any time or passed when the node starts</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 param set /ublox_dgnss CFG_RATE_NAV 2

</code></pre></div></div>
<p>or the current value retrieved</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 param get /ublox_dgnss CFG_RATE_NAV

</code></pre></div></div>
<h3 id="ubx-parameters">UBX Parameters</h3>

<p>The following parameters may be set. Its a subset of the full UBX Gen 9 configuration parameter list.</p>

<p>Values will be as described in the integration manual (without scaling applied). Changing a CFG_MSGOUT_* type parameter to a value &gt;0 will cause the corresponding ublox_ubx_msgs to be published.</p>

<p>CFG_INFMSG_NMEA_USB
  CFG_INFMSG_UBX_USB
  CFG_MSGOUT_UBX_NAV_CLOCK_USB
  CFG_MSGOUT_UBX_NAV_COV_USB
  CFG_MSGOUT_UBX_NAV_DOP_USB
  CFG_MSGOUT_UBX_NAV_EOE_USB
  CFG_MSGOUT_UBX_NAV_HPPOSECEF_USB
  CFG_MSGOUT_UBX_NAV_HPPOSLLH_USB
  CFG_MSGOUT_UBX_NAV_ODO_USB
  CFG_MSGOUT_UBX_NAV_ORB_USB
  CFG_MSGOUT_UBX_NAV_SAT_USB
  CFG_MSGOUT_UBX_NAV_SIG_USB
  CFG_MSGOUT_UBX_NAV_POSECEF_USB
  CFG_MSGOUT_UBX_NAV_POSLLH_USB
  CFG_MSGOUT_UBX_NAV_PVT_USB
  CFG_MSGOUT_UBX_NAV_RELPOSNED_USB
  CFG_MSGOUT_UBX_NAV_STATUS_USB
  CFG_MSGOUT_UBX_NAV_TIMEUTC_USB
  CFG_MSGOUT_UBX_NAV_VELECEF_USB
  CFG_MSGOUT_UBX_NAV_VELNED_USB
  CFG_MSGOUT_UBX_RXM_COR_USB
  CFG_MSGOUT_UBX_RXM_RTCM_USB
  CFG_MSGOUT_UBX_RXM_MEASX_USB
  CFG_MSGOUT_UBX_RXM_RAWX_USB
  CFG_MSGOUT_UBX_RXM_SPARTN_USB
  CFG_MSGOUT_UBX_MON_COMMS_USB
  CFG_MSGOUT_UBX_ESF_MEAS_USB
  CFG_MSGOUT_UBX_ESF_STATUS_USB
  CFG_MSGOUT_UBX_SEC_SIG_USB
  CFG_MSGOUT_UBX_SEC_SIGLOG_USB
  CFG_NAVHPG_DGNSSMODE
  CFG_NAVSPG_DYNMODEL
  CFG_NAVSPG_FIXMODE
  CFG_NAVSPG_INIFIX3D
  CFG_NAVSPG_UTCSTANDARD
  CFG_ODO_COGLPGAIN
  CFG_ODO_COGMAXPOSACC
  CFG_ODO_COGMAXSPEED
  CFG_ODO_OUTLPCOG
  CFG_ODO_OUTLPVEL
  CFG_ODO_PROFILE
  CFG_ODO_USE_COG
  CFG_ODO_USE_ODO
  CFG_ODO_VALLPGAIN
  CFG_RATE_MEAS
  CFG_RATE_NAV
  CFG_RATE_TIMEREF
  CFG_TMODE_MODE
  CFG_TMODE_POS_TYPE
  CFG_UART1INPROT_NMEA
  CFG_UART1INPROT_RTCM3X
  CFG_UART1INPROT_SPARTN
  CFG_UART1INPROT_UBX
  CFG_UART1OUTPROT_NMEA
  CFG_UART1OUTPROT_RTCM3X
  CFG_UART1OUTPROT_UBX
  CFG_UART2INPROT_NMEA
  CFG_UART2INPROT_RTCM3X
  CFG_UART2INPROT_SPARTN
  CFG_UART2INPROT_UBX
  CFG_UART2OUTPROT_NMEA
  CFG_UART2OUTPROT_RTCM3X
  CFG_UART2OUTPROT_UBX
  CFG_USBINPROT_NMEA
  CFG_USBINPROT_RTCM3X
  CFG_USBINPROT_UBX
  CFG_USBOUTPROT_NMEA
  CFG_USBOUTPROT_RTCM3X
  CFG_USBOUTPROT_UBX</p>

<p>CFG_SPARTN_USE_SOURCE</p>

<p>CFG_SFIMU_AUTO_MNTALG_ENA
  CFG_SFIMU_IMU_MNTALG_YAW
  CFG_SFIMU_IMU_MNTALG_PITCH
  CFG_SFIMU_IMU_MNTALG_ROLL</p>

<p>CFG_SFODO_COMBINE_TICKS
  CFG_SFODO_COUNT_MAX
  CFG_SFODO_DIS_AUTOCOUNTMAX
  CFG_SFODO_DIS_AUTODIRPINPOL
  CFG_SFODO_FACTOR
  CFG_SFODO_LATENCY
  CFG_SFODO_QUANT_ERROR</p>

<h3 id="device-identification-parameters">Device Identification Parameters</h3>

<p>aka Use with Multiple Devices</p>

<p>By default, the ublox_dgnss node will search for and connect to the first device which matches the ublox USB ID’s (vendor ID of 0x1546 and product ID of 0x01a9).  If multiple devices are connected simultaneously, the remaining devices will be ignored.  In this situation you have no control over which device is used, since the order in which they are found may depend on the order in which they were physically attached to the host.</p>

<p>If you have multiple ublox devices attached simultaneously and wish to connect to a specific device, you can specify a launch parameter “DEVICE_SERIAL_STRING”.  The node will then search for and connect to the first device with this matching serial string.  The device serial string “CFG-USB-SERIAL_NO_STRx” itself should be programmed into the ublox device beforehand using u-center software.</p>

<p>The frame ID used in ROS2 messages for that device can also be specified using the launch parameter “FRAME_ID”.</p>

<p>Note: these parameters are not written to the device.  They only instruct the node on how to behave.</p>

<h1 id="ros2-ubx-nav-messages">ROS2 UBX NAV Messages</h1>

<p>The following messages may be outputted. They included a <code class="language-plaintext highlighter-rouge">std_msgs/Header header</code> with the remainder of the fields matching the UBX output. Note that field names use different notation as the UBX field name notation is not compliant with the ROS IDL field names.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/ubx_esf_meas

/ubx_esf_status
/ubx_mon_comms
/ubx_nav_clock
/ubx_nav_cov
/ubx_nav_dop
/ubx_nav_eoe
/ubx_nav_hp_pos_ecef
/ubx_nav_hp_pos_llh
/ubx_nav_odo
/ubx_nav_orb
/ubx_nav_sat
/ubx_nav_sig
/ubx_nav_pos_ecef
/ubx_nav_pos_llh
/ubx_nav_pvt
/ubx_nav_rel_pos_ned
/ubx_nav_status
/ubx_nav_time_utc
/ubx_nav_vel_ecef
/ubx_nav_vel_ned
/ubx_rxm_cor
/ubx_rxm_rtcm
/ubx_rxm_measx
/ubx_rxm_rawx
/ubx_sec_sig
/ubx_sec_sig_log


</code></pre></div></div>

<p>The following topics are subscribed to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/ubx_esf_meas_to_device
/ntrip_client/rtcm

</code></pre></div></div>

<h1 id="ros2-navsatfix-messages">ROS2 NAVSATFIX Messages</h1>

<p>In addition to the UBX NAV messages shown above, <a href="https://docs.ros2.org/latest/api/sensor_msgs/msg/NavSatFix.html">NavSatFix messages</a> can also be published on topic /fix.</p>

<p>Note that this node relies on (and hence subscribes to) three UBX Nav messages, namely /ubx_nav_hp_pos_llh, /ubx_nav_cov, /ubx_nav_status.</p>

<p>If the ublox device is not configured to publish these three messages, the navsatfix message will likewise not be published.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/fix

</code></pre></div></div>

<h1 id="ntrip-client---rtcm-messages">NTRIP Client - RTCM messages</h1>

<p>A basic NTRIP client is provided, that focuses in binary RTCM data. Its purpose is to acquire the RTCM data from an internet based NTRIP Castor and publish <a href="https://index.ros.org/p/rtcm_msgs/">RTCM Messages</a>.</p>

<p>An example launch file is provided. You will need to set values appropriate for the NTRIP Castor intended to be used</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch ublox_dgnss ntrip_client.launch.py use_https:=true host:=ntrip.data.gnss.ga.gov.au port:=443 mountpoint:=MBCH00AUS0 username:=username password:=password

</code></pre></div></div>
<p>Note the launch file has been configured to also use environment variables <code class="language-plaintext highlighter-rouge">NTRIP_USERNAME</code> &amp; <code class="language-plaintext highlighter-rouge">NTRIP_PASSWORD</code> such that you dont need credentials in the launch scripts.</p>

<h1 id="fixed-base-and-rover">Fixed Base and Rover</h1>

<p>This package supports the use case where a fixed base station is setup to emit RTCM data and a moving rover consumes the emitted RTCM data for improved location accuracy as it moves. The base is setup to perform the survey-in procedure and, once finished, emit RTCM messages.</p>

<p>Example launch files are provided for this use case. Run <code class="language-plaintext highlighter-rouge">ublox_fb+r_base.launch.py</code> for the fixed base and <code class="language-plaintext highlighter-rouge">ublox_fb+r_rover.launch.py</code> for the moving rover.</p>

<h1 id="moving-base-and-rover">Moving Base and Rover</h1>

<p>The ZED-F9P devices support the “moving base and rover” mode of operation, using two devices on a mobile vehicle to provide both position and orientation data.  Further information on this mode, including physical connections between the two devices and the host machine are included in the following ublox application note.</p>

<p>https://www.u-blox.com/sites/default/files/documents/ZED-F9P-MovingBase_AppNote_UBX-19009093.pdf</p>

<p>Note: the ZED-F9R device does not support this mode.</p>

<p>Example launch configuration files are included as “ublox_mb+r_base.launch.py” and “ublox_mb+r_rover.launch.py” for the base and rover devices respectively.  The base and rover are physically connected similar to that described in Section 2.2.1 “Wired connection between base and rover” in the ublox app note, with UART2 used for the wired connection between base and rover.  Both base and rover connect to the host machine via USB.  Device configuration is similar to that described in Section 2.3.2 “5 Hz navigation rate application” in the app note.</p>

<p>Both base and rover will output position data which can be used to publish NavSatFix messages (as described above).  The rover also outputs heading data via UBX-NAV-RELPOSNED messages.  Refer to Section 2.4 “Using the heading output” in the app note for more information.</p>

<p>Note: as this mode required two ZED-F9P devices connected simultaneously, you will need to configure each device with a different serial string and specify these in the launch files.  See description above on device identification parameters.</p>

<h1 id="helpful-tips">Helpful tips</h1>

<h2 id="did-the-f9-device-receive-and-use-the-rtcm-data">Did the F9 device receive and use the RTCM data?</h2>
<p>If you want to see if the UBX device has received and processed the RTCM data run this, after ensuring that CFG_MSGOUT_UBX_RXM_RTCM_USB is set to 1 via <code class="language-plaintext highlighter-rouge">rqt</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 topic echo /ubx_rxm_rtcm

</code></pre></div></div>
<p>If <code class="language-plaintext highlighter-rouge">msg_used</code> shows 2 then the RTCM message has been used by the device.</p>

<p>This <a href="https://www.use-snip.com/kb/knowledge-base/an-rtcm-message-cheat-sheet/">RTCM 3 Message cheat sheet</a> can be used to determine wha the <code class="language-plaintext highlighter-rouge">msg_type</code> field represents eg GPS, GLONASS, Galileo, SBAS, QZSS or BeiDou.</p>

<h2 id="was-a-high-precision-location-calculated">Was a high precision location calculated?</h2>

<p>Ensure CFG_MSGOUT_UBX_NAV_STATUS_USB is set to 1. It is lower priority message but can be used to determine what type of GPS fix and the type of differential error correction that has been supplied.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 topic echo /ubx_nav_status

</code></pre></div></div>

<p>should output a message similar to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>header:
  stamp:
    sec: 1684907069
    nanosec: 214298394
  frame_id: ubx
itow: 279887200
gps_fix:
  fix_type: 3
gps_fix_ok: true
diff_soln: true
wkn_set: true
tow_set: true
diff_corr: true
carr_soln_valid: true
map_matching:
  status: 0
psm:
  state: 0
spoof_det:
  state: 2
carr_soln:
  status: 0
ttff: 709
msss: 3416912

</code></pre></div></div>

<p>If the <code class="language-plaintext highlighter-rouge">gps_fix.fix_type</code> = 3, it means its a 3D fix. The <code class="language-plaintext highlighter-rouge">diff_soln</code> and <code class="language-plaintext highlighter-rouge">diff_corr</code> implies that the differential error correction has occurred.</p>

<h2 id="how-precise-is-my-solution">How precise is my solution?</h2>

<p>After making sure that the deivce is processing RTCM messages and assuming that you have launched the node with <code class="language-plaintext highlighter-rouge">ros2 launch ublox_dgnss ublox_rover_hpposllh.launch.py</code>, run the following the command</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 topic echo /ubx_nav_hp_pos_llh

</code></pre></div></div>
<p>You should see something similiar to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>header:
  stamp:
    sec: 1684907675
    nanosec: 765881914
  frame_id: ubx
version: 0
invalid_lon: false
invalid_lat: false
invalid_height: false
invalid_hmsl: false
invalid_lon_hp: false
invalid_lat_hp: false
invalid_height_hp: false
invalid_hmsl_hp: false
itow: 280493800
lon: 1534256850
lat: -280021154
height: 87232
hmsl: 49963
lon_hp: 31
lat_hp: -7
height_hp: -1
hmsl_hp: 1
h_acc: 169
v_acc: 123

</code></pre></div></div>

<p>The driver output the raw UBX data into the message so some interpreting is required.</p>

<p><code class="language-plaintext highlighter-rouge">h_acc</code> and <code class="language-plaintext highlighter-rouge">v_acc</code> are in millimeters but need to be scaled by 0.1 - <code class="language-plaintext highlighter-rouge">h_acc: 16.9 mm</code> and <code class="language-plaintext highlighter-rouge">v_acc: 12.3 mm</code> per the above. Such that there is centimeter level accuracy.</p>

<p>If in doubt as to what the scaling is, please look at the F9 interface description for an explanation. All debug log output have had scaling applied.</p>

<p>If you would like to calculate the high precision lon, lat and height values use the following code as a guide</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   // Extract the LLH and high-precision components
    double lat = ubx_hppos_llh_msg-&gt;lat * 1e-7 + ubx_hppos_llh_msg-&gt;lat_hp * 1e-9;
    double lon = ubx_hppos_llh_msg-&gt;lon * 1e-7 + ubx_hppos_llh_msg-&gt;lon_hp * 1e-9;
    double alt = ubx_hppos_llh_msg-&gt;height * 1e-3 + ubx_hppos_llh_msg-&gt;height_hp * 1e-4;

</code></pre></div></div>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <em>No CONTRIBUTING.md found.</em>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-iron">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/ublox_dgnss">ublox_dgnss</a> <small>repository</small></h3>
        <span class="label label-default">gps</span> <span class="label label-default">ublox</span> <span class="label label-default">ubx</span> <span class="label label-default">gps-location</span> <span class="label label-default">gps-data</span> <span class="label label-default">ros2</span> <span class="label label-default">high-precision</span> <span class="label label-default">ntripcaster</span> <span class="label label-default">dgnss</span> <span class="label label-default">ntripclient</span> 
        
        <a class="label label-primary pkg-label" href="/p/ntrip_client_node">ntrip_client_node</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_dgnss">ublox_dgnss</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_dgnss_node">ublox_dgnss_node</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_nav_sat_fix_hp_node">ublox_nav_sat_fix_hp_node</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_ubx_interfaces">ublox_ubx_interfaces</a>
        
        <a class="label label-primary pkg-label" href="/p/ublox_ubx_msgs">ublox_ubx_msgs</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-aussierobots-ublox_dgnss
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-aussierobots-ublox_dgnss" role="menuitem" tabindex="-1" href="/r/ublox_dgnss/github-aussierobots-ublox_dgnss" data="github-aussierobots-ublox_dgnss">
                    <span class="glyphicon glyphicon-star"></span>
                    github-aussierobots-ublox_dgnss
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">This usb based ROS2 driver is focused on UBLOX Generation 9 UBX messaging, for a DGNSS rover. High precision data is available.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/aussierobots/ublox_dgnss.git">https://github.com/aussierobots/ublox_dgnss.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">main</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-02-27
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <span class="label label-default">gps</span> <span class="label label-default">ublox</span> <span class="label label-default">ubx</span> <span class="label label-default">gps-location</span> <span class="label label-default">gps-data</span> <span class="label label-default">ros2</span> <span class="label label-default">high-precision</span> <span class="label label-default">ntripcaster</span> <span class="label label-default">dgnss</span> <span class="label label-default">ntripclient</span> 
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/ublox_dgnss/#iron-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ublox_dgnss/#iron-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ublox_dgnss/#iron-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/ntrip_client_node">ntrip_client_node</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_dgnss">ublox_dgnss</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_dgnss_node">ublox_dgnss_node</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_nav_sat_fix_hp_node">ublox_nav_sat_fix_hp_node</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_ubx_interfaces">ublox_ubx_interfaces</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/ublox_ubx_msgs">ublox_ubx_msgs</a></td>
                    <td>0.5.5</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="ublox-dgnss">ublox-dgnss</h1>

<p>This usb based driver is focused on UBLOX Generation 9 UBX messaging, for a DGNSS rover. High precision data is available. A moving base station configuration has been added. This package also supports a fixed base station and moving rover use case.</p>

<p>RTCM messages can be delivered externally. Alternately the ntrip_client_node can be utilised to retrieve RTCM messages from a castor to publish <code class="language-plaintext highlighter-rouge">/ntrip_client/rtcm</code> messages which will be received by the ublox_dgnss_node.</p>

<p>Work has started on SPARTN support - basic commands are available to enable it on the device and to confirm that the messages are being used (when delivered to the device).</p>

<p>This driver will only work with later generation ublox devices. Testing and development was performed against a ZED-F9P and a ZED-F9R connected via USB, under Ubuntu 22.04/24.04. The driver uses libusb api 1.0.</p>

<p>This release works with Rolling, Jazzy, Iron and Humble.</p>

<p>You may need to create a udev rule as follows:</p>

<p>/etc/udev/rules.d/99-ublox-gnss.rules</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  #UBLOX ZED-F9
  ATTRS{idVendor}=="1546", ATTRS{idProduct}=="01a9", MODE="0666", GROUP="plugdev"

</code></pre></div></div>

<p>This driver follows the UBX standards used for the ZED-F9P/F9R as documented in the <a href="https://content.u-blox.com/sites/default/files/documents/u-blox-F9-HPG-1.32_InterfaceDescription_UBX-22008968.pdf">F9P interface description</a> and <a href="https://content.u-blox.com/sites/default/files/documents/u-blox-F9-HPS-1.30_InterfaceDescription_UBX-22010984.pdf">F9R interface description</a>.</p>

<p>It implements a subset of the specification related to achieving high precision output as a rover. U-center can be used to alter settings. Any configuration parameter changed by this driver, will be applied only in RAM. Upon a restart (hot, cold or warm) or after a hot plug usb attach event, the configuration stored in the driver will be sent to the device.</p>

<h2 id="start-commands">Start commands</h2>

<p>There are multiple ways to start the node. Its been built using composition. An executable is provider. An example follows which turns off NMEA output at startup.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 run ublox_dgnss_node ublox_dgnss_node --ros-args -p CFG_USBOUTPROT_NMEA:=False

</code></pre></div></div>
<p>Parameters can be set at launch and some examples are provided to launch high precision pos ecef|llh</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch ublox_dgnss ublox_rover_hpposecef.launch.py

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch ublox_dgnss ublox_rover_hpposllh.launch.py

</code></pre></div></div>

<h2 id="services">Services</h2>

<p>Four services are provided to reset odo, cold start, warm start and hot start.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/reset_odo ublox_ubx_interfaces/srv/ResetODO

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/cold_start ublox_ubx_interfaces/srv/ColdStart '{reset_type: 1}'

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/warm_start ublox_ubx_interfaces/srv/WarmStart '{reset_type: 1}'

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 service call /ublox_dgnss/hot_start ublox_ubx_interfaces/srv/HotStart '{reset_type: 1}'

</code></pre></div></div>

<h2 id="parameters">Parameters</h2>

<p>Parameter values can be set at any time or passed when the node starts</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 param set /ublox_dgnss CFG_RATE_NAV 2

</code></pre></div></div>
<p>or the current value retrieved</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 param get /ublox_dgnss CFG_RATE_NAV

</code></pre></div></div>
<h3 id="ubx-parameters">UBX Parameters</h3>

<p>The following parameters may be set. Its a subset of the full UBX Gen 9 configuration parameter list.</p>

<p>Values will be as described in the integration manual (without scaling applied). Changing a CFG_MSGOUT_* type parameter to a value &gt;0 will cause the corresponding ublox_ubx_msgs to be published.</p>

<p>CFG_INFMSG_NMEA_USB
  CFG_INFMSG_UBX_USB
  CFG_MSGOUT_UBX_NAV_CLOCK_USB
  CFG_MSGOUT_UBX_NAV_COV_USB
  CFG_MSGOUT_UBX_NAV_DOP_USB
  CFG_MSGOUT_UBX_NAV_EOE_USB
  CFG_MSGOUT_UBX_NAV_HPPOSECEF_USB
  CFG_MSGOUT_UBX_NAV_HPPOSLLH_USB
  CFG_MSGOUT_UBX_NAV_ODO_USB
  CFG_MSGOUT_UBX_NAV_ORB_USB
  CFG_MSGOUT_UBX_NAV_SAT_USB
  CFG_MSGOUT_UBX_NAV_SIG_USB
  CFG_MSGOUT_UBX_NAV_POSECEF_USB
  CFG_MSGOUT_UBX_NAV_POSLLH_USB
  CFG_MSGOUT_UBX_NAV_PVT_USB
  CFG_MSGOUT_UBX_NAV_RELPOSNED_USB
  CFG_MSGOUT_UBX_NAV_STATUS_USB
  CFG_MSGOUT_UBX_NAV_TIMEUTC_USB
  CFG_MSGOUT_UBX_NAV_VELECEF_USB
  CFG_MSGOUT_UBX_NAV_VELNED_USB
  CFG_MSGOUT_UBX_RXM_COR_USB
  CFG_MSGOUT_UBX_RXM_RTCM_USB
  CFG_MSGOUT_UBX_RXM_MEASX_USB
  CFG_MSGOUT_UBX_RXM_RAWX_USB
  CFG_MSGOUT_UBX_RXM_SPARTN_USB
  CFG_MSGOUT_UBX_MON_COMMS_USB
  CFG_MSGOUT_UBX_ESF_MEAS_USB
  CFG_MSGOUT_UBX_ESF_STATUS_USB
  CFG_MSGOUT_UBX_SEC_SIG_USB
  CFG_MSGOUT_UBX_SEC_SIGLOG_USB
  CFG_NAVHPG_DGNSSMODE
  CFG_NAVSPG_DYNMODEL
  CFG_NAVSPG_FIXMODE
  CFG_NAVSPG_INIFIX3D
  CFG_NAVSPG_UTCSTANDARD
  CFG_ODO_COGLPGAIN
  CFG_ODO_COGMAXPOSACC
  CFG_ODO_COGMAXSPEED
  CFG_ODO_OUTLPCOG
  CFG_ODO_OUTLPVEL
  CFG_ODO_PROFILE
  CFG_ODO_USE_COG
  CFG_ODO_USE_ODO
  CFG_ODO_VALLPGAIN
  CFG_RATE_MEAS
  CFG_RATE_NAV
  CFG_RATE_TIMEREF
  CFG_TMODE_MODE
  CFG_TMODE_POS_TYPE
  CFG_UART1INPROT_NMEA
  CFG_UART1INPROT_RTCM3X
  CFG_UART1INPROT_SPARTN
  CFG_UART1INPROT_UBX
  CFG_UART1OUTPROT_NMEA
  CFG_UART1OUTPROT_RTCM3X
  CFG_UART1OUTPROT_UBX
  CFG_UART2INPROT_NMEA
  CFG_UART2INPROT_RTCM3X
  CFG_UART2INPROT_SPARTN
  CFG_UART2INPROT_UBX
  CFG_UART2OUTPROT_NMEA
  CFG_UART2OUTPROT_RTCM3X
  CFG_UART2OUTPROT_UBX
  CFG_USBINPROT_NMEA
  CFG_USBINPROT_RTCM3X
  CFG_USBINPROT_UBX
  CFG_USBOUTPROT_NMEA
  CFG_USBOUTPROT_RTCM3X
  CFG_USBOUTPROT_UBX</p>

<p>CFG_SPARTN_USE_SOURCE</p>

<p>CFG_SFIMU_AUTO_MNTALG_ENA
  CFG_SFIMU_IMU_MNTALG_YAW
  CFG_SFIMU_IMU_MNTALG_PITCH
  CFG_SFIMU_IMU_MNTALG_ROLL</p>

<p>CFG_SFODO_COMBINE_TICKS
  CFG_SFODO_COUNT_MAX
  CFG_SFODO_DIS_AUTOCOUNTMAX
  CFG_SFODO_DIS_AUTODIRPINPOL
  CFG_SFODO_FACTOR
  CFG_SFODO_LATENCY
  CFG_SFODO_QUANT_ERROR</p>

<h3 id="device-identification-parameters">Device Identification Parameters</h3>

<p>aka Use with Multiple Devices</p>

<p>By default, the ublox_dgnss node will search for and connect to the first device which matches the ublox USB ID’s (vendor ID of 0x1546 and product ID of 0x01a9).  If multiple devices are connected simultaneously, the remaining devices will be ignored.  In this situation you have no control over which device is used, since the order in which they are found may depend on the order in which they were physically attached to the host.</p>

<p>If you have multiple ublox devices attached simultaneously and wish to connect to a specific device, you can specify a launch parameter “DEVICE_SERIAL_STRING”.  The node will then search for and connect to the first device with this matching serial string.  The device serial string “CFG-USB-SERIAL_NO_STRx” itself should be programmed into the ublox device beforehand using u-center software.</p>

<p>The frame ID used in ROS2 messages for that device can also be specified using the launch parameter “FRAME_ID”.</p>

<p>Note: these parameters are not written to the device.  They only instruct the node on how to behave.</p>

<h1 id="ros2-ubx-nav-messages">ROS2 UBX NAV Messages</h1>

<p>The following messages may be outputted. They included a <code class="language-plaintext highlighter-rouge">std_msgs/Header header</code> with the remainder of the fields matching the UBX output. Note that field names use different notation as the UBX field name notation is not compliant with the ROS IDL field names.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/ubx_esf_meas

/ubx_esf_status
/ubx_mon_comms
/ubx_nav_clock
/ubx_nav_cov
/ubx_nav_dop
/ubx_nav_eoe
/ubx_nav_hp_pos_ecef
/ubx_nav_hp_pos_llh
/ubx_nav_odo
/ubx_nav_orb
/ubx_nav_sat
/ubx_nav_sig
/ubx_nav_pos_ecef
/ubx_nav_pos_llh
/ubx_nav_pvt
/ubx_nav_rel_pos_ned
/ubx_nav_status
/ubx_nav_time_utc
/ubx_nav_vel_ecef
/ubx_nav_vel_ned
/ubx_rxm_cor
/ubx_rxm_rtcm
/ubx_rxm_measx
/ubx_rxm_rawx
/ubx_sec_sig
/ubx_sec_sig_log


</code></pre></div></div>

<p>The following topics are subscribed to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/ubx_esf_meas_to_device
/ntrip_client/rtcm

</code></pre></div></div>

<h1 id="ros2-navsatfix-messages">ROS2 NAVSATFIX Messages</h1>

<p>In addition to the UBX NAV messages shown above, <a href="https://docs.ros2.org/latest/api/sensor_msgs/msg/NavSatFix.html">NavSatFix messages</a> can also be published on topic /fix.</p>

<p>Note that this node relies on (and hence subscribes to) three UBX Nav messages, namely /ubx_nav_hp_pos_llh, /ubx_nav_cov, /ubx_nav_status.</p>

<p>If the ublox device is not configured to publish these three messages, the navsatfix message will likewise not be published.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/fix

</code></pre></div></div>

<h1 id="ntrip-client---rtcm-messages">NTRIP Client - RTCM messages</h1>

<p>A basic NTRIP client is provided, that focuses in binary RTCM data. Its purpose is to acquire the RTCM data from an internet based NTRIP Castor and publish <a href="https://index.ros.org/p/rtcm_msgs/">RTCM Messages</a>.</p>

<p>An example launch file is provided. You will need to set values appropriate for the NTRIP Castor intended to be used</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch ublox_dgnss ntrip_client.launch.py use_https:=true host:=ntrip.data.gnss.ga.gov.au port:=443 mountpoint:=MBCH00AUS0 username:=username password:=password

</code></pre></div></div>
<p>Note the launch file has been configured to also use environment variables <code class="language-plaintext highlighter-rouge">NTRIP_USERNAME</code> &amp; <code class="language-plaintext highlighter-rouge">NTRIP_PASSWORD</code> such that you dont need credentials in the launch scripts.</p>

<h1 id="fixed-base-and-rover">Fixed Base and Rover</h1>

<p>This package supports the use case where a fixed base station is setup to emit RTCM data and a moving rover consumes the emitted RTCM data for improved location accuracy as it moves. The base is setup to perform the survey-in procedure and, once finished, emit RTCM messages.</p>

<p>Example launch files are provided for this use case. Run <code class="language-plaintext highlighter-rouge">ublox_fb+r_base.launch.py</code> for the fixed base and <code class="language-plaintext highlighter-rouge">ublox_fb+r_rover.launch.py</code> for the moving rover.</p>

<h1 id="moving-base-and-rover">Moving Base and Rover</h1>

<p>The ZED-F9P devices support the “moving base and rover” mode of operation, using two devices on a mobile vehicle to provide both position and orientation data.  Further information on this mode, including physical connections between the two devices and the host machine are included in the following ublox application note.</p>

<p>https://www.u-blox.com/sites/default/files/documents/ZED-F9P-MovingBase_AppNote_UBX-19009093.pdf</p>

<p>Note: the ZED-F9R device does not support this mode.</p>

<p>Example launch configuration files are included as “ublox_mb+r_base.launch.py” and “ublox_mb+r_rover.launch.py” for the base and rover devices respectively.  The base and rover are physically connected similar to that described in Section 2.2.1 “Wired connection between base and rover” in the ublox app note, with UART2 used for the wired connection between base and rover.  Both base and rover connect to the host machine via USB.  Device configuration is similar to that described in Section 2.3.2 “5 Hz navigation rate application” in the app note.</p>

<p>Both base and rover will output position data which can be used to publish NavSatFix messages (as described above).  The rover also outputs heading data via UBX-NAV-RELPOSNED messages.  Refer to Section 2.4 “Using the heading output” in the app note for more information.</p>

<p>Note: as this mode required two ZED-F9P devices connected simultaneously, you will need to configure each device with a different serial string and specify these in the launch files.  See description above on device identification parameters.</p>

<h1 id="helpful-tips">Helpful tips</h1>

<h2 id="did-the-f9-device-receive-and-use-the-rtcm-data">Did the F9 device receive and use the RTCM data?</h2>
<p>If you want to see if the UBX device has received and processed the RTCM data run this, after ensuring that CFG_MSGOUT_UBX_RXM_RTCM_USB is set to 1 via <code class="language-plaintext highlighter-rouge">rqt</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 topic echo /ubx_rxm_rtcm

</code></pre></div></div>
<p>If <code class="language-plaintext highlighter-rouge">msg_used</code> shows 2 then the RTCM message has been used by the device.</p>

<p>This <a href="https://www.use-snip.com/kb/knowledge-base/an-rtcm-message-cheat-sheet/">RTCM 3 Message cheat sheet</a> can be used to determine wha the <code class="language-plaintext highlighter-rouge">msg_type</code> field represents eg GPS, GLONASS, Galileo, SBAS, QZSS or BeiDou.</p>

<h2 id="was-a-high-precision-location-calculated">Was a high precision location calculated?</h2>

<p>Ensure CFG_MSGOUT_UBX_NAV_STATUS_USB is set to 1. It is lower priority message but can be used to determine what type of GPS fix and the type of differential error correction that has been supplied.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 topic echo /ubx_nav_status

</code></pre></div></div>

<p>should output a message similar to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>header:
  stamp:
    sec: 1684907069
    nanosec: 214298394
  frame_id: ubx
itow: 279887200
gps_fix:
  fix_type: 3
gps_fix_ok: true
diff_soln: true
wkn_set: true
tow_set: true
diff_corr: true
carr_soln_valid: true
map_matching:
  status: 0
psm:
  state: 0
spoof_det:
  state: 2
carr_soln:
  status: 0
ttff: 709
msss: 3416912

</code></pre></div></div>

<p>If the <code class="language-plaintext highlighter-rouge">gps_fix.fix_type</code> = 3, it means its a 3D fix. The <code class="language-plaintext highlighter-rouge">diff_soln</code> and <code class="language-plaintext highlighter-rouge">diff_corr</code> implies that the differential error correction has occurred.</p>

<h2 id="how-precise-is-my-solution">How precise is my solution?</h2>

<p>After making sure that the deivce is processing RTCM messages and assuming that you have launched the node with <code class="language-plaintext highlighter-rouge">ros2 launch ublox_dgnss ublox_rover_hpposllh.launch.py</code>, run the following the command</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 topic echo /ubx_nav_hp_pos_llh

</code></pre></div></div>
<p>You should see something similiar to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>header:
  stamp:
    sec: 1684907675
    nanosec: 765881914
  frame_id: ubx
version: 0
invalid_lon: false
invalid_lat: false
invalid_height: false
invalid_hmsl: false
invalid_lon_hp: false
invalid_lat_hp: false
invalid_height_hp: false
invalid_hmsl_hp: false
itow: 280493800
lon: 1534256850
lat: -280021154
height: 87232
hmsl: 49963
lon_hp: 31
lat_hp: -7
height_hp: -1
hmsl_hp: 1
h_acc: 169
v_acc: 123

</code></pre></div></div>

<p>The driver output the raw UBX data into the message so some interpreting is required.</p>

<p><code class="language-plaintext highlighter-rouge">h_acc</code> and <code class="language-plaintext highlighter-rouge">v_acc</code> are in millimeters but need to be scaled by 0.1 - <code class="language-plaintext highlighter-rouge">h_acc: 16.9 mm</code> and <code class="language-plaintext highlighter-rouge">v_acc: 12.3 mm</code> per the above. Such that there is centimeter level accuracy.</p>

<p>If in doubt as to what the scaling is, please look at the F9 interface description for an explanation. All debug log output have had scaling applied.</p>

<p>If you would like to calculate the high precision lon, lat and height values use the following code as a guide</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   // Extract the LLH and high-precision components
    double lat = ubx_hppos_llh_msg-&gt;lat * 1e-7 + ubx_hppos_llh_msg-&gt;lat_hp * 1e-9;
    double lon = ubx_hppos_llh_msg-&gt;lon * 1e-7 + ubx_hppos_llh_msg-&gt;lon_hp * 1e-9;
    double alt = ubx_hppos_llh_msg-&gt;height * 1e-3 + ubx_hppos_llh_msg-&gt;height_hp * 1e-4;

</code></pre></div></div>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <em>No CONTRIBUTING.md found.</em>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-melodic">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/ublox_dgnss">ublox_dgnss</a> <small>repository</small></h3>
        <span class="label label-default">gps</span> <span class="label label-default">ublox</span> <span class="label label-default">ubx</span> <span class="label label-default">gps-location</span> <span class="label label-default">gps-data</span> <span class="label label-default">ros2</span> <span class="label label-default">high-precision</span> <span class="label label-default">ntripcaster</span> <span class="label label-default">dgnss</span> <span class="label label-default">ntripclient</span> 
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-aussierobots-ublox_dgnss
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-aussierobots-ublox_dgnss" role="menuitem" tabindex="-1" href="/r/ublox_dgnss/github-aussierobots-ublox_dgnss" data="github-aussierobots-ublox_dgnss">
                    <span class="glyphicon glyphicon-star"></span>
                    github-aussierobots-ublox_dgnss
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>melodic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>


<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
  $(function() {
    setupContributeListTabLinks();
  });
  $(document).ready(function() {
    setupDistroSwitch("humble");
    setupContributeLists("https://github.com/aussierobots/ublox_dgnss.git");
  });
</script>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="container-fluid">
      <div style="float:left;">
        
          <a href="https://github.com/rkent/rosindex" title="Find rosindex in Github">
          <span class="icon  icon--github">
            <svg viewBox="0 0 16 16">
              <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
            </svg>
          </span>

          <span class="username">rkent/rosindex</span>
        </a>
        <em class="hidden-xs">| generated on 2025-05-05</em>
      
      </div>
      <div style="float:right;">
        <p class="text"><span class="hidden-xs">a community-maintained index of robotics software
 | </span><a href="/privacy.txt">privacy</a></p>
      </div>
    </div>
  </div>

</footer>


  </body>

</html>
