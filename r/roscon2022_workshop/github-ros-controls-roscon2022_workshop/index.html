<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Index</title>
    <meta name="description" content="a community-maintained index of robotics software
">

    
    <link rel="canonical" href="http://index.rosdabbler.com/r/roscon2022_workshop/github-ros-controls-roscon2022_workshop/">
    
    
    <link rel="icon" sizes="any" type="image/svg+xml" href="/assets/rosindex_logo.svg">

    

    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">
    

    

    <script type="text/javascript" src=/js/jquery.js></script>
    <script src=/bootstrap/js/bootstrap.min.js type="text/javascript"></script>
    <script src=/js/jquery-cookie.js type="text/javascript"></script>
    
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EVD5Z6G6NH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EVD5Z6G6NH');
</script>

    <script type="text/javascript" src=/js/toc.js></script>

    <script src=/js/distro_switch.js></script>
  </head>

  <body>

    <header class="site-header">

  <div class="wrapper">
    <div class="container-fluid" style="margin-bottom: 10px">
      <div class="row">
        <!-- title -->
        <div class="col-xs-3" style="white-space:nowrap">
          <a class="site-title" href="/">
            <img src="/assets/rosindex_logo.svg" width="26" height="26" alt="ROS index logo" style="padding-bottom: 3px"/>
            ROS Index</a>
        </div>
        <!-- main internal links -->
        <div class="col-xs-6 text-center" style="padding:0px">
          <div class="btn-group hidden-xs" role="group" aria-label="..." style="padding: 6px">
            <div class="btn-group" role="group">
              <a href="/?search_packages=true" class="btn btn-default" role="button">Package List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/?search_repos=true" class="btn btn-default" role="button">Repository List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/search_deps" class="btn btn-default" role="button">System Dependencies</a>
            </div>
          </div>
          <div class="hidden-lg hidden-md hidden-sm">
            <button id="hLabel" class="btn btn-link dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Lists <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="hLabel">
              <li><a href="/?search_packages=true">Package List</a></li>
              <li><a href="/?search_repos=true">Repository List</a></li>
              <li><a href="/search_deps">System Dependencies</a></li>
            </ul>
          </div>
        </div>
        <!-- additional links -->
        <div class="col-xs-3 text-right" style="white-space:nowrap; padding:0px">
          <ul class="list-inline" style="margin-bottom:0px;">
            <li class="dropdown hidden-xs hidden-sm">
              <button id="rLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                ROS Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu" aria-labelledby="rLabel">
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-xs hidden-sm">
              <button id="aLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                About <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="aLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-md hidden-lg">
              <button id="qLabel" class="btn btn-link" type="button"
                      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="qLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
                <hr style="margin:7px" />
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin-top:20px">
  <div class="container-fluid">
    <div class="row">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/repos">Repos</a></li>
        <li class="active">roscon2022_workshop</li>
        <!--<li class="active">roscon2022_workshop</li>-->
      </ol>
    </div>
    <div class="row">
      

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
    <label id="humble-option" class="distro-button btn btn-xs btn-default" href="#humble" data="humble">
      <input type="radio" name="options" id="humble-radio" autocomplete="off"> humble
    </label>
  
    <label id="jazzy-option" class="distro-button btn btn-xs btn-default" href="#jazzy" data="jazzy">
      <input type="radio" name="options" id="jazzy-radio" autocomplete="off"> jazzy
    </label>
  
    <label id="kilted-option" class="distro-button btn btn-xs btn-default" href="#kilted" data="kilted">
      <input type="radio" name="options" id="kilted-radio" autocomplete="off"> kilted
    </label>
  
    <label id="rolling-option" class="distro-button btn btn-xs btn-default" href="#rolling" data="rolling">
      <input type="radio" name="options" id="rolling-radio" autocomplete="off"> rolling
    </label>
  
    <label id="github-option" class="distro-button btn btn-xs btn-primary" href="#github" data="github">
      <input type="radio" name="options" id="github-radio" autocomplete="off"> github
    </label>
  
    <label id="noetic-option" class="distro-button btn btn-xs btn-default" href="#noetic" data="noetic">
      <input type="radio" name="options" id="noetic-radio" autocomplete="off"> noetic
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-default" data-toggle="dropdown" id="older-distro-button">
        <input type="radio" name="options" autocomplete="off">
      <span id="older-label">Older</span>
      <span class="caret"></span>
    </label>
    <ul class="dropdown-menu" role="menu">
      
        <li data="galactic" id="galactic-option" class="disabled older-distro-option"  href="#galactic">
          <a href="#galactic" data="galactic" id="galactic-button">galactic</a>
        </li>
      
        <li data="iron" id="iron-option" class="disabled older-distro-option"  href="#iron">
          <a href="#iron" data="iron" id="iron-button">iron</a>
        </li>
      
        <li data="melodic" id="melodic-option" class="disabled older-distro-option"  href="#melodic">
          <a href="#melodic" data="melodic" id="melodic-button">melodic</a>
        </li>
      
    </ul>
  </div>
</div>

    </div>
    <div class="row">
      &nbsp;
    </div>
  </div>
</div>


  <div class="distro distro-humble">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/roscon2022_workshop">roscon2022_workshop</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-ros-controls-roscon2022_workshop
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-ros-controls-roscon2022_workshop" role="menuitem" tabindex="-1" href="/r/roscon2022_workshop/github-ros-controls-roscon2022_workshop" data="github-ros-controls-roscon2022_workshop">
                    <span class="glyphicon glyphicon-star"></span>
                    github-ros-controls-roscon2022_workshop
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>humble</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-jazzy">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/roscon2022_workshop">roscon2022_workshop</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-ros-controls-roscon2022_workshop
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-ros-controls-roscon2022_workshop" role="menuitem" tabindex="-1" href="/r/roscon2022_workshop/github-ros-controls-roscon2022_workshop" data="github-ros-controls-roscon2022_workshop">
                    <span class="glyphicon glyphicon-star"></span>
                    github-ros-controls-roscon2022_workshop
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>jazzy</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-kilted">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/roscon2022_workshop">roscon2022_workshop</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-ros-controls-roscon2022_workshop
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-ros-controls-roscon2022_workshop" role="menuitem" tabindex="-1" href="/r/roscon2022_workshop/github-ros-controls-roscon2022_workshop" data="github-ros-controls-roscon2022_workshop">
                    <span class="glyphicon glyphicon-star"></span>
                    github-ros-controls-roscon2022_workshop
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>kilted</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-rolling">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/roscon2022_workshop">roscon2022_workshop</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-ros-controls-roscon2022_workshop
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-ros-controls-roscon2022_workshop" role="menuitem" tabindex="-1" href="/r/roscon2022_workshop/github-ros-controls-roscon2022_workshop" data="github-ros-controls-roscon2022_workshop">
                    <span class="glyphicon glyphicon-star"></span>
                    github-ros-controls-roscon2022_workshop
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>rolling</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-github">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/roscon2022_workshop">roscon2022_workshop</a> <small>repository</small></h3>
        
        
        <a class="label label-primary pkg-label" href="/p/controlko_bringup">controlko_bringup</a>
        
        <a class="label label-primary pkg-label" href="/p/controlko_controllers">controlko_controllers</a>
        
        <a class="label label-primary pkg-label" href="/p/controlko_description">controlko_description</a>
        
        <a class="label label-primary pkg-label" href="/p/controlko_hardware_interface">controlko_hardware_interface</a>
        
        <a class="label label-primary pkg-label" href="/p/roscon2022_control_workshop">roscon2022_control_workshop</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-ros-controls-roscon2022_workshop
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-ros-controls-roscon2022_workshop" role="menuitem" tabindex="-1" href="/r/roscon2022_workshop/github-ros-controls-roscon2022_workshop" data="github-ros-controls-roscon2022_workshop">
                    <span class="glyphicon glyphicon-star"></span>
                    github-ros-controls-roscon2022_workshop
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default"></span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/ros-controls/roscon2022_workshop.git">https://github.com/ros-controls/roscon2022_workshop.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">master</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2023-06-16
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          <span class="label label-warning">UNKNOWN
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-default">UNRELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/roscon2022_workshop/#github-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/roscon2022_workshop/#github-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/roscon2022_workshop/#github-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/controlko_bringup">controlko_bringup</a></td>
                    <td>0.0.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/controlko_controllers">controlko_controllers</a></td>
                    <td>0.0.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/controlko_description">controlko_description</a></td>
                    <td>0.0.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/controlko_hardware_interface">controlko_hardware_interface</a></td>
                    <td>0.0.0</td>
                  </tr>
                
                  <tr>
                    <td><a href="/p/roscon2022_control_workshop">roscon2022_control_workshop</a></td>
                    <td>0.0.0</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="roscon-2022-workshop-on-ros2_control">ROSCon 2022 workshop on ros2_control</h1>

<p>Thank you for your interest in ros2_control.
This repository was developed with the purpose of supporting the workshop on <em>ros2_control</em> @ ROSCon2022 in Kyoto, Japan.
Whether you participated or not, the repository will provide you with detailed instructions on how to use the <em>ros2_control</em> framework and explain functionality and purpose of its individual parts.</p>

<h3 id="installing-this-repository">Installing this repository</h3>

<p>After cloning the repository, go to your source workspace and execute the following commands to import the necessary repositories and to install all dependencies:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vcs import --input roscon2022_workshop/roscon2022_workshop.repos .
rosdep update
rosdep install -y -i --from-paths .

</code></pre></div></div>

<h2 id="what-is-ros2_control">What is <em>ros2_control</em>
</h2>

<p>In short, ros2_control is a control framework for ROS2.
But actually, it is much more, it is the kernel of the ROS2 system that controls robots:</p>
<ul>
  <li>it abstracts hardware and low-level control for other frameworks such as MoveIt2 and Nav2;</li>
  <li>it provides resource access management,</li>
  <li>controls their lifecycle and so on.</li>
</ul>

<p>For more details check <a href="https://control.ros.org/master/doc/resources/resources.html#ros-world-2021">this presentation</a></p>

<h2 id="structure-of-this-repository-and-workshop">Structure of this repository (and workshop)</h2>

<p>The structure of the repository follows the flow of integrating robots with ROS2 and these are the following steps:</p>

<ol>
  <li>
    <p>📑 Setting up the hardware description for <em>ros2_control</em></p>

    <ol>
      <li>🗒 Setting up the robot’s URDF using XACRO</li>
      <li>📝 Extending the robot’s URDF with the <code class="language-plaintext highlighter-rouge">&lt;ros2_control&gt;</code> tag</li>
    </ol>
  </li>
  <li>
    <p>🖥 Using the <em>Mock Hardware</em> plugin for easy and generic testing of the setup (and how it can save you ton of time and nerves)</p>

    <ol>
      <li>🛠 How to setup <em>Mock Hardware</em> for a robot?</li>
      <li>🔩 How to test it with an off-the-shelf controller?</li>
    </ol>
  </li>
  <li>
    <p>⚙ Getting to know the roles of the main components of the <em>ros2_control</em> framework: <em>Controller Manager</em>, <em>Controllers</em>, <em>Resource Manager</em> and <em>Hardware Interface</em></p>
  </li>
  <li>
    <p>🔬 Introspection of the <em>ros2_control</em> system</p>
  </li>
  <li>
    <p>💻 Simulating your hardware using Gazebo Classic and Gazebo</p>
  </li>
  <li>
    <p>🔃 Become familiar with the lifecycle of controllers and hardware. Learn how to use them.</p>
  </li>
  <li>
    <p>🤖 How to write a hardware interface for a robot</p>
  </li>
  <li>
    <p>🛂 How to write a controller</p>
  </li>
</ol>

<h2 id="details-about-the-workshop">Details about the workshop</h2>

<h3 id="1--setting-up-the-hardware-description-for-ros2_control">1. 📑 Setting up the hardware description for <em>ros2_control</em>
</h3>

<h5 id="goal">GOAL</h5>

<ul>
  <li>learn how to setup the URDF of a robot using XACRO macros</li>
  <li>learn what URDF changes are needed to integrate a robot with <code class="language-plaintext highlighter-rouge">ros2_control</code>
</li>
</ul>

<h5 id="-setting-up-urdf-using-xacro-for-a-robot">🗒 Setting up URDF using XACRO for a robot</h5>

<p>For any robot that is used with ROS/ROS2 an URDF description is needed.
This description holds information about kinematics, visualization (e.g., for Rviz2) and collision data.
This description is also used by popular ROS2 high-level libraries like, MoveIt2, Nav2 and Simulators.</p>

<p>In this excercise we will focus on setting up the description using the XACRO format which is highly configurable and parameterizable and generally better to use than the static URDF format.</p>

<h5 id="task">Task</h5>

<p>Branch: <code class="language-plaintext highlighter-rouge">1-robot-description/task</code></p>

<p>Task is to setup the XACRO for RRbot in a package called <code class="language-plaintext highlighter-rouge">controlko_description</code>.</p>

<p>Kinematics:</p>

<ul>
  <li>2 DoF</li>
  <li>1st joint is on a pedestal (box 30x30x30 cm) 30 cm above the ground and rotates around the axis orthogonal to the ground</li>
  <li>1st link is 50cm long (cylinder with 20cm diameter)</li>
  <li>2nd joint is rotation orthogonal to the first link’s height</li>
  <li>2nd link is 60cm long  (10x10cm cross-section 5x5cm)</li>
</ul>

<p>Hardware:</p>

<ul>
  <li>Force Torque Sensor at TCP (6D)</li>
  <li>2 digital inputs and output (outputs can be measured)</li>
</ul>

<p>References:</p>

<ul>
  <li>https://wiki.ros.org/urdf</li>
  <li>https://wiki.ros.org/urdf/XML</li>
</ul>

<p>Files to create or adjust:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">rrbot_macro.xacro</code> - macro with kinematics and geometries for the <code class="language-plaintext highlighter-rouge">rrbot</code>
</li>
  <li>
<code class="language-plaintext highlighter-rouge">rrbot.urdf.xacro</code> - main xacro file for the robot where macro is instantiated</li>
  <li>
<code class="language-plaintext highlighter-rouge">view_robot.launch.py</code> - loading and showing robot in <code class="language-plaintext highlighter-rouge">rviz2</code>
</li>
</ul>

<p><strong>TIPP</strong>: <code class="language-plaintext highlighter-rouge">RosTeamWS</code> tool has some scripts that can help you to solve this task faster (on the branch is this already implemented). Resources:</p>

<ul>
  <li><a href="https://stoglrobotics.github.io/ros_team_workspace/master/guidelines/robot_package_structure.html">Commonly used robot-package structure</a></li>
  <li><a href="https://stoglrobotics.github.io/ros_team_workspace/master/use-cases/ros_packages/create_package.html">Creating a new package</a></li>
  <li><a href="https://stoglrobotics.github.io/ros_team_workspace/master/use-cases/ros_packages/setup_robot_description_package.html">Setting up robot description</a></li>
</ul>

<h5 id="solution">Solution:</h5>

<p>Branch: <code class="language-plaintext highlighter-rouge">1-robot-description/solution</code></p>

<p>Check the files listed above and execute:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch controlko_description view_rrbot.launch.py

</code></pre></div></div>
<p>to view the robot and move its joints using the <code class="language-plaintext highlighter-rouge">Joint State Publisher</code> GUI.</p>

<h3 id="2--using-mock-hardware-plugin-for-simple-and-generic-testing-of-the-setup">2. 🖥 Using <em>Mock Hardware</em> plugin for simple and generic testing of the setup</h3>

<h5 id="goal-1">GOAL</h5>

<ul>
  <li>learn what is <em>Mock Hardware</em> and how to use it</li>
  <li>learn how you can fast and easily test you controller’s setup and parameters before you deal with simulation or real hardware</li>
</ul>

<p><em>Mock Hardware</em> is mocking ros2_control <code class="language-plaintext highlighter-rouge">Hardware Interface</code> based on the robot’s description from the <code class="language-plaintext highlighter-rouge">ros2_control</code> tag.
Its purpose is to simplify and boost the development process when creating a new controller or setting up their configuration.
The advantage of using it, over simulation or real hardware, is a very fast start-up and lean functionality.
It is a well tested module helping you focus on other components in your setup knowing that your “hardware” behaves ideally.
<em>NOTE:</em> the functionality of <em>Mock Hardware</em> is intentionally limited and it only enables you to reflect commanded values on the state interfaces with the same name. Nevertheless, this is sufficient for most tasks.</p>

<p><strong>TIPP</strong>:</p>

<ul>
  <li>Dr. Denis recommends you to always start to develop things first with the Mock Hardware and then start switching to simulation or real hardware.
This way you save time dealing with a broken setup with simulation or hardware in the loop.</li>
</ul>

<h5 id="-how-to-setup-mock-hardware-for-a-robot">🛠 How to setup <em>Mock Hardware</em> for a robot?</h5>

<ol>
  <li>
    <p>Add <code class="language-plaintext highlighter-rouge">hardware</code> tag under the <code class="language-plaintext highlighter-rouge">ros2_control</code> tag with plugin <code class="language-plaintext highlighter-rouge">mock_components/GenericSystem</code> and set <code class="language-plaintext highlighter-rouge">mock_sensor_commands</code> parameter.
The parameter create fake command interface for sensor values than enables you to simulate the values on the sensor.</p>
  </li>
  <li>
    <p>Create a launch file named <code class="language-plaintext highlighter-rouge">rrbot.launch.py</code> that starts the ros2_control node with the correct robot description.</p>
  </li>
</ol>

<p><strong>NOTE</strong>: Currently, there is only <code class="language-plaintext highlighter-rouge">GenericSystem</code> mock component, which can mock also sensor or actuator components (because they just have a reduced feature set compared to a system).</p>

<h5 id="-how-to-test-it-with-an-off-the-shelf-controller">🔩 How to test it with an off-the-shelf controller?</h5>

<ol>
  <li>Setup the following controllers for the <code class="language-plaintext highlighter-rouge">RRBot</code>:</li>
</ol>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">Joint State Broadcaster</code> - always needed to get <code class="language-plaintext highlighter-rouge">/joint_states</code> topic from a hardware.</li>
  <li>
<code class="language-plaintext highlighter-rouge">Forward Command Controller</code> - sending position commands for the joints.</li>
  <li>
<code class="language-plaintext highlighter-rouge">Joint Trajectory Controller</code> - interpolating trajectory between the position commands for the joint.</li>
</ul>

<ol>
  <li>
    <p>Add to launch file spawning (loading and activating) of controllers.</p>
  </li>
  <li>
    <p>Test forward command controller by sending a reference to it using <code class="language-plaintext highlighter-rouge">ros2 topic pub</code> command.</p>
  </li>
  <li>
    <p>Create a launch file that starts <code class="language-plaintext highlighter-rouge">ros2_controllers_test_nodes/publisher_joint_trajectory_controller</code> to publish goals for the JTC.</p>
  </li>
</ol>

<p><strong>TIPP</strong>: <code class="language-plaintext highlighter-rouge">RosTeamWS</code> tool has some scripts that can help you to solve this task faster. Resources:</p>

<ul>
  <li><a href="https://stoglrobotics.github.io/ros_team_workspace/master/guidelines/robot_package_structure.html">Commonly used robot-package structure</a></li>
  <li><a href="https://stoglrobotics.github.io/ros_team_workspace/master/use-cases/ros_packages/create_package.html">Creating a new package</a></li>
  <li><a href="https://stoglrobotics.github.io/ros_team_workspace/master/use-cases/ros_packages/setup_robot_bringup_package.html">Setting up robot bringup</a></li>
</ul>

<h5 id="solution-1">Solution:</h5>

<p>Branch: <code class="language-plaintext highlighter-rouge">2-robot-mock-hardware</code></p>

<p>Check the files listed above and execute:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch controlko_bringup rrbot.launch.py

</code></pre></div></div>
<p>then publish a command to the forward command controller:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 topic pub /forward_position_controller/commands std_msgs/msg/Float64MultiArray "
layout:
 dim: []
 data_offset: 0
data:
 - 0.7
 - 0.7"

</code></pre></div></div>

<p>To start <code class="language-plaintext highlighter-rouge">RRBot</code> with JTC execute:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch controlko_bringup rrbot.launch.py robot_controller:=joint_trajectory_controller

</code></pre></div></div>
<p>and open a new terminal and execute:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch controlko_bringup test_joint_trajectory_controller.launch.py

</code></pre></div></div>

<p><strong>NOTE</strong>: delay between spawning controllers is usually not necessary, but useful when starting a complex setup. Adjust this specifically for the specific use-case.</p>

<h3 id="3--getting-know-the-roles-of-the-main-components-of-ros2_control-framework">3. ⚙ Getting know the roles of the main components of <em>ros2_control</em> framework</h3>

<p>Start the previous example one more time and try to answer the following questions:</p>

<ol>
  <li>What and where is <em>Controller Manager</em>?</li>
  <li>What are <em>Controllers</em>? How they can be seen in ROS2?</li>
  <li>What is <em>Resource Manager</em>? Where can you see it? How to access it?</li>
  <li>What is <em>Hardware Interface</em>? Where is this stored? How to interact with it?</li>
</ol>

<h5 id="solution-2">Solution:</h5>

<p><img src="https://github.com/ros-controls/control.ros.org/blob/master/doc/resources/images/ros2_control_overview.png" alt="ros2_control Overview"></p>

<h3 id="4--introspection-of-ros2_control-system">4. 🔬 Introspection of <em>ros2_control</em> system</h3>

<p>There are two options to interact with the ros2_control, first, using the CLI interface with commands like <code class="language-plaintext highlighter-rouge">ros2 control &lt;command&gt;</code> (package <code class="language-plaintext highlighter-rouge">ros2controlcli</code>), and second, using services from the controller manager directly.</p>

<p>Try to figure out how to answer the following questions using those tools:</p>

<ol>
  <li>What controllers are loaded in the system?</li>
  <li>What is the state of the controllers?</li>
  <li>What hardware interfaces are there and in which state?</li>
  <li>Which interfaces are available?</li>
  <li>How can we switch between <code class="language-plaintext highlighter-rouge">forward_position_controller</code> and <code class="language-plaintext highlighter-rouge">joint_trajectory_controller</code>?</li>
  <li>What happens when you try to run all controllers in parallel?</li>
  <li>What interfaces are controllers using?</li>
</ol>

<p>Also there are few graphical tools available for <code class="language-plaintext highlighter-rouge">ros2_control</code>: <code class="language-plaintext highlighter-rouge">rqt_controller_manager</code> and <code class="language-plaintext highlighter-rouge">rqt_joint_trajectory_controller</code>. Try to use those tools.</p>

<h5 id="solution-3">Solution:</h5>

<p>Answers to the questions:</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">ros2 control list_controllers</code></li>
  <li><code class="language-plaintext highlighter-rouge">ros2 control list_controllers</code></li>
  <li><code class="language-plaintext highlighter-rouge">ros2 service call /controller_manager/list_hardware_components controller_manager_msgs/srv/ListHardwareComponents {}</code></li>
  <li><code class="language-plaintext highlighter-rouge">ros2 control list_hardware_interfaces</code></li>
  <li>
<code class="language-plaintext highlighter-rouge">ros2 run controller_manager spawner forward_position_controller --inactive</code>
<code class="language-plaintext highlighter-rouge">ros2 control switch_controllers --deactivate joint_trajectory_controller --activate forward_position_controller</code>
</li>
  <li>See output in the terminal where <code class="language-plaintext highlighter-rouge">ros2_control_node</code> is running: <code class="language-plaintext highlighter-rouge">ros2 control switch_controllers --activate joint_trajectory_controller</code>
</li>
  <li><code class="language-plaintext highlighter-rouge">ros2 control list_controllers -v</code></li>
</ol>

<h3 id="5--simulating-your-hardware-using-gazebo-classic-and-gazebo">5. 💻 Simulating your hardware using Gazebo Classic and Gazebo</h3>

<p>ros2_control is integrated with simulators using simulator-specific plugins.
Those plugins extend controller manager with simulator-related functionalities and enables loading hardware interfaces that are created specifically for the simulator.
Simulators are using description under <code class="language-plaintext highlighter-rouge">&lt;ros2_control&gt;</code> to setup the interfaces.
They are searched for interfaces with standard names, <code class="language-plaintext highlighter-rouge">position</code>, <code class="language-plaintext highlighter-rouge">velocity</code> and <code class="language-plaintext highlighter-rouge">effort</code>, to wire them with the internal simulator-states.</p>

<p>The plugins and interfaces for the simulators are the following:</p>

<p><strong>Gazebo Classic</strong></p>
<ul>
  <li>Package: <code class="language-plaintext highlighter-rouge">gazebo_ros2_control</code>
</li>
  <li>Simulator plugin: <code class="language-plaintext highlighter-rouge">libgazebo_ros2_control.so</code>
</li>
  <li>HW interface plugin: <code class="language-plaintext highlighter-rouge">gazebo_ros2_control/GazeboSystem</code>
</li>
</ul>

<p><strong>Gazebo</strong></p>
<ul>
  <li>Package: <code class="language-plaintext highlighter-rouge">gz_ros2_control</code>
</li>
  <li>Simulator plugin: <code class="language-plaintext highlighter-rouge">libign_ros2_control-system.so</code>
</li>
  <li>HW interface plugin: <code class="language-plaintext highlighter-rouge">ign_ros2_control/IgnitionSystem</code>
  <strong>NOTE</strong> <code class="language-plaintext highlighter-rouge">ign</code> will be switched to <code class="language-plaintext highlighter-rouge">gz</code> very soon!</li>
</ul>

<p>Let’s define those plugins for <code class="language-plaintext highlighter-rouge">RRBot</code>:</p>

<ol>
  <li>Extend <code class="language-plaintext highlighter-rouge">rrbot.urdf.xacro</code> with <code class="language-plaintext highlighter-rouge">&lt;gazebo&gt;</code> tags defining simulator plugins and parameters.</li>
  <li>Add hardware interface plugins under <code class="language-plaintext highlighter-rouge">&lt;ros2_control&gt;</code> tag in the file <code class="language-plaintext highlighter-rouge">rrbot_macro.ros2_control.xacro</code>.</li>
  <li>Add new launch file <code class="language-plaintext highlighter-rouge">rrbot_sim_gazebo_class.launch.py</code> for starting Gazebo Classic simulation.</li>
  <li>Add new launch file <code class="language-plaintext highlighter-rouge">rrobt_sim_gazebo.launch.py</code> for starting Gazebo simulation.</li>
</ol>

<h5 id="solution-4">Solution:</h5>

<p>Branch: <code class="language-plaintext highlighter-rouge">5-simulation</code></p>

<p>Check updated files from the above list.
To start the Gazebo Classic simulation use:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch controlko_bringup rrbot_sim_gazebo_classic.launch.py

</code></pre></div></div>

<p>To start the Gazebo simulation use:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch controlko_bringup rrbot_sim_gazebo.launch.py

</code></pre></div></div>

<p>Now execute the test script for joint trajectory controller to move the robot.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 launch controlko_bringup test_joint_trajectory_controller.launch.py

</code></pre></div></div>

<p><strong>NOTE</strong>: When running simulation be sure to set the joint limits defined in the macro file.</p>

<h3 id="6--getting-familiar-with-the-lifecycle-of-controllers-and-hardware-and-how-to-use-it">6. 🔃 Getting familiar with the lifecycle of controllers and hardware and how to use it</h3>

<p><em>ros2_control</em> enables you to control the lifecycle of controllers and hardware components.
The states and transitions are the same as for the <code class="language-plaintext highlighter-rouge">Lifecycle Nodes</code>.
Check the diagram below for more details:</p>

<p><img src="https://control.ros.org/master/_images/hardware_interface_lifecycle.png" alt="Lifecycle of Hardware Interfaces"></p>

<h5 id="task-1">Task</h5>

<ol>
  <li>Start the <code class="language-plaintext highlighter-rouge">RRbot</code> with <code class="language-plaintext highlighter-rouge">Mock System</code>
</li>
  <li>Check the lifecycle state of controllers and hardware interfaces</li>
  <li>Activate the <code class="language-plaintext highlighter-rouge">joint_trajectory_controller</code> controller. What else do you have to do to achieve that?</li>
  <li>Set hardware to <code class="language-plaintext highlighter-rouge">inactive</code> state. What is now the internal state of the <em>ros2_control</em> instance?</li>
  <li>Have you heard of the <code class="language-plaintext highlighter-rouge">RQT Controller Manager</code> plugin? Try it!</li>
</ol>

<h5 id="solution-5">Solution:</h5>

<p>Branch: <code class="language-plaintext highlighter-rouge">6-getting-know-lifecycle</code></p>

<p>Execute the following commands to get the answers from the task:</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">ros2 launch controlko_bringup rrbot.launch.py</code></li>
  <li>Execute in another terminal:</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   ros2 control list_controllers
   ros2 service call /controller_manager/list_hardware_components controller_manager_msgs/srv/ListHardwareComponents {}
   
</code></pre></div></div>
<ol>
  <li>Execute the following commands (this is one of multiple valid ways)</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   ros2 control load_controller joint_trajectory_controller
   ros2 control set_controller_state joint_trajectory_controller inactive
   ros2 control switch_controllers --deactivate forward_position_controller --activate joint_trajectory_controller
   
</code></pre></div></div>

<ol>
  <li>Execute the following commands (this is one of multiple valid ways)</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   # stop controller
   ros2 control switch_controllers --deactivate joint_trajectory_controller
   # get component name
   ros2 service call /controller_manager/list_hardware_components controller_manager_msgs/srv/ListHardwareComponents {}
   # set component state
   ros2 service call /controller_manager/set_hardware_component_state controller_manager_msgs/srv/SetHardwareComponentState "
   name: rrbot
   target_state:
    id: 0 
    label: inactive"
   # check internals of ros2_control
   ros2 control list_controllers
   ros2 control list_hardware_interfaces
   
</code></pre></div></div>

<h3 id="7--how-to-write-a-hardware-interface-for-a-robot">7. 🤖 How to write a hardware interface for a robot</h3>

<p>Hardware interface is the lowest layer towards hardware in <em>ros2_control</em>.
A hardware interface is a driver for a specific robot that exports interfaces to the framework for controllers to use them.
Overview of <em>ros2_control</em> shows this graphically:</p>

<p><img src="https://control.ros.org/master/_images/ros2_control_overview.png" alt="Overview of *ros2_control*"></p>

<p>Lifecycle diagrams from the <a href="https://github.com/ros-controls/roscon2022_workshop/tree/master/">Task 6</a> explains in detail when which method is used.</p>

<h5 id="task-2">Task</h5>

<p>Branch: <code class="language-plaintext highlighter-rouge">7-robot-hardware-interface/task</code></p>

<p>Write a hardware interface for the <em>RRBot</em>.</p>

<ol>
  <li>Create or adjust a package named <code class="language-plaintext highlighter-rouge">controlko_hardware_interface</code> with hardware interface files.</li>
  <li>
    <p>Write a hardware interface that uses a header-only library for the communication with <em>RRBot</em>:</p>

    <ul>
      <li>check the file <code class="language-plaintext highlighter-rouge">controlko_hardware_interface/include/controlko_hardware_interface/dr_denis_rrbot_comms.hpp</code>
</li>
      <li>use <a href="https://control.ros.org/master/doc/ros2_control/hardware_interface/doc/writing_new_hardware_interface.html">Writing a new hardware interface manual</a> to implement everything needed.</li>
      <li>extend the URDF file to use hardware interface</li>
    </ul>
  </li>
  <li>
    <p>During the implementation of the hardware interface take care about the following details:</p>

    <ul>
      <li>Which control modes are supported?</li>
      <li>What happens if an incompatible controller is activated?</li>
    </ul>
  </li>
  <li>What are the capabilities?</li>
</ol>

<p><strong>TIPP</strong>: <code class="language-plaintext highlighter-rouge">RosTeamWS</code> tool has some scripts that can help you to solve this task faster. Resources:</p>

<ul>
  <li><a href="https://stoglrobotics.github.io/ros_team_workspace/master/guidelines/robot_package_structure.html">Commonly used robot-package structure</a></li>
  <li><a href="https://stoglrobotics.github.io/ros_team_workspace/master/use-cases/ros_packages/create_package.html">Creating a new package</a></li>
  <li><a href="https://stoglrobotics.github.io/ros_team_workspace/master/use-cases/ros2_control/setup_robot_hardware_interface.html">Setup robot’s hardware package</a></li>
</ul>

<h5 id="solution-6">Solution</h5>

<p>Branch: <code class="language-plaintext highlighter-rouge">7-robot-hardware-interface/solution</code></p>

<p>Execute the following commands to get the answers from the task:</p>

<ol>
  <li>
    <p><code class="language-plaintext highlighter-rouge">ros2 launch controlko_bringup rrbot.launch.py use_mock_hardware:=false</code></p>
  </li>
  <li>
    <p>Test execution with <code class="language-plaintext highlighter-rouge">forward_position_controller</code> and <code class="language-plaintext highlighter-rouge">joint_trajectory_controller</code></p>
  </li>
  <li>
    <p>Test activation of an incompatible controller using:</p>
  </li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   ros2 control load_controller incompatible_joint_trajectory_controller
   ros2 control set_controller_state incompatible_joint_trajectory_controller inactive
   ros2 control switch_controllers --deactivate forward_position_controller --activate incompatible_joint_trajectory_controller
   
</code></pre></div></div>

<h3 id="8--how-to-write-a-controller">8. 🛂 How to write a controller</h3>

<p>Controllers in <em>ros2_control</em> are serving on the one hand as “interfaces” towards the ROS-world and on the other hand implement algorithms to control the hardware.
A controller, when activated, gets loaned access to the exported hardware interface to read and write values directly from/to memory locations that the hardware interface is using.
Although somewhat limited, this concept enables deterministic and reliable data flow between controllers and hardware interfaces (drivers).</p>

<p><img src="https://control.ros.org/master/_images/ros2_control_overview.png" alt="Overview of *ros2_control*"></p>

<h5 id="task-3">Task</h5>

<p>Branch: <code class="language-plaintext highlighter-rouge">8-write-controller/task</code></p>

<p>Write a controller for <em>RRBot</em> robot that takes joint displacements as input and updates new joint positions for it.</p>

<ol>
  <li>Add controller files into the <code class="language-plaintext highlighter-rouge">controlko_controllers</code> package.</li>
  <li>
    <p>During the implementation take care about the following details:</p>

    <ul>
      <li>How is data exchanged between the controller’s callbacks and the <code class="language-plaintext highlighter-rouge">update</code> method?</li>
      <li>
        <p>How are statuses from controller published to ROS topics?</p>
      </li>
      <li>Controller should have a <em>slow mode</em> where displacements are reduced to half.</li>
      <li>Controller accepts a command only once.</li>
    </ul>
  </li>
  <li>
    <p>Write a controller that uses <code class="language-plaintext highlighter-rouge">control_msgs/msg/JointJog</code> message for the input.</p>

    <ul>
      <li>Check the definition of <a href="https://github.com/ros-controls/control_msgs/blob/galactic-devel/control_msgs/msg/JointJog.msg"><code class="language-plaintext highlighter-rouge">JointJog</code> message</a>
</li>
      <li>Alternatively use the CLI command: <code class="language-plaintext highlighter-rouge">ros2 interface show control_msgs/msg/JointJog</code>
</li>
      <li>Use <a href="https://control.ros.org/master/doc/ros2_controllers/doc/writing_new_controller.html">Writing a new controller manual</a> to implement the controller</li>
    </ul>
  </li>
</ol>

<p><strong>TIPP</strong>: <code class="language-plaintext highlighter-rouge">RosTeamWS</code> tool has some scripts that can help you solve this task faster. Resources:</p>

<ul>
  <li><a href="https://stoglrobotics.github.io/ros_team_workspace/master/use-cases/ros_packages/create_package.html">Creating a new package</a></li>
  <li>
<a href="https://stoglrobotics.github.io/ros_team_workspace/master/use-cases/ros2_control/setup_controller.html">Setup controller package</a> - choose setup of “normal” controller</li>
</ul>

<h5 id="solution-7">Solution</h5>

<p>Branch: <code class="language-plaintext highlighter-rouge">8-write-controller/solution</code></p>

<p>First check the code:</p>

<ul>
  <li>
<em>ros2_control</em> is now using PickNik’s <a href="https://github.com/PickNikRobotics/generate_parameter_library">generate_parameter_library</a> so simpler and cleaner parameters usage and definition.
    <ul>
      <li>parameters are defined in [./src/displacement_controller.yaml] file</li>
      <li>example controller setup is in:
        <ul>
          <li>[./test/displacement_controller_params.yaml] - when controller is used directly with the hardware</li>
          <li>[./test/displacement_controller_preceeding_params.yaml] - when controller is used at the beginning of the chain (see the next task for details!)</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>Execute the following commands to see the new controller running:</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">ros2 launch controlko_bringup rrbot.launch.py</code></li>
</ol>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <em>No CONTRIBUTING.md found.</em>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-noetic">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/roscon2022_workshop">roscon2022_workshop</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-ros-controls-roscon2022_workshop
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-ros-controls-roscon2022_workshop" role="menuitem" tabindex="-1" href="/r/roscon2022_workshop/github-ros-controls-roscon2022_workshop" data="github-ros-controls-roscon2022_workshop">
                    <span class="glyphicon glyphicon-star"></span>
                    github-ros-controls-roscon2022_workshop
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>noetic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-galactic">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/roscon2022_workshop">roscon2022_workshop</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-ros-controls-roscon2022_workshop
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-ros-controls-roscon2022_workshop" role="menuitem" tabindex="-1" href="/r/roscon2022_workshop/github-ros-controls-roscon2022_workshop" data="github-ros-controls-roscon2022_workshop">
                    <span class="glyphicon glyphicon-star"></span>
                    github-ros-controls-roscon2022_workshop
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>galactic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-iron">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/roscon2022_workshop">roscon2022_workshop</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-ros-controls-roscon2022_workshop
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-ros-controls-roscon2022_workshop" role="menuitem" tabindex="-1" href="/r/roscon2022_workshop/github-ros-controls-roscon2022_workshop" data="github-ros-controls-roscon2022_workshop">
                    <span class="glyphicon glyphicon-star"></span>
                    github-ros-controls-roscon2022_workshop
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>iron</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-melodic">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/roscon2022_workshop">roscon2022_workshop</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-ros-controls-roscon2022_workshop
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-ros-controls-roscon2022_workshop" role="menuitem" tabindex="-1" href="/r/roscon2022_workshop/github-ros-controls-roscon2022_workshop" data="github-ros-controls-roscon2022_workshop">
                    <span class="glyphicon glyphicon-star"></span>
                    github-ros-controls-roscon2022_workshop
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>melodic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>


<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
  $(function() {
    setupContributeListTabLinks();
  });
  $(document).ready(function() {
    setupDistroSwitch("humble");
    setupContributeLists("https://github.com/ros-controls/roscon2022_workshop.git");
  });
</script>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="container-fluid">
      <div style="float:left;">
        
          <a href="https://github.com/rkent/rosindex" title="Find rosindex in Github">
          <span class="icon  icon--github">
            <svg viewBox="0 0 16 16">
              <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
            </svg>
          </span>

          <span class="username">rkent/rosindex</span>
        </a>
        <em class="hidden-xs">| generated on 2025-05-05</em>
      
      </div>
      <div style="float:right;">
        <p class="text"><span class="hidden-xs">a community-maintained index of robotics software
 | </span><a href="/privacy.txt">privacy</a></p>
      </div>
    </div>
  </div>

</footer>


  </body>

</html>
