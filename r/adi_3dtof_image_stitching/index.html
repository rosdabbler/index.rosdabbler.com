<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Index</title>
    <meta name="description" content="a community-maintained index of robotics software
">

    
    <link rel="canonical" href="http://index.rosdabbler.com/r/adi_3dtof_image_stitching/">
    
    
    <link rel="icon" sizes="any" type="image/svg+xml" href="/assets/rosindex_logo.svg">

    

    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">
    

    

    <script type="text/javascript" src=/js/jquery.js></script>
    <script src=/bootstrap/js/bootstrap.min.js type="text/javascript"></script>
    <script src=/js/jquery-cookie.js type="text/javascript"></script>
    
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EVD5Z6G6NH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EVD5Z6G6NH');
</script>

    <script type="text/javascript" src=/js/toc.js></script>

    <script src=/js/distro_switch.js></script>
  </head>

  <body>

    <header class="site-header">

  <div class="wrapper">
    <div class="container-fluid" style="margin-bottom: 10px">
      <div class="row">
        <!-- title -->
        <div class="col-xs-3" style="white-space:nowrap">
          <a class="site-title" href="/">
            <img src="/assets/rosindex_logo.svg" width="26" height="26" alt="ROS index logo" style="padding-bottom: 3px"/>
            ROS Index</a>
        </div>
        <!-- main internal links -->
        <div class="col-xs-6 text-center" style="padding:0px">
          <div class="btn-group hidden-xs" role="group" aria-label="..." style="padding: 6px">
            <div class="btn-group" role="group">
              <a href="/?search_packages=true" class="btn btn-default" role="button">Package List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/?search_repos=true" class="btn btn-default" role="button">Repository List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/search_deps" class="btn btn-default" role="button">System Dependencies</a>
            </div>
          </div>
          <div class="hidden-lg hidden-md hidden-sm">
            <button id="hLabel" class="btn btn-link dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Lists <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="hLabel">
              <li><a href="/?search_packages=true">Package List</a></li>
              <li><a href="/?search_repos=true">Repository List</a></li>
              <li><a href="/search_deps">System Dependencies</a></li>
            </ul>
          </div>
        </div>
        <!-- additional links -->
        <div class="col-xs-3 text-right" style="white-space:nowrap; padding:0px">
          <ul class="list-inline" style="margin-bottom:0px;">
            <li class="dropdown hidden-xs hidden-sm">
              <button id="rLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                ROS Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu" aria-labelledby="rLabel">
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-xs hidden-sm">
              <button id="aLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                About <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="aLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-md hidden-lg">
              <button id="qLabel" class="btn btn-link" type="button"
                      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="qLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
                <hr style="margin:7px" />
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin-top:20px">
  <div class="container-fluid">
    <div class="row">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/repos">Repos</a></li>
        <li class="active">adi_3dtof_image_stitching</li>
        <!--<li class="active">adi_3dtof_image_stitching</li>-->
      </ol>
    </div>
    <div class="row">
      

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
    <label id="humble-option" class="distro-button btn btn-xs btn-primary" href="#humble" data="humble">
      <input type="radio" name="options" id="humble-radio" autocomplete="off"> humble
    </label>
  
    <label id="jazzy-option" class="distro-button btn btn-xs btn-default" href="#jazzy" data="jazzy">
      <input type="radio" name="options" id="jazzy-radio" autocomplete="off"> jazzy
    </label>
  
    <label id="kilted-option" class="distro-button btn btn-xs btn-default" href="#kilted" data="kilted">
      <input type="radio" name="options" id="kilted-radio" autocomplete="off"> kilted
    </label>
  
    <label id="rolling-option" class="distro-button btn btn-xs btn-default" href="#rolling" data="rolling">
      <input type="radio" name="options" id="rolling-radio" autocomplete="off"> rolling
    </label>
  
    <label id="github-option" class="distro-button btn btn-xs btn-default" href="#github" data="github">
      <input type="radio" name="options" id="github-radio" autocomplete="off"> github
    </label>
  
    <label id="noetic-option" class="distro-button btn btn-xs btn-primary" href="#noetic" data="noetic">
      <input type="radio" name="options" id="noetic-radio" autocomplete="off"> noetic
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-default" data-toggle="dropdown" id="older-distro-button">
        <input type="radio" name="options" autocomplete="off">
      <span id="older-label">Older</span>
      <span class="caret"></span>
    </label>
    <ul class="dropdown-menu" role="menu">
      
        <li data="galactic" id="galactic-option" class="disabled older-distro-option"  href="#galactic">
          <a href="#galactic" data="galactic" id="galactic-button">galactic</a>
        </li>
      
        <li data="iron" id="iron-option" class="disabled older-distro-option"  href="#iron">
          <a href="#iron" data="iron" id="iron-button">iron</a>
        </li>
      
        <li data="melodic" id="melodic-option" class="disabled older-distro-option"  href="#melodic">
          <a href="#melodic" data="melodic" id="melodic-button">melodic</a>
        </li>
      
    </ul>
  </div>
</div>

    </div>
    <div class="row">
      &nbsp;
    </div>
  </div>
</div>


  <div class="distro distro-humble">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/adi_3dtof_image_stitching">adi_3dtof_image_stitching</a> <small>repository</small></h3>
        
        
        <a class="label label-primary pkg-label" href="/p/adi_3dtof_image_stitching">adi_3dtof_image_stitching</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-analogdevicesinc-adi_3dtof_image_stitching
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-analogdevicesinc-adi_3dtof_image_stitching" role="menuitem" tabindex="-1" href="/r/adi_3dtof_image_stitching/github-analogdevicesinc-adi_3dtof_image_stitching" data="github-analogdevicesinc-adi_3dtof_image_stitching">
                    <span class="glyphicon glyphicon-star"></span>
                    github-analogdevicesinc-adi_3dtof_image_stitching
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">The ADI 3D ToF Image Stitching is a ROS (Robot Operating System) package for stitching Depth images from multiple ADTF3175D Time-Of-Flight sensors to expand the field of view.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/analogdevicesinc/adi_3dtof_image_stitching.git">https://github.com/analogdevicesinc/adi_3dtof_image_stitching.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">humble-devel</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-03-21
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/adi_3dtof_image_stitching/#humble-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/adi_3dtof_image_stitching/#humble-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/adi_3dtof_image_stitching/#humble-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/adi_3dtof_image_stitching">adi_3dtof_image_stitching</a></td>
                    <td>2.1.0</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 style="text-align: center;"> Analog Devices 3DToF Image Stitching</h1>

<hr>
<h1 id="overview">Overview</h1>
<p>The <strong>ADI 3DToF Image Stitching</strong> is a ROS (Robot Operating System) package for stitching depth images from multiple Time-Of-Flight sensors like ADI’s ADTF3175D ToF sensor. This node subscribes to captured Depth and IR images from multiple <strong>ADI 3DToF ADTF31xx</strong> nodes, stitches them to create a single expanded field of view and publishes the stitched Depth, IR and PointCloud as ROS topics. The node publishes Stitched Depth and IR Images at 2048x512 (16 bits per image) resolution @ 10FPS in realtime mode on <a href="https://www.aaeon.com/en/p/ai-edge-solutions-nvidia-jetson-xavier-nx-boxer-8250ai">AAEON BOXER-8250AI</a>, while stitching inputs from 4 different <a href="https://www.analog.com/en/design-center/evaluation-hardware-and-software/evaluation-boards-kits/EVAL-ADTF3175.html#eb-overview">EVAL-ADTF3175D</a> and giving an expanded FOV of 278 Degrees. Along with the Stitched Depth and IR frames, the Stitched Point Cloud is also published at 10FPS.</p>

<p><a href="https://docs.ros.org/en/humble/index.html"><img src="https://img.shields.io/badge/-humble-green?style=plastic&amp;logo=ros" alt="Humble"></a> <a href="https://releases.ubuntu.com/jammy/"><img src="https://img.shields.io/badge/-UBUNTU%2022.04-orange?style=plastic&amp;logo=ubuntu&amp;logoColor=white" alt="Ubuntu 22.04"></a> <a href="https://releases.ubuntu.com/focal/"><img src="https://img.shields.io/badge/-UBUNTU%2020.04-orange?style=plastic&amp;logo=ubuntu&amp;logoColor=white" alt="Ubuntu 20.04"></a> <a href="https://github.com/analogdevicesinc/adi_3dtof_image_stitching/tree/humble-devel/./LICENSE"><img src="https://img.shields.io/badge/License-BSD_3--Clause-purple.svg" alt="License"></a> <img src="https://img.shields.io/badge/arm64-blue?style=plastic&amp;logo=arm&amp;logoColor=white" alt="ARM64"> <img src="https://img.shields.io/badge/x86__64-blue?style=plastic&amp;logo=intel&amp;logoColor=white" alt="x86_64"> <img src="https://img.shields.io/badge/-Xavier--NX-green?style=plastic&amp;logo=nvidia&amp;logoColor=white" alt="Nvidia Xavier NX"></p>

<h1 id="background">Background</h1>
<ul>
  <li>Supported Time-of-flight boards: <a href="https://www.analog.com/en/products/adtf3175.html">ADTF3175D</a>
</li>
  <li>Supported ROS and OS distro: Humble (Ubuntu 22.04 and Ubuntu 20.04(Source Build))</li>
  <li>Supported platform: armV8 64-bit (arm64) and Intel Core x86_64(amd64) processors(Core i3, Core i5 and Core i7)</li>
</ul>

<h1 id="hardware">Hardware</h1>

<p>For the tested setup with GPU inference support, the following are used:</p>
<ul>
  <li>4 x <a href="https://www.analog.com/en/design-center/evaluation-hardware-and-software/evaluation-boards-kits/EVAL-ADTF3175.html#eb-overview">EVAL-ADTF3175D</a>
</li>
  <li>1 x <a href="https://www.aaeon.com/en/p/ai-edge-solutions-nvidia-jetson-xavier-nx-boxer-8250ai">AAEON BOXER-8250AI</a>
</li>
  <li>1 x External 12V power supply</li>
  <li>4 x Usb type-c to type-A cables - with 5gbps data speed support</li>
</ul>

<p>Minimum requirements for a test setup on host laptop/computer CPU:</p>
<ul>
  <li>2 x <a href="https://www.analog.com/en/design-center/evaluation-hardware-and-software/evaluation-boards-kits/EVAL-ADTF3175.html#eb-overview">EVAL-ADTF3175D</a>
</li>
  <li>Host laptop with intel i5 or higher cpu running Ubuntu-20.04LTS or WSL2 with Ubuntu-20.04</li>
  <li>2 x USB type-c to type-A cables - with 5gbps data speed support</li>
  <li>USB power hub</li>
</ul>

<blockquote>
  <p>:memo: _Note: Refer the <a href="https://wiki.analog.com/resources/eval/user-guides/eval-adtf3175d-nxz">User Guide</a> to ensure the eval module has adequate power supply during operation.</p>
</blockquote>

<p>The image below shows the connection diagram of the setup (with labels):</p>

<p><img src="https://raw.githubusercontent.com/analogdevicesinc/adi_3dtof_image_stitching/humble-devel/./docs/images/connection_diagram.PNG" alt="Adi_3dtof_Image_Stitching Connection"></p>

<p>The image below shows the actual setup used (for reference):</p>

<p><img src="https://raw.githubusercontent.com/analogdevicesinc/adi_3dtof_image_stitching/humble-devel/./docs/images/realtime_setup.PNG" alt="Adi_3dtof_Image_Stitching Actual Setup"></p>

<h1 id="hardware-setup">Hardware setup</h1>
<p>Follow the below mentioned steps to get the hardware setup ready:</p>
<ol>
  <li>Setup the ToF devices with <a href="https://github.com/analogdevicesinc/adi_3dtof_adtf31xx">adi_3dtof_adtf31xx_sensor</a> node following the steps mentioned in the <a href="https://github.com/analogdevicesinc/adi_3dtof_adtf31xx/tree/humble-devel">repository</a>.</li>
  <li>Ensure all devices are running at <code class="language-plaintext highlighter-rouge">10fps</code> by following these <a href="https://github.com/analogdevicesinc/adi_3dtof_image_stitching/tree/humble-devel/./docs/adtf_device_10_fps_setup.txt">steps</a>.</li>
  <li>Position the cameras properly as per the dimentions shown in the below Diagram.</li>
</ol>

<p><img src="https://raw.githubusercontent.com/analogdevicesinc/adi_3dtof_image_stitching/humble-devel/./docs/images/camera_positioning_dimentions.PNG" alt="Adi_3dtof_Image_Stitching camera positionning"></p>

<blockquote>
  <p>:memo: <em>Notes</em>:</p>
  <ul>
    <li>Please contact the <code class="language-plaintext highlighter-rouge">Maintainers</code> to get the CAD design for the baseplate setup shown above.</li>
  </ul>
</blockquote>

<ol>
  <li>Finally, connect the devices to the host(Linux PC or AAEON BOXER-8250AI) using usb cables as shown below.</li>
</ol>

<p><img src="https://raw.githubusercontent.com/analogdevicesinc/adi_3dtof_image_stitching/humble-devel/./docs/images/device_connections.png" alt="Adi_3dtof_Image_Stitching Connections"></p>

<h1 id="software">Software</h1>

<h2 id="software-dependencies">Software Dependencies</h2>
<p>Assumptions before building this package:</p>
<ul>
  <li>Linux System or WSL2(Only Simulation Mode supported) running Ubuntu 22.04LTS</li>
  <li>ROS2 Humble: If not installed, follow these <a href="https://docs.ros.org/en/humble/Installation/Ubuntu-Install-Debians.html">steps</a>.</li>
  <li>Setup colcon workspace (with workspace folder named as “ros2_ws”).</li>
  <li>System Date/Time is updated:
Make sure the Date/Time is set properly before compiling and running the application. Connecting to a WiFi network would make sure the Date/Time is set properly.</li>
  <li>NTP server is setup for device Synchronization. If not, please refer this <a href="https://ubuntuforums.org/showthread.php?t=862620">Link</a> to setup NTP server on Host.</li>
</ul>

<p>Software Requirements for Running on <a href="https://www.aaeon.com/en/p/ai-edge-solutions-nvidia-jetson-xavier-nx-boxer-8250ai">AAEON BOXER-8250AI</a> :</p>
<ul>
  <li>Nvidia Jetpack OS 5.0.2 .</li>
  <li>
<a href="https://developer.nvidia.com/cuda-11-4-0-download-archive">CUDA 11.4</a>. It comes preinstalled with Jetpack OS. If not, follow these <a href="https://docs.nvidia.com/cuda/archive/11.4.0/cuda-installation-guide-linux/index.html">steps</a>.</li>
</ul>

<h1 id="clone">Clone</h1>

<ol>
  <li>Clone the repo and checkout the correct release branch/
tag into ros2 workspace directory</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nv">$ </span><span class="nb">cd</span> ~/ros2_ws/src
    <span class="nv">$ </span>git clone https://github.com/analogdevicesinc/adi_3dtof_image_stitching.git <span class="nt">-b</span> v2.0.0
    
</code></pre></div></div>

<h1 id="build">Build</h1>

<p>Do proper exports first:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">source</span> /opt/ros/&lt;ROS version&gt;/setup.bash

</code></pre></div></div>
<p>Where:</p>
<ul>
  <li>“ROS version” is the user’s actual ROS version</li>
</ul>

<p>Then:</p>

<p>For setup with GPU inference support using CUDA:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd</span> ~/ros2_ws/
<span class="nv">$ </span>colcon build <span class="nt">--cmake-target</span> clean
<span class="nv">$ </span>colcon build <span class="nt">--symlink-install</span> <span class="nt">--cmake-args</span> <span class="nt">-DCMAKE_BUILD_TYPE</span><span class="o">=</span>Release <span class="nt">-DENABLE_GPU</span><span class="o">=</span>True <span class="nt">--event-handlers</span> console_direct+
<span class="nv">$ </span><span class="nb">source install</span>/setup.bash

</code></pre></div></div>

<p>For setup with CPU inference support using openMP:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd</span> ~/ros2_ws/
<span class="nv">$ </span>colcon build <span class="nt">--cmake-target</span> clean
<span class="nv">$ </span>colcon build <span class="nt">--symlink-install</span> <span class="nt">--cmake-args</span> <span class="nt">-DCMAKE_BUILD_TYPE</span><span class="o">=</span>Release <span class="nt">--event-handlers</span> console_direct+
<span class="nv">$ </span><span class="nb">source install</span>/setup.bash

</code></pre></div></div>
<h2 id="preparing-the-sensors">Preparing the sensors</h2>

<h3 id="setting-up-the-ip-address">Setting up the IP address</h3>
<p>The default IP address of the sensor is set to <code class="language-plaintext highlighter-rouge">10.42.0.1</code>. It is essential that each sensor has its own IP to avoid conflicts. To do so, ssh into the sensor with the credentials:</p>

<blockquote>

  <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>Username: analog
Password: analog

</code></pre></div>  </div>
</blockquote>

<ol>
  <li>Update the “Address” field in <code class="language-plaintext highlighter-rouge">/etc/systemd/network/20-wired-usb0.network</code> file.</li>
  <li>Update the server address in <code class="language-plaintext highlighter-rouge">/etc/ntp.conf</code> (<code class="language-plaintext highlighter-rouge">server 10.4x.0.100 iburst</code>)</li>
  <li>Reboot the device and login with the new ip</li>
</ol>

<h3 id="sharing-the-launch-file">Sharing the launch file</h3>
<p>The sensor modules may be missing the required launch files that designate the transforms for the sensors in 3D space, which is essential the image stitching algorithm to work appropriately. to do so, we transfer the appropriate launch file, refer to the table below, to transfer to the corresponding sensor. Refer to the CAD diagram to determine the location and camera tag.
|Camera|Launch file|
|—|—|
|cam1|adi_3dtof_adtf31xx_cam1_launch.py|
|cam2|adi_3dtof_adtf31xx_cam2_launch.py|
|cam3|adi_3dtof_adtf31xx_cam3_launch.py|
|cam4|adi_3dtof_adtf31xx_cam4_launch.py|</p>

<p>To transfer the launch file</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd</span> ~/ros2_ws/src/adi_3dtof_image_stitching/launch
<span class="nv">$ </span>scp adi_3dtof_adtf31xx_cam1.launch analog@10.42.0.1:/home/analog/ros2_ws/adi_3dtof_adtf31xx/launch

</code></pre></div></div>
<blockquote>
  <ul>
    <li>Ensure rmw settings are updated in all the Devices and the Host to support muti-sensor usecases
      <blockquote>

        <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c">#Update the default rmw xml profile file to the settings file present inside "rmw_config" foler</span>
<span class="nv">$ </span><span class="nb">export </span><span class="nv">FASTRTPS_DEFAULT_PROFILES_FILE</span><span class="o">=</span> ~/ros2_ws/src/adi_3dtof_image_stitching/rmw_config/rmw_settings.xml
<span class="c">#Next restart ROS daemon for the profile changes to take effect</span>
<span class="nv">$ </span>ros2 daemon stop

</code></pre></div>        </div>
      </blockquote>
    </li>
    <li>The above mentioned steps for rmw settings setup can also be completed by running the “setup_rmw_settings.sh” script present inside the “rmw_config” folder.
      <blockquote>

        <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd</span> ~/ros2_ws/src/adi_3dtof_image_stitching/rmw_config
<span class="nv">$ </span><span class="nb">chmod</span> +x setup_rmw_settings.sh
<span class="nv">$ </span><span class="nb">source </span>setup_rmw_settings.sh

</code></pre></div>        </div>
        <h1 id="nodes">Nodes</h1>
      </blockquote>
    </li>
  </ul>
</blockquote>

<h2 id="adi_3dtof_image_stitching_node">adi_3dtof_image_stitching_node</h2>

<blockquote>
  <p>:memo: _Note: For those with <cam_name> in the topic names, these are ideally the names assigned for EVAL-ADTF3175D. For example, if there are 2 cameras used, with the names as cam1 and cam2 ,there should be two subscribed topics for depth_image, specifically /cam1/depth_image for camra 1 and then /cam2/depth_image for camera 2._</cam_name></p>
</blockquote>

<h3 id="published-topics">Published topics</h3>

<p>These are the default topic names, topic names can be modified as a ROS parameter.</p>

<ul>
  <li>
<strong>/adi_3dtof_image_stitching/depth_image</strong>
    <ul>
      <li>Stitched 16-bit output Depth image of size 2048X512</li>
    </ul>
  </li>
  <li>
<strong>/adi_3dtof_image_stitching/ir_image</strong>
    <ul>
      <li>Stitched 16-bit output IR image of size 2048X512</li>
    </ul>
  </li>
  <li>
<strong>/adi_3dtof_image_stitching/point_cloud</strong>
    <ul>
      <li>Point cloud 3D model of the stitched environment of size 2048X512X3</li>
    </ul>
  </li>
</ul>

<h3 id="subscriber-topics">Subscriber topics</h3>

<ul>
  <li>**/<cam_name>/ir_image**
</cam_name>    <ul>
      <li>512X512 16-bit IR image from sensor node</li>
    </ul>
  </li>
  <li>**/<cam_name>/depth_image**
</cam_name>    <ul>
      <li>512X512 16-bit Depth image from sensor node</li>
    </ul>
  </li>
  <li>**/<cam_name>/camera_info**
</cam_name>    <ul>
      <li>Camera information of the sensor</li>
    </ul>
  </li>
</ul>

<h3 id="parameters">Parameters</h3>

<blockquote>
  <p>:memo: <em>Notes:</em></p>
  <ul>
    <li><em>If any of these parameters are not set/declared, default values will be used.</em></li>
  </ul>
</blockquote>

<h5 id="adi_3dtof_image_stitching-ros-node-parameters"><em>adi_3dtof_image_stitching ROS Node Parameters</em></h5>

<ul>
  <li>
<strong>param_camera_prefixes</strong> (vector<string>, default: ["cam1","cam2","cam3","cam4"])
</string>    <ul>
      <li>This list indicates the camera names of sensors connected for image stitching.</li>
      <li>we support 2 sensors in minimum and 4 sensors at maximum for a horizontal setup at the moment.</li>
      <li>The camera names must match the camera name assigned in the adi_3dtof_adtf31xx sensor node for the respective sensors.</li>
    </ul>
  </li>
  <li>
<strong>param_camera_link</strong> (String, default: “adi_camera_link”)
    <ul>
      <li>Name of camera Link</li>
    </ul>
  </li>
  <li>
<strong>param_enable_depth_ir_compression</strong> (Bool, default: True)
    <ul>
      <li>Indicates if Depth compression is enabled for the inputs comming in from the adi_3dtof_adtf31xx sensor nodes</li>
      <li>set this to “False” if Depth compression is disabled</li>
    </ul>
  </li>
  <li>
<strong>param_output_mode</strong> (int, default: 0)
    <ul>
      <li>Enables/disables saving of stitched output.</li>
      <li>set this to 1 to enable video output saving.
        <blockquote>
          <p>:memo: _Notes:_Enabling video output slows down the speed of image stitching algorithm.</p>
        </blockquote>
      </li>
    </ul>
  </li>
  <li>
<strong>param_out_file_name</strong> (String, default: “stitched_output.avi”)
    <ul>
      <li>output location to save stitched output if “param_output_mode” is enabled.</li>
    </ul>
  </li>
</ul>

<h1 id="launch">Launch</h1>

<h3 id="simulation-mode">Simulation Mode</h3>

<p>To do a quick test of image Stitching Algorithm, there is a simulation FILEIO setup that you can run.
Idea is, 4 adi_3dtof_adtf31xx sensor nodes will run in FILEIO mode on recorded vectors, publising sensor Depth and IR data which will be subscribed and processed by adi_3dtof_image_stitching node:</p>
<ol>
  <li>adi_3dtof_adtf31xx reads the binary recorded files and publishes depth_image ir_image and camera_info</li>
  <li>The adi_3dtof_image_stitching node subscribes to the incoming data and runs image stitching algorithm on them.</li>
  <li>It then publishes stitched Depth and IR images, along with stitched Point-cloud.</li>
</ol>

<blockquote>
  <p>:memo: <em>Notes</em>:</p>
  <ul>
    <li>Running the adi_3dtof_image_stitching node in Simulation mode requires the setup of <a href="https://github.com/analogdevicesinc/adi_3dtof_adtf31xx">adi_3dtof_adtf31xx_sensor</a> node to be done before hand.</li>
    <li>It is assumed that both adi_3dtof_image_stitching node and adi_3dtof_adtf31xx node are built in the location “~/ros2_ws/”.</li>
    <li>It is also assumed that the demo vectors folder “adi_3dtof_input_video_files” is copied to the location “~/ros2_ws/src/”. (please refer the “arg_in_file_name” in the launch files)</li>
  </ul>
</blockquote>

<p>To proceed with the test, execute these following command:</p>

<table>
  <thead>
    <tr>
      <th>Terminal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>&lt;pre&gt;$cd ~/ros2_ws/ <br>$source /opt/ros/humble/setup.bash <br>$source install/setup.bash <br>$ros2 launch adi_3dtof_image_stitching adi_3dtof_image_stitching_launch.py</td>
    </tr>
  </tbody>
</table>

<h4 id="monitor-the-output-on-rviz2-window">Monitor the Output on Rviz2 Window</h4>

<ol>
  <li>Open a Rviz2 instance</li>
  <li>in Rviz2 window add display for “/adi_3dtof_image_stitching/depth_image” to monitor the Stitched Depth output.</li>
  <li>Add display for “/adi_3dtof_image_stitching/ir_image” to monitor the Stitched IR output.</li>
  <li>Add display for “/adi_3dtof_image_stitching/point_cloud” to display the 3D point CLoud.</li>
</ol>

<h3 id="real-time-mode">Real-Time Mode</h3>
<p>To test the Stitching Algorithm on a real-time setup the adi_3dtof_image_stitching node needs to be launched in Host-Only mode
Idea is, the individual sensors connected to the host computer(Jetson NX host or Laptop) will publish their respective Depth and IR data independently in real-time:</p>
<ol>
  <li>Sensors will publish their respective Depth and IR frames of size 512X512 independently</li>
  <li>The adi_3dtof_image_stitching node will subscribe to the incomming data from all sensors, synchronize them and run image stitching.</li>
  <li>The stitched output is then published as ROS messages which can be viewed on the Rviz2 window.</li>
  <li>Stitched output can also be saved into a video file by enabling the “enable_video_out” parameter.</li>
</ol>

<p>To proceed with the test, first execute these following commands on four (4) different terminals (in sequence) to start image capture in the EVAL-ADTF3175D:
:memo:</p>
<blockquote>
  <ul>
    <li>This is assuming that we are testing a 4-camera setup to get a 278 degrees FOV. Reduce the number of terminals accordingly for 2 or 3 camera setup.</li>
    <li>Please ensure the below mentioned launch files are available inside the launch folder for the adi_3dtof_adtf31xx code present inside the devices. If not please follow the following steps:-
      <blockquote>
        <ol>
          <li>Copy the respective launch files from the launch folder of the adi_3dtof_image_stitching repository to the launch folder of the adi_3dtof_adtf31xx code inside the devices.</li>
          <li>Change the ‘arg_input_sensor_mode’ paameter value to 0 to help run the node in real-time capture mode.</li>
          <li>Build the adi_3dtof_adtf31xx node again on the device, so it can access these new launch files.</li>
        </ol>
      </blockquote>
    </li>
  </ul>
</blockquote>

<table>
  <thead>
    <tr>
      <th>Terminal 1</th>
      <th>Terminal 2</th>
      <th>Terminal 3</th>
      <th>Terminal 4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>&lt;pre&gt;~$ ssh analog@[ip of cam1] <br>&gt;cd ~/ros2_ws/ <br>&gt;source /opt/ros/humble/install/setup.bash <br>&gt;source install/setup.bash <br>&gt;ros2 launch adi_3dtof_adtf31xx adi_3dtof_adtf31xx_cam1_launch.py</td>
      <td>&lt;pre&gt;~$ ssh analog@[ip of cam2] <br>&gt;cd ~/ros2_ws/ <br>&gt;source /opt/ros/humble/install/setup.bash <br>&gt;source install/setup.bash <br>&gt;ros2 launch adi_3dtof_adtf31xx adi_3dtof_adtf31xx_cam2_launch.py</td>
      <td>&lt;pre&gt;~$ ssh analog@[ip of cam3] <br>&gt;cd ~/ros2_ws/ <br>&gt;source /opt/ros/humble/install/setup.bash <br>&gt;source install/setup.bash <br>&gt;ros2 launch adi_3dtof_adtf31xx adi_3dtof_adtf31xx_cam3_launch.py</td>
      <td>&lt;pre&gt;~$ ssh analog@[ip of cam4] <br>&gt;cd ~/ros2_ws/ <br>&gt;source /opt/ros/humble/install/setup.bash <br>&gt;source install/setup.bash <br>&gt;ros2 launch adi_3dtof_adtf31xx adi_3dtof_adtf31xx_cam4_launch.py</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>:memo: _Notes:</p>
  <ul>
    <li>Its assumed that the adi_3dtof_adtf31xx nodes are already built within the EVAL-ADTF3175D. It is also assumed that adi_3dtof_adtf31xx node are built in the location “~/ros2_ws/” within the sensor modules.</li>
    <li>It is assumed that the respective sensor launch files from the adi_3dtfo_image_stitching package are copied to the launch folder of adi_3dtof_adtf31xx package within the respective sensors and the input mode is changed to 0.(it is 2 by default)_</li>
    <li>The credentials to login to the devices is given below</li>
  </ul>

  <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  username: analog
  password: analog
  
</code></pre></div>  </div>
</blockquote>

<p>Next run the adi_3dtof_image_stitching node on Host in the Host-Only mode, by executing the following command:
| Terminal 5 |
— |
| &lt;pre&gt;$cd ~/ros2_ws/ <br>$source /opt/ros/humble/setup.bash <br>$source install/setup.bash <br>$ros2 launch adi_3dtof_image_stitching adi_3dtof_image_stitching_host_only_launch.py |</p>

<p>:memo:</p>
<blockquote>
  <ul>
    <li>It is assumed that both adi_3dtof_image_stitching node is built in the location “~/ros2_ws/”.</li>
    <li><span style="color:red"><strong>Make sure that the Date/Time is correctly set for all the devices, this application makes use of the topic Timestamp for synchronization. Hence, if the time is not set properly the application will not run.</strong></span></li>
    <li>If the Image Stitching Node is not subscribing/processing the depth and IR Data published by the connected sensors, please ensure the following points are checked:-
      <ol>
        <li>Ensure that the camera name prefixes for the sensor topics, match the names listed in <strong>param_camera_prefixes</strong> parameter of the image stitching launch file.</li>
        <li>If the topics published by the sensors are uncompressed, please ensure to change the <strong>param_enable_depth_ir_compression</strong> parameter to <strong>False</strong> too in the launch file of Image Stitching Node.</li>
      </ol>
    </li>
  </ul>
</blockquote>

<p><strong>Monitor the Output on Rviz2 Window</strong></p>

<ol>
  <li>Open a Rviz2 Instance</li>
  <li>in Rviz2 window add display for “/adi_3dtof_image_stitching/depth_image” to monitor the Stitched Depth output.</li>
  <li>Add display for “/adi_3dtof_image_stitching/ir_image” to monitor the Stitched IR output.</li>
  <li>Add display for “/adi_3dtof_image_stitching/point_cloud” to display the 3D point CLoud.</li>
</ol>

<h1 id="limitations">Limitations</h1>
<ol>
  <li>Currently a maximum of 4 sensors and a minimum of 2 sensors are supported for stitching, in the horizontal setup proposed.</li>
  <li>Real-time Operation is not currently supported on WSL2 setups.</li>
  <li>
<a href="https://www.aaeon.com/en/p/ai-edge-solutions-nvidia-jetson-xavier-nx-boxer-8250ai">AAEON BOXER-8250AI</a> slows dows as the device heats up, hence proper cooling mechanism is necessary.</li>
  <li>Subscribing to stitched point cloud for real-time display might slow down the algorithm operation.</li>
</ol>

<h1 id="known-issues">Known Issues</h1>
<ol>
  <li>While using WSL2 on a Windows system to run the <a href="https://github.com/analogdevicesinc/adi_3dtof_image_stitching/tree/humble-devel/#simulation-mode">simulation mode demo</a> the auto-spawned Rviz2 window may stop in some cases. In such instances please open Rviz2 again from a new terminal and subscribe to the necessary topics to continue. Steps are mentioned <a href="https://github.com/analogdevicesinc/adi_3dtof_image_stitching/tree/humble-devel/#monitor-the-output-on-rviz2-window">here</a>.</li>
</ol>

<h1 id="support">Support</h1>

<p>Please contact the <code class="language-plaintext highlighter-rouge">Maintainers</code> if you want to evaluate the algorithm for your own setup/configuration.</p>

<p>Any other inquiries are also welcome.</p>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <em>No CONTRIBUTING.md found.</em>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-jazzy">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/adi_3dtof_image_stitching">adi_3dtof_image_stitching</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-analogdevicesinc-adi_3dtof_image_stitching
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-analogdevicesinc-adi_3dtof_image_stitching" role="menuitem" tabindex="-1" href="/r/adi_3dtof_image_stitching/github-analogdevicesinc-adi_3dtof_image_stitching" data="github-analogdevicesinc-adi_3dtof_image_stitching">
                    <span class="glyphicon glyphicon-star"></span>
                    github-analogdevicesinc-adi_3dtof_image_stitching
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>jazzy</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-kilted">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/adi_3dtof_image_stitching">adi_3dtof_image_stitching</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-analogdevicesinc-adi_3dtof_image_stitching
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-analogdevicesinc-adi_3dtof_image_stitching" role="menuitem" tabindex="-1" href="/r/adi_3dtof_image_stitching/github-analogdevicesinc-adi_3dtof_image_stitching" data="github-analogdevicesinc-adi_3dtof_image_stitching">
                    <span class="glyphicon glyphicon-star"></span>
                    github-analogdevicesinc-adi_3dtof_image_stitching
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>kilted</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-rolling">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/adi_3dtof_image_stitching">adi_3dtof_image_stitching</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-analogdevicesinc-adi_3dtof_image_stitching
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-analogdevicesinc-adi_3dtof_image_stitching" role="menuitem" tabindex="-1" href="/r/adi_3dtof_image_stitching/github-analogdevicesinc-adi_3dtof_image_stitching" data="github-analogdevicesinc-adi_3dtof_image_stitching">
                    <span class="glyphicon glyphicon-star"></span>
                    github-analogdevicesinc-adi_3dtof_image_stitching
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>rolling</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-github">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/adi_3dtof_image_stitching">adi_3dtof_image_stitching</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-analogdevicesinc-adi_3dtof_image_stitching
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-analogdevicesinc-adi_3dtof_image_stitching" role="menuitem" tabindex="-1" href="/r/adi_3dtof_image_stitching/github-analogdevicesinc-adi_3dtof_image_stitching" data="github-analogdevicesinc-adi_3dtof_image_stitching">
                    <span class="glyphicon glyphicon-star"></span>
                    github-analogdevicesinc-adi_3dtof_image_stitching
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>github</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-noetic">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/adi_3dtof_image_stitching">adi_3dtof_image_stitching</a> <small>repository</small></h3>
        
        
        <a class="label label-primary pkg-label" href="/p/adi_3dtof_image_stitching">adi_3dtof_image_stitching</a>
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-analogdevicesinc-adi_3dtof_image_stitching
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-analogdevicesinc-adi_3dtof_image_stitching" role="menuitem" tabindex="-1" href="/r/adi_3dtof_image_stitching/github-analogdevicesinc-adi_3dtof_image_stitching" data="github-analogdevicesinc-adi_3dtof_image_stitching">
                    <span class="glyphicon glyphicon-star"></span>
                    github-analogdevicesinc-adi_3dtof_image_stitching
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        
        <div class="panel panel-default">
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">The ADI 3D ToF Image Stitching is a ROS (Robot Operating System) package for stitching Depth images from multiple ADTF3175D Time-Of-Flight sensors to expand the field of view.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/analogdevicesinc/adi_3dtof_image_stitching.git">https://github.com/analogdevicesinc/adi_3dtof_image_stitching.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">noetic-devel</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-03-21
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/adi_3dtof_image_stitching/#noetic-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/adi_3dtof_image_stitching/#noetic-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/adi_3dtof_image_stitching/#noetic-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/adi_3dtof_image_stitching">adi_3dtof_image_stitching</a></td>
                    <td>1.1.0</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 style="text-align: center;"> Analog Devices 3DToF Image Stitching</h1>

<hr>
<h1 id="overview">Overview</h1>
<p>The <strong>ADI 3DToF Image Stitching</strong> is a ROS (Robot Operating System) package for stitching depth images from multiple Time-Of-Flight sensors like ADI’s ADTF3175D ToF sensor. This node subscribes to captured Depth and IR images from multiple <strong>ADI 3DToF ADTF31xx</strong> nodes, stitches them to create a single expanded field of view and publishes the stitched Depth, IR and PointCloud as ROS topics. The node publishes Stitched Depth and IR Images at 2048x512 (16 bits per image) resolution @ 10FPS in realtime mode on <a href="https://www.aaeon.com/en/p/ai-edge-solutions-nvidia-jetson-xavier-nx-boxer-8250ai">AAEON BOXER-8250AI</a>, while stitching inputs from 4 different <a href="https://www.analog.com/en/design-center/evaluation-hardware-and-software/evaluation-boards-kits/EVAL-ADTF3175.html#eb-overview">EVAL-ADTF3175D</a> and giving an expanded FOV of 278 Degrees. Along with the Stitched Depth and IR frames, the Stitched Point Cloud is also published at 10FPS.</p>

<p><a href="http://wiki.ros.org/noetic"><img src="https://img.shields.io/badge/-NOETIC-green?style=plastic&amp;logo=ros" alt="Noetic"></a> <a href="https://releases.ubuntu.com/focal/"><img src="https://img.shields.io/badge/-UBUNTU%2020.04-orange?style=plastic&amp;logo=ubuntu&amp;logoColor=white" alt="Ubuntu 20.04"></a> <a href="https://github.com/analogdevicesinc/adi_3dtof_image_stitching/tree/noetic-devel/./LICENSE"><img src="https://img.shields.io/badge/License-BSD_3--Clause-purple.svg" alt="License"></a> <img src="https://img.shields.io/badge/arm64-blue?style=plastic&amp;logo=arm&amp;logoColor=white" alt="ARM64"> <img src="https://img.shields.io/badge/x86__64-blue?style=plastic&amp;logo=intel&amp;logoColor=white" alt="x86_64"> <img src="https://img.shields.io/badge/-Xavier--NX-green?style=plastic&amp;logo=nvidia&amp;logoColor=white" alt="Nvidia Xavier NX"></p>

<h1 id="background">Background</h1>
<ul>
  <li>Supported Time-of-flight boards: <a href="https://www.analog.com/en/products/adtf3175.html">ADTF3175D</a>
</li>
  <li>Supported ROS and OS distro: Noetic (Ubuntu 20.04)</li>
  <li>Supported platform: armV8 64-bit (arm64) and Intel Core x86_64(amd64) processors(Core i3, Core i5 and Core i7)</li>
</ul>

<h1 id="hardware">Hardware</h1>

<p>For the tested setup with GPU inference support, the following are used:</p>
<ul>
  <li>4 x <a href="https://www.analog.com/en/design-center/evaluation-hardware-and-software/evaluation-boards-kits/EVAL-ADTF3175.html#eb-overview">EVAL-ADTF3175D</a>
</li>
  <li>1 x <a href="https://www.aaeon.com/en/p/ai-edge-solutions-nvidia-jetson-xavier-nx-boxer-8250ai">AAEON BOXER-8250AI</a>
</li>
  <li>1 x External 12V power supply</li>
  <li>4 x Usb type-c to type-A cables - with 5gbps data speed support</li>
</ul>

<p>Minimum requirements for a test setup on host laptop/computer CPU:</p>
<ul>
  <li>2 x <a href="https://www.analog.com/en/design-center/evaluation-hardware-and-software/evaluation-boards-kits/EVAL-ADTF3175.html#eb-overview">EVAL-ADTF3175D</a>
</li>
  <li>Host laptop with intel i5 or higher cpu running Ubuntu-20.04LTS or WSL2 with Ubuntu-20.04</li>
  <li>2 x USB type-c to type-A cables - with 5gbps data speed support</li>
  <li>USB power hub</li>
</ul>

<blockquote>
  <p>:memo: _Note: Refer the <a href="https://wiki.analog.com/resources/eval/user-guides/eval-adtf3175d-nxz">User Guide</a> to ensure the eval module has adequate power supply during operation.</p>
</blockquote>

<p>The image below shows the connection diagram of the setup (with labels):</p>

<p><img src="https://raw.githubusercontent.com/analogdevicesinc/adi_3dtof_image_stitching/noetic-devel/./docs/images/connection_diagram.PNG" alt="Adi_3dtof_Image_Stitching Connection"></p>

<p>The image below shows the actual setup used (for reference):</p>

<p><img src="https://raw.githubusercontent.com/analogdevicesinc/adi_3dtof_image_stitching/noetic-devel/./docs/images/realtime_setup.PNG" alt="Adi_3dtof_Image_Stitching Actual Setup"></p>

<h1 id="hardware-setup">Hardware setup</h1>
<p>Follow the below mentioned steps to get the hardware setup ready:</p>
<ol>
  <li>Setup the ToF devices with <a href="https://github.com/analogdevicesinc/adi_3dtof_adtf31xx">adi_3dtof_adtf31xx_sensor</a> node following the steps mentioned in the <a href="https://github.com/analogdevicesinc/adi_3dtof_adtf31xx">repository</a>.</li>
  <li>Ensure all devices are running at <code class="language-plaintext highlighter-rouge">10fps</code> by following these <a href="https://github.com/analogdevicesinc/adi_3dtof_image_stitching/tree/noetic-devel/./docs/adtf_device_10_fps_setup.txt">steps</a>.</li>
  <li>Position the cameras properly as per the dimentions shown in the below Diagram.</li>
</ol>

<p><img src="https://raw.githubusercontent.com/analogdevicesinc/adi_3dtof_image_stitching/noetic-devel/./docs/images/camera_positioning_dimentions.PNG" alt="Adi_3dtof_Image_Stitching camera positionning"></p>

<blockquote>
  <p>:memo: <em>Notes</em>:</p>
  <ul>
    <li>Please contact the <code class="language-plaintext highlighter-rouge">Maintainers</code> to get the CAD design for the baseplate setup shown above.</li>
  </ul>
</blockquote>

<ol>
  <li>Finally, connect the devices to the host(Linux PC or AAEON BOXER-8250AI) using usb cables as shown below.</li>
</ol>

<p><img src="https://raw.githubusercontent.com/analogdevicesinc/adi_3dtof_image_stitching/noetic-devel/./docs/images/device_connections.png" alt="Adi_3dtof_Image_Stitching Connections"></p>

<h1 id="software">Software</h1>

<h2 id="software-dependencies">Software Dependencies</h2>
<p>Assumptions before building this package:</p>
<ul>
  <li>Linux System or WSL2(Only Simulation Mode supported) running Ubuntu 20.04LTS</li>
  <li>ROS Noetic: If not installed, follow these <a href="http://wiki.ros.org/noetic/Installation/Ubuntu">steps</a>.</li>
  <li>Setup catkin workspace (with workspace folder named as “catkin_ws”). If not done, follow these <a href="http://wiki.ros.org/ROS/Tutorials/InstallingandConfiguringROSEnvironment#:~:text=you%20installed%20ROS.-,Create%20a%20ROS%20Workspace,-catkin">steps</a>.</li>
  <li>System Date/Time is updated:
Make sure the Date/Time is set properly before compiling and running the application. Connecting to a WiFi network would make sure the Date/Time is set properly.</li>
  <li>NTP server is setup for device Synchronization. If not, please refer this <a href="https://ubuntuforums.org/showthread.php?t=862620">Link</a> to setup NTP server on Host.</li>
</ul>

<p>Software Requirements for Running on <a href="https://www.aaeon.com/en/p/ai-edge-solutions-nvidia-jetson-xavier-nx-boxer-8250ai">AAEON BOXER-8250AI</a> :</p>
<ul>
  <li>Nvidia Jetpack OS 5.0.2 .</li>
  <li>
<a href="https://developer.nvidia.com/cuda-11-4-0-download-archive">CUDA 11.4</a>. It comes preinstalled with Jetpack OS. If not, follow these <a href="https://docs.nvidia.com/cuda/archive/11.4.0/cuda-installation-guide-linux/index.html">steps</a>.</li>
</ul>

<h1 id="clone">Clone</h1>

<ol>
  <li>Clone the repo and checkout the corect release branch/
tag into catkin workspace directory</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nv">$ </span><span class="nb">cd</span> ~/catkin_ws/src
    <span class="nv">$ </span>git clone https://github.com/analogdevicesinc/adi_3dtof_image_stitching.git <span class="nt">-b</span> v1.1.0
    
</code></pre></div></div>

<h1 id="setup">Setup</h1>
<h2 id="build">Build</h2>

<p>Do proper exports first:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">source</span> /opt/ros/&lt;ROS version&gt;/setup.bash

</code></pre></div></div>
<p>Where:</p>
<ul>
  <li>“ROS version” is the user’s actual ROS version</li>
</ul>

<p>Then:</p>

<p>For setup with GPU inference support using CUDA:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd</span> ~/catkin_ws/
<span class="nv">$ </span>catkin_make clean
<span class="nv">$ </span>catkin_make <span class="nt">-DENABLE_GPU</span><span class="o">=</span><span class="nb">true</span> <span class="nt">-DCMAKE_BUILD_TYPE</span><span class="o">=</span>Release <span class="nt">-j2</span>
<span class="nv">$ </span><span class="nb">source </span>devel/setup.bash

</code></pre></div></div>

<p>For setup with CPU inference support using openMP:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd</span> ~/catkin_ws/
<span class="nv">$ </span>catkin_make clean
<span class="nv">$ </span>catkin_make <span class="nt">-DCMAKE_BUILD_TYPE</span><span class="o">=</span>Release <span class="nt">-j2</span>
<span class="nv">$ </span><span class="nb">source </span>devel/setup.bash

</code></pre></div></div>
<h2 id="preparing-the-sensors">Preparing the sensors</h2>

<h3 id="setting-up-the-ip-address">Setting up the IP address</h3>
<p>The default IP address of the sensor is set to <code class="language-plaintext highlighter-rouge">10.42.0.1</code>. It is essential that each sensor has its own IP to avoid conflicts. To do so, ssh into the sensor with the credentials:</p>

<blockquote>

  <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>Username: analog
Password: analog

</code></pre></div>  </div>
</blockquote>

<ol>
  <li>Update the “Address” field in <code class="language-plaintext highlighter-rouge">/etc/systemd/network/20-wired-usb0.network</code> file.</li>
  <li>Update the <code class="language-plaintext highlighter-rouge">ROS_MASTER_URI</code> and <code class="language-plaintext highlighter-rouge">ROS_IP</code> values in <code class="language-plaintext highlighter-rouge">~/.bashrc</code>. For example,</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">export </span><span class="nv">ROS_MASTER_URI</span><span class="o">=</span>http://10.43.0.100:11311
<span class="nv">$ </span><span class="nb">export </span><span class="nv">ROS_IP</span><span class="o">=</span>10.43.0.1

</code></pre></div></div>
<ol>
  <li>Update the server address in <code class="language-plaintext highlighter-rouge">/etc/ntp.conf</code> (<code class="language-plaintext highlighter-rouge">server 10.4x.0.100 iburst</code>)</li>
  <li>Reboot the device and login with the new ip</li>
</ol>

<h3 id="sharing-the-launch-file">Sharing the launch file</h3>
<p>The sensor modules may be missing the required launch files that designate the transforms for the sensors in 3D space, which is essential the image stitching algorithm to work appropriately. to do so, we transfer the appropriate launch file, refer to the table below, to transfer to the corresponding sensor. Refer to the CAD diagram to determine the location and camera tag.
|Camera|Launch file|
|—|—|
|cam1|adi_3dtof_adtf31xx_cam1.launch|
|cam2|adi_3dtof_adtf31xx_cam2.launch|
|cam3|adi_3dtof_adtf31xx_cam3.launch|
|cam4|adi_3dtof_adtf31xx_cam4.launch|</p>

<p>To transfer the launch file</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd</span> ~/catkin_ws/src/adi_3dtof_image_stitching/launch
<span class="nv">$ </span>scp adi_3dtof_adtf31xx_cam1.launch analog@10.42.0.1:/home/analog/catkin_ws/adi_3dtof_adtf31xx/launch

</code></pre></div></div>
<h1 id="nodes">Nodes</h1>

<h2 id="adi_3dtof_image_stitching_node">adi_3dtof_image_stitching_node</h2>

<blockquote>
  <p>:memo: _Note: For those with <cam_name> in the topic names, these are ideally the names assigned for EVAL-ADTF3175D. For example, if there are 2 cameras used, with the names as cam1 and cam2 ,there should be two subscribed topics for depth_image, specifically /tmc_info_0 for camra 1 and then /tmc_info_1 for camera 2._</cam_name></p>
</blockquote>

<h3 id="published-topics">Published topics</h3>

<p>These are the default topic names, topic names can be modified as a ROS parameter.</p>

<ul>
  <li>
<strong>/adi_3dtof_image_stitching/depth_image</strong>
    <ul>
      <li>Stitched 16-bit output Depth image of size 2048X512</li>
    </ul>
  </li>
  <li>
<strong>/adi_3dtof_image_stitching/ir_image</strong>
    <ul>
      <li>Stitched 16-bit output IR image of size 2048X512</li>
    </ul>
  </li>
  <li>
<strong>/adi_3dtof_image_stitching/point_cloud</strong>
    <ul>
      <li>Point cloud 3D model of the stitched environment of size 2048X512X3</li>
    </ul>
  </li>
</ul>

<h3 id="subscriber-topics">Subscriber topics</h3>

<ul>
  <li>**/<cam_name>/ir_image**
</cam_name>    <ul>
      <li>512X512 16-bit IR image from sensor node</li>
    </ul>
  </li>
  <li>**/<cam_name>/depth_image**
</cam_name>    <ul>
      <li>512X512 16-bit Depth image from sensor node</li>
    </ul>
  </li>
  <li>**/<cam_name>/camera_info**
</cam_name>    <ul>
      <li>Camera information of the sensor</li>
    </ul>
  </li>
</ul>

<h3 id="parameters">Parameters</h3>

<blockquote>
  <p>:memo: <em>Notes:</em></p>
  <ul>
    <li><em>If any of these parameters are not set/declared, default values will be used.</em></li>
  </ul>
</blockquote>

<h5 id="adi_3dtof_image_stitching-ros-node-parameters"><em>adi_3dtof_image_stitching ROS Node Parameters</em></h5>

<ul>
  <li>
<strong>param_camera_prefixes</strong> (vector<string>, default: ["cam1","cam2","cam3","cam4"])
</string>    <ul>
      <li>This list indicates the camera names of sensors connected for image stitching.</li>
      <li>we support 2 sensors in minimum and 4 sensors at maximum for a horizontal setup at the moment.</li>
      <li>The camera names must match the camera name assigned in the adi_3dtof_adtf31xx sensor node for the respective sensors.</li>
    </ul>
  </li>
  <li>
<strong>param_camera_link</strong> (String, default: “adi_camera_link”)
    <ul>
      <li>Name of camera Link</li>
    </ul>
  </li>
  <li>
<strong>image_transport</strong> (String, default: “compressedDepth”)
    <ul>
      <li>Indicates if Depth compression is enabled for the inputs comming in from the adi_3dtof_adtf31xx sensor nodes</li>
      <li>set this to “raw” if Depth compression is disabled</li>
    </ul>
  </li>
  <li>
<strong>param_output_mode</strong> (int, default: 0)
    <ul>
      <li>Enables/disables saving of stitched output.</li>
      <li>set this to 1 to enable video output saving.
        <blockquote>
          <p>:memo: _Notes:_Enabling video output slows down the speed of image stitching algorithm.</p>
        </blockquote>
      </li>
    </ul>
  </li>
  <li>
<strong>param_out_file_name</strong> (String, default: “stitched_output.avi”)
    <ul>
      <li>output location to save stitched output if “param_output_mode” is enabled.</li>
    </ul>
  </li>
</ul>

<h1 id="launch">Launch</h1>

<h3 id="simulation-mode">Simulation Mode</h3>

<p>To do a quick test of image Stitching Algorithm, there is a simulation FILEIO setup that you can run.
Idea is, 4 adi_3dtof_adtf31xx sensor nodes will run in FILEIO mode on recorded vectors, publising sensor Depth and IR data which will be subscribed and processed by adi_3dtof_image_stitching node:</p>
<ol>
  <li>adi_3dtof_adtf31xx reads the binary recorded files and publishes depth_image ir_image and camera_info</li>
  <li>The adi_3dtof_image_stitching node subscribes to the incoming data and runs image stitching algorithm on them.</li>
  <li>It then publishes stitched Depth and IR images, along with stitched Point-cloud.</li>
</ol>

<p>The <code class="language-plaintext highlighter-rouge">adi_3dtof_input_video_files</code> folder contains the binary video files which can be obtained by running the <code class="language-plaintext highlighter-rouge">get_video.sh</code> script provided by the release file. This folder is to be located in the <strong>source folder of your <em>workspace</em></strong>. For example <code class="language-plaintext highlighter-rouge">~/catkin_ws/src</code>.</p>

<blockquote>
  <p>:memo: <em>Notes</em>:</p>
  <ul>
    <li>Running the adi_3dtof_image_stitching node in Simulation mode requires the setup of <a href="https://github.com/analogdevicesinc/adi_3dtof_adtf31xx">adi_3dtof_adtf31xx_sensor</a> node to be done before hand.</li>
    <li>It is assumed that both adi_3dtof_image_stitching node and adi_3dtof_adtf31xx node are built in the location “~/catkin_ws/”.</li>
    <li>It is also assumed that the demo vectors folder “adi_3dtof_input_video_files” is copied to the location “~/catkin_ws/src/”. (please refer the “arg_in_file_name” in the launch files)</li>
  </ul>
</blockquote>

<p>To proceed with the test, execute these following command:</p>

<table>
  <thead>
    <tr>
      <th>Terminal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>&lt;pre&gt;$cd ~/catkin_ws/ <br>$source /opt/ros/noetic/setup.bash <br>$source devel/setup.bash <br>$roslaunch adi_3dtof_image_stitching adi_3dtof_image_stitching.launch</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>When running the launch file, ensure that sensor mode of all the dependant launch files is set to <code class="language-plaintext highlighter-rouge">2</code>, which sets launch to FILEIO mode.</p>
</blockquote>

<p><strong>Monitor the Output on Rviz Window</strong></p>

<blockquote>
  <p>:memo: <em>Notes:</em></p>
  <ul>
    <li>in Rviz window add display for “/adi_3dtof_image_stitching/depth_image” to monitor the Stitched Depth output.</li>
    <li>Add display for “/adi_3dtof_image_stitching/ir_image” to monitor the Stitched IR output.</li>
    <li>Add display for “/adi_3dtof_image_stitching/point_cloud” to display the 3D point CLoud.</li>
  </ul>
</blockquote>

<h3 id="real-time-mode">Real-Time Mode</h3>
<p>To run the Stitching Algorithm on a real-time setup the adi_3dtof_image_stitching node needs to be launched in Host-Only mode. Idea is, the individual sensors connected to the host computer(Jetson NX host or Laptop) will publish their respective Depth and IR data independently in real-time:</p>
<ol>
  <li>Sensors will publish their respective Depth and IR frames of size 512X512 independently</li>
  <li>The adi_3dtof_image_stitching node will subscribe to th e incomming data from all sensors, synchronize them and run image stitching.</li>
  <li>The stitched output is then published as ROS messages which can be viewed on the Rviz window.</li>
  <li>Stitched output can also be saved into a video file by enabling the “enable_video_out” parameter.</li>
</ol>

<p>To proceed with the test, first execute these following commands on four (4) different terminals (in sequence) to start image capture in the EVAL-ADTF3175D:</p>
<blockquote>
  <p>:memo: <em>Note: This is assuming that we are testing a 4-camera setup to get a 278 degrees FOV. Reduce the number of terminals accordingly for 2 or 3 camera setup</em></p>
</blockquote>

<table>
  <thead>
    <tr>
      <th>Terminal 1</th>
      <th>Terminal 2</th>
      <th>Terminal 3</th>
      <th>Terminal 4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>&lt;pre&gt;~$ ssh analog@[ip of cam1] <br>&gt;cd ~/catkin_ws/ <br>&gt;source /opt/ros/noetic/setup.bash <br>&gt;source devel/setup.bash <br>&gt;roslaunch adi_3dtof_adtf31xx adi_3dtof_cam1.launch</td>
      <td>&lt;pre&gt;~$ ssh analog@[ip of cam2] <br>&gt;cd ~/catkin_ws/ <br>&gt;source /opt/ros/noetic/setup.bash <br>&gt;source devel/setup.bash <br>&gt;roslaunch adi_3dtof_adtf31xx adi_3dtof_cam2.launch</td>
      <td>&lt;pre&gt;~$ ssh analog@[ip of cam3] <br>&gt;cd ~/catkin_ws/ <br>&gt;source /opt/ros/noetic/setup.bash <br>&gt;source devel/setup.bash <br>&gt;roslaunch adi_3dtof_adtf31xx adi_3dtof_cam3.launch</td>
      <td>&lt;pre&gt;~$ ssh analog@[ip of cam4] <br>&gt;cd ~/catkin_ws/ <br>&gt;source /opt/ros/noetic/setup.bash <br>&gt;source devel/setup.bash <br>&gt;roslaunch adi_3dtof_adtf31xx adi_3dtof_cam4.launch</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>:memo: _Notes:</p>
  <ul>
    <li>Its assumed that the adi_3dtof_adtf31xx nodes are already built within the EVAL-ADTF3175D. It is also assumed that adi_3dtof_adtf31xx node are built in the location “~/catkin_ws/” within the sensor modules._</li>
    <li>The credentials to login to the devices is given below</li>
  </ul>

  <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  username: analog
  password: analog
  
</code></pre></div>  </div>
</blockquote>

<p>Next run the adi_3dtof_image_stitching node on Host in the Host-Only mode, by executing the following command:
| Terminal 5 |
— |
| &lt;pre&gt;$cd ~/catkin_ws/ <br>$source /opt/ros/noetic/setup.bash <br>$source devel/setup.bash <br>$roslaunch adi_3dtof_image_stitching adi_3dtof_image_stitching_host_only.launch |</p>

<p>Remember to edit the list of arguments depending on the number of sensors use. For example, if we were to use only three sensors instead of 4, the line is edited to look like:</p>

<p>Before</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">"arg_camera_prefixes"</span> <span class="na">default=</span><span class="s">"[$(arg ns_prefix_cam1),$(arg ns_prefix_cam2),$(arg ns_prefix_cam3),$(arg ns_prefix_cam4)]"</span><span class="nt">/&gt;</span>

</code></pre></div></div>
<p>After</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">"arg_camera_prefixes"</span> <span class="na">default=</span><span class="s">"[$(arg ns_prefix_cam1),$(arg ns_prefix_cam2),$(arg ns_prefix_cam3)]"</span><span class="nt">/&gt;</span>

</code></pre></div></div>
<p>Simply drop the corresponding camera from the list.</p>
<blockquote>
  <p>:memo: <em>Note: It is assumed that both adi_3dtof_image_stitching node is built in the location “~/catkin_ws/”</em>.</p>
</blockquote>

<p><strong>Monitor the Output on Rviz Window</strong></p>

<blockquote>
  <p>:memo: <em>Notes:</em></p>
  <ul>
    <li>in Rviz window add display for “/adi_3dtof_image_stitching/depth_image” to monitor the Stitched Depth output.</li>
    <li>Add display for “/adi_3dtof_image_stitching/ir_image” to monitor the Stitched IR output.</li>
    <li>Add display for “/adi_3dtof_image_stitching/point_cloud” to display the 3D point CLoud.</li>
  </ul>
</blockquote>

<h1 id="limitations">Limitations</h1>
<ol>
  <li>Currently a maximum of 4 sensors and a minimum of 2 sensors are supported for stitching, in the horizontal setup proposed.</li>
  <li>Real-time Operation is not currently supported on WSL2 setups.</li>
  <li>
<a href="https://www.aaeon.com/en/p/ai-edge-solutions-nvidia-jetson-xavier-nx-boxer-8250ai">AAEON BOXER-8250AI</a> slows dows as the device heats up, hence proper cooling mechanism is necessary.</li>
  <li>Subscribing to stitched point cloud for real-time display might slow down the algorithm operation.</li>
</ol>

<h1 id="support">Support</h1>

<p>Please contact the <code class="language-plaintext highlighter-rouge">Maintainers</code> if you want to evaluate the algorithm for your own setup/configuration.</p>

<p>Any other inquiries are also welcome.</p>
</div>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">CONTRIBUTING</h3></div>
          <div class="panel-body">
            
              <em>No CONTRIBUTING.md found.</em>
            
          </div>
        </div>

        
        
      
    </div>
  </div>

  <div class="distro distro-galactic">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/adi_3dtof_image_stitching">adi_3dtof_image_stitching</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-analogdevicesinc-adi_3dtof_image_stitching
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-analogdevicesinc-adi_3dtof_image_stitching" role="menuitem" tabindex="-1" href="/r/adi_3dtof_image_stitching/github-analogdevicesinc-adi_3dtof_image_stitching" data="github-analogdevicesinc-adi_3dtof_image_stitching">
                    <span class="glyphicon glyphicon-star"></span>
                    github-analogdevicesinc-adi_3dtof_image_stitching
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>galactic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-iron">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/adi_3dtof_image_stitching">adi_3dtof_image_stitching</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-analogdevicesinc-adi_3dtof_image_stitching
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-analogdevicesinc-adi_3dtof_image_stitching" role="menuitem" tabindex="-1" href="/r/adi_3dtof_image_stitching/github-analogdevicesinc-adi_3dtof_image_stitching" data="github-analogdevicesinc-adi_3dtof_image_stitching">
                    <span class="glyphicon glyphicon-star"></span>
                    github-analogdevicesinc-adi_3dtof_image_stitching
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>iron</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-melodic">
    <div class="container-fluid">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/adi_3dtof_image_stitching">adi_3dtof_image_stitching</a> <small>repository</small></h3>
        
        

      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" title="Select Instance">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-analogdevicesinc-adi_3dtof_image_stitching
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-analogdevicesinc-adi_3dtof_image_stitching" role="menuitem" tabindex="-1" href="/r/adi_3dtof_image_stitching/github-analogdevicesinc-adi_3dtof_image_stitching" data="github-analogdevicesinc-adi_3dtof_image_stitching">
                    <span class="glyphicon glyphicon-star"></span>
                    github-analogdevicesinc-adi_3dtof_image_stitching
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

      
        <div class="alert alert-warning" role="alert">No version for distro <strong>melodic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>


<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
  $(function() {
    setupContributeListTabLinks();
  });
  $(document).ready(function() {
    setupDistroSwitch("humble");
    setupContributeLists("https://github.com/analogdevicesinc/adi_3dtof_image_stitching.git");
  });
</script>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="container-fluid">
      <div style="float:left;">
        
          <a href="https://github.com/rkent/rosindex" title="Find rosindex in Github">
          <span class="icon  icon--github">
            <svg viewBox="0 0 16 16">
              <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
            </svg>
          </span>

          <span class="username">rkent/rosindex</span>
        </a>
        <em class="hidden-xs">| generated on 2025-05-05</em>
      
      </div>
      <div style="float:right;">
        <p class="text"><span class="hidden-xs">a community-maintained index of robotics software
 | </span><a href="/privacy.txt">privacy</a></p>
      </div>
    </div>
  </div>

</footer>


  </body>

</html>
