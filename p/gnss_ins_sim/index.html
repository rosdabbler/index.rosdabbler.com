<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Package: gnss_ins_sim</title>
    <meta name="description" content="a community-maintained index of robotics software
">

    
    <link rel="canonical" href="http://index.rosdabbler.com/p/gnss_ins_sim/">
    
    
    <link rel="icon" sizes="any" type="image/svg+xml" href="/assets/rosindex_logo.svg">

    

    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">
    

    

    <script type="text/javascript" src=/js/jquery.js></script>
    <script src=/bootstrap/js/bootstrap.min.js type="text/javascript"></script>
    <script src=/js/jquery-cookie.js type="text/javascript"></script>
    
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EVD5Z6G6NH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EVD5Z6G6NH');
</script>

    <script type="text/javascript" src=/js/toc.js></script>

    <script src=/js/distro_switch.js></script>
  </head>

  <body>

    <header class="site-header">

  <div class="wrapper">
    <div class="container-fluid" style="margin-bottom: 10px">
      <div class="row">
        <!-- title -->
        <div class="col-xs-3" style="white-space:nowrap">
          <a class="site-title" href="/">
            <img src="/assets/rosindex_logo.svg" width="26" height="26" alt="ROS index logo" style="padding-bottom: 3px"/>
            ROS Index</a>
        </div>
        <!-- main internal links -->
        <div class="col-xs-6 text-center" style="padding:0px">
          <div class="btn-group hidden-xs" role="group" aria-label="..." style="padding: 6px">
            <div class="btn-group" role="group">
              <a href="/?search_packages=true" class="btn btn-default" role="button">Package List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/?search_repos=true" class="btn btn-default" role="button">Repository List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/search_deps" class="btn btn-default" role="button">System Dependencies</a>
            </div>
          </div>
          <div class="hidden-lg hidden-md hidden-sm">
            <button id="hLabel" class="btn btn-link dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Lists <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="hLabel">
              <li><a href="/?search_packages=true">Package List</a></li>
              <li><a href="/?search_repos=true">Repository List</a></li>
              <li><a href="/search_deps">System Dependencies</a></li>
            </ul>
          </div>
        </div>
        <!-- additional links -->
        <div class="col-xs-3 text-right" style="white-space:nowrap; padding:0px">
          <ul class="list-inline" style="margin-bottom:0px;">
            <li class="dropdown hidden-xs hidden-sm">
              <button id="rLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                ROS Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu" aria-labelledby="rLabel">
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-xs hidden-sm">
              <button id="aLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                About <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="aLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-md hidden-lg">
              <button id="qLabel" class="btn btn-link" type="button"
                      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="qLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
                <hr style="margin:7px" />
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin-top: 20px">
  <div class="container-fluid">
    <div class="row">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/?search_packages=true">Packages</a></li>
        <li class="active">gnss_ins_sim</li>
      </ol>
    </div>
    <div class="row">
      

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
    <label id="humble-option" class="distro-button btn btn-xs btn-default" href="#humble" data="humble">
      <input type="radio" name="options" id="humble-radio" autocomplete="off"> humble
    </label>
  
    <label id="jazzy-option" class="distro-button btn btn-xs btn-default" href="#jazzy" data="jazzy">
      <input type="radio" name="options" id="jazzy-radio" autocomplete="off"> jazzy
    </label>
  
    <label id="kilted-option" class="distro-button btn btn-xs btn-default" href="#kilted" data="kilted">
      <input type="radio" name="options" id="kilted-radio" autocomplete="off"> kilted
    </label>
  
    <label id="rolling-option" class="distro-button btn btn-xs btn-default" href="#rolling" data="rolling">
      <input type="radio" name="options" id="rolling-radio" autocomplete="off"> rolling
    </label>
  
    <label id="github-option" class="distro-button btn btn-xs btn-primary" href="#github" data="github">
      <input type="radio" name="options" id="github-radio" autocomplete="off"> github
    </label>
  
    <label id="noetic-option" class="distro-button btn btn-xs btn-default" href="#noetic" data="noetic">
      <input type="radio" name="options" id="noetic-radio" autocomplete="off"> noetic
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-default" data-toggle="dropdown" id="older-distro-button">
        <input type="radio" name="options" autocomplete="off">
      <span id="older-label">Older</span>
      <span class="caret"></span>
    </label>
    <ul class="dropdown-menu" role="menu">
      
        <li data="galactic" id="galactic-option" class="disabled older-distro-option"  href="#galactic">
          <a href="#galactic" data="galactic" id="galactic-button">galactic</a>
        </li>
      
        <li data="iron" id="iron-option" class="disabled older-distro-option"  href="#iron">
          <a href="#iron" data="iron" id="iron-button">iron</a>
        </li>
      
        <li data="melodic" id="melodic-option" class="disabled older-distro-option"  href="#melodic">
          <a href="#melodic" data="melodic" id="melodic-button">melodic</a>
        </li>
      
    </ul>
  </div>
</div>

    </div>
    <div class="row">
      &nbsp;
    </div>
  </div>
</div>


  <div class="distro distro-humble">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>humble</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-jazzy">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>jazzy</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-kilted">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>kilted</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-rolling">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>rolling</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-github">
    <div class="container-fluid">
      
        
        
        

        <div class="row">
          <div class="col-md-10">
            

<div class="well well-sm">
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px" src="/assets/package.png">
      </td>
      <td>
        <h3 style="margin-top: 5px">
          <a style="text-decoration:none" href="/p/gnss_ins_sim">gnss_ins_sim</a> <small>package from <a style="text-decoration:none" href="/r/localization_for_autonomous_driving/github-gezp-localization_for_autonomous_driving">localization_for_autonomous_driving</a> repo</small>
        </h3>
          
            
            
              <a class="label label-primary pkg-label" href="/p/graph_based_localization">

graph_based_localization
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/imu_odometry">

imu_odometry
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/kf_based_localization">

kf_based_localization
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/lidar_localization">

lidar_localization
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/lidar_mapping">

lidar_mapping
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/lidar_odometry">

lidar_odometry
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/localization_common">

localization_common
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/localization_interfaces">

localization_interfaces
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/loosely_lio_mapping">

loosely_lio_mapping
</a>
            
          
            
            
              <span class="label label-default pkg-label">

gnss_ins_sim
</span>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/ndt_omp_ros2">

ndt_omp_ros2
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/scan_context">

scan_context
</a>
            
          
      </td>
    </tr>
  </table>
</div>

            <div class="visible-xs visible-sm">
              
              
              



<div class="list-group list-group-sm list-group-horizontal list-group-justified">
  <a class="list-group-item text-center"
     target="_blank"
     href="http://docs.ros.org/en/github/p/gnss_ins_sim"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       <br>
       API Docs
  </a>
  <a class="list-group-item text-center"
     target="_blank"
     href="https://github.com/gezp/localization_for_autonomous_driving/tree/humble/third_party/gnss_ins_sim"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       <br>
       Browse Code
  </a>
  
  
  
  
  
  
</div>

            </div>
            



<ul class="nav nav-tabs nav-justified" id="github-tabs" style="margin-bottom:20px">
  <li class="better-tabs active">
    <a href="#github-overview" data-toggle="tab">Overview</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    
    <a href="#github-assets" data-toggle="tab"><span class="label label-default">0</span> Assets</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    <a href="#github-deps" data-toggle="tab"><span class="label label-primary">2</span> Dependencies</a>
  </li>
  <li class="better-tabs">
    
    <a href="#github-tutorials" data-toggle="tab"><span class="label label-default">0</span> Tutorials</a>
  </li>
  <li class="better-tabs">
    <a href="#github-questions" data-toggle="tab"><span id="github-questions-count" class="label label-primary">0</span> Q & A</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="github-overview">
    
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h4 class="panel-title">Package Summary</h4></div>
          <div class="panel-body">
            <table class="table table-condensed">
              <tr>
                <td style="width:100px;" class="text-right"><strong>Tags</strong></td>
                <td>
                  
                  
                    <em>No category tags.</em>
                  
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Version</strong></td>
                <td>0.0.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>License</strong></td>
                <td>Apache-2.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>Build type</strong></td>
                <td>
                  
                    <span class="label label-default">
                  
                    AMENT_CMAKE</span>
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Use</strong></td>
                <td>
                
                  <span class="label label-success">RECOMMENDED</span>
                
                </td>
              </tr>
            </table>
          </div>
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body">
            
            
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">localization for autonomous driving based on ROS2.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/gezp/localization_for_autonomous_driving.git">https://github.com/gezp/localization_for_autonomous_driving.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">humble</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2024-08-18
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          <span class="label label-warning">UNKNOWN
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="No CI information available for this package.">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-default">UNRELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <span class="label label-default">localization</span> <span class="label label-default">slam</span> <span class="label label-default">autonomous-driving</span> <span class="label label-default">ros2</span> 
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/localization_for_autonomous_driving/#github-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/localization_for_autonomous_driving/#github-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/localization_for_autonomous_driving/#github-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Package Description</h3></div>
          <div class="panel-body">
            ROS package wrapper for gnss_ins_sim, https://github.com/Aceinna/gnss-ins-sim
          </div>
          <div class="panel-heading"><h4 class="panel-title">Additional Links</h4></div>
          <div class="panel-body">
            
            
              <em>No additional links.</em>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Maintainers</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Aceinna</li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Authors</h4></div>
          <div class="panel-body">
            
            
              <em>No additional authors.</em>
            
          </div>
        </div>
      </div>
    </div>
    
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-heading"><span class="glyphicon glyphicon-file"></span><a href="https://github.com/gezp/localization_for_autonomous_driving/tree/humble/third_party/gnss_ins_sim/README.md" title="Open in git repository">third_party/gnss_ins_sim/README.md</a></div>
              <div class="panel-body">
                    <div class="rendered-markdown">
<h1 id="gnss-ins-sim">GNSS-INS-SIM</h1>

<p>Copy from <a href="https://github.com/Aceinna/gnss-ins-sim">gnss-ins-sim</a>: 020ca3798e931813c6e394ba822d4d3c43218a0f</p>

<p><strong>GNSS-INS-SIM</strong> is an GNSS/INS simulation project, which generates reference trajectories, IMU sensor output, GPS output, odometer output and magnetometer output. Users choose/set up the sensor model, define the waypoints and provide algorithms, and <strong>gnss-ins-sim</strong> can generate required data for the algorithms, run the algorithms, plot simulation results, save simulations results, and generate a brief summary.</p>

<h1 id="contents">Contents</h1>

<hr>

<ul>
  <li><a href="https://github.com/gezp/localization_for_autonomous_driving/tree/humble/third_party/gnss_ins_sim/#requirements">Requirements</a></li>
  <li><a href="https://github.com/gezp/localization_for_autonomous_driving/tree/humble/third_party/gnss_ins_sim/#demos">Demos</a></li>
  <li>
<a href="https://github.com/gezp/localization_for_autonomous_driving/tree/humble/third_party/gnss_ins_sim/#get-started">Get started</a>
    <ul>
      <li><a href="https://github.com/gezp/localization_for_autonomous_driving/tree/humble/third_party/gnss_ins_sim/#step-1-define-the-imu-model">Step 1 Define the IMU model</a></li>
      <li><a href="https://github.com/gezp/localization_for_autonomous_driving/tree/humble/third_party/gnss_ins_sim/#step-2-create-a-motion-profile">Step 2 Create a motion profile</a></li>
      <li><a href="https://github.com/gezp/localization_for_autonomous_driving/tree/humble/third_party/gnss_ins_sim/#step-3-create-your-algorithm">Step 3 Create your algorithm</a></li>
      <li><a href="https://github.com/gezp/localization_for_autonomous_driving/tree/humble/third_party/gnss_ins_sim/#step-4-run-the-simulation">Step 4 Run the simulation</a></li>
      <li><a href="https://github.com/gezp/localization_for_autonomous_driving/tree/humble/third_party/gnss_ins_sim/#step-5-show-results">Step 5 Show results</a></li>
    </ul>
  </li>
  <li><a href="https://github.com/gezp/localization_for_autonomous_driving/tree/humble/third_party/gnss_ins_sim/#Acknowledgement">Acknowledgement</a></li>
</ul>

<h1 id="requirements">Requirements</h1>

<ul>
  <li>Numpy ( version&gt;1.10 )</li>
  <li>Matplotlib</li>
</ul>

<h1 id="demos">Demos</h1>

<p>We provide the following demos to show how to use this tool:</p>

<table>
  <thead>
    <tr>
      <th>file name</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>demo_no_algo.py</td>
      <td>A demo of generating data, saving generated data to files and plotting (2D/3D)interested data, no user specified algorithm.</td>
    </tr>
    <tr>
      <td>demo_allan.py</td>
      <td>A demo of Allan analysis of gyroscope and accelerometer data. The generated Allan deviation is shown in figures.</td>
    </tr>
    <tr>
      <td>demo_free_integration.py</td>
      <td>A demo of a simple strapdown system. The simulation runs for 1000 times. The statistics of the INS results of the 1000 simulations are generated.</td>
    </tr>
    <tr>
      <td>demo_inclinometer_mahony.py</td>
      <td>A demo of an dynamic inclinometer algorithm based on Mahony’s theory. This demo shows how to generate error plot of interested data.</td>
    </tr>
    <tr>
      <td>demo_aceinna_vg.py</td>
      <td>A demo of DMU380 dynamic tilt algorithm. The algorithm is first compiled as a shared library. This demo shows how to call the shared library. This is the algorithm inside Aceinna’s VG/MTLT products.</td>
    </tr>
    <tr>
      <td>demo_aceinna_ins.py</td>
      <td>A demo of DMU380 GNSS/INS fusion algorithm. The algorithm is first compiled as a shared library. This demo shows how to call the shared library. This is the algorithm inside Aceinna’s INS products.</td>
    </tr>
    <tr>
      <td>demo_multiple_algorithms.py</td>
      <td>A demo of multiple algorithms in a simulation. This demo shows how to compare resutls of multiple algorithm.</td>
    </tr>
    <tr>
      <td>demo_gen_data_from_files.py</td>
      <td>This demo shows how to do simulation from logged data files.</td>
    </tr>
  </tbody>
</table>

<h1 id="get-started">Get started</h1>

<h2 id="step-1-define-the-imu-model">Step 1 Define the IMU model</h2>

<h3 id="step-11-define-the-imu-error-model">Step 1.1 Define the IMU error model</h3>

<p>IMU error model can be specified in two ways:</p>

<h4 id="choose-a-built-in-model">Choose a built-in model</h4>

<p>There are three built-in IMU models: ‘low-accuracy’, ‘mid-accuracy’ and ‘high accuracy’.</p>

<h4 id="manually-define-the-model">Manually define the model</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">imu_err</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># gyro bias, deg/hr
</span>            <span class="sh">'</span><span class="s">gyro_b</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span>
            <span class="c1"># gyro angle random walk, deg/rt-hr
</span>            <span class="sh">'</span><span class="s">gyro_arw</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]),</span>
            <span class="c1"># gyro bias instability, deg/hr
</span>            <span class="sh">'</span><span class="s">gyro_b_stability</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">]),</span>
            <span class="c1"># gyro bias instability correlation, sec.
</span>            <span class="c1"># set this to 'inf' to use a random walk model
</span>            <span class="c1"># set this to a positive real number to use a first-order Gauss-Markkov model
</span>            <span class="sh">'</span><span class="s">gyro_b_corr</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mf">100.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">]),</span>
            <span class="c1"># accelerometer bias, m/s^2
</span>            <span class="sh">'</span><span class="s">accel_b</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mf">0.0e-3</span><span class="p">,</span> <span class="mf">0.0e-3</span><span class="p">,</span> <span class="mf">0.0e-3</span><span class="p">]),</span>
            <span class="c1"># accelerometer velocity random walk, m/s/rt-hr
</span>            <span class="sh">'</span><span class="s">accel_vrw</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mf">0.03119</span><span class="p">,</span> <span class="mf">0.03009</span><span class="p">,</span> <span class="mf">0.04779</span><span class="p">]),</span>
            <span class="c1"># accelerometer bias instability, m/s^2
</span>            <span class="sh">'</span><span class="s">accel_b_stability</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mf">4.29e-5</span><span class="p">,</span> <span class="mf">5.72e-5</span><span class="p">,</span> <span class="mf">8.02e-5</span><span class="p">]),</span>
            <span class="c1"># accelerometer bias instability correlation, sec. Similar to gyro_b_corr
</span>            <span class="sh">'</span><span class="s">accel_b_corr</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mf">200.0</span><span class="p">,</span> <span class="mf">200.0</span><span class="p">,</span> <span class="mf">200.0</span><span class="p">]),</span>
            <span class="c1"># magnetometer noise std, uT
</span>            <span class="sh">'</span><span class="s">mag_std</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
          <span class="p">}</span>

</code></pre></div></div>

<h3 id="step-12-create-an-imu-object">Step 1.2 Create an IMU object</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">imu</span> <span class="o">=</span> <span class="n">imu_model</span><span class="p">.</span><span class="nc">IMU</span><span class="p">(</span><span class="n">accuracy</span><span class="o">=</span><span class="n">imu_err</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">gps</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">imu</span> <span class="o">=</span> <span class="n">imu_model</span><span class="p">.</span><span class="nc">IMU</span><span class="p">(</span><span class="n">accuracy</span><span class="o">=</span><span class="sh">'</span><span class="s">low-accuracy</span><span class="sh">'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">gps</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

</code></pre></div></div>

<p>axis = 6 to generate only gyro and accelerometer data.</p>

<p>axis = 9 to generate magnetometer data besides gyro and accelerometer data.</p>

<p>gps = True to generate GPS data, gps = False not.</p>

<h2 id="step-2-create-a-motion-profile">Step 2 Create a motion profile</h2>

<p>A motion profile specifies the initial states of the vehicle and motion command that drives the vehicle to move, as shown in the following table.</p>

<table>
  <thead>
    <tr>
      <th>Ini lat (deg)</th>
      <th>ini lon (deg)</th>
      <th>ini alt (m)</th>
      <th>ini vx_body (m/s)</th>
      <th>ini vy_body (m/s)</th>
      <th>ini vz_body (m/s)</th>
      <th>ini yaw (deg)</th>
      <th>ini pitch (deg)</th>
      <th>ini roll (deg)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>32</td>
      <td>120</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>command type</td>
      <td>yaw (deg)</td>
      <td>pitch (deg)</td>
      <td>roll (deg)</td>
      <td>vx_body (m/s)</td>
      <td>vy_body (m/s)</td>
      <td>vz_body (m/s)</td>
      <td>command duration (s)</td>
      <td>GPS visibility</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>200</td>
      <td>1</td>
    </tr>
    <tr>
      <td>…</td>
      <td>…</td>
      <td>…</td>
      <td>…</td>
      <td>…</td>
      <td>…</td>
      <td>…</td>
      <td>…</td>
      <td>…</td>
    </tr>
  </tbody>
</table>

<p>The initial position should be given in the LLA (latitude, longitude and altitude) form. The initial velocity is specified in the vehicle body frame. The initial attitude is represented by Euler angles of ZYX rotation sequence.</p>

<p>Motion commands define how the vehicle moves from its initial state. The simulation will generate true angular velocity, acceleration, magnetic field, position, velocity and attitude according to the commands. Combined with sensor error models, these true values are used to generate gyroscope, accelerometer, magnetometer and GPS output.
There is only one motion command in the above table. Indeed, you can add more motion commands to specify the attitude and velocity of the vehicle. You can also define GPS visibility of the vehicle for each command.</p>

<p>Five command types are supported, as listed below.</p>

<table>
  <thead>
    <tr>
      <th>Command type</th>
      <th>Comment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>Directly define the Euler angles change rate and body frame velocity change rate. The change rates are given by column 2~7. The units are deg/s and m/s/s. Column 8 gives how long the command will last. If you want to fully control execution time of each command by your own, you should always choose the motion type to be 1</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Define the absolute attitude and absolute velocity to reach. The target attitude and velocity are given by column 2~7. The units are deg and m/s. Column 8 defines the maximum time to execute the command. If actual executing time is less than max time, the remaining time will not be used and the next command will be executed immediately. If the command cannot be finished within max time, the next command will be executed after max time.</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Define attitude change and velocity change. The attitude and velocity changes are given by column 2~7. The units are deg and m/s. Column 8 defines the maximum time to execute the command.</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Define absolute attitude and velocity change. The absolute attitude and velocity change are given by column 2~7. The units are deg and m/s. Column 8 defines the maximum time to execute the command.</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Define attitude change and absolute velocity. The attitude change and absolute velocity are given by column 2~7. The units are deg and m/s. Column 8 defines the maximum time to execute the command.</td>
    </tr>
  </tbody>
</table>

<h3 id="an-example-of-motion-profile">An example of motion profile</h3>

<table>
  <thead>
    <tr>
      <th>Ini lat (deg)</th>
      <th>ini lon (deg)</th>
      <th>ini alt (m)</th>
      <th>ini vx_body (m/s)</th>
      <th>ini vy_body (m/s)</th>
      <th>ini vz_body (m/s)</th>
      <th>ini yaw (deg)</th>
      <th>ini pitch (deg)</th>
      <th>ini roll (deg)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>32</td>
      <td>120</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>command type</td>
      <td>yaw (deg)</td>
      <td>pitch (deg)</td>
      <td>roll (deg)</td>
      <td>vx_body (m/s)</td>
      <td>vy_body (m/s)</td>
      <td>vz_body (m/s)</td>
      <td>command duration (s)</td>
      <td>GPS visibility</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>200</td>
      <td>1</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0</td>
      <td>45</td>
      <td>0</td>
      <td>10</td>
      <td>0</td>
      <td>0</td>
      <td>250</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>10</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>90</td>
      <td>-45</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>25</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>180</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>25</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-180</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>25</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>180</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>25</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-180</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>25</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>180</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>25</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-180</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>25</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
      <td>1</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>10</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<p>The initial latitude, longitude and altitude of the vehicle are 32deg, 120deg and 0 meter, respectively. The initial velocity of the vehicle is 0. The initial Euler angles are 0deg pitch, 0deg roll and 0deg yaw, which means the vehicle is level and its x axis points to the north.</p>

<table>
  <thead>
    <tr>
      <th>command type</th>
      <th>yaw (deg)</th>
      <th>pitch (deg)</th>
      <th>roll (deg)</th>
      <th>vx_body (m/s)</th>
      <th>vy_body (m/s)</th>
      <th>vz_body (m/s)</th>
      <th>command duration (s)</th>
      <th>GPS visibility</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>200</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<p>This command is of type 1. Command type1 directly gives Euler angle change rate and velocity change rate. In this case, they are zeros. That means keep the current state (being static) of the vehicle for 200sec. During this period, GPS is visible.</p>

<table>
  <thead>
    <tr>
      <th>command type</th>
      <th>yaw (deg)</th>
      <th>pitch (deg)</th>
      <th>roll (deg)</th>
      <th>vx_body (m/s)</th>
      <th>vy_body (m/s)</th>
      <th>vz_body (m/s)</th>
      <th>command duration (s)</th>
      <th>GPS visibility</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>5</td>
      <td>0</td>
      <td>45</td>
      <td>0</td>
      <td>10</td>
      <td>0</td>
      <td>0</td>
      <td>250</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<p>This command is of type 5. Command type 5 defines attitude change and absolute velocity. In this case, the pitch angle will be increased by 45deg, and the velocity along the x axis of the body frame will be accelerated to 10m/s. This command should be executed within 250sec.</p>

<table>
  <thead>
    <tr>
      <th>command type</th>
      <th>yaw (deg)</th>
      <th>pitch (deg)</th>
      <th>roll (deg)</th>
      <th>vx_body (m/s)</th>
      <th>vy_body (m/s)</th>
      <th>vz_body (m/s)</th>
      <th>command duration (s)</th>
      <th>GPS visibility</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>3</td>
      <td>90</td>
      <td>-45</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>25</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<p>This command is of type 3. Command type 3 defines attitude change and velocity change. In this case, the yaw angle will be increased by 90deg, which is a right turn. The pitch angle is decreased by 45deg. The velocity of the vehicle does not change. This command should be executed within 25sec.</p>

<p>The following figure shows the trajectory generated from the motion commands in the above table. The trajectory sections corresponding to the above three commands are marked by command types 1, 5 and 3.</p>
<div align="center">
<img width="500" src="https://github.com/Aceinna/gnss-ins-sim/blob/master/gnss_ins_sim/docs/images/motion_profile_demo.png">
</div>

<h2 id="step-3-create-your-algorithm">Step 3 Create your algorithm</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">algo</span> <span class="o">=</span> <span class="n">allan_analysis</span><span class="p">.</span><span class="nc">Allan</span><span class="p">()</span> <span class="c1"># an Allan analysis demo algorithm
</span>
</code></pre></div></div>

<p>An algorithm is an object of a Python class. It should at least include the following members:</p>

<h3 id="selfinput-and-selfoutput">self.input and self.output</h3>

<p>The member variable ‘input’ tells <strong>gnss-ins-sim</strong> what data the algorithm need. ‘input’ is a tuple or list of strings.</p>

<p>The member variable ‘output’ tells <strong>gnss-ins-sim</strong> what data the algorithm returns. ‘output’ is a tuple or list of strings.</p>

<p>Each string in ‘input’ and ‘output’ corresponds to a set of data supported by <strong>gnss-ins-sim</strong>. The following is a list of supported data by <strong>gnss-ins-sim</strong>.</p>

<table>
  <thead>
    <tr>
      <th>name</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>‘ref_frame’</td>
      <td>Reference frame used as the navigation frame and the attitude reference. <br> 0: NED (default), with x axis pointing along geographic north, y axis pointing eastward, z axis pointing downward. Position will be expressed in LLA form, and the velocity of the vehicle relative to the ECEF frame will be expressed in local NED frame. <br> 1: a virtual inertial frame with constant g, x axis pointing along geographic or magnetic north, z axis pointing along g, y axis completing a right-handed coordinate system. Position and velocity will both be in the [x y z] form in this frame. <br> **Notice: For this virtual inertial frame, position is indeed the sum of the initial position in ecef and the relative position in the virutal inertial frame. Indeed, two vectors expressed in different frames should not be added. This is done in this way here just to preserve all useful information to generate .kml files. Keep this in mind if you use this result.</td>
    </tr>
    <tr>
      <td>‘fs’</td>
      <td>Sample frequency of IMU, units: Hz</td>
    </tr>
    <tr>
      <td>‘fs_gps’</td>
      <td>Sample frequency of GNSS, units: Hz</td>
    </tr>
    <tr>
      <td>‘fs_mag’</td>
      <td>Sample frequency of magnetometer, units: Hz</td>
    </tr>
    <tr>
      <td>‘time’</td>
      <td>Time series corresponds to IMU samples, units: sec.</td>
    </tr>
    <tr>
      <td>‘gps_time’</td>
      <td>Time series corresponds to GNSS samples, units: sec.</td>
    </tr>
    <tr>
      <td>‘algo_time’</td>
      <td>Time series corresponding to algorithm output, units: [’s’]. If your algorithm output data rate is different from the input data rate, you should include ‘algo_time’ in the algorithm output.</td>
    </tr>
    <tr>
      <td>‘gps_visibility’</td>
      <td>Indicate if GPS is available. 1 means yes, and 0 means no.</td>
    </tr>
    <tr>
      <td>‘ref_pos’</td>
      <td>True position in the navigation frame. When users choose NED (ref_frame=0) as the navigation frame, positions will be given in the form of [Latitude, Longitude, Altitude], units: [‘rad’, ‘rad’, ‘m’]. When users choose the virtual inertial frame, positions (initial position + positions relative to the  origin of the frame) will be given in the form of [x, y, z], units:  [‘m’, ‘m’, ‘m’].</td>
    </tr>
    <tr>
      <td>‘ref_vel’</td>
      <td>True velocity w.r.t the navigation/reference frame expressed in the NED frame, units: [‘m/s’, ‘m/s’, ‘m/s’].</td>
    </tr>
    <tr>
      <td>‘ref_att_euler’</td>
      <td>True attitude (Euler angles, ZYX rotation sequency), units: [‘rad’, ‘rad’, ‘rad’]</td>
    </tr>
    <tr>
      <td>‘ref_att_quat’</td>
      <td>True attitude (quaternions)</td>
    </tr>
    <tr>
      <td>‘ref_gyro’</td>
      <td>True angular velocity in the body frame, units: [‘rad/s’, ‘rad/s’, ‘rad/s’]</td>
    </tr>
    <tr>
      <td>‘ref_accel’</td>
      <td>True acceleration in the body frame, units: [‘m/s^2’, ‘m/s^2’, ‘m/s^2’]</td>
    </tr>
    <tr>
      <td>‘ref_mag’</td>
      <td>True geomagnetic field in the body frame, units: [‘uT’, ‘uT’, ‘uT’] (only available when axis=9 in IMU object)</td>
    </tr>
    <tr>
      <td>‘ref_gps’</td>
      <td>True GPS position/velocity, [‘rad’, ‘rad’, ‘m’, ‘m/s’, ‘m/s’, ‘m/s’] for NED (LLA), [‘m’, ‘m’, ‘m’, ‘m/s’, ‘m/s’, ‘m/s’] for virtual inertial frame (xyz) (only available when gps=True in IMU object)</td>
    </tr>
    <tr>
      <td>‘gyro’</td>
      <td>Gyroscope measurements, ‘ref_gyro’ with errors</td>
    </tr>
    <tr>
      <td>‘accel’</td>
      <td>Accelerometer measurements, ‘ref_accel’ with errors</td>
    </tr>
    <tr>
      <td>‘mag’</td>
      <td>Magnetometer measurements, ‘ref_mag’ with errors</td>
    </tr>
    <tr>
      <td>‘gps’</td>
      <td>GPS measurements, ‘ref_gps’ with errors</td>
    </tr>
    <tr>
      <td>‘ad_gyro’</td>
      <td>Allan std of gyro, units: [‘rad/s’, ‘rad/s’, ‘rad/s’]</td>
    </tr>
    <tr>
      <td>‘ad_accel’</td>
      <td>Allan std of accel, units: [‘m/s2’, ‘m/s2’, ‘m/s2’]</td>
    </tr>
    <tr>
      <td>‘pos’</td>
      <td>Simulation position from algo, units: [‘rad’, ‘rad’, ‘m’] for NED (LLA), [‘m’, ‘m’, ‘m’] for virtual inertial frame (xyz).</td>
    </tr>
    <tr>
      <td>‘vel’</td>
      <td>Simulation velocity from algo, units: [‘m/s’, ‘m/s’, ‘m/s’]</td>
    </tr>
    <tr>
      <td>‘att_euler’</td>
      <td>Simulation attitude (Euler, ZYX)  from algo, units: [‘rad’, ‘rad’, ‘rad’]</td>
    </tr>
    <tr>
      <td>‘att_quat’</td>
      <td>Simulation attitude (quaternion)  from algo</td>
    </tr>
    <tr>
      <td>‘wb’</td>
      <td>Gyroscope bias estimation, units: [‘rad/s’, ‘rad/s’, ‘rad/s’]</td>
    </tr>
    <tr>
      <td>‘ab’</td>
      <td>Accelerometer bias estimation, units: [‘m/s^2’, ‘m/s^2’, ‘m/s^2’]</td>
    </tr>
    <tr>
      <td>‘gyro_cal’</td>
      <td>Calibrated gyro output, units: [‘rad/s’, ‘rad/s’, ‘rad/s’]</td>
    </tr>
    <tr>
      <td>‘accel_cal’</td>
      <td>Calibrated acceleromter output, units: [‘m/s^2’, ‘m/s^2’, ‘m/s^2’]</td>
    </tr>
    <tr>
      <td>‘mag_cal’</td>
      <td>Calibrated magnetometer output, units: [‘uT’, ‘uT’, ‘uT’]</td>
    </tr>
    <tr>
      <td>‘soft_iron’</td>
      <td>3x3 soft iron calibration matrix</td>
    </tr>
    <tr>
      <td>‘hard_iron’</td>
      <td>Hard iron calibration, units: [‘uT’, ‘uT’, ‘uT’]</td>
    </tr>
  </tbody>
</table>

<h3 id="selfrunself-set_of_input">self.run(self, set_of_input)</h3>

<p>This is the main procedure of the algorithm. <strong>gnss-ins-sim</strong> will call this procedure to run the algorithm.
‘set_of_input’ is a list of data that is consistent with self.input.
For example, if you set self.input = [‘fs’, ‘accel’, ‘gyro’], you should get the corresponding data this way:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">set_of_input</span><span class="p">):</span>
      <span class="c1"># get input
</span>      <span class="n">fs</span> <span class="o">=</span> <span class="n">set_of_input</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
      <span class="n">accel</span> <span class="o">=</span> <span class="n">set_of_input</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
      <span class="n">gyro</span> <span class="o">=</span> <span class="n">set_of_input</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

</code></pre></div></div>

<h3 id="selfget_resultsself">self.get_results(self)</h3>

<p><strong>gnss-ins-sim</strong> will call this procedure to get resutls from the algorithm. The return should be consistent with self.output.
For example, if you set self.output = [‘allan_t’, ‘allan_std_accel’, ‘allan_std_gyro’], you should return the results this way:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">get_results</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
      <span class="n">self</span><span class="p">.</span><span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">tau</span><span class="p">,</span>
                      <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="n">avar_ax</span><span class="p">,</span> <span class="n">avar_ay</span><span class="p">,</span> <span class="n">avar_az</span><span class="p">]).</span><span class="n">T</span><span class="p">,</span>
                      <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="n">avar_wx</span><span class="p">,</span> <span class="n">avar_wy</span><span class="p">,</span> <span class="n">avar_wz</span><span class="p">]).</span><span class="n">T</span><span class="p">]</span>
      <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">results</span>

</code></pre></div></div>

<h3 id="selfresetself">self.reset(self)</h3>

<p><strong>gnss-ins-sim</strong> will call this procedure after run the algorithm. This is necessary when you want to run the algorithm more than one time and some states of the algorithm should be reinitialized.</p>

<h2 id="step-4-run-the-simulation">Step 4 Run the simulation</h2>

<h3 id="step-41-create-the-simulation-object">step 4.1 Create the simulation object</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">sim</span> <span class="o">=</span> <span class="n">ins_sim</span><span class="p">.</span><span class="nc">Sim</span><span class="p">(</span>
        <span class="c1"># sample rate of imu (gyro and accel), GPS and magnetometer
</span>        <span class="p">[</span><span class="n">fs</span><span class="p">,</span> <span class="n">fs_gps</span><span class="p">,</span> <span class="n">fs_mag</span><span class="p">],</span>
        <span class="c1"># initial conditions and motion definition,
</span>        <span class="c1"># see IMU in ins_sim.py for details
</span>        <span class="n">data_path</span><span class="o">+</span><span class="sh">"</span><span class="s">//motion_def-90deg_turn.csv</span><span class="sh">"</span><span class="p">,</span>
        <span class="c1"># reference frame
</span>        <span class="n">ref_frame</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="c1"># the imu object created at step 1
</span>        <span class="n">imu</span><span class="p">,</span>
        <span class="c1"># vehicle maneuver capability
</span>        <span class="c1"># [max accel, max angular accel, max angular rate]
</span>        <span class="n">mode</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]),</span>
        <span class="c1"># specifies the vibration model for IMU
</span>        <span class="n">env</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="c1">#env=np.genfromtxt(data_path+'//vib_psd.csv', delimiter=',', skip_header=1),
</span>        <span class="c1"># the algorithm object created at step 2
</span>        <span class="n">algorithm</span><span class="o">=</span><span class="n">algo</span><span class="p">)</span>

</code></pre></div></div>

<p><strong>gnss-ins-sim</strong> supports running multiple algorithms in one simulation. You can refer to demo_multiple_algorihtms.py for example.</p>

<p>There are three kinds of vibration models: random, sinusoidal and PSD.</p>

<table>
  <thead>
    <tr>
      <th>Acceleration vibration model</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>‘[nx ny nz]g-random’</td>
      <td>normal-distribution random vibration, rms is n*9.8 m/s^2</td>
    </tr>
    <tr>
      <td>‘[nx ny nz]-random’</td>
      <td>normal-distribution random vibration, rms is n m/s^2</td>
    </tr>
    <tr>
      <td>‘[nx ny nz]g-mHz-sinusoidal’</td>
      <td>sinusoidal vibration of m Hz, amplitude is n*9.8 m/s^2</td>
    </tr>
    <tr>
      <td>‘[nx ny nz]-mHz-sinusoidal’</td>
      <td>sinusoidal vibration of m Hz, amplitude is n m/s^2</td>
    </tr>
    <tr>
      <td>numpy array of size (n,4)</td>
      <td>single-sided PSD. The four columns are [freqency, x, y, z], in units of (m/s^2)^2/Hz</td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>For the vibratoin model of the gyro, it is similar as that of the acceleration except that the unit is default to rad/s and ‘d’ is used to change the unit to be deg/s.</p>

<p>The following example sets random vibration to accel with RMS for x/y/z axis being 1, 2 and 3 m/s^2, respectively, and sets sinusoidal vibration to gyro with frequency being 0.5Hz and amplitude for x/y/z axis being 6, 5 and 4 deg/s, respectively.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    env = {'acc': '[1 2 3]-random',
           'gyro': '[6 5 4]d-0.5Hz-sinusoidal'}

</code></pre></div></div>
<h3 id="step-42-run-the-simulation">Step 4.2 Run the simulation</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sim</span><span class="p">.</span><span class="nf">run</span><span class="p">()</span>     <span class="c1"># run for 1 time
</span><span class="n">sim</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="c1"># run for 1 time
</span><span class="n">sim</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># run for 100 times
</span>
</code></pre></div></div>

<h2 id="step-5-show-results">Step 5 Show results</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># generate a simulation summary,
# and save the summary and all data in directory './data'.
# You can specify the directory.
</span><span class="n">sim</span><span class="p">.</span><span class="nf">results</span><span class="p">(</span><span class="sh">'</span><span class="s">./data/</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># generate a simulation summary, do not save any file
</span><span class="n">sim</span><span class="p">.</span><span class="nf">results</span><span class="p">()</span>

<span class="c1"># plot interested data
</span><span class="n">sim</span><span class="p">.</span><span class="nf">plot</span><span class="p">([</span><span class="sh">'</span><span class="s">ref_pos</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">gyro</span><span class="sh">'</span><span class="p">],</span> <span class="n">opt</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">ref_pos</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">3d</span><span class="sh">'</span><span class="p">})</span>

</code></pre></div></div>

<h1 id="acknowledgement">Acknowledgement</h1>

<ul>
  <li>Geomagnetic field model <a href="https://github.com/cmweiss/geomag/tree/master/geomag">https://github.com/cmweiss/geomag/tree/master/geomag</a>
</li>
  <li>MRepo <a href="http://www.instk.org/">http://www.instk.org</a>
</li>
</ul>
</div>
              </div>
            </div>
          </div>
        </div>
      
    
    <div class="row">
      <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-heading"><span class="glyphicon glyphicon-list"></span> CHANGELOG</div>
          <div class="panel-body">
            
              <em>No CHANGELOG found.</em>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="github-tutorials">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wiki Tutorials</h3>
      </div>
      <div class="panel-body">
        
        <em>This package does not provide any links to tutorials in it's <a href="https://index.ros.org/contribute/metadata/">rosindex metadata</a>.</em>
        <em>You can check on the <a href="http://wiki.ros.org/gnss_ins_sim/Tutorials" target="_blank">ROS Wiki Tutorials</a> page for the package.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="github-deps">
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Package Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th class="text-center">Deps</th>
                  <th style="width: 100%">Name</th>
                </thead>
                <tbody>
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake#github-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake#github">ament_cmake  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_python#github-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_python#github">ament_cmake_python  </a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
          <div class="panel-heading">
            <h3 class="panel-title">System Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <em>No direct system dependencies.</em>
            
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Dependant Packages</h3>
          </div>
          <div class="panel-body">
            
              <em>No known dependants.</em>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="github-assets">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Launch files</h3>
      </div>
      <div class="panel-body">
        
          <em>No launch files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Messages</h3>
      </div>
      <div class="panel-body">
        
          <em>No message files found.</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Services</h3>
      </div>
      <div class="panel-body">
        
          <em>No service files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Plugins</h3>
      </div>
      <div class="panel-body">
        
          <em>No plugins found.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="github-questions">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent questions tagged <kbd>gnss_ins_sim</kbd> at <strong><a href="https://robotics.stackexchange.com/" target="_blank">Robotics Stack Exchange</a></strong></h3>      </div>
      <div id="github-question-list" class="panel-body" style="display: none;"></div>
      <div id="github-no-question-list" class="panel-body" style="display: none;">
        <p>No questions yet, you can ask one <a href="https://robotics.stackexchange.com/questions/tagged/gnss_ins_sim+github">here</a>.</p>
      </div>
      <div id="github-get-question-fail" class="panel-body alert alert-warning" style="display: none;">
        <p>Failed to get question list, you can ticket an issue <a href="https://github.com/ros-infrastructure/rosindex/issues/new" target="_blank" class="alert-link">here</a> </p>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/package_body_tabs.js"></script>

<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
jQuery(function() {
    // Update the count on the links to the contribution suggestions
    updateContributionSuggestionsCountOnPackage('https://github.com/gezp/localization_for_autonomous_driving.git');
});
</script>

          </div>
          <div class="col-md-2 hidden-xs hidden-sm">
            
            
            



<div class="list-group list-group-sm ">
  <a class="list-group-item"
     target="_blank"
     href="http://docs.ros.org/en/github/p/gnss_ins_sim"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       
       API Docs
  </a>
  <a class="list-group-item"
     target="_blank"
     href="https://github.com/gezp/localization_for_autonomous_driving/tree/humble/third_party/gnss_ins_sim"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       
       Browse Code
  </a>
  
  
  
  
  
  
</div>

          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-noetic">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>noetic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-galactic">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>galactic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-iron">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>iron</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-melodic">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>melodic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>



<script id="question-list-template" type="text/html">
  <p>
    Browse <a href="https://robotics.stackexchange.com/questions/tagged/gnss_ins_sim?tab=Newest">recent questions</a>
    or see the <a href="https://robotics.stackexchange.com/questions/tagged/gnss_ins_sim?tab=Votes">highest voted ones</a>.
  </p>
  
  <table class="table table-striped">
    <thead>
      <tr>
        <th scope="col">Title</th>
        <th scope="col">Answered?</th>
        <th scope="col">Created</th>
        <th scope="col">Active</th>
      </tr>
    </thead>
    <tbody>
      {{#questions}}
      <tr>
        <th scope="row"><a href="{{link}}">{{title}}</a><br><small>Tags: {{strtags}}</small></th>
        <th>{{answered}}</th>
        <th>{{created}}</th>
        <th>{{active}}</th>
      </tr>
      {{/questions}}
    </tbody>
  </table>
  {{#has_more}}
  <hr>
  <h4>Additional questions are available at
    <a href="https://robotics.stackexchange.com/questions/tagged/{{name}}?tab=Newest">Robotics Stack Exchange</a>
  </h4>
  {{/has_more}}
  
</script>

<script type="text/javascript" src="/js/mustache.js"></script>
<script type="text/javascript">
  jQuery(function() {
    jQuery.getJSON(url="https://api.stackexchange.com/2.3/questions?order=desc&site=robotics" +
                       "&tagged=gnss_ins_sim&pagesize=50&sort=activity")
    .done(function(feed) {
      if (feed.items.length > 0) {
        var question_count_str = (feed.has_more ? '>' : '') + String(feed.items.length)
        const questions = feed.items.map(
          function(question) {
            question.id = Math.round(Math.random() * 99999.0);
            question.created = (new Date(question.creation_date * 1000)).toDateString()
            question.active = (new Date(question.last_activity_date * 1000)).toDateString()
            question.answered = question.is_answered ? "Yes" : "No"
            question.strtags = question.tags.join(' ')
            return question;
          });
        const template = jQuery("#question-list-template").text();
        Mustache.parse(template);
        var rendered = Mustache.render(
          template, 
          { questions: questions,
            has_more: feed.has_more,
            name: "gnss_ins_sim"
          }
        );
      }
      //   TODO(tfoote) Resolve images
      //   jQuery("#-question-list img").each(function() {
      //     if (jQuery(this).attr("src").startsWith("/upfiles")) {
      //        jQuery(this).attr("src", "https://answers.ros.org" + jQuery(this).attr("src"));
      //     }
      //   });
      
      if (feed.items.length > 0) {
        jQuery("#humble-question-list").html(rendered);
        jQuery("#humble-question-list").show();
      } else {
        jQuery("#humble-no-question-list").show();
      }
      jQuery("#humble-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#jazzy-question-list").html(rendered);
        jQuery("#jazzy-question-list").show();
      } else {
        jQuery("#jazzy-no-question-list").show();
      }
      jQuery("#jazzy-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#kilted-question-list").html(rendered);
        jQuery("#kilted-question-list").show();
      } else {
        jQuery("#kilted-no-question-list").show();
      }
      jQuery("#kilted-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#rolling-question-list").html(rendered);
        jQuery("#rolling-question-list").show();
      } else {
        jQuery("#rolling-no-question-list").show();
      }
      jQuery("#rolling-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#github-question-list").html(rendered);
        jQuery("#github-question-list").show();
      } else {
        jQuery("#github-no-question-list").show();
      }
      jQuery("#github-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#noetic-question-list").html(rendered);
        jQuery("#noetic-question-list").show();
      } else {
        jQuery("#noetic-no-question-list").show();
      }
      jQuery("#noetic-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#galactic-question-list").html(rendered);
        jQuery("#galactic-question-list").show();
      } else {
        jQuery("#galactic-no-question-list").show();
      }
      jQuery("#galactic-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#iron-question-list").html(rendered);
        jQuery("#iron-question-list").show();
      } else {
        jQuery("#iron-no-question-list").show();
      }
      jQuery("#iron-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#melodic-question-list").html(rendered);
        jQuery("#melodic-question-list").show();
      } else {
        jQuery("#melodic-no-question-list").show();
      }
      jQuery("#melodic-questions-count").text(question_count_str);
      
    })
    .fail(function(jqxhr, textStatus, error) {
      console.error("Failed to get question data: " + jqxhr.responseText);
      
      jQuery("#humble-get-question-fail").show();
      
      jQuery("#jazzy-get-question-fail").show();
      
      jQuery("#kilted-get-question-fail").show();
      
      jQuery("#rolling-get-question-fail").show();
      
      jQuery("#github-get-question-fail").show();
      
      jQuery("#noetic-get-question-fail").show();
      
      jQuery("#galactic-get-question-fail").show();
      
      jQuery("#iron-get-question-fail").show();
      
      jQuery("#melodic-get-question-fail").show();
      
    });
  });
</script>


<script type="text/javascript">
  $(document).ready(function() {
    setupDistroSwitch("humble");
  });
</script>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="container-fluid">
      <div style="float:left;">
        
          <a href="https://github.com/rkent/rosindex" title="Find rosindex in Github">
          <span class="icon  icon--github">
            <svg viewBox="0 0 16 16">
              <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
            </svg>
          </span>

          <span class="username">rkent/rosindex</span>
        </a>
        <em class="hidden-xs">| generated on 2025-05-05</em>
      
      </div>
      <div style="float:right;">
        <p class="text"><span class="hidden-xs">a community-maintained index of robotics software
 | </span><a href="/privacy.txt">privacy</a></p>
      </div>
    </div>
  </div>

</footer>


  </body>

</html>
