<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Package: marine_acoustic_msgs</title>
    <meta name="description" content="a community-maintained index of robotics software
">

    
    <link rel="canonical" href="http://index.rosdabbler.com/p/marine_acoustic_msgs/">
    
    
    <link rel="icon" sizes="any" type="image/svg+xml" href="/assets/rosindex_logo.svg">

    

    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">
    

    

    <script type="text/javascript" src=/js/jquery.js></script>
    <script src=/bootstrap/js/bootstrap.min.js type="text/javascript"></script>
    <script src=/js/jquery-cookie.js type="text/javascript"></script>
    
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EVD5Z6G6NH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EVD5Z6G6NH');
</script>

    <script type="text/javascript" src=/js/toc.js></script>

    <script src=/js/distro_switch.js></script>
  </head>

  <body>

    <header class="site-header">

  <div class="wrapper">
    <div class="container-fluid" style="margin-bottom: 10px">
      <div class="row">
        <!-- title -->
        <div class="col-xs-3" style="white-space:nowrap">
          <a class="site-title" href="/">
            <img src="/assets/rosindex_logo.svg" width="26" height="26" alt="ROS index logo" style="padding-bottom: 3px"/>
            ROS Index</a>
        </div>
        <!-- main internal links -->
        <div class="col-xs-6 text-center" style="padding:0px">
          <div class="btn-group hidden-xs" role="group" aria-label="..." style="padding: 6px">
            <div class="btn-group" role="group">
              <a href="/?search_packages=true" class="btn btn-default" role="button">Package List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/?search_repos=true" class="btn btn-default" role="button">Repository List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/search_deps" class="btn btn-default" role="button">System Dependencies</a>
            </div>
          </div>
          <div class="hidden-lg hidden-md hidden-sm">
            <button id="hLabel" class="btn btn-link dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Lists <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="hLabel">
              <li><a href="/?search_packages=true">Package List</a></li>
              <li><a href="/?search_repos=true">Repository List</a></li>
              <li><a href="/search_deps">System Dependencies</a></li>
            </ul>
          </div>
        </div>
        <!-- additional links -->
        <div class="col-xs-3 text-right" style="white-space:nowrap; padding:0px">
          <ul class="list-inline" style="margin-bottom:0px;">
            <li class="dropdown hidden-xs hidden-sm">
              <button id="rLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                ROS Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu" aria-labelledby="rLabel">
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-xs hidden-sm">
              <button id="aLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                About <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="aLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-md hidden-lg">
              <button id="qLabel" class="btn btn-link" type="button"
                      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="qLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
                <hr style="margin:7px" />
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin-top: 20px">
  <div class="container-fluid">
    <div class="row">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/?search_packages=true">Packages</a></li>
        <li class="active">marine_acoustic_msgs</li>
      </ol>
    </div>
    <div class="row">
      

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
    <label id="humble-option" class="distro-button btn btn-xs btn-primary" href="#humble" data="humble">
      <input type="radio" name="options" id="humble-radio" autocomplete="off"> humble
    </label>
  
    <label id="jazzy-option" class="distro-button btn btn-xs btn-primary" href="#jazzy" data="jazzy">
      <input type="radio" name="options" id="jazzy-radio" autocomplete="off"> jazzy
    </label>
  
    <label id="kilted-option" class="distro-button btn btn-xs btn-primary" href="#kilted" data="kilted">
      <input type="radio" name="options" id="kilted-radio" autocomplete="off"> kilted
    </label>
  
    <label id="rolling-option" class="distro-button btn btn-xs btn-primary" href="#rolling" data="rolling">
      <input type="radio" name="options" id="rolling-radio" autocomplete="off"> rolling
    </label>
  
    <label id="github-option" class="distro-button btn btn-xs btn-default" href="#github" data="github">
      <input type="radio" name="options" id="github-radio" autocomplete="off"> github
    </label>
  
    <label id="noetic-option" class="distro-button btn btn-xs btn-primary" href="#noetic" data="noetic">
      <input type="radio" name="options" id="noetic-radio" autocomplete="off"> noetic
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-primary" data-toggle="dropdown" id="older-distro-button">
        <input type="radio" name="options" autocomplete="off">
      <span id="older-label">Older</span>
      <span class="caret"></span>
    </label>
    <ul class="dropdown-menu" role="menu">
      
        <li data="galactic" id="galactic-option" class="disabled older-distro-option"  href="#galactic">
          <a href="#galactic" data="galactic" id="galactic-button">galactic</a>
        </li>
      
        <li data="iron" id="iron-option" class=" older-distro-option"  href="#iron">
          <a href="#iron" data="iron" id="iron-button">iron</a>
        </li>
      
        <li data="melodic" id="melodic-option" class="disabled older-distro-option"  href="#melodic">
          <a href="#melodic" data="melodic" id="melodic-button">melodic</a>
        </li>
      
    </ul>
  </div>
</div>

    </div>
    <div class="row">
      &nbsp;
    </div>
  </div>
</div>


  <div class="distro distro-humble">
    <div class="container-fluid">
      
        
        
        

        <div class="row">
          <div class="col-md-10">
            

<div class="well well-sm">
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px" src="/assets/package.png">
      </td>
      <td>
        <h3 style="margin-top: 5px">
          <a style="text-decoration:none" href="/p/marine_acoustic_msgs">marine_acoustic_msgs</a> <small>package from <a style="text-decoration:none" href="/r/marine_msgs/github-apl-ocean-engineering-marine_msgs">marine_msgs</a> repo</small>
        </h3>
          
            
            
              <span class="label label-default pkg-label">

marine_acoustic_msgs
</span>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/marine_sensor_msgs">

marine_sensor_msgs
</a>
            
          
      </td>
    </tr>
  </table>
</div>

            <div class="visible-xs visible-sm">
              
              
              



<div class="list-group list-group-sm list-group-horizontal list-group-justified">
  <a class="list-group-item text-center"
     target="_blank"
     href="http://docs.ros.org/en/humble/p/marine_acoustic_msgs"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       <br>
       API Docs
  </a>
  <a class="list-group-item text-center"
     target="_blank"
     href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       <br>
       Browse Code
  </a>
  
  
  
  
  
  
</div>

            </div>
            



<ul class="nav nav-tabs nav-justified" id="humble-tabs" style="margin-bottom:20px">
  <li class="better-tabs active">
    <a href="#humble-overview" data-toggle="tab">Overview</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    
    <a href="#humble-assets" data-toggle="tab"><span class="label label-primary">8</span> Assets</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    <a href="#humble-deps" data-toggle="tab"><span class="label label-primary">5</span> Dependencies</a>
  </li>
  <li class="better-tabs">
    
    <a href="#humble-tutorials" data-toggle="tab"><span class="label label-default">0</span> Tutorials</a>
  </li>
  <li class="better-tabs">
    <a href="#humble-questions" data-toggle="tab"><span id="humble-questions-count" class="label label-primary">0</span> Q & A</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="humble-overview">
    
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h4 class="panel-title">Package Summary</h4></div>
          <div class="panel-body">
            <table class="table table-condensed">
              <tr>
                <td style="width:100px;" class="text-right"><strong>Tags</strong></td>
                <td>
                  
                  
                    <em>No category tags.</em>
                  
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Version</strong></td>
                <td>2.1.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>License</strong></td>
                <td>BSD-3-Clause</td>
              </tr>
              <tr>
                <td class="text-right"><strong>Build type</strong></td>
                <td>
                  
                    <span class="label label-default">
                  
                    AMENT_CMAKE</span>
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Use</strong></td>
                <td>
                
                  <span class="label label-success">RECOMMENDED</span>
                
                </td>
              </tr>
            </table>
          </div>
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body">
            
            
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">Messages for DVLs, multibeams, and imaging sonars.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/apl-ocean-engineering/marine_msgs.git">https://github.com/apl-ocean-engineering/marine_msgs.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">ros2</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2024-03-15
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="No CI information available for this package.">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/marine_msgs/#humble-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/marine_msgs/#humble-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/marine_msgs/#humble-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Package Description</h3></div>
          <div class="panel-body">
            The marine_acoustic_msgs package, including messages for common
  underwater sensors (DVL, multibeam sonar, imaging sonar)
  
          </div>
          <div class="panel-heading"><h4 class="panel-title">Additional Links</h4></div>
          <div class="panel-body">
            
            
              <em>No additional links.</em>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Maintainers</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Laura Lindzey</li>
                
                  <li>Roland Arsenault</li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Authors</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Aaron Marburg</li>
                
                  <li>Ian Vaughn</li>
                
                  <li>Kris Krasnosky</li>
                
                  <li>Laura Lindzey</li>
                
                  <li>Roland Arsenault</li>
                
              </ul>
            
          </div>
        </div>
      </div>
    </div>
    
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-heading"><span class="glyphicon glyphicon-file"></span><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/README.md" title="Open in git repository">marine_acoustic_msgs/README.md</a></div>
              <div class="panel-body">
                    <div class="rendered-markdown">
<h2 id="marine_acoustic_msgs">marine_acoustic_msgs</h2>

<p>This package includes messages for three commonly used sensors for research in underwater autonomy:</p>
<ul>
  <li>DVL</li>
  <li>Multibeam</li>
  <li>Imaging Sonar</li>
</ul>

<p>Each of the proposed messages is based on an existing
message that is currently in use across a variety of manufacturers of the
same instrument type. This gives us confidence that they are mature enough
to be indexed in the ROS debs and that they will generalize across other sensors.</p>

<h2 id="coordinate-frame-conventions">Coordinate Frame Conventions</h2>
<p><img src="https://user-images.githubusercontent.com/23006525/167165812-008ccccb-31a7-4c13-b2da-6235d37a7a3b.png" alt="cordiante_conventions"></p>

<h2 id="design-decisions-common-across-multiple-acoustic-messages">Design decisions common across multiple acoustic messages</h2>

<p>Looking at the differences among existing open source UUV messages for
acoustic sensors, there are a number of overarching design decisions to be
made before defining individual messages. The proposed set of messages
adheres to these guidelines:</p>

<ul>
  <li>The messages should be suitable for use across a wide variety of hardware.
    <ul>
      <li>Any sensor-specific metadata fields should be published in a separate message.
Standards for defining these additional messages are beyond the scope of this PR.
However, options include:
        <ul>
          <li>Capture all raw bytes sent to / received from a sensor (e.g. WHOI’s RawData.msg)</li>
          <li>Publish a separate message corresponding exactly to the datagrams
sent by the sensor (e.g. PD0.msg)</li>
          <li>Publish a separate message with the additional data, but no duplication
of the standard message, following the Image/CameraInfo pattern.</li>
        </ul>
      </li>
      <li>In order to support generality for a wide range of sensors, there will be some
fields that are not applicable to some sensors.
        <ul>
          <li>If not supported at all, the array may be left empty.</li>
          <li>If value is constant across the data frame, array may be length 1.</li>
          <li>Otherwise, the length of each array should match the length of the data.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>“raw/temporal” Underwater acoustic messages should include the speed of sound
(field will be called sound_speed) that was used by the sensor, as well as any
information required to raytrace the data with a new sound velocity profile.</li>
  <li>“processed/spatial” acoustic messages will have the ray-tracing already performed.</li>
  <li>The beam geometry is specified as a per-beam vector relative to the frame in
the header. This is an alternative to other approaches that have been used, including:
    <ul>
      <li>additional TF frames for individual beams, which will quickly become unwieldy</li>
      <li>an array of beam messages, where each beam includes its geometry relative
to the sensor. Abstracting out the individual beams doesn’t serve to simplify
the interpretation of the data, and doesn’t enable using an empty vector to
indicate that a field isn’t applicable.</li>
      <li>follow LaserScan convention and derive the geometry from min/max/step,
which doesn’t generalize across sonars, since they do not all have beams
spaced equiangualarly.</li>
    </ul>
  </li>
  <li>Individual message types should be based on how the data is used, rather
than similarities in data format. For example:
    <ul>
      <li>DVL and ADCP messages should not be combined, even though there is
significant overlap in hardware and provided data. Consumers of DVL
data expect a single velocity. Consumers of ADCP data expect velocities
at an array of ranges.</li>
      <li>There is a need for a difference between SonarImage and SonarRanges
(aka multibeam), since they are not typically interchangeable in
downstream processing algorithms, even though the newer sensors are
blurring the lines. A sonar image consists of intensities-vs-time,
while sonar ranges identify discrete returns.</li>
    </ul>
  </li>
  <li>In order to be consistent with other messages in sensor_msgs, message
types should be named after the type of data rather than type of sensor:
    <ul>
      <li>SonarImage.msg instead of ImagingSonar.msg</li>
      <li>SonarRanges.msg instead of Multibeam.msg or ProfilingSonar.msg.</li>
    </ul>
  </li>
</ul>

<h2 id="dvl">DVL</h2>
<h3 id="existing-messages">Existing Messages</h3>

<p>The most widely used messages appear to be:</p>
<ul>
  <li>WHOI’s <a href="https://bitbucket.org/whoidsl/ds_msgs/src/master/ds_sensor_msgs/msg/Dvl.msg">ds_sensor_msgs/Dvl.msg</a>.
It is currently in use with both RDI and Nortek instruments.</li>
  <li>UUV Simulator’s <a href="https://github.com/uuvsimulator/uuv_simulator/blob/master/uuv_sensor_plugins/uuv_sensor_ros_plugins_msgs/msg/DVL.msg">uuv_sensor_ros_plugins_msgs/DVL.msg</a>
(This was used as the base for <a href="https://github.com/udgcirs/marine_ros_conventions_discussion/blob/master/sensor_msgs/DVL.msg">marine_ros_conventions_discussion/DVL.msg</a>)
The main implementation difference between ds_sensor_msgs and uuv_simulator is
whether the top-level DVL message includes the beam data in an array,
or whether there is an array of DvlBeam messages.</li>
  <li>UWSim’s <a href="https://github.com/uji-ros-pkg/underwater_simulation/blob/melodic-devel/underwater_sensor_msgs/msg/DVL.msg">underwater_sensor_msgs/DVL.msg</a>.
It is not particularly idiomatic for a ROS message: Rather than using a
Vector3 for velocity, it has individual fields (wi_{x,y,z}_axis); and
rather than using TF to transform between frames, it includes the data in
instrument-referenced and vehicle-referenced frames within the same message.</li>
</ul>

<p>While all options agree that the DVL message should include aggregate data
from the instrument (estimated altitude and velocity), they differ in what else is included:</p>
<ul>
  <li>Per-beam data (range, velocity, and their covariances): WHOI &amp; UUV Simulator</li>
  <li>Both bottom-track and water-track velocities: WHOI &amp; UWSim</li>
  <li>Additional details about the sensor configuration: WHOI</li>
</ul>

<h3 id="dvl-specific-design-decisions">DVL-specific design decisions</h3>
<ul>
  <li>Is there broad support for including water-track velocity in addition to ground-track in the same message definition?
    <ul>
      <li>NPS is currently interleaving DVL &amp; ADCP messages from the same driver for an instrument that provides both an ADCP profile and a DVL bottom-track velocity. I like this approach.</li>
      <li>If the same message type supports both bottom track and water track (single reading, not profile), maybe there should be a convention that bottom track / water track are published on different topics so subscribing nodes can ignore water track velocities if they don’t use them.</li>
    </ul>
  </li>
  <li>Whether the additional information about the sensor configuration (DVL_TYPE) belongs in the top-level message. Other messages in sensor_msgs do not tend to have similar flags; however, this depends on whether we want to be able to perform sound velocity corrections using the data in the DVL message.</li>
  <li>Does a quality flag belong in the standardized message?</li>
</ul>

<h3 id="proposed-message">Proposed Message</h3>

<p>https://github.com/apl-ocean-engineering/marine_msgs/blob/main/marine_acoustic_msgs/msg/Dvl.msg</p>

<p>This message started with WHOI’s definition, which has been used in
drivers for Nortek and RDI DVLs. There are also corresponding rviz
and gazebo plugins. (I have trivial forks of those plugins supporting the proposed message.)</p>

<p>I propose the following changes from WHOI’s original message:</p>
<ul>
  <li>Remove the ds_header – DsHeader was an attempt to add some hardware-specific
metadata to the sensor processing pipeline. It was never fully implemented,
and isn’t consistent with other definitions in sensor_msgs.</li>
  <li>Remove dvl_time – this was originally intended to support integration of
DVL messages from instruments that only provide a monotonic count rather
than fully-synchronized timestamps. With modern instruments, <code class="language-plaintext highlighter-rouge">header.stamp</code>
should capture a posix time suitable for integrating the reported velocity.</li>
  <li>Replace coordinate_mode with beams_valid flag. The 3D velocity and altitude
should always be reported in the instrument frame which is specified in the
header, and beam ranges/velocities are scalars measured along the corresponding <code class="language-plaintext highlighter-rouge">beam_unit_vec</code>.</li>
  <li>speed_sound -&gt; sound_speed for consistency across acoustic messages</li>
</ul>

<h2 id="multibeam-and-forward-looking-sonar-fls-messages">Multibeam and Forward Looking Sonar (FLS) messages</h2>

<h3 id="organization">Organization</h3>
<p><img src="https://user-images.githubusercontent.com/23006525/160207155-eb9c003e-8a9a-460e-8c1d-6240924e81e6.png" alt="data_structure"></p>

<p>Multibeam and FLS sonar data (referred to as sonar data for brevity) are broken into two type categories, detections and images.   Images are intended to represent Watercolumn or FLS imaging data.   Detections represent a detection reported by the sonar for a given beam.</p>

<p>Sonar data is also organized into two domain categories,  temporal and spatial.  Messages are intended to be initially reported in the temporal domain by the sonar drive then converted to the spatial domain through a processing pipeline.   However, some sonars report images and detections directly in the spatial domain.  In this case, sensor drivers may report directly with the appropriate spatial message.</p>

<h3 id="data-structure">Data structure</h3>
<p>the Sonar messages consist of top level messages:</p>
<ul>
  <li>RawSonarImage</li>
  <li>ProjectedSonarImage</li>
  <li>SonarDetection</li>
  <li>SonarRanges</li>
</ul>

<p>These messages share common data in the following sub-messages:</p>
<ul>
  <li>DetectionFlag</li>
  <li>PingInfo</li>
  <li>SonarImageData</li>
</ul>

<h4 id="sonarimagedata-packing">SonarImageData packing</h4>

<p>It’s worth mentioning how the data is packed in the sonar image message as it may not be obvious.</p>

<ul>
  <li>the actual pixel data is in row-major (i.e beam_no major) order.</li>
  <li>the pixel data is stored as an array of bytes (uint8). It should be cast as the type specified in dtype flag. They are enumerated in the message</li>
  <li>to find the range for each cell: (sample_number + sample0) * sound_speed / (2.0 * sample_rate)</li>
</ul>

<p>The image details details how image data is stored.</p>

<p><img src="https://user-images.githubusercontent.com/23006525/160203744-7fc6b06a-ac3d-4419-b6a9-fec83e07cef7.png" alt="wcl_def"></p>

<h3 id="geometry-conventions">Geometry Conventions</h3>
<p><img src="https://user-images.githubusercontent.com/23006525/167165995-ce578962-be79-4219-89a0-920953ca6cb2.png" alt="rx_tx_detail"></p>

<ul>
  <li>angles/beam directions in the spatial domain shall:
    <ul>
      <li>be reported as unit vectors according to the coordinate frame convention specified above.</li>
      <li>be reported at time reported in the header timestamp.  (at or before transmit time)</li>
    </ul>
  </li>
  <li>angles/beam directions in the temporal domain shall be reported as transmit (Tx) and receive (Rx) angles according to the diagram above
    <ul>
      <li>rx_angle is defined as the elevation from the X-Z plane at receive time. This elevation is positive toward the Y axis.  This elevation defines a cone of possible return directions for a given return beam.</li>
      <li>tx_angle is defined as the elevation from the Y-Z plane at transmit time. This elevation is positive toward the X axis.  This elevation defines a cone that represents the area insonified by the tx pulse.</li>
    </ul>
  </li>
</ul>

<h3 id="style-conventions">Style Conventions</h3>
<p>These messages were designed to comply with the conventions set forth by the <a href="http://wiki.ros.org/ROS/Patterns/Conventions#Messages">ROS/Patterns/Conventions guide</a>.   Beyond that, we have set the following conventions:</p>
<ul>
  <li>All vector quantities should have plural names</li>
  <li>Variable length message components should be represented as vectors of core ros messages like std_msgs or geometry_msgs.  Avoid variable length arrays of custom message types.  * In otherwords, favor “structures of arrays” rather than “arrays of structures”. One exception is the case where data must be grouped to be interpreted properly AND is shared across multiple messages.  (eg. an int with an associated enum.  See PingInfo.msg)</li>
  <li>Message components common to several top-level messages should be split into sub-messages.  (eg. PingInfo is shared by SonarRanges, SonarDetections and RawSonarImage)</li>
  <li>
<strong>(PROVISIONAL)</strong> Vector quantities may be of length zero.  This shall be interpreted as “unreported”.  (see internal MSG documentation for more details)</li>
</ul>
</div>
              </div>
            </div>
          </div>
        </div>
      
    
    <div class="row">
      <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-heading"><span class="glyphicon glyphicon-list"></span> CHANGELOG</div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="changelog-for-package-marine_acoustic_msgs">Changelog for package marine_acoustic_msgs</h1>

<h2 id="210-2024-03-15">2.1.0 (2024-03-15)</h2>

<ul>
  <li>Update CMake files to follow established standards</li>
  <li>Add Roland Arsenault as maintainer</li>
  <li>Update ros2 CI to use current ROS2 distributions
(<a href="https://github.com/apl-ocean-engineering/marine_msgs/issues/56">#56</a>)</li>
  <li>Updated ros2 branch to be in line with revisions in main
(<a href="https://github.com/apl-ocean-engineering/marine_msgs/issues/44">#44</a>)</li>
  <li>Contributors: Roland Arsenault, Sean Fish, Laura Lindzey</li>
</ul>

<h2 id="110-2022-11-30">1.1.0 (2022-11-30)</h2>

<ul>
  <li>Fix ProjectedSonarImage comments about frame
(<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/26">#26</a>)</li>
  <li>Add CI, pre-commit, prerelease and dependabot
(<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/27">#27</a>)
Co-authored-by: Laura Lindzey &lt;&lt;lindzey@uw.edu&gt;&gt;</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/25">#25</a>
from apl-ocean-engineering/add_migration_rule Add migration rule
from v0.0.1 to 28ec6a7</li>
  <li>Add migration rule from v0.0.1 to 28ec6a7</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/22">#22</a>
from rolker/fix_variable_name</li>
  <li>Rename num_beams to beam_count.</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/21">#21</a>
from CaptKrasno/acoustic_msg_devel</li>
  <li>Contributors: CaptKrasno, Laura Lindzey, Roland Arsenault, Vatan
Aksoy Tezer, lauralindzey</li>
</ul>

<h2 id="100-2022-05-05">1.0.0 (2022-05-05)</h2>

<ul>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/20">#20</a>
from CaptKrasno/acoustic_msg_devel Acoustic msg devel</li>
  <li>Removed unused (old) sonarImage message</li>
  <li>Merge remote-tracking branch 'apl-ocean-engineering/main' into
acoustic_msg_devel</li>
  <li>added ping info to sonar ranges</li>
  <li>Number of beams has been added to sonarImageData so it can be
decoded independently</li>
  <li>Update README.md</li>
  <li>Merge remote-tracking branch 'origin/main' into
acoustic_msg_devel</li>
  <li>committing changes from meeting</li>
  <li>Update README.md</li>
  <li>Changes after pull request discussion</li>
  <li>update internal documentation</li>
  <li>Merge branch 'main' into acoustic_msg_devel</li>
  <li>Add multibeam detections and watercolumn</li>
  <li>Contributors: CaptKrasno, Kristopher Krasnosky, lauralindzey</li>
</ul>

<h2 id="001-2021-11-23">0.0.1 (2021-11-23)</h2>

<ul>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/13">#13</a>
from amarburg/feature/revise-sonar-image-comment Feature/revise
sonar image comment</li>
  <li>Revised comments based on PR feedback.</li>
  <li>Revised based on comments on PR Removed language on 2D sonars
Revised language on azimuth and elevation angles Revised language on
header timestamp.</li>
  <li>Added note on sound speed.</li>
  <li>Very minor update in spelling.</li>
  <li>Significant rewrite of the explanatory comment in SonarImage.msg</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/10">#10</a>
from valschmidt/main Fixed broken links for proposed messages.</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/1">#1</a>
from valschmidt/valschmidt-fixed_broken_msg_links Fixed broken
links to proposed messages.</li>
  <li>Fixed broken links to proposed messages.</li>
  <li>Create Contributing.md First pass at the contributing doc adapted
from MBARI's LRAUV contributing guide</li>
  <li>Move acoustic_msgs package out of repo's root directory.</li>
  <li>Contributors: Aaron Marburg, CaptKrasno, Laura Lindzey, braanan,
lauralindzey, valschmidt</li>
</ul>
</div>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="humble-tutorials">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wiki Tutorials</h3>
      </div>
      <div class="panel-body">
        
        <em>This package does not provide any links to tutorials in it's <a href="https://index.ros.org/contribute/metadata/">rosindex metadata</a>.</em>
        <em>You can check on the <a href="http://wiki.ros.org/marine_acoustic_msgs/Tutorials" target="_blank">ROS Wiki Tutorials</a> page for the package.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="humble-deps">
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Package Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th class="text-center">Deps</th>
                  <th style="width: 100%">Name</th>
                </thead>
                <tbody>
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake#humble">ament_cmake  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_generators#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_generators#humble">rosidl_default_generators  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_runtime#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_runtime#humble">rosidl_default_runtime  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/std_msgs#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/std_msgs#humble">std_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/geometry_msgs#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/geometry_msgs#humble">geometry_msgs  </a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
          <div class="panel-heading">
            <h3 class="panel-title">System Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <em>No direct system dependencies.</em>
            
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Dependant Packages</h3>
          </div>
          <div class="panel-body">
            
              <em>No known dependants.</em>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="humble-assets">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Launch files</h3>
      </div>
      <div class="panel-body">
        
          <em>No launch files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Messages</h3>
      </div>
      <div class="panel-body">
        
          <ul>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/RawSonarImage.msg" target="_blank">msg/RawSonarImage.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/DetectionFlag.msg" target="_blank">msg/DetectionFlag.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/SonarRanges.msg" target="_blank">msg/SonarRanges.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/ProjectedSonarImage.msg" target="_blank">msg/ProjectedSonarImage.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/SonarDetections.msg" target="_blank">msg/SonarDetections.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/Dvl.msg" target="_blank">msg/Dvl.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/PingInfo.msg" target="_blank">msg/PingInfo.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/SonarImageData.msg" target="_blank">msg/SonarImageData.msg</a></li>
            
          </ul>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Services</h3>
      </div>
      <div class="panel-body">
        
          <em>No service files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Plugins</h3>
      </div>
      <div class="panel-body">
        
          <em>No plugins found.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="humble-questions">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent questions tagged <kbd>marine_acoustic_msgs</kbd> at <strong><a href="https://robotics.stackexchange.com/" target="_blank">Robotics Stack Exchange</a></strong></h3>      </div>
      <div id="humble-question-list" class="panel-body" style="display: none;"></div>
      <div id="humble-no-question-list" class="panel-body" style="display: none;">
        <p>No questions yet, you can ask one <a href="https://robotics.stackexchange.com/questions/tagged/marine_acoustic_msgs+humble">here</a>.</p>
      </div>
      <div id="humble-get-question-fail" class="panel-body alert alert-warning" style="display: none;">
        <p>Failed to get question list, you can ticket an issue <a href="https://github.com/ros-infrastructure/rosindex/issues/new" target="_blank" class="alert-link">here</a> </p>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/package_body_tabs.js"></script>

<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
jQuery(function() {
    // Update the count on the links to the contribution suggestions
    updateContributionSuggestionsCountOnPackage('https://github.com/apl-ocean-engineering/marine_msgs.git');
});
</script>

          </div>
          <div class="col-md-2 hidden-xs hidden-sm">
            
            
            



<div class="list-group list-group-sm ">
  <a class="list-group-item"
     target="_blank"
     href="http://docs.ros.org/en/humble/p/marine_acoustic_msgs"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       
       API Docs
  </a>
  <a class="list-group-item"
     target="_blank"
     href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       
       Browse Code
  </a>
  
  
  
  
  
  
</div>

          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-jazzy">
    <div class="container-fluid">
      
        
        
        

        <div class="row">
          <div class="col-md-10">
            

<div class="well well-sm">
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px" src="/assets/package.png">
      </td>
      <td>
        <h3 style="margin-top: 5px">
          <a style="text-decoration:none" href="/p/marine_acoustic_msgs">marine_acoustic_msgs</a> <small>package from <a style="text-decoration:none" href="/r/marine_msgs/github-apl-ocean-engineering-marine_msgs">marine_msgs</a> repo</small>
        </h3>
          
            
            
              <span class="label label-default pkg-label">

marine_acoustic_msgs
</span>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/marine_sensor_msgs">

marine_sensor_msgs
</a>
            
          
      </td>
    </tr>
  </table>
</div>

            <div class="visible-xs visible-sm">
              
              
              



<div class="list-group list-group-sm list-group-horizontal list-group-justified">
  <a class="list-group-item text-center"
     target="_blank"
     href="http://docs.ros.org/en/jazzy/p/marine_acoustic_msgs"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       <br>
       API Docs
  </a>
  <a class="list-group-item text-center"
     target="_blank"
     href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       <br>
       Browse Code
  </a>
  
  
  
  
  
  
</div>

            </div>
            



<ul class="nav nav-tabs nav-justified" id="jazzy-tabs" style="margin-bottom:20px">
  <li class="better-tabs active">
    <a href="#jazzy-overview" data-toggle="tab">Overview</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    
    <a href="#jazzy-assets" data-toggle="tab"><span class="label label-primary">8</span> Assets</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    <a href="#jazzy-deps" data-toggle="tab"><span class="label label-primary">5</span> Dependencies</a>
  </li>
  <li class="better-tabs">
    
    <a href="#jazzy-tutorials" data-toggle="tab"><span class="label label-default">0</span> Tutorials</a>
  </li>
  <li class="better-tabs">
    <a href="#jazzy-questions" data-toggle="tab"><span id="jazzy-questions-count" class="label label-primary">0</span> Q & A</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="jazzy-overview">
    
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h4 class="panel-title">Package Summary</h4></div>
          <div class="panel-body">
            <table class="table table-condensed">
              <tr>
                <td style="width:100px;" class="text-right"><strong>Tags</strong></td>
                <td>
                  
                  
                    <em>No category tags.</em>
                  
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Version</strong></td>
                <td>2.1.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>License</strong></td>
                <td>BSD-3-Clause</td>
              </tr>
              <tr>
                <td class="text-right"><strong>Build type</strong></td>
                <td>
                  
                    <span class="label label-default">
                  
                    AMENT_CMAKE</span>
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Use</strong></td>
                <td>
                
                  <span class="label label-success">RECOMMENDED</span>
                
                </td>
              </tr>
            </table>
          </div>
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body">
            
            
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">Messages for DVLs, multibeams, and imaging sonars.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/apl-ocean-engineering/marine_msgs.git">https://github.com/apl-ocean-engineering/marine_msgs.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">ros2</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2024-03-15
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="No CI information available for this package.">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/marine_msgs/#jazzy-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/marine_msgs/#jazzy-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/marine_msgs/#jazzy-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Package Description</h3></div>
          <div class="panel-body">
            The marine_acoustic_msgs package, including messages for common
  underwater sensors (DVL, multibeam sonar, imaging sonar)
  
          </div>
          <div class="panel-heading"><h4 class="panel-title">Additional Links</h4></div>
          <div class="panel-body">
            
            
              <em>No additional links.</em>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Maintainers</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Laura Lindzey</li>
                
                  <li>Roland Arsenault</li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Authors</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Aaron Marburg</li>
                
                  <li>Ian Vaughn</li>
                
                  <li>Kris Krasnosky</li>
                
                  <li>Laura Lindzey</li>
                
                  <li>Roland Arsenault</li>
                
              </ul>
            
          </div>
        </div>
      </div>
    </div>
    
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-heading"><span class="glyphicon glyphicon-file"></span><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/README.md" title="Open in git repository">marine_acoustic_msgs/README.md</a></div>
              <div class="panel-body">
                    <div class="rendered-markdown">
<h2 id="marine_acoustic_msgs">marine_acoustic_msgs</h2>

<p>This package includes messages for three commonly used sensors for research in underwater autonomy:</p>
<ul>
  <li>DVL</li>
  <li>Multibeam</li>
  <li>Imaging Sonar</li>
</ul>

<p>Each of the proposed messages is based on an existing
message that is currently in use across a variety of manufacturers of the
same instrument type. This gives us confidence that they are mature enough
to be indexed in the ROS debs and that they will generalize across other sensors.</p>

<h2 id="coordinate-frame-conventions">Coordinate Frame Conventions</h2>
<p><img src="https://user-images.githubusercontent.com/23006525/167165812-008ccccb-31a7-4c13-b2da-6235d37a7a3b.png" alt="cordiante_conventions"></p>

<h2 id="design-decisions-common-across-multiple-acoustic-messages">Design decisions common across multiple acoustic messages</h2>

<p>Looking at the differences among existing open source UUV messages for
acoustic sensors, there are a number of overarching design decisions to be
made before defining individual messages. The proposed set of messages
adheres to these guidelines:</p>

<ul>
  <li>The messages should be suitable for use across a wide variety of hardware.
    <ul>
      <li>Any sensor-specific metadata fields should be published in a separate message.
Standards for defining these additional messages are beyond the scope of this PR.
However, options include:
        <ul>
          <li>Capture all raw bytes sent to / received from a sensor (e.g. WHOI’s RawData.msg)</li>
          <li>Publish a separate message corresponding exactly to the datagrams
sent by the sensor (e.g. PD0.msg)</li>
          <li>Publish a separate message with the additional data, but no duplication
of the standard message, following the Image/CameraInfo pattern.</li>
        </ul>
      </li>
      <li>In order to support generality for a wide range of sensors, there will be some
fields that are not applicable to some sensors.
        <ul>
          <li>If not supported at all, the array may be left empty.</li>
          <li>If value is constant across the data frame, array may be length 1.</li>
          <li>Otherwise, the length of each array should match the length of the data.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>“raw/temporal” Underwater acoustic messages should include the speed of sound
(field will be called sound_speed) that was used by the sensor, as well as any
information required to raytrace the data with a new sound velocity profile.</li>
  <li>“processed/spatial” acoustic messages will have the ray-tracing already performed.</li>
  <li>The beam geometry is specified as a per-beam vector relative to the frame in
the header. This is an alternative to other approaches that have been used, including:
    <ul>
      <li>additional TF frames for individual beams, which will quickly become unwieldy</li>
      <li>an array of beam messages, where each beam includes its geometry relative
to the sensor. Abstracting out the individual beams doesn’t serve to simplify
the interpretation of the data, and doesn’t enable using an empty vector to
indicate that a field isn’t applicable.</li>
      <li>follow LaserScan convention and derive the geometry from min/max/step,
which doesn’t generalize across sonars, since they do not all have beams
spaced equiangualarly.</li>
    </ul>
  </li>
  <li>Individual message types should be based on how the data is used, rather
than similarities in data format. For example:
    <ul>
      <li>DVL and ADCP messages should not be combined, even though there is
significant overlap in hardware and provided data. Consumers of DVL
data expect a single velocity. Consumers of ADCP data expect velocities
at an array of ranges.</li>
      <li>There is a need for a difference between SonarImage and SonarRanges
(aka multibeam), since they are not typically interchangeable in
downstream processing algorithms, even though the newer sensors are
blurring the lines. A sonar image consists of intensities-vs-time,
while sonar ranges identify discrete returns.</li>
    </ul>
  </li>
  <li>In order to be consistent with other messages in sensor_msgs, message
types should be named after the type of data rather than type of sensor:
    <ul>
      <li>SonarImage.msg instead of ImagingSonar.msg</li>
      <li>SonarRanges.msg instead of Multibeam.msg or ProfilingSonar.msg.</li>
    </ul>
  </li>
</ul>

<h2 id="dvl">DVL</h2>
<h3 id="existing-messages">Existing Messages</h3>

<p>The most widely used messages appear to be:</p>
<ul>
  <li>WHOI’s <a href="https://bitbucket.org/whoidsl/ds_msgs/src/master/ds_sensor_msgs/msg/Dvl.msg">ds_sensor_msgs/Dvl.msg</a>.
It is currently in use with both RDI and Nortek instruments.</li>
  <li>UUV Simulator’s <a href="https://github.com/uuvsimulator/uuv_simulator/blob/master/uuv_sensor_plugins/uuv_sensor_ros_plugins_msgs/msg/DVL.msg">uuv_sensor_ros_plugins_msgs/DVL.msg</a>
(This was used as the base for <a href="https://github.com/udgcirs/marine_ros_conventions_discussion/blob/master/sensor_msgs/DVL.msg">marine_ros_conventions_discussion/DVL.msg</a>)
The main implementation difference between ds_sensor_msgs and uuv_simulator is
whether the top-level DVL message includes the beam data in an array,
or whether there is an array of DvlBeam messages.</li>
  <li>UWSim’s <a href="https://github.com/uji-ros-pkg/underwater_simulation/blob/melodic-devel/underwater_sensor_msgs/msg/DVL.msg">underwater_sensor_msgs/DVL.msg</a>.
It is not particularly idiomatic for a ROS message: Rather than using a
Vector3 for velocity, it has individual fields (wi_{x,y,z}_axis); and
rather than using TF to transform between frames, it includes the data in
instrument-referenced and vehicle-referenced frames within the same message.</li>
</ul>

<p>While all options agree that the DVL message should include aggregate data
from the instrument (estimated altitude and velocity), they differ in what else is included:</p>
<ul>
  <li>Per-beam data (range, velocity, and their covariances): WHOI &amp; UUV Simulator</li>
  <li>Both bottom-track and water-track velocities: WHOI &amp; UWSim</li>
  <li>Additional details about the sensor configuration: WHOI</li>
</ul>

<h3 id="dvl-specific-design-decisions">DVL-specific design decisions</h3>
<ul>
  <li>Is there broad support for including water-track velocity in addition to ground-track in the same message definition?
    <ul>
      <li>NPS is currently interleaving DVL &amp; ADCP messages from the same driver for an instrument that provides both an ADCP profile and a DVL bottom-track velocity. I like this approach.</li>
      <li>If the same message type supports both bottom track and water track (single reading, not profile), maybe there should be a convention that bottom track / water track are published on different topics so subscribing nodes can ignore water track velocities if they don’t use them.</li>
    </ul>
  </li>
  <li>Whether the additional information about the sensor configuration (DVL_TYPE) belongs in the top-level message. Other messages in sensor_msgs do not tend to have similar flags; however, this depends on whether we want to be able to perform sound velocity corrections using the data in the DVL message.</li>
  <li>Does a quality flag belong in the standardized message?</li>
</ul>

<h3 id="proposed-message">Proposed Message</h3>

<p>https://github.com/apl-ocean-engineering/marine_msgs/blob/main/marine_acoustic_msgs/msg/Dvl.msg</p>

<p>This message started with WHOI’s definition, which has been used in
drivers for Nortek and RDI DVLs. There are also corresponding rviz
and gazebo plugins. (I have trivial forks of those plugins supporting the proposed message.)</p>

<p>I propose the following changes from WHOI’s original message:</p>
<ul>
  <li>Remove the ds_header – DsHeader was an attempt to add some hardware-specific
metadata to the sensor processing pipeline. It was never fully implemented,
and isn’t consistent with other definitions in sensor_msgs.</li>
  <li>Remove dvl_time – this was originally intended to support integration of
DVL messages from instruments that only provide a monotonic count rather
than fully-synchronized timestamps. With modern instruments, <code class="language-plaintext highlighter-rouge">header.stamp</code>
should capture a posix time suitable for integrating the reported velocity.</li>
  <li>Replace coordinate_mode with beams_valid flag. The 3D velocity and altitude
should always be reported in the instrument frame which is specified in the
header, and beam ranges/velocities are scalars measured along the corresponding <code class="language-plaintext highlighter-rouge">beam_unit_vec</code>.</li>
  <li>speed_sound -&gt; sound_speed for consistency across acoustic messages</li>
</ul>

<h2 id="multibeam-and-forward-looking-sonar-fls-messages">Multibeam and Forward Looking Sonar (FLS) messages</h2>

<h3 id="organization">Organization</h3>
<p><img src="https://user-images.githubusercontent.com/23006525/160207155-eb9c003e-8a9a-460e-8c1d-6240924e81e6.png" alt="data_structure"></p>

<p>Multibeam and FLS sonar data (referred to as sonar data for brevity) are broken into two type categories, detections and images.   Images are intended to represent Watercolumn or FLS imaging data.   Detections represent a detection reported by the sonar for a given beam.</p>

<p>Sonar data is also organized into two domain categories,  temporal and spatial.  Messages are intended to be initially reported in the temporal domain by the sonar drive then converted to the spatial domain through a processing pipeline.   However, some sonars report images and detections directly in the spatial domain.  In this case, sensor drivers may report directly with the appropriate spatial message.</p>

<h3 id="data-structure">Data structure</h3>
<p>the Sonar messages consist of top level messages:</p>
<ul>
  <li>RawSonarImage</li>
  <li>ProjectedSonarImage</li>
  <li>SonarDetection</li>
  <li>SonarRanges</li>
</ul>

<p>These messages share common data in the following sub-messages:</p>
<ul>
  <li>DetectionFlag</li>
  <li>PingInfo</li>
  <li>SonarImageData</li>
</ul>

<h4 id="sonarimagedata-packing">SonarImageData packing</h4>

<p>It’s worth mentioning how the data is packed in the sonar image message as it may not be obvious.</p>

<ul>
  <li>the actual pixel data is in row-major (i.e beam_no major) order.</li>
  <li>the pixel data is stored as an array of bytes (uint8). It should be cast as the type specified in dtype flag. They are enumerated in the message</li>
  <li>to find the range for each cell: (sample_number + sample0) * sound_speed / (2.0 * sample_rate)</li>
</ul>

<p>The image details details how image data is stored.</p>

<p><img src="https://user-images.githubusercontent.com/23006525/160203744-7fc6b06a-ac3d-4419-b6a9-fec83e07cef7.png" alt="wcl_def"></p>

<h3 id="geometry-conventions">Geometry Conventions</h3>
<p><img src="https://user-images.githubusercontent.com/23006525/167165995-ce578962-be79-4219-89a0-920953ca6cb2.png" alt="rx_tx_detail"></p>

<ul>
  <li>angles/beam directions in the spatial domain shall:
    <ul>
      <li>be reported as unit vectors according to the coordinate frame convention specified above.</li>
      <li>be reported at time reported in the header timestamp.  (at or before transmit time)</li>
    </ul>
  </li>
  <li>angles/beam directions in the temporal domain shall be reported as transmit (Tx) and receive (Rx) angles according to the diagram above
    <ul>
      <li>rx_angle is defined as the elevation from the X-Z plane at receive time. This elevation is positive toward the Y axis.  This elevation defines a cone of possible return directions for a given return beam.</li>
      <li>tx_angle is defined as the elevation from the Y-Z plane at transmit time. This elevation is positive toward the X axis.  This elevation defines a cone that represents the area insonified by the tx pulse.</li>
    </ul>
  </li>
</ul>

<h3 id="style-conventions">Style Conventions</h3>
<p>These messages were designed to comply with the conventions set forth by the <a href="http://wiki.ros.org/ROS/Patterns/Conventions#Messages">ROS/Patterns/Conventions guide</a>.   Beyond that, we have set the following conventions:</p>
<ul>
  <li>All vector quantities should have plural names</li>
  <li>Variable length message components should be represented as vectors of core ros messages like std_msgs or geometry_msgs.  Avoid variable length arrays of custom message types.  * In otherwords, favor “structures of arrays” rather than “arrays of structures”. One exception is the case where data must be grouped to be interpreted properly AND is shared across multiple messages.  (eg. an int with an associated enum.  See PingInfo.msg)</li>
  <li>Message components common to several top-level messages should be split into sub-messages.  (eg. PingInfo is shared by SonarRanges, SonarDetections and RawSonarImage)</li>
  <li>
<strong>(PROVISIONAL)</strong> Vector quantities may be of length zero.  This shall be interpreted as “unreported”.  (see internal MSG documentation for more details)</li>
</ul>
</div>
              </div>
            </div>
          </div>
        </div>
      
    
    <div class="row">
      <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-heading"><span class="glyphicon glyphicon-list"></span> CHANGELOG</div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="changelog-for-package-marine_acoustic_msgs">Changelog for package marine_acoustic_msgs</h1>

<h2 id="210-2024-03-15">2.1.0 (2024-03-15)</h2>

<ul>
  <li>Update CMake files to follow established standards</li>
  <li>Add Roland Arsenault as maintainer</li>
  <li>Update ros2 CI to use current ROS2 distributions
(<a href="https://github.com/apl-ocean-engineering/marine_msgs/issues/56">#56</a>)</li>
  <li>Updated ros2 branch to be in line with revisions in main
(<a href="https://github.com/apl-ocean-engineering/marine_msgs/issues/44">#44</a>)</li>
  <li>Contributors: Roland Arsenault, Sean Fish, Laura Lindzey</li>
</ul>

<h2 id="110-2022-11-30">1.1.0 (2022-11-30)</h2>

<ul>
  <li>Fix ProjectedSonarImage comments about frame
(<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/26">#26</a>)</li>
  <li>Add CI, pre-commit, prerelease and dependabot
(<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/27">#27</a>)
Co-authored-by: Laura Lindzey &lt;&lt;lindzey@uw.edu&gt;&gt;</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/25">#25</a>
from apl-ocean-engineering/add_migration_rule Add migration rule
from v0.0.1 to 28ec6a7</li>
  <li>Add migration rule from v0.0.1 to 28ec6a7</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/22">#22</a>
from rolker/fix_variable_name</li>
  <li>Rename num_beams to beam_count.</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/21">#21</a>
from CaptKrasno/acoustic_msg_devel</li>
  <li>Contributors: CaptKrasno, Laura Lindzey, Roland Arsenault, Vatan
Aksoy Tezer, lauralindzey</li>
</ul>

<h2 id="100-2022-05-05">1.0.0 (2022-05-05)</h2>

<ul>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/20">#20</a>
from CaptKrasno/acoustic_msg_devel Acoustic msg devel</li>
  <li>Removed unused (old) sonarImage message</li>
  <li>Merge remote-tracking branch 'apl-ocean-engineering/main' into
acoustic_msg_devel</li>
  <li>added ping info to sonar ranges</li>
  <li>Number of beams has been added to sonarImageData so it can be
decoded independently</li>
  <li>Update README.md</li>
  <li>Merge remote-tracking branch 'origin/main' into
acoustic_msg_devel</li>
  <li>committing changes from meeting</li>
  <li>Update README.md</li>
  <li>Changes after pull request discussion</li>
  <li>update internal documentation</li>
  <li>Merge branch 'main' into acoustic_msg_devel</li>
  <li>Add multibeam detections and watercolumn</li>
  <li>Contributors: CaptKrasno, Kristopher Krasnosky, lauralindzey</li>
</ul>

<h2 id="001-2021-11-23">0.0.1 (2021-11-23)</h2>

<ul>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/13">#13</a>
from amarburg/feature/revise-sonar-image-comment Feature/revise
sonar image comment</li>
  <li>Revised comments based on PR feedback.</li>
  <li>Revised based on comments on PR Removed language on 2D sonars
Revised language on azimuth and elevation angles Revised language on
header timestamp.</li>
  <li>Added note on sound speed.</li>
  <li>Very minor update in spelling.</li>
  <li>Significant rewrite of the explanatory comment in SonarImage.msg</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/10">#10</a>
from valschmidt/main Fixed broken links for proposed messages.</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/1">#1</a>
from valschmidt/valschmidt-fixed_broken_msg_links Fixed broken
links to proposed messages.</li>
  <li>Fixed broken links to proposed messages.</li>
  <li>Create Contributing.md First pass at the contributing doc adapted
from MBARI's LRAUV contributing guide</li>
  <li>Move acoustic_msgs package out of repo's root directory.</li>
  <li>Contributors: Aaron Marburg, CaptKrasno, Laura Lindzey, braanan,
lauralindzey, valschmidt</li>
</ul>
</div>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="jazzy-tutorials">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wiki Tutorials</h3>
      </div>
      <div class="panel-body">
        
        <em>This package does not provide any links to tutorials in it's <a href="https://index.ros.org/contribute/metadata/">rosindex metadata</a>.</em>
        <em>You can check on the <a href="http://wiki.ros.org/marine_acoustic_msgs/Tutorials" target="_blank">ROS Wiki Tutorials</a> page for the package.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="jazzy-deps">
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Package Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th class="text-center">Deps</th>
                  <th style="width: 100%">Name</th>
                </thead>
                <tbody>
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake#jazzy">ament_cmake  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_generators#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_generators#jazzy">rosidl_default_generators  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_runtime#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_runtime#jazzy">rosidl_default_runtime  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/std_msgs#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/std_msgs#jazzy">std_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/geometry_msgs#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/geometry_msgs#jazzy">geometry_msgs  </a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
          <div class="panel-heading">
            <h3 class="panel-title">System Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <em>No direct system dependencies.</em>
            
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Dependant Packages</h3>
          </div>
          <div class="panel-body">
            
              <em>No known dependants.</em>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="jazzy-assets">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Launch files</h3>
      </div>
      <div class="panel-body">
        
          <em>No launch files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Messages</h3>
      </div>
      <div class="panel-body">
        
          <ul>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/RawSonarImage.msg" target="_blank">msg/RawSonarImage.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/DetectionFlag.msg" target="_blank">msg/DetectionFlag.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/SonarRanges.msg" target="_blank">msg/SonarRanges.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/ProjectedSonarImage.msg" target="_blank">msg/ProjectedSonarImage.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/SonarDetections.msg" target="_blank">msg/SonarDetections.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/Dvl.msg" target="_blank">msg/Dvl.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/PingInfo.msg" target="_blank">msg/PingInfo.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/SonarImageData.msg" target="_blank">msg/SonarImageData.msg</a></li>
            
          </ul>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Services</h3>
      </div>
      <div class="panel-body">
        
          <em>No service files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Plugins</h3>
      </div>
      <div class="panel-body">
        
          <em>No plugins found.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="jazzy-questions">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent questions tagged <kbd>marine_acoustic_msgs</kbd> at <strong><a href="https://robotics.stackexchange.com/" target="_blank">Robotics Stack Exchange</a></strong></h3>      </div>
      <div id="jazzy-question-list" class="panel-body" style="display: none;"></div>
      <div id="jazzy-no-question-list" class="panel-body" style="display: none;">
        <p>No questions yet, you can ask one <a href="https://robotics.stackexchange.com/questions/tagged/marine_acoustic_msgs+jazzy">here</a>.</p>
      </div>
      <div id="jazzy-get-question-fail" class="panel-body alert alert-warning" style="display: none;">
        <p>Failed to get question list, you can ticket an issue <a href="https://github.com/ros-infrastructure/rosindex/issues/new" target="_blank" class="alert-link">here</a> </p>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/package_body_tabs.js"></script>

<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
jQuery(function() {
    // Update the count on the links to the contribution suggestions
    updateContributionSuggestionsCountOnPackage('https://github.com/apl-ocean-engineering/marine_msgs.git');
});
</script>

          </div>
          <div class="col-md-2 hidden-xs hidden-sm">
            
            
            



<div class="list-group list-group-sm ">
  <a class="list-group-item"
     target="_blank"
     href="http://docs.ros.org/en/jazzy/p/marine_acoustic_msgs"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       
       API Docs
  </a>
  <a class="list-group-item"
     target="_blank"
     href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       
       Browse Code
  </a>
  
  
  
  
  
  
</div>

          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-kilted">
    <div class="container-fluid">
      
        
        
        

        <div class="row">
          <div class="col-md-10">
            

<div class="well well-sm">
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px" src="/assets/package.png">
      </td>
      <td>
        <h3 style="margin-top: 5px">
          <a style="text-decoration:none" href="/p/marine_acoustic_msgs">marine_acoustic_msgs</a> <small>package from <a style="text-decoration:none" href="/r/marine_msgs/github-apl-ocean-engineering-marine_msgs">marine_msgs</a> repo</small>
        </h3>
          
            
            
              <span class="label label-default pkg-label">

marine_acoustic_msgs
</span>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/marine_sensor_msgs">

marine_sensor_msgs
</a>
            
          
      </td>
    </tr>
  </table>
</div>

            <div class="visible-xs visible-sm">
              
              
              



<div class="list-group list-group-sm list-group-horizontal list-group-justified">
  <a class="list-group-item text-center"
     target="_blank"
     href="http://docs.ros.org/en/kilted/p/marine_acoustic_msgs"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       <br>
       API Docs
  </a>
  <a class="list-group-item text-center"
     target="_blank"
     href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       <br>
       Browse Code
  </a>
  
  
  
  
  
  
</div>

            </div>
            



<ul class="nav nav-tabs nav-justified" id="kilted-tabs" style="margin-bottom:20px">
  <li class="better-tabs active">
    <a href="#kilted-overview" data-toggle="tab">Overview</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    
    <a href="#kilted-assets" data-toggle="tab"><span class="label label-primary">8</span> Assets</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    <a href="#kilted-deps" data-toggle="tab"><span class="label label-primary">5</span> Dependencies</a>
  </li>
  <li class="better-tabs">
    
    <a href="#kilted-tutorials" data-toggle="tab"><span class="label label-default">0</span> Tutorials</a>
  </li>
  <li class="better-tabs">
    <a href="#kilted-questions" data-toggle="tab"><span id="kilted-questions-count" class="label label-primary">0</span> Q & A</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="kilted-overview">
    
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h4 class="panel-title">Package Summary</h4></div>
          <div class="panel-body">
            <table class="table table-condensed">
              <tr>
                <td style="width:100px;" class="text-right"><strong>Tags</strong></td>
                <td>
                  
                  
                    <em>No category tags.</em>
                  
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Version</strong></td>
                <td>2.1.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>License</strong></td>
                <td>BSD-3-Clause</td>
              </tr>
              <tr>
                <td class="text-right"><strong>Build type</strong></td>
                <td>
                  
                    <span class="label label-default">
                  
                    AMENT_CMAKE</span>
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Use</strong></td>
                <td>
                
                  <span class="label label-success">RECOMMENDED</span>
                
                </td>
              </tr>
            </table>
          </div>
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body">
            
            
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">Messages for DVLs, multibeams, and imaging sonars.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/apl-ocean-engineering/marine_msgs.git">https://github.com/apl-ocean-engineering/marine_msgs.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">ros2</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2024-03-15
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="No CI information available for this package.">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/marine_msgs/#kilted-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/marine_msgs/#kilted-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/marine_msgs/#kilted-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Package Description</h3></div>
          <div class="panel-body">
            The marine_acoustic_msgs package, including messages for common
  underwater sensors (DVL, multibeam sonar, imaging sonar)
  
          </div>
          <div class="panel-heading"><h4 class="panel-title">Additional Links</h4></div>
          <div class="panel-body">
            
            
              <em>No additional links.</em>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Maintainers</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Laura Lindzey</li>
                
                  <li>Roland Arsenault</li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Authors</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Aaron Marburg</li>
                
                  <li>Ian Vaughn</li>
                
                  <li>Kris Krasnosky</li>
                
                  <li>Laura Lindzey</li>
                
                  <li>Roland Arsenault</li>
                
              </ul>
            
          </div>
        </div>
      </div>
    </div>
    
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-heading"><span class="glyphicon glyphicon-file"></span><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/README.md" title="Open in git repository">marine_acoustic_msgs/README.md</a></div>
              <div class="panel-body">
                    <div class="rendered-markdown">
<h2 id="marine_acoustic_msgs">marine_acoustic_msgs</h2>

<p>This package includes messages for three commonly used sensors for research in underwater autonomy:</p>
<ul>
  <li>DVL</li>
  <li>Multibeam</li>
  <li>Imaging Sonar</li>
</ul>

<p>Each of the proposed messages is based on an existing
message that is currently in use across a variety of manufacturers of the
same instrument type. This gives us confidence that they are mature enough
to be indexed in the ROS debs and that they will generalize across other sensors.</p>

<h2 id="coordinate-frame-conventions">Coordinate Frame Conventions</h2>
<p><img src="https://user-images.githubusercontent.com/23006525/167165812-008ccccb-31a7-4c13-b2da-6235d37a7a3b.png" alt="cordiante_conventions"></p>

<h2 id="design-decisions-common-across-multiple-acoustic-messages">Design decisions common across multiple acoustic messages</h2>

<p>Looking at the differences among existing open source UUV messages for
acoustic sensors, there are a number of overarching design decisions to be
made before defining individual messages. The proposed set of messages
adheres to these guidelines:</p>

<ul>
  <li>The messages should be suitable for use across a wide variety of hardware.
    <ul>
      <li>Any sensor-specific metadata fields should be published in a separate message.
Standards for defining these additional messages are beyond the scope of this PR.
However, options include:
        <ul>
          <li>Capture all raw bytes sent to / received from a sensor (e.g. WHOI’s RawData.msg)</li>
          <li>Publish a separate message corresponding exactly to the datagrams
sent by the sensor (e.g. PD0.msg)</li>
          <li>Publish a separate message with the additional data, but no duplication
of the standard message, following the Image/CameraInfo pattern.</li>
        </ul>
      </li>
      <li>In order to support generality for a wide range of sensors, there will be some
fields that are not applicable to some sensors.
        <ul>
          <li>If not supported at all, the array may be left empty.</li>
          <li>If value is constant across the data frame, array may be length 1.</li>
          <li>Otherwise, the length of each array should match the length of the data.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>“raw/temporal” Underwater acoustic messages should include the speed of sound
(field will be called sound_speed) that was used by the sensor, as well as any
information required to raytrace the data with a new sound velocity profile.</li>
  <li>“processed/spatial” acoustic messages will have the ray-tracing already performed.</li>
  <li>The beam geometry is specified as a per-beam vector relative to the frame in
the header. This is an alternative to other approaches that have been used, including:
    <ul>
      <li>additional TF frames for individual beams, which will quickly become unwieldy</li>
      <li>an array of beam messages, where each beam includes its geometry relative
to the sensor. Abstracting out the individual beams doesn’t serve to simplify
the interpretation of the data, and doesn’t enable using an empty vector to
indicate that a field isn’t applicable.</li>
      <li>follow LaserScan convention and derive the geometry from min/max/step,
which doesn’t generalize across sonars, since they do not all have beams
spaced equiangualarly.</li>
    </ul>
  </li>
  <li>Individual message types should be based on how the data is used, rather
than similarities in data format. For example:
    <ul>
      <li>DVL and ADCP messages should not be combined, even though there is
significant overlap in hardware and provided data. Consumers of DVL
data expect a single velocity. Consumers of ADCP data expect velocities
at an array of ranges.</li>
      <li>There is a need for a difference between SonarImage and SonarRanges
(aka multibeam), since they are not typically interchangeable in
downstream processing algorithms, even though the newer sensors are
blurring the lines. A sonar image consists of intensities-vs-time,
while sonar ranges identify discrete returns.</li>
    </ul>
  </li>
  <li>In order to be consistent with other messages in sensor_msgs, message
types should be named after the type of data rather than type of sensor:
    <ul>
      <li>SonarImage.msg instead of ImagingSonar.msg</li>
      <li>SonarRanges.msg instead of Multibeam.msg or ProfilingSonar.msg.</li>
    </ul>
  </li>
</ul>

<h2 id="dvl">DVL</h2>
<h3 id="existing-messages">Existing Messages</h3>

<p>The most widely used messages appear to be:</p>
<ul>
  <li>WHOI’s <a href="https://bitbucket.org/whoidsl/ds_msgs/src/master/ds_sensor_msgs/msg/Dvl.msg">ds_sensor_msgs/Dvl.msg</a>.
It is currently in use with both RDI and Nortek instruments.</li>
  <li>UUV Simulator’s <a href="https://github.com/uuvsimulator/uuv_simulator/blob/master/uuv_sensor_plugins/uuv_sensor_ros_plugins_msgs/msg/DVL.msg">uuv_sensor_ros_plugins_msgs/DVL.msg</a>
(This was used as the base for <a href="https://github.com/udgcirs/marine_ros_conventions_discussion/blob/master/sensor_msgs/DVL.msg">marine_ros_conventions_discussion/DVL.msg</a>)
The main implementation difference between ds_sensor_msgs and uuv_simulator is
whether the top-level DVL message includes the beam data in an array,
or whether there is an array of DvlBeam messages.</li>
  <li>UWSim’s <a href="https://github.com/uji-ros-pkg/underwater_simulation/blob/melodic-devel/underwater_sensor_msgs/msg/DVL.msg">underwater_sensor_msgs/DVL.msg</a>.
It is not particularly idiomatic for a ROS message: Rather than using a
Vector3 for velocity, it has individual fields (wi_{x,y,z}_axis); and
rather than using TF to transform between frames, it includes the data in
instrument-referenced and vehicle-referenced frames within the same message.</li>
</ul>

<p>While all options agree that the DVL message should include aggregate data
from the instrument (estimated altitude and velocity), they differ in what else is included:</p>
<ul>
  <li>Per-beam data (range, velocity, and their covariances): WHOI &amp; UUV Simulator</li>
  <li>Both bottom-track and water-track velocities: WHOI &amp; UWSim</li>
  <li>Additional details about the sensor configuration: WHOI</li>
</ul>

<h3 id="dvl-specific-design-decisions">DVL-specific design decisions</h3>
<ul>
  <li>Is there broad support for including water-track velocity in addition to ground-track in the same message definition?
    <ul>
      <li>NPS is currently interleaving DVL &amp; ADCP messages from the same driver for an instrument that provides both an ADCP profile and a DVL bottom-track velocity. I like this approach.</li>
      <li>If the same message type supports both bottom track and water track (single reading, not profile), maybe there should be a convention that bottom track / water track are published on different topics so subscribing nodes can ignore water track velocities if they don’t use them.</li>
    </ul>
  </li>
  <li>Whether the additional information about the sensor configuration (DVL_TYPE) belongs in the top-level message. Other messages in sensor_msgs do not tend to have similar flags; however, this depends on whether we want to be able to perform sound velocity corrections using the data in the DVL message.</li>
  <li>Does a quality flag belong in the standardized message?</li>
</ul>

<h3 id="proposed-message">Proposed Message</h3>

<p>https://github.com/apl-ocean-engineering/marine_msgs/blob/main/marine_acoustic_msgs/msg/Dvl.msg</p>

<p>This message started with WHOI’s definition, which has been used in
drivers for Nortek and RDI DVLs. There are also corresponding rviz
and gazebo plugins. (I have trivial forks of those plugins supporting the proposed message.)</p>

<p>I propose the following changes from WHOI’s original message:</p>
<ul>
  <li>Remove the ds_header – DsHeader was an attempt to add some hardware-specific
metadata to the sensor processing pipeline. It was never fully implemented,
and isn’t consistent with other definitions in sensor_msgs.</li>
  <li>Remove dvl_time – this was originally intended to support integration of
DVL messages from instruments that only provide a monotonic count rather
than fully-synchronized timestamps. With modern instruments, <code class="language-plaintext highlighter-rouge">header.stamp</code>
should capture a posix time suitable for integrating the reported velocity.</li>
  <li>Replace coordinate_mode with beams_valid flag. The 3D velocity and altitude
should always be reported in the instrument frame which is specified in the
header, and beam ranges/velocities are scalars measured along the corresponding <code class="language-plaintext highlighter-rouge">beam_unit_vec</code>.</li>
  <li>speed_sound -&gt; sound_speed for consistency across acoustic messages</li>
</ul>

<h2 id="multibeam-and-forward-looking-sonar-fls-messages">Multibeam and Forward Looking Sonar (FLS) messages</h2>

<h3 id="organization">Organization</h3>
<p><img src="https://user-images.githubusercontent.com/23006525/160207155-eb9c003e-8a9a-460e-8c1d-6240924e81e6.png" alt="data_structure"></p>

<p>Multibeam and FLS sonar data (referred to as sonar data for brevity) are broken into two type categories, detections and images.   Images are intended to represent Watercolumn or FLS imaging data.   Detections represent a detection reported by the sonar for a given beam.</p>

<p>Sonar data is also organized into two domain categories,  temporal and spatial.  Messages are intended to be initially reported in the temporal domain by the sonar drive then converted to the spatial domain through a processing pipeline.   However, some sonars report images and detections directly in the spatial domain.  In this case, sensor drivers may report directly with the appropriate spatial message.</p>

<h3 id="data-structure">Data structure</h3>
<p>the Sonar messages consist of top level messages:</p>
<ul>
  <li>RawSonarImage</li>
  <li>ProjectedSonarImage</li>
  <li>SonarDetection</li>
  <li>SonarRanges</li>
</ul>

<p>These messages share common data in the following sub-messages:</p>
<ul>
  <li>DetectionFlag</li>
  <li>PingInfo</li>
  <li>SonarImageData</li>
</ul>

<h4 id="sonarimagedata-packing">SonarImageData packing</h4>

<p>It’s worth mentioning how the data is packed in the sonar image message as it may not be obvious.</p>

<ul>
  <li>the actual pixel data is in row-major (i.e beam_no major) order.</li>
  <li>the pixel data is stored as an array of bytes (uint8). It should be cast as the type specified in dtype flag. They are enumerated in the message</li>
  <li>to find the range for each cell: (sample_number + sample0) * sound_speed / (2.0 * sample_rate)</li>
</ul>

<p>The image details details how image data is stored.</p>

<p><img src="https://user-images.githubusercontent.com/23006525/160203744-7fc6b06a-ac3d-4419-b6a9-fec83e07cef7.png" alt="wcl_def"></p>

<h3 id="geometry-conventions">Geometry Conventions</h3>
<p><img src="https://user-images.githubusercontent.com/23006525/167165995-ce578962-be79-4219-89a0-920953ca6cb2.png" alt="rx_tx_detail"></p>

<ul>
  <li>angles/beam directions in the spatial domain shall:
    <ul>
      <li>be reported as unit vectors according to the coordinate frame convention specified above.</li>
      <li>be reported at time reported in the header timestamp.  (at or before transmit time)</li>
    </ul>
  </li>
  <li>angles/beam directions in the temporal domain shall be reported as transmit (Tx) and receive (Rx) angles according to the diagram above
    <ul>
      <li>rx_angle is defined as the elevation from the X-Z plane at receive time. This elevation is positive toward the Y axis.  This elevation defines a cone of possible return directions for a given return beam.</li>
      <li>tx_angle is defined as the elevation from the Y-Z plane at transmit time. This elevation is positive toward the X axis.  This elevation defines a cone that represents the area insonified by the tx pulse.</li>
    </ul>
  </li>
</ul>

<h3 id="style-conventions">Style Conventions</h3>
<p>These messages were designed to comply with the conventions set forth by the <a href="http://wiki.ros.org/ROS/Patterns/Conventions#Messages">ROS/Patterns/Conventions guide</a>.   Beyond that, we have set the following conventions:</p>
<ul>
  <li>All vector quantities should have plural names</li>
  <li>Variable length message components should be represented as vectors of core ros messages like std_msgs or geometry_msgs.  Avoid variable length arrays of custom message types.  * In otherwords, favor “structures of arrays” rather than “arrays of structures”. One exception is the case where data must be grouped to be interpreted properly AND is shared across multiple messages.  (eg. an int with an associated enum.  See PingInfo.msg)</li>
  <li>Message components common to several top-level messages should be split into sub-messages.  (eg. PingInfo is shared by SonarRanges, SonarDetections and RawSonarImage)</li>
  <li>
<strong>(PROVISIONAL)</strong> Vector quantities may be of length zero.  This shall be interpreted as “unreported”.  (see internal MSG documentation for more details)</li>
</ul>
</div>
              </div>
            </div>
          </div>
        </div>
      
    
    <div class="row">
      <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-heading"><span class="glyphicon glyphicon-list"></span> CHANGELOG</div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="changelog-for-package-marine_acoustic_msgs">Changelog for package marine_acoustic_msgs</h1>

<h2 id="210-2024-03-15">2.1.0 (2024-03-15)</h2>

<ul>
  <li>Update CMake files to follow established standards</li>
  <li>Add Roland Arsenault as maintainer</li>
  <li>Update ros2 CI to use current ROS2 distributions
(<a href="https://github.com/apl-ocean-engineering/marine_msgs/issues/56">#56</a>)</li>
  <li>Updated ros2 branch to be in line with revisions in main
(<a href="https://github.com/apl-ocean-engineering/marine_msgs/issues/44">#44</a>)</li>
  <li>Contributors: Roland Arsenault, Sean Fish, Laura Lindzey</li>
</ul>

<h2 id="110-2022-11-30">1.1.0 (2022-11-30)</h2>

<ul>
  <li>Fix ProjectedSonarImage comments about frame
(<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/26">#26</a>)</li>
  <li>Add CI, pre-commit, prerelease and dependabot
(<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/27">#27</a>)
Co-authored-by: Laura Lindzey &lt;&lt;lindzey@uw.edu&gt;&gt;</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/25">#25</a>
from apl-ocean-engineering/add_migration_rule Add migration rule
from v0.0.1 to 28ec6a7</li>
  <li>Add migration rule from v0.0.1 to 28ec6a7</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/22">#22</a>
from rolker/fix_variable_name</li>
  <li>Rename num_beams to beam_count.</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/21">#21</a>
from CaptKrasno/acoustic_msg_devel</li>
  <li>Contributors: CaptKrasno, Laura Lindzey, Roland Arsenault, Vatan
Aksoy Tezer, lauralindzey</li>
</ul>

<h2 id="100-2022-05-05">1.0.0 (2022-05-05)</h2>

<ul>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/20">#20</a>
from CaptKrasno/acoustic_msg_devel Acoustic msg devel</li>
  <li>Removed unused (old) sonarImage message</li>
  <li>Merge remote-tracking branch 'apl-ocean-engineering/main' into
acoustic_msg_devel</li>
  <li>added ping info to sonar ranges</li>
  <li>Number of beams has been added to sonarImageData so it can be
decoded independently</li>
  <li>Update README.md</li>
  <li>Merge remote-tracking branch 'origin/main' into
acoustic_msg_devel</li>
  <li>committing changes from meeting</li>
  <li>Update README.md</li>
  <li>Changes after pull request discussion</li>
  <li>update internal documentation</li>
  <li>Merge branch 'main' into acoustic_msg_devel</li>
  <li>Add multibeam detections and watercolumn</li>
  <li>Contributors: CaptKrasno, Kristopher Krasnosky, lauralindzey</li>
</ul>

<h2 id="001-2021-11-23">0.0.1 (2021-11-23)</h2>

<ul>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/13">#13</a>
from amarburg/feature/revise-sonar-image-comment Feature/revise
sonar image comment</li>
  <li>Revised comments based on PR feedback.</li>
  <li>Revised based on comments on PR Removed language on 2D sonars
Revised language on azimuth and elevation angles Revised language on
header timestamp.</li>
  <li>Added note on sound speed.</li>
  <li>Very minor update in spelling.</li>
  <li>Significant rewrite of the explanatory comment in SonarImage.msg</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/10">#10</a>
from valschmidt/main Fixed broken links for proposed messages.</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/1">#1</a>
from valschmidt/valschmidt-fixed_broken_msg_links Fixed broken
links to proposed messages.</li>
  <li>Fixed broken links to proposed messages.</li>
  <li>Create Contributing.md First pass at the contributing doc adapted
from MBARI's LRAUV contributing guide</li>
  <li>Move acoustic_msgs package out of repo's root directory.</li>
  <li>Contributors: Aaron Marburg, CaptKrasno, Laura Lindzey, braanan,
lauralindzey, valschmidt</li>
</ul>
</div>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="kilted-tutorials">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wiki Tutorials</h3>
      </div>
      <div class="panel-body">
        
        <em>This package does not provide any links to tutorials in it's <a href="https://index.ros.org/contribute/metadata/">rosindex metadata</a>.</em>
        <em>You can check on the <a href="http://wiki.ros.org/marine_acoustic_msgs/Tutorials" target="_blank">ROS Wiki Tutorials</a> page for the package.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="kilted-deps">
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Package Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th class="text-center">Deps</th>
                  <th style="width: 100%">Name</th>
                </thead>
                <tbody>
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake#kilted-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake#kilted">ament_cmake  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_generators#kilted-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_generators#kilted">rosidl_default_generators  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_runtime#kilted-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_runtime#kilted">rosidl_default_runtime  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/std_msgs#kilted-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/std_msgs#kilted">std_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/geometry_msgs#kilted-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/geometry_msgs#kilted">geometry_msgs  </a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
          <div class="panel-heading">
            <h3 class="panel-title">System Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <em>No direct system dependencies.</em>
            
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Dependant Packages</h3>
          </div>
          <div class="panel-body">
            
              <em>No known dependants.</em>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="kilted-assets">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Launch files</h3>
      </div>
      <div class="panel-body">
        
          <em>No launch files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Messages</h3>
      </div>
      <div class="panel-body">
        
          <ul>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/RawSonarImage.msg" target="_blank">msg/RawSonarImage.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/DetectionFlag.msg" target="_blank">msg/DetectionFlag.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/SonarRanges.msg" target="_blank">msg/SonarRanges.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/ProjectedSonarImage.msg" target="_blank">msg/ProjectedSonarImage.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/SonarDetections.msg" target="_blank">msg/SonarDetections.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/Dvl.msg" target="_blank">msg/Dvl.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/PingInfo.msg" target="_blank">msg/PingInfo.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/SonarImageData.msg" target="_blank">msg/SonarImageData.msg</a></li>
            
          </ul>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Services</h3>
      </div>
      <div class="panel-body">
        
          <em>No service files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Plugins</h3>
      </div>
      <div class="panel-body">
        
          <em>No plugins found.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="kilted-questions">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent questions tagged <kbd>marine_acoustic_msgs</kbd> at <strong><a href="https://robotics.stackexchange.com/" target="_blank">Robotics Stack Exchange</a></strong></h3>      </div>
      <div id="kilted-question-list" class="panel-body" style="display: none;"></div>
      <div id="kilted-no-question-list" class="panel-body" style="display: none;">
        <p>No questions yet, you can ask one <a href="https://robotics.stackexchange.com/questions/tagged/marine_acoustic_msgs+kilted">here</a>.</p>
      </div>
      <div id="kilted-get-question-fail" class="panel-body alert alert-warning" style="display: none;">
        <p>Failed to get question list, you can ticket an issue <a href="https://github.com/ros-infrastructure/rosindex/issues/new" target="_blank" class="alert-link">here</a> </p>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/package_body_tabs.js"></script>

<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
jQuery(function() {
    // Update the count on the links to the contribution suggestions
    updateContributionSuggestionsCountOnPackage('https://github.com/apl-ocean-engineering/marine_msgs.git');
});
</script>

          </div>
          <div class="col-md-2 hidden-xs hidden-sm">
            
            
            



<div class="list-group list-group-sm ">
  <a class="list-group-item"
     target="_blank"
     href="http://docs.ros.org/en/kilted/p/marine_acoustic_msgs"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       
       API Docs
  </a>
  <a class="list-group-item"
     target="_blank"
     href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       
       Browse Code
  </a>
  
  
  
  
  
  
</div>

          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-rolling">
    <div class="container-fluid">
      
        
        
        

        <div class="row">
          <div class="col-md-10">
            

<div class="well well-sm">
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px" src="/assets/package.png">
      </td>
      <td>
        <h3 style="margin-top: 5px">
          <a style="text-decoration:none" href="/p/marine_acoustic_msgs">marine_acoustic_msgs</a> <small>package from <a style="text-decoration:none" href="/r/marine_msgs/github-apl-ocean-engineering-marine_msgs">marine_msgs</a> repo</small>
        </h3>
          
            
            
              <span class="label label-default pkg-label">

marine_acoustic_msgs
</span>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/marine_sensor_msgs">

marine_sensor_msgs
</a>
            
          
      </td>
    </tr>
  </table>
</div>

            <div class="visible-xs visible-sm">
              
              
              



<div class="list-group list-group-sm list-group-horizontal list-group-justified">
  <a class="list-group-item text-center"
     target="_blank"
     href="http://docs.ros.org/en/rolling/p/marine_acoustic_msgs"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       <br>
       API Docs
  </a>
  <a class="list-group-item text-center"
     target="_blank"
     href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       <br>
       Browse Code
  </a>
  
  
  
  
  
  
</div>

            </div>
            



<ul class="nav nav-tabs nav-justified" id="rolling-tabs" style="margin-bottom:20px">
  <li class="better-tabs active">
    <a href="#rolling-overview" data-toggle="tab">Overview</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    
    <a href="#rolling-assets" data-toggle="tab"><span class="label label-primary">8</span> Assets</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    <a href="#rolling-deps" data-toggle="tab"><span class="label label-primary">5</span> Dependencies</a>
  </li>
  <li class="better-tabs">
    
    <a href="#rolling-tutorials" data-toggle="tab"><span class="label label-default">0</span> Tutorials</a>
  </li>
  <li class="better-tabs">
    <a href="#rolling-questions" data-toggle="tab"><span id="rolling-questions-count" class="label label-primary">0</span> Q & A</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="rolling-overview">
    
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h4 class="panel-title">Package Summary</h4></div>
          <div class="panel-body">
            <table class="table table-condensed">
              <tr>
                <td style="width:100px;" class="text-right"><strong>Tags</strong></td>
                <td>
                  
                  
                    <em>No category tags.</em>
                  
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Version</strong></td>
                <td>2.1.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>License</strong></td>
                <td>BSD-3-Clause</td>
              </tr>
              <tr>
                <td class="text-right"><strong>Build type</strong></td>
                <td>
                  
                    <span class="label label-default">
                  
                    AMENT_CMAKE</span>
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Use</strong></td>
                <td>
                
                  <span class="label label-success">RECOMMENDED</span>
                
                </td>
              </tr>
            </table>
          </div>
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body">
            
            
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">Messages for DVLs, multibeams, and imaging sonars.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/apl-ocean-engineering/marine_msgs.git">https://github.com/apl-ocean-engineering/marine_msgs.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">ros2</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2024-03-15
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="No CI information available for this package.">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/marine_msgs/#rolling-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/marine_msgs/#rolling-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/marine_msgs/#rolling-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Package Description</h3></div>
          <div class="panel-body">
            The marine_acoustic_msgs package, including messages for common
  underwater sensors (DVL, multibeam sonar, imaging sonar)
  
          </div>
          <div class="panel-heading"><h4 class="panel-title">Additional Links</h4></div>
          <div class="panel-body">
            
            
              <em>No additional links.</em>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Maintainers</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Laura Lindzey</li>
                
                  <li>Roland Arsenault</li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Authors</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Aaron Marburg</li>
                
                  <li>Ian Vaughn</li>
                
                  <li>Kris Krasnosky</li>
                
                  <li>Laura Lindzey</li>
                
                  <li>Roland Arsenault</li>
                
              </ul>
            
          </div>
        </div>
      </div>
    </div>
    
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-heading"><span class="glyphicon glyphicon-file"></span><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/README.md" title="Open in git repository">marine_acoustic_msgs/README.md</a></div>
              <div class="panel-body">
                    <div class="rendered-markdown">
<h2 id="marine_acoustic_msgs">marine_acoustic_msgs</h2>

<p>This package includes messages for three commonly used sensors for research in underwater autonomy:</p>
<ul>
  <li>DVL</li>
  <li>Multibeam</li>
  <li>Imaging Sonar</li>
</ul>

<p>Each of the proposed messages is based on an existing
message that is currently in use across a variety of manufacturers of the
same instrument type. This gives us confidence that they are mature enough
to be indexed in the ROS debs and that they will generalize across other sensors.</p>

<h2 id="coordinate-frame-conventions">Coordinate Frame Conventions</h2>
<p><img src="https://user-images.githubusercontent.com/23006525/167165812-008ccccb-31a7-4c13-b2da-6235d37a7a3b.png" alt="cordiante_conventions"></p>

<h2 id="design-decisions-common-across-multiple-acoustic-messages">Design decisions common across multiple acoustic messages</h2>

<p>Looking at the differences among existing open source UUV messages for
acoustic sensors, there are a number of overarching design decisions to be
made before defining individual messages. The proposed set of messages
adheres to these guidelines:</p>

<ul>
  <li>The messages should be suitable for use across a wide variety of hardware.
    <ul>
      <li>Any sensor-specific metadata fields should be published in a separate message.
Standards for defining these additional messages are beyond the scope of this PR.
However, options include:
        <ul>
          <li>Capture all raw bytes sent to / received from a sensor (e.g. WHOI’s RawData.msg)</li>
          <li>Publish a separate message corresponding exactly to the datagrams
sent by the sensor (e.g. PD0.msg)</li>
          <li>Publish a separate message with the additional data, but no duplication
of the standard message, following the Image/CameraInfo pattern.</li>
        </ul>
      </li>
      <li>In order to support generality for a wide range of sensors, there will be some
fields that are not applicable to some sensors.
        <ul>
          <li>If not supported at all, the array may be left empty.</li>
          <li>If value is constant across the data frame, array may be length 1.</li>
          <li>Otherwise, the length of each array should match the length of the data.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>“raw/temporal” Underwater acoustic messages should include the speed of sound
(field will be called sound_speed) that was used by the sensor, as well as any
information required to raytrace the data with a new sound velocity profile.</li>
  <li>“processed/spatial” acoustic messages will have the ray-tracing already performed.</li>
  <li>The beam geometry is specified as a per-beam vector relative to the frame in
the header. This is an alternative to other approaches that have been used, including:
    <ul>
      <li>additional TF frames for individual beams, which will quickly become unwieldy</li>
      <li>an array of beam messages, where each beam includes its geometry relative
to the sensor. Abstracting out the individual beams doesn’t serve to simplify
the interpretation of the data, and doesn’t enable using an empty vector to
indicate that a field isn’t applicable.</li>
      <li>follow LaserScan convention and derive the geometry from min/max/step,
which doesn’t generalize across sonars, since they do not all have beams
spaced equiangualarly.</li>
    </ul>
  </li>
  <li>Individual message types should be based on how the data is used, rather
than similarities in data format. For example:
    <ul>
      <li>DVL and ADCP messages should not be combined, even though there is
significant overlap in hardware and provided data. Consumers of DVL
data expect a single velocity. Consumers of ADCP data expect velocities
at an array of ranges.</li>
      <li>There is a need for a difference between SonarImage and SonarRanges
(aka multibeam), since they are not typically interchangeable in
downstream processing algorithms, even though the newer sensors are
blurring the lines. A sonar image consists of intensities-vs-time,
while sonar ranges identify discrete returns.</li>
    </ul>
  </li>
  <li>In order to be consistent with other messages in sensor_msgs, message
types should be named after the type of data rather than type of sensor:
    <ul>
      <li>SonarImage.msg instead of ImagingSonar.msg</li>
      <li>SonarRanges.msg instead of Multibeam.msg or ProfilingSonar.msg.</li>
    </ul>
  </li>
</ul>

<h2 id="dvl">DVL</h2>
<h3 id="existing-messages">Existing Messages</h3>

<p>The most widely used messages appear to be:</p>
<ul>
  <li>WHOI’s <a href="https://bitbucket.org/whoidsl/ds_msgs/src/master/ds_sensor_msgs/msg/Dvl.msg">ds_sensor_msgs/Dvl.msg</a>.
It is currently in use with both RDI and Nortek instruments.</li>
  <li>UUV Simulator’s <a href="https://github.com/uuvsimulator/uuv_simulator/blob/master/uuv_sensor_plugins/uuv_sensor_ros_plugins_msgs/msg/DVL.msg">uuv_sensor_ros_plugins_msgs/DVL.msg</a>
(This was used as the base for <a href="https://github.com/udgcirs/marine_ros_conventions_discussion/blob/master/sensor_msgs/DVL.msg">marine_ros_conventions_discussion/DVL.msg</a>)
The main implementation difference between ds_sensor_msgs and uuv_simulator is
whether the top-level DVL message includes the beam data in an array,
or whether there is an array of DvlBeam messages.</li>
  <li>UWSim’s <a href="https://github.com/uji-ros-pkg/underwater_simulation/blob/melodic-devel/underwater_sensor_msgs/msg/DVL.msg">underwater_sensor_msgs/DVL.msg</a>.
It is not particularly idiomatic for a ROS message: Rather than using a
Vector3 for velocity, it has individual fields (wi_{x,y,z}_axis); and
rather than using TF to transform between frames, it includes the data in
instrument-referenced and vehicle-referenced frames within the same message.</li>
</ul>

<p>While all options agree that the DVL message should include aggregate data
from the instrument (estimated altitude and velocity), they differ in what else is included:</p>
<ul>
  <li>Per-beam data (range, velocity, and their covariances): WHOI &amp; UUV Simulator</li>
  <li>Both bottom-track and water-track velocities: WHOI &amp; UWSim</li>
  <li>Additional details about the sensor configuration: WHOI</li>
</ul>

<h3 id="dvl-specific-design-decisions">DVL-specific design decisions</h3>
<ul>
  <li>Is there broad support for including water-track velocity in addition to ground-track in the same message definition?
    <ul>
      <li>NPS is currently interleaving DVL &amp; ADCP messages from the same driver for an instrument that provides both an ADCP profile and a DVL bottom-track velocity. I like this approach.</li>
      <li>If the same message type supports both bottom track and water track (single reading, not profile), maybe there should be a convention that bottom track / water track are published on different topics so subscribing nodes can ignore water track velocities if they don’t use them.</li>
    </ul>
  </li>
  <li>Whether the additional information about the sensor configuration (DVL_TYPE) belongs in the top-level message. Other messages in sensor_msgs do not tend to have similar flags; however, this depends on whether we want to be able to perform sound velocity corrections using the data in the DVL message.</li>
  <li>Does a quality flag belong in the standardized message?</li>
</ul>

<h3 id="proposed-message">Proposed Message</h3>

<p>https://github.com/apl-ocean-engineering/marine_msgs/blob/main/marine_acoustic_msgs/msg/Dvl.msg</p>

<p>This message started with WHOI’s definition, which has been used in
drivers for Nortek and RDI DVLs. There are also corresponding rviz
and gazebo plugins. (I have trivial forks of those plugins supporting the proposed message.)</p>

<p>I propose the following changes from WHOI’s original message:</p>
<ul>
  <li>Remove the ds_header – DsHeader was an attempt to add some hardware-specific
metadata to the sensor processing pipeline. It was never fully implemented,
and isn’t consistent with other definitions in sensor_msgs.</li>
  <li>Remove dvl_time – this was originally intended to support integration of
DVL messages from instruments that only provide a monotonic count rather
than fully-synchronized timestamps. With modern instruments, <code class="language-plaintext highlighter-rouge">header.stamp</code>
should capture a posix time suitable for integrating the reported velocity.</li>
  <li>Replace coordinate_mode with beams_valid flag. The 3D velocity and altitude
should always be reported in the instrument frame which is specified in the
header, and beam ranges/velocities are scalars measured along the corresponding <code class="language-plaintext highlighter-rouge">beam_unit_vec</code>.</li>
  <li>speed_sound -&gt; sound_speed for consistency across acoustic messages</li>
</ul>

<h2 id="multibeam-and-forward-looking-sonar-fls-messages">Multibeam and Forward Looking Sonar (FLS) messages</h2>

<h3 id="organization">Organization</h3>
<p><img src="https://user-images.githubusercontent.com/23006525/160207155-eb9c003e-8a9a-460e-8c1d-6240924e81e6.png" alt="data_structure"></p>

<p>Multibeam and FLS sonar data (referred to as sonar data for brevity) are broken into two type categories, detections and images.   Images are intended to represent Watercolumn or FLS imaging data.   Detections represent a detection reported by the sonar for a given beam.</p>

<p>Sonar data is also organized into two domain categories,  temporal and spatial.  Messages are intended to be initially reported in the temporal domain by the sonar drive then converted to the spatial domain through a processing pipeline.   However, some sonars report images and detections directly in the spatial domain.  In this case, sensor drivers may report directly with the appropriate spatial message.</p>

<h3 id="data-structure">Data structure</h3>
<p>the Sonar messages consist of top level messages:</p>
<ul>
  <li>RawSonarImage</li>
  <li>ProjectedSonarImage</li>
  <li>SonarDetection</li>
  <li>SonarRanges</li>
</ul>

<p>These messages share common data in the following sub-messages:</p>
<ul>
  <li>DetectionFlag</li>
  <li>PingInfo</li>
  <li>SonarImageData</li>
</ul>

<h4 id="sonarimagedata-packing">SonarImageData packing</h4>

<p>It’s worth mentioning how the data is packed in the sonar image message as it may not be obvious.</p>

<ul>
  <li>the actual pixel data is in row-major (i.e beam_no major) order.</li>
  <li>the pixel data is stored as an array of bytes (uint8). It should be cast as the type specified in dtype flag. They are enumerated in the message</li>
  <li>to find the range for each cell: (sample_number + sample0) * sound_speed / (2.0 * sample_rate)</li>
</ul>

<p>The image details details how image data is stored.</p>

<p><img src="https://user-images.githubusercontent.com/23006525/160203744-7fc6b06a-ac3d-4419-b6a9-fec83e07cef7.png" alt="wcl_def"></p>

<h3 id="geometry-conventions">Geometry Conventions</h3>
<p><img src="https://user-images.githubusercontent.com/23006525/167165995-ce578962-be79-4219-89a0-920953ca6cb2.png" alt="rx_tx_detail"></p>

<ul>
  <li>angles/beam directions in the spatial domain shall:
    <ul>
      <li>be reported as unit vectors according to the coordinate frame convention specified above.</li>
      <li>be reported at time reported in the header timestamp.  (at or before transmit time)</li>
    </ul>
  </li>
  <li>angles/beam directions in the temporal domain shall be reported as transmit (Tx) and receive (Rx) angles according to the diagram above
    <ul>
      <li>rx_angle is defined as the elevation from the X-Z plane at receive time. This elevation is positive toward the Y axis.  This elevation defines a cone of possible return directions for a given return beam.</li>
      <li>tx_angle is defined as the elevation from the Y-Z plane at transmit time. This elevation is positive toward the X axis.  This elevation defines a cone that represents the area insonified by the tx pulse.</li>
    </ul>
  </li>
</ul>

<h3 id="style-conventions">Style Conventions</h3>
<p>These messages were designed to comply with the conventions set forth by the <a href="http://wiki.ros.org/ROS/Patterns/Conventions#Messages">ROS/Patterns/Conventions guide</a>.   Beyond that, we have set the following conventions:</p>
<ul>
  <li>All vector quantities should have plural names</li>
  <li>Variable length message components should be represented as vectors of core ros messages like std_msgs or geometry_msgs.  Avoid variable length arrays of custom message types.  * In otherwords, favor “structures of arrays” rather than “arrays of structures”. One exception is the case where data must be grouped to be interpreted properly AND is shared across multiple messages.  (eg. an int with an associated enum.  See PingInfo.msg)</li>
  <li>Message components common to several top-level messages should be split into sub-messages.  (eg. PingInfo is shared by SonarRanges, SonarDetections and RawSonarImage)</li>
  <li>
<strong>(PROVISIONAL)</strong> Vector quantities may be of length zero.  This shall be interpreted as “unreported”.  (see internal MSG documentation for more details)</li>
</ul>
</div>
              </div>
            </div>
          </div>
        </div>
      
    
    <div class="row">
      <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-heading"><span class="glyphicon glyphicon-list"></span> CHANGELOG</div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="changelog-for-package-marine_acoustic_msgs">Changelog for package marine_acoustic_msgs</h1>

<h2 id="210-2024-03-15">2.1.0 (2024-03-15)</h2>

<ul>
  <li>Update CMake files to follow established standards</li>
  <li>Add Roland Arsenault as maintainer</li>
  <li>Update ros2 CI to use current ROS2 distributions
(<a href="https://github.com/apl-ocean-engineering/marine_msgs/issues/56">#56</a>)</li>
  <li>Updated ros2 branch to be in line with revisions in main
(<a href="https://github.com/apl-ocean-engineering/marine_msgs/issues/44">#44</a>)</li>
  <li>Contributors: Roland Arsenault, Sean Fish, Laura Lindzey</li>
</ul>

<h2 id="110-2022-11-30">1.1.0 (2022-11-30)</h2>

<ul>
  <li>Fix ProjectedSonarImage comments about frame
(<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/26">#26</a>)</li>
  <li>Add CI, pre-commit, prerelease and dependabot
(<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/27">#27</a>)
Co-authored-by: Laura Lindzey &lt;&lt;lindzey@uw.edu&gt;&gt;</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/25">#25</a>
from apl-ocean-engineering/add_migration_rule Add migration rule
from v0.0.1 to 28ec6a7</li>
  <li>Add migration rule from v0.0.1 to 28ec6a7</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/22">#22</a>
from rolker/fix_variable_name</li>
  <li>Rename num_beams to beam_count.</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/21">#21</a>
from CaptKrasno/acoustic_msg_devel</li>
  <li>Contributors: CaptKrasno, Laura Lindzey, Roland Arsenault, Vatan
Aksoy Tezer, lauralindzey</li>
</ul>

<h2 id="100-2022-05-05">1.0.0 (2022-05-05)</h2>

<ul>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/20">#20</a>
from CaptKrasno/acoustic_msg_devel Acoustic msg devel</li>
  <li>Removed unused (old) sonarImage message</li>
  <li>Merge remote-tracking branch 'apl-ocean-engineering/main' into
acoustic_msg_devel</li>
  <li>added ping info to sonar ranges</li>
  <li>Number of beams has been added to sonarImageData so it can be
decoded independently</li>
  <li>Update README.md</li>
  <li>Merge remote-tracking branch 'origin/main' into
acoustic_msg_devel</li>
  <li>committing changes from meeting</li>
  <li>Update README.md</li>
  <li>Changes after pull request discussion</li>
  <li>update internal documentation</li>
  <li>Merge branch 'main' into acoustic_msg_devel</li>
  <li>Add multibeam detections and watercolumn</li>
  <li>Contributors: CaptKrasno, Kristopher Krasnosky, lauralindzey</li>
</ul>

<h2 id="001-2021-11-23">0.0.1 (2021-11-23)</h2>

<ul>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/13">#13</a>
from amarburg/feature/revise-sonar-image-comment Feature/revise
sonar image comment</li>
  <li>Revised comments based on PR feedback.</li>
  <li>Revised based on comments on PR Removed language on 2D sonars
Revised language on azimuth and elevation angles Revised language on
header timestamp.</li>
  <li>Added note on sound speed.</li>
  <li>Very minor update in spelling.</li>
  <li>Significant rewrite of the explanatory comment in SonarImage.msg</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/10">#10</a>
from valschmidt/main Fixed broken links for proposed messages.</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/1">#1</a>
from valschmidt/valschmidt-fixed_broken_msg_links Fixed broken
links to proposed messages.</li>
  <li>Fixed broken links to proposed messages.</li>
  <li>Create Contributing.md First pass at the contributing doc adapted
from MBARI's LRAUV contributing guide</li>
  <li>Move acoustic_msgs package out of repo's root directory.</li>
  <li>Contributors: Aaron Marburg, CaptKrasno, Laura Lindzey, braanan,
lauralindzey, valschmidt</li>
</ul>
</div>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="rolling-tutorials">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wiki Tutorials</h3>
      </div>
      <div class="panel-body">
        
        <em>This package does not provide any links to tutorials in it's <a href="https://index.ros.org/contribute/metadata/">rosindex metadata</a>.</em>
        <em>You can check on the <a href="http://wiki.ros.org/marine_acoustic_msgs/Tutorials" target="_blank">ROS Wiki Tutorials</a> page for the package.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="rolling-deps">
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Package Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th class="text-center">Deps</th>
                  <th style="width: 100%">Name</th>
                </thead>
                <tbody>
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake#rolling-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake#rolling">ament_cmake  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_generators#rolling-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_generators#rolling">rosidl_default_generators  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_runtime#rolling-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_runtime#rolling">rosidl_default_runtime  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/std_msgs#rolling-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/std_msgs#rolling">std_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/geometry_msgs#rolling-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/geometry_msgs#rolling">geometry_msgs  </a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
          <div class="panel-heading">
            <h3 class="panel-title">System Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <em>No direct system dependencies.</em>
            
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Dependant Packages</h3>
          </div>
          <div class="panel-body">
            
              <em>No known dependants.</em>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="rolling-assets">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Launch files</h3>
      </div>
      <div class="panel-body">
        
          <em>No launch files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Messages</h3>
      </div>
      <div class="panel-body">
        
          <ul>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/RawSonarImage.msg" target="_blank">msg/RawSonarImage.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/DetectionFlag.msg" target="_blank">msg/DetectionFlag.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/SonarRanges.msg" target="_blank">msg/SonarRanges.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/ProjectedSonarImage.msg" target="_blank">msg/ProjectedSonarImage.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/SonarDetections.msg" target="_blank">msg/SonarDetections.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/Dvl.msg" target="_blank">msg/Dvl.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/PingInfo.msg" target="_blank">msg/PingInfo.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/SonarImageData.msg" target="_blank">msg/SonarImageData.msg</a></li>
            
          </ul>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Services</h3>
      </div>
      <div class="panel-body">
        
          <em>No service files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Plugins</h3>
      </div>
      <div class="panel-body">
        
          <em>No plugins found.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="rolling-questions">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent questions tagged <kbd>marine_acoustic_msgs</kbd> at <strong><a href="https://robotics.stackexchange.com/" target="_blank">Robotics Stack Exchange</a></strong></h3>      </div>
      <div id="rolling-question-list" class="panel-body" style="display: none;"></div>
      <div id="rolling-no-question-list" class="panel-body" style="display: none;">
        <p>No questions yet, you can ask one <a href="https://robotics.stackexchange.com/questions/tagged/marine_acoustic_msgs+rolling">here</a>.</p>
      </div>
      <div id="rolling-get-question-fail" class="panel-body alert alert-warning" style="display: none;">
        <p>Failed to get question list, you can ticket an issue <a href="https://github.com/ros-infrastructure/rosindex/issues/new" target="_blank" class="alert-link">here</a> </p>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/package_body_tabs.js"></script>

<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
jQuery(function() {
    // Update the count on the links to the contribution suggestions
    updateContributionSuggestionsCountOnPackage('https://github.com/apl-ocean-engineering/marine_msgs.git');
});
</script>

          </div>
          <div class="col-md-2 hidden-xs hidden-sm">
            
            
            



<div class="list-group list-group-sm ">
  <a class="list-group-item"
     target="_blank"
     href="http://docs.ros.org/en/rolling/p/marine_acoustic_msgs"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       
       API Docs
  </a>
  <a class="list-group-item"
     target="_blank"
     href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       
       Browse Code
  </a>
  
  
  
  
  
  
</div>

          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-github">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>github</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-noetic">
    <div class="container-fluid">
      
        
        
        

        <div class="row">
          <div class="col-md-10">
            

<div class="well well-sm">
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px" src="/assets/package.png">
      </td>
      <td>
        <h3 style="margin-top: 5px">
          <a style="text-decoration:none" href="/p/marine_acoustic_msgs">marine_acoustic_msgs</a> <small>package from <a style="text-decoration:none" href="/r/marine_msgs/github-apl-ocean-engineering-marine_msgs">marine_msgs</a> repo</small>
        </h3>
          
            
            
              <span class="label label-default pkg-label">

marine_acoustic_msgs
</span>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/marine_sensor_msgs">

marine_sensor_msgs
</a>
            
          
      </td>
    </tr>
  </table>
</div>

            <div class="visible-xs visible-sm">
              
              
              



<div class="list-group list-group-sm list-group-horizontal list-group-justified">
  <a class="list-group-item text-center"
     target="_blank"
     href="http://docs.ros.org/en/noetic/api/marine_acoustic_msgs/html/"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       <br>
       API Docs
  </a>
  <a class="list-group-item text-center"
     target="_blank"
     href="https://github.com/apl-ocean-engineering/marine_msgs/tree/main/marine_acoustic_msgs"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       <br>
       Browse Code
  </a>
  
  
  
  
  
  <a class="list-group-item text-center "
     target="_blank"
     href="http://wiki.ros.org/marine_acoustic_msgs?distro=noetic"
     title="View this package on wiki.ros.org">
       <span style="margin-right: 5px;" class="glyphicon glyphicon-info-sign"></span>
       <br>
       Wiki
  </a>
  
  
</div>

            </div>
            



<ul class="nav nav-tabs nav-justified" id="noetic-tabs" style="margin-bottom:20px">
  <li class="better-tabs active">
    <a href="#noetic-overview" data-toggle="tab">Overview</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    
    <a href="#noetic-assets" data-toggle="tab"><span class="label label-primary">8</span> Assets</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    <a href="#noetic-deps" data-toggle="tab"><span class="label label-primary">6</span> Dependencies</a>
  </li>
  <li class="better-tabs">
    
    <a href="#noetic-tutorials" data-toggle="tab"><span class="label label-default">0</span> Tutorials</a>
  </li>
  <li class="better-tabs">
    <a href="#noetic-questions" data-toggle="tab"><span id="noetic-questions-count" class="label label-primary">0</span> Q & A</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="noetic-overview">
    
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h4 class="panel-title">Package Summary</h4></div>
          <div class="panel-body">
            <table class="table table-condensed">
              <tr>
                <td style="width:100px;" class="text-right"><strong>Tags</strong></td>
                <td>
                  
                  
                    <em>No category tags.</em>
                  
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Version</strong></td>
                <td>2.0.2</td>
              </tr>
              <tr>
                <td class="text-right"><strong>License</strong></td>
                <td>BSD-3-Clause</td>
              </tr>
              <tr>
                <td class="text-right"><strong>Build type</strong></td>
                <td>
                  
                    <span class="label label-info">
                  
                    CATKIN</span>
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Use</strong></td>
                <td>
                
                  <span class="label label-success">RECOMMENDED</span>
                
                </td>
              </tr>
            </table>
          </div>
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body">
            
            
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">Messages for DVLs, multibeams, and imaging sonars.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/apl-ocean-engineering/marine_msgs.git">https://github.com/apl-ocean-engineering/marine_msgs.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">main</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2024-03-15
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="No CI information available for this package.">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/marine_msgs/#noetic-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/marine_msgs/#noetic-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/marine_msgs/#noetic-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Package Description</h3></div>
          <div class="panel-body">
            The marine_acoustic_msgs package, including messages for common
  underwater sensors (DVL, multibeam sonar, imaging sonar)
  
          </div>
          <div class="panel-heading"><h4 class="panel-title">Additional Links</h4></div>
          <div class="panel-body">
            
            
              <em>No additional links.</em>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Maintainers</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Laura Lindzey</li>
                
                  <li>Roland Arsenault</li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Authors</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Aaron Marburg</li>
                
                  <li>Ian Vaughn</li>
                
                  <li>Kris Krasnosky</li>
                
                  <li>Laura Lindzey</li>
                
                  <li>Roland Arsenault</li>
                
              </ul>
            
          </div>
        </div>
      </div>
    </div>
    
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-heading"><span class="glyphicon glyphicon-file"></span><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/main/marine_acoustic_msgs/README.md" title="Open in git repository">marine_acoustic_msgs/README.md</a></div>
              <div class="panel-body">
                    <div class="rendered-markdown">
<h2 id="marine_acoustic_msgs">marine_acoustic_msgs</h2>

<p>This package includes messages for three commonly used sensors for research in underwater autonomy:</p>
<ul>
  <li>DVL</li>
  <li>Multibeam</li>
  <li>Imaging Sonar</li>
</ul>

<p>Each of the proposed messages is based on an existing
message that is currently in use across a variety of manufacturers of the
same instrument type. This gives us confidence that they are mature enough
to be indexed in the ROS debs and that they will generalize across other sensors.</p>

<h2 id="coordinate-frame-conventions">Coordinate Frame Conventions</h2>
<p><img src="https://user-images.githubusercontent.com/23006525/167165812-008ccccb-31a7-4c13-b2da-6235d37a7a3b.png" alt="cordiante_conventions"></p>

<h2 id="design-decisions-common-across-multiple-acoustic-messages">Design decisions common across multiple acoustic messages</h2>

<p>Looking at the differences among existing open source UUV messages for
acoustic sensors, there are a number of overarching design decisions to be
made before defining individual messages. The proposed set of messages
adheres to these guidelines:</p>

<ul>
  <li>The messages should be suitable for use across a wide variety of hardware.
    <ul>
      <li>Any sensor-specific metadata fields should be published in a separate message.
Standards for defining these additional messages are beyond the scope of this PR.
However, options include:
        <ul>
          <li>Capture all raw bytes sent to / received from a sensor (e.g. WHOI’s RawData.msg)</li>
          <li>Publish a separate message corresponding exactly to the datagrams
sent by the sensor (e.g. PD0.msg)</li>
          <li>Publish a separate message with the additional data, but no duplication
of the standard message, following the Image/CameraInfo pattern.</li>
        </ul>
      </li>
      <li>In order to support generality for a wide range of sensors, there will be some
fields that are not applicable to some sensors.
        <ul>
          <li>If not supported at all, the array may be left empty.</li>
          <li>If value is constant across the data frame, array may be length 1.</li>
          <li>Otherwise, the length of each array should match the length of the data.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>“raw/temporal” Underwater acoustic messages should include the speed of sound
(field will be called sound_speed) that was used by the sensor, as well as any
information required to raytrace the data with a new sound velocity profile.</li>
  <li>“processed/spatial” acoustic messages will have the ray-tracing already performed.</li>
  <li>The beam geometry is specified as a per-beam vector relative to the frame in
the header. This is an alternative to other approaches that have been used, including:
    <ul>
      <li>additional TF frames for individual beams, which will quickly become unwieldy</li>
      <li>an array of beam messages, where each beam includes its geometry relative
to the sensor. Abstracting out the individual beams doesn’t serve to simplify
the interpretation of the data, and doesn’t enable using an empty vector to
indicate that a field isn’t applicable.</li>
      <li>follow LaserScan convention and derive the geometry from min/max/step,
which doesn’t generalize across sonars, since they do not all have beams
spaced equiangualarly.</li>
    </ul>
  </li>
  <li>Individual message types should be based on how the data is used, rather
than similarities in data format. For example:
    <ul>
      <li>DVL and ADCP messages should not be combined, even though there is
significant overlap in hardware and provided data. Consumers of DVL
data expect a single velocity. Consumers of ADCP data expect velocities
at an array of ranges.</li>
      <li>There is a need for a difference between SonarImage and SonarRanges
(aka multibeam), since they are not typically interchangeable in
downstream processing algorithms, even though the newer sensors are
blurring the lines. A sonar image consists of intensities-vs-time,
while sonar ranges identify discrete returns.</li>
    </ul>
  </li>
  <li>In order to be consistent with other messages in sensor_msgs, message
types should be named after the type of data rather than type of sensor:
    <ul>
      <li>SonarImage.msg instead of ImagingSonar.msg</li>
      <li>SonarRanges.msg instead of Multibeam.msg or ProfilingSonar.msg.</li>
    </ul>
  </li>
</ul>

<h2 id="dvl">DVL</h2>
<h3 id="existing-messages">Existing Messages</h3>

<p>The most widely used messages appear to be:</p>
<ul>
  <li>WHOI’s <a href="https://bitbucket.org/whoidsl/ds_msgs/src/master/ds_sensor_msgs/msg/Dvl.msg">ds_sensor_msgs/Dvl.msg</a>.
It is currently in use with both RDI and Nortek instruments.</li>
  <li>UUV Simulator’s <a href="https://github.com/uuvsimulator/uuv_simulator/blob/master/uuv_sensor_plugins/uuv_sensor_ros_plugins_msgs/msg/DVL.msg">uuv_sensor_ros_plugins_msgs/DVL.msg</a>
(This was used as the base for <a href="https://github.com/udgcirs/marine_ros_conventions_discussion/blob/master/sensor_msgs/DVL.msg">marine_ros_conventions_discussion/DVL.msg</a>)
The main implementation difference between ds_sensor_msgs and uuv_simulator is
whether the top-level DVL message includes the beam data in an array,
or whether there is an array of DvlBeam messages.</li>
  <li>UWSim’s <a href="https://github.com/uji-ros-pkg/underwater_simulation/blob/melodic-devel/underwater_sensor_msgs/msg/DVL.msg">underwater_sensor_msgs/DVL.msg</a>.
It is not particularly idiomatic for a ROS message: Rather than using a
Vector3 for velocity, it has individual fields (wi_{x,y,z}_axis); and
rather than using TF to transform between frames, it includes the data in
instrument-referenced and vehicle-referenced frames within the same message.</li>
</ul>

<p>While all options agree that the DVL message should include aggregate data
from the instrument (estimated altitude and velocity), they differ in what else is included:</p>
<ul>
  <li>Per-beam data (range, velocity, and their covariances): WHOI &amp; UUV Simulator</li>
  <li>Both bottom-track and water-track velocities: WHOI &amp; UWSim</li>
  <li>Additional details about the sensor configuration: WHOI</li>
</ul>

<h3 id="dvl-specific-design-decisions">DVL-specific design decisions</h3>
<ul>
  <li>Is there broad support for including water-track velocity in addition to ground-track in the same message definition?
    <ul>
      <li>NPS is currently interleaving DVL &amp; ADCP messages from the same driver for an instrument that provides both an ADCP profile and a DVL bottom-track velocity. I like this approach.</li>
      <li>If the same message type supports both bottom track and water track (single reading, not profile), maybe there should be a convention that bottom track / water track are published on different topics so subscribing nodes can ignore water track velocities if they don’t use them.</li>
    </ul>
  </li>
  <li>Whether the additional information about the sensor configuration (DVL_TYPE) belongs in the top-level message. Other messages in sensor_msgs do not tend to have similar flags; however, this depends on whether we want to be able to perform sound velocity corrections using the data in the DVL message.</li>
  <li>Does a quality flag belong in the standardized message?</li>
</ul>

<h3 id="proposed-message">Proposed Message</h3>

<p>https://github.com/apl-ocean-engineering/marine_msgs/blob/main/marine_acoustic_msgs/msg/Dvl.msg</p>

<p>This message started with WHOI’s definition, which has been used in
drivers for Nortek and RDI DVLs. There are also corresponding rviz
and gazebo plugins. (I have trivial forks of those plugins supporting the proposed message.)</p>

<p>I propose the following changes from WHOI’s original message:</p>
<ul>
  <li>Remove the ds_header – DsHeader was an attempt to add some hardware-specific
metadata to the sensor processing pipeline. It was never fully implemented,
and isn’t consistent with other definitions in sensor_msgs.</li>
  <li>Remove dvl_time – this was originally intended to support integration of
DVL messages from instruments that only provide a monotonic count rather
than fully-synchronized timestamps. With modern instruments, <code class="language-plaintext highlighter-rouge">header.stamp</code>
should capture a posix time suitable for integrating the reported velocity.</li>
  <li>Replace coordinate_mode with beams_valid flag. The 3D velocity and altitude
should always be reported in the instrument frame which is specified in the
header, and beam ranges/velocities are scalars measured along the corresponding <code class="language-plaintext highlighter-rouge">beam_unit_vec</code>.</li>
  <li>speed_sound -&gt; sound_speed for consistency across acoustic messages</li>
</ul>

<h2 id="multibeam-and-forward-looking-sonar-fls-messages">Multibeam and Forward Looking Sonar (FLS) messages</h2>

<h3 id="organization">Organization</h3>
<p><img src="https://user-images.githubusercontent.com/23006525/160207155-eb9c003e-8a9a-460e-8c1d-6240924e81e6.png" alt="data_structure"></p>

<p>Multibeam and FLS sonar data (referred to as sonar data for brevity) are broken into two type categories, detections and images.   Images are intended to represent Watercolumn or FLS imaging data.   Detections represent a detection reported by the sonar for a given beam.</p>

<p>Sonar data is also organized into two domain categories,  temporal and spatial.  Messages are intended to be initially reported in the temporal domain by the sonar drive then converted to the spatial domain through a processing pipeline.   However, some sonars report images and detections directly in the spatial domain.  In this case, sensor drivers may report directly with the appropriate spatial message.</p>

<h3 id="data-structure">Data structure</h3>
<p>the Sonar messages consist of top level messages:</p>
<ul>
  <li>RawSonarImage</li>
  <li>ProjectedSonarImage</li>
  <li>SonarDetection</li>
  <li>SonarRanges</li>
</ul>

<p>These messages share common data in the following sub-messages:</p>
<ul>
  <li>DetectionFlag</li>
  <li>PingInfo</li>
  <li>SonarImageData</li>
</ul>

<h4 id="sonarimagedata-packing">SonarImageData packing</h4>

<p>It’s worth mentioning how the data is packed in the sonar image message as it may not be obvious.</p>

<ul>
  <li>the actual pixel data is in row-major (i.e beam_no major) order.</li>
  <li>the pixel data is stored as an array of bytes (uint8). It should be cast as the type specified in dtype flag. They are enumerated in the message</li>
  <li>to find the range for each cell: (sample_number + sample0) * sound_speed / (2.0 * sample_rate)</li>
</ul>

<p>The image details details how image data is stored.</p>

<p><img src="https://user-images.githubusercontent.com/23006525/160203744-7fc6b06a-ac3d-4419-b6a9-fec83e07cef7.png" alt="wcl_def"></p>

<h3 id="geometry-conventions">Geometry Conventions</h3>
<p><img src="https://user-images.githubusercontent.com/23006525/167165995-ce578962-be79-4219-89a0-920953ca6cb2.png" alt="rx_tx_detail"></p>

<ul>
  <li>angles/beam directions in the spatial domain shall:
    <ul>
      <li>be reported as unit vectors according to the coordinate frame convention specified above.</li>
      <li>be reported at time reported in the header timestamp.  (at or before transmit time)</li>
    </ul>
  </li>
  <li>angles/beam directions in the temporal domain shall be reported as transmit (Tx) and receive (Rx) angles according to the diagram above
    <ul>
      <li>rx_angle is defined as the elevation from the X-Z plane at receive time. This elevation is positive toward the Y axis.  This elevation defines a cone of possible return directions for a given return beam.</li>
      <li>tx_angle is defined as the elevation from the Y-Z plane at transmit time. This elevation is positive toward the X axis.  This elevation defines a cone that represents the area insonified by the tx pulse.</li>
    </ul>
  </li>
</ul>

<h3 id="style-conventions">Style Conventions</h3>
<p>These messages were designed to comply with the conventions set forth by the <a href="http://wiki.ros.org/ROS/Patterns/Conventions#Messages">ROS/Patterns/Conventions guide</a>.   Beyond that, we have set the following conventions:</p>
<ul>
  <li>All vector quantities should have plural names</li>
  <li>Variable length message components should be represented as vectors of core ros messages like std_msgs or geometry_msgs.  Avoid variable length arrays of custom message types.  * In otherwords, favor “structures of arrays” rather than “arrays of structures”. One exception is the case where data must be grouped to be interpreted properly AND is shared across multiple messages.  (eg. an int with an associated enum.  See PingInfo.msg)</li>
  <li>Message components common to several top-level messages should be split into sub-messages.  (eg. PingInfo is shared by SonarRanges, SonarDetections and RawSonarImage)</li>
  <li>
<strong>(PROVISIONAL)</strong> Vector quantities may be of length zero.  This shall be interpreted as “unreported”.  (see internal MSG documentation for more details)</li>
</ul>
</div>
              </div>
            </div>
          </div>
        </div>
      
    
    <div class="row">
      <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-heading"><span class="glyphicon glyphicon-list"></span> CHANGELOG</div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="changelog-for-package-marine_acoustic_msgs">Changelog for package marine_acoustic_msgs</h1>

<h2 id="202-2024-03-15">2.0.2 (2024-03-15)</h2>

<ul>
  <li>Add Roland Arsenault as maintainer
(<a href="https://github.com/rolker/marine_msgs/issues/55">#55</a>)</li>
  <li>Contributors: Roland Arsenault</li>
</ul>

<h2 id="201-2024-02-13">2.0.1 (2024-02-13)</h2>

<h2 id="110-2022-11-30">1.1.0 (2022-11-30)</h2>

<ul>
  <li>Fix ProjectedSonarImage comments about frame
(<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/26">#26</a>)</li>
  <li>Add CI, pre-commit, prerelease and dependabot
(<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/27">#27</a>)
Co-authored-by: Laura Lindzey &lt;&lt;lindzey@uw.edu&gt;&gt;</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/25">#25</a>
from apl-ocean-engineering/add_migration_rule Add migration rule
from v0.0.1 to 28ec6a7</li>
  <li>Add migration rule from v0.0.1 to 28ec6a7</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/22">#22</a>
from rolker/fix_variable_name</li>
  <li>Rename num_beams to beam_count.</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/21">#21</a>
from CaptKrasno/acoustic_msg_devel</li>
  <li>Contributors: CaptKrasno, Laura Lindzey, Roland Arsenault, Vatan
Aksoy Tezer, lauralindzey</li>
</ul>

<h2 id="100-2022-05-05">1.0.0 (2022-05-05)</h2>

<ul>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/20">#20</a>
from CaptKrasno/acoustic_msg_devel Acoustic msg devel</li>
  <li>Removed unused (old) sonarImage message</li>
  <li>Merge remote-tracking branch 'apl-ocean-engineering/main' into
acoustic_msg_devel</li>
  <li>added ping info to sonar ranges</li>
  <li>Number of beams has been added to sonarImageData so it can be
decoded independently</li>
  <li>Update README.md</li>
  <li>Merge remote-tracking branch 'origin/main' into
acoustic_msg_devel</li>
  <li>committing changes from meeting</li>
  <li>Update README.md</li>
  <li>Changes after pull request discussion</li>
  <li>update internal documentation</li>
  <li>Merge branch 'main' into acoustic_msg_devel</li>
  <li>Add multibeam detections and watercolumn</li>
  <li>Contributors: CaptKrasno, Kristopher Krasnosky, lauralindzey</li>
</ul>

<h2 id="001-2021-11-23">0.0.1 (2021-11-23)</h2>

<ul>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/13">#13</a>
from amarburg/feature/revise-sonar-image-comment Feature/revise
sonar image comment</li>
  <li>Revised comments based on PR feedback.</li>
  <li>Revised based on comments on PR Removed language on 2D sonars
Revised language on azimuth and elevation angles Revised language on
header timestamp.</li>
  <li>Added note on sound speed.</li>
  <li>Very minor update in spelling.</li>
  <li>Significant rewrite of the explanatory comment in SonarImage.msg</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/10">#10</a>
from valschmidt/main Fixed broken links for proposed messages.</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/1">#1</a>
from valschmidt/valschmidt-fixed_broken_msg_links Fixed broken
links to proposed messages.</li>
  <li>Fixed broken links to proposed messages.</li>
  <li>Create Contributing.md First pass at the contributing doc adapted
from MBARI's LRAUV contributing guide</li>
  <li>Move acoustic_msgs package out of repo's root directory.</li>
  <li>Contributors: Aaron Marburg, CaptKrasno, Laura Lindzey, braanan,
lauralindzey, valschmidt</li>
</ul>
</div>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="noetic-tutorials">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wiki Tutorials</h3>
      </div>
      <div class="panel-body">
        
        <em>This package does not provide any links to tutorials in it's <a href="https://index.ros.org/contribute/metadata/">rosindex metadata</a>.</em>
        <em>You can check on the <a href="http://wiki.ros.org/marine_acoustic_msgs/Tutorials" target="_blank">ROS Wiki Tutorials</a> page for the package.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="noetic-deps">
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Package Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th class="text-center">Deps</th>
                  <th style="width: 100%">Name</th>
                </thead>
                <tbody>
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/geometry_msgs#noetic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/geometry_msgs#noetic">geometry_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/message_generation#noetic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/message_generation#noetic">message_generation  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/std_msgs#noetic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/std_msgs#noetic">std_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/catkin#noetic-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/catkin#noetic">catkin  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/message_runtime#noetic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/message_runtime#noetic">message_runtime  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosbag_migration_rule#noetic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosbag_migration_rule#noetic">rosbag_migration_rule  </a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
          <div class="panel-heading">
            <h3 class="panel-title">System Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <em>No direct system dependencies.</em>
            
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Dependant Packages</h3>
          </div>
          <div class="panel-body">
            
              <em>No known dependants.</em>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="noetic-assets">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Launch files</h3>
      </div>
      <div class="panel-body">
        
          <em>No launch files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Messages</h3>
      </div>
      <div class="panel-body">
        
          <ul>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/main/marine_acoustic_msgs/msg/RawSonarImage.msg" target="_blank">msg/RawSonarImage.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/main/marine_acoustic_msgs/msg/DetectionFlag.msg" target="_blank">msg/DetectionFlag.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/main/marine_acoustic_msgs/msg/SonarRanges.msg" target="_blank">msg/SonarRanges.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/main/marine_acoustic_msgs/msg/ProjectedSonarImage.msg" target="_blank">msg/ProjectedSonarImage.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/main/marine_acoustic_msgs/msg/SonarDetections.msg" target="_blank">msg/SonarDetections.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/main/marine_acoustic_msgs/msg/Dvl.msg" target="_blank">msg/Dvl.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/main/marine_acoustic_msgs/msg/PingInfo.msg" target="_blank">msg/PingInfo.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/main/marine_acoustic_msgs/msg/SonarImageData.msg" target="_blank">msg/SonarImageData.msg</a></li>
            
          </ul>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Services</h3>
      </div>
      <div class="panel-body">
        
          <em>No service files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Plugins</h3>
      </div>
      <div class="panel-body">
        
          <em>No plugins found.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="noetic-questions">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent questions tagged <kbd>marine_acoustic_msgs</kbd> at <strong><a href="https://robotics.stackexchange.com/" target="_blank">Robotics Stack Exchange</a></strong></h3>      </div>
      <div id="noetic-question-list" class="panel-body" style="display: none;"></div>
      <div id="noetic-no-question-list" class="panel-body" style="display: none;">
        <p>No questions yet, you can ask one <a href="https://robotics.stackexchange.com/questions/tagged/marine_acoustic_msgs+noetic">here</a>.</p>
      </div>
      <div id="noetic-get-question-fail" class="panel-body alert alert-warning" style="display: none;">
        <p>Failed to get question list, you can ticket an issue <a href="https://github.com/ros-infrastructure/rosindex/issues/new" target="_blank" class="alert-link">here</a> </p>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/package_body_tabs.js"></script>

<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
jQuery(function() {
    // Update the count on the links to the contribution suggestions
    updateContributionSuggestionsCountOnPackage('https://github.com/apl-ocean-engineering/marine_msgs.git');
});
</script>

          </div>
          <div class="col-md-2 hidden-xs hidden-sm">
            
            
            



<div class="list-group list-group-sm ">
  <a class="list-group-item"
     target="_blank"
     href="http://docs.ros.org/en/noetic/api/marine_acoustic_msgs/html/"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       
       API Docs
  </a>
  <a class="list-group-item"
     target="_blank"
     href="https://github.com/apl-ocean-engineering/marine_msgs/tree/main/marine_acoustic_msgs"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       
       Browse Code
  </a>
  
  
  
  
  
  <a class="list-group-item "
     target="_blank"
     href="http://wiki.ros.org/marine_acoustic_msgs?distro=noetic"
     title="View this package on wiki.ros.org">
       <span style="margin-right: 5px;" class="glyphicon glyphicon-info-sign"></span>
       
       Wiki
  </a>
  
  
</div>

          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-galactic">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>galactic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-iron">
    <div class="container-fluid">
      
        
        
        

        <div class="row">
          <div class="col-md-10">
            

<div class="well well-sm">
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px" src="/assets/package.png">
      </td>
      <td>
        <h3 style="margin-top: 5px">
          <a style="text-decoration:none" href="/p/marine_acoustic_msgs">marine_acoustic_msgs</a> <small>package from <a style="text-decoration:none" href="/r/marine_msgs/github-apl-ocean-engineering-marine_msgs">marine_msgs</a> repo</small>
        </h3>
          
            
            
              <span class="label label-default pkg-label">

marine_acoustic_msgs
</span>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/marine_sensor_msgs">

marine_sensor_msgs
</a>
            
          
      </td>
    </tr>
  </table>
</div>

            <div class="visible-xs visible-sm">
              
              
              



<div class="list-group list-group-sm list-group-horizontal list-group-justified">
  <a class="list-group-item text-center"
     target="_blank"
     href="http://docs.ros.org/en/iron/p/marine_acoustic_msgs"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       <br>
       API Docs
  </a>
  <a class="list-group-item text-center"
     target="_blank"
     href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       <br>
       Browse Code
  </a>
  
  
  
  
  
  
</div>

            </div>
            



<ul class="nav nav-tabs nav-justified" id="iron-tabs" style="margin-bottom:20px">
  <li class="better-tabs active">
    <a href="#iron-overview" data-toggle="tab">Overview</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    
    <a href="#iron-assets" data-toggle="tab"><span class="label label-primary">8</span> Assets</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    <a href="#iron-deps" data-toggle="tab"><span class="label label-primary">5</span> Dependencies</a>
  </li>
  <li class="better-tabs">
    
    <a href="#iron-tutorials" data-toggle="tab"><span class="label label-default">0</span> Tutorials</a>
  </li>
  <li class="better-tabs">
    <a href="#iron-questions" data-toggle="tab"><span id="iron-questions-count" class="label label-primary">0</span> Q & A</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="iron-overview">
    
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h4 class="panel-title">Package Summary</h4></div>
          <div class="panel-body">
            <table class="table table-condensed">
              <tr>
                <td style="width:100px;" class="text-right"><strong>Tags</strong></td>
                <td>
                  
                  
                    <em>No category tags.</em>
                  
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Version</strong></td>
                <td>2.1.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>License</strong></td>
                <td>BSD-3-Clause</td>
              </tr>
              <tr>
                <td class="text-right"><strong>Build type</strong></td>
                <td>
                  
                    <span class="label label-default">
                  
                    AMENT_CMAKE</span>
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Use</strong></td>
                <td>
                
                  <span class="label label-success">RECOMMENDED</span>
                
                </td>
              </tr>
            </table>
          </div>
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body">
            
            
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">Messages for DVLs, multibeams, and imaging sonars.</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/apl-ocean-engineering/marine_msgs.git">https://github.com/apl-ocean-engineering/marine_msgs.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">ros2</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2024-03-15
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="No CI information available for this package.">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/marine_msgs/#iron-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/marine_msgs/#iron-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/marine_msgs/#iron-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Package Description</h3></div>
          <div class="panel-body">
            The marine_acoustic_msgs package, including messages for common
  underwater sensors (DVL, multibeam sonar, imaging sonar)
  
          </div>
          <div class="panel-heading"><h4 class="panel-title">Additional Links</h4></div>
          <div class="panel-body">
            
            
              <em>No additional links.</em>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Maintainers</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Laura Lindzey</li>
                
                  <li>Roland Arsenault</li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Authors</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Aaron Marburg</li>
                
                  <li>Ian Vaughn</li>
                
                  <li>Kris Krasnosky</li>
                
                  <li>Laura Lindzey</li>
                
                  <li>Roland Arsenault</li>
                
              </ul>
            
          </div>
        </div>
      </div>
    </div>
    
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-heading"><span class="glyphicon glyphicon-file"></span><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/README.md" title="Open in git repository">marine_acoustic_msgs/README.md</a></div>
              <div class="panel-body">
                    <div class="rendered-markdown">
<h2 id="marine_acoustic_msgs">marine_acoustic_msgs</h2>

<p>This package includes messages for three commonly used sensors for research in underwater autonomy:</p>
<ul>
  <li>DVL</li>
  <li>Multibeam</li>
  <li>Imaging Sonar</li>
</ul>

<p>Each of the proposed messages is based on an existing
message that is currently in use across a variety of manufacturers of the
same instrument type. This gives us confidence that they are mature enough
to be indexed in the ROS debs and that they will generalize across other sensors.</p>

<h2 id="coordinate-frame-conventions">Coordinate Frame Conventions</h2>
<p><img src="https://user-images.githubusercontent.com/23006525/167165812-008ccccb-31a7-4c13-b2da-6235d37a7a3b.png" alt="cordiante_conventions"></p>

<h2 id="design-decisions-common-across-multiple-acoustic-messages">Design decisions common across multiple acoustic messages</h2>

<p>Looking at the differences among existing open source UUV messages for
acoustic sensors, there are a number of overarching design decisions to be
made before defining individual messages. The proposed set of messages
adheres to these guidelines:</p>

<ul>
  <li>The messages should be suitable for use across a wide variety of hardware.
    <ul>
      <li>Any sensor-specific metadata fields should be published in a separate message.
Standards for defining these additional messages are beyond the scope of this PR.
However, options include:
        <ul>
          <li>Capture all raw bytes sent to / received from a sensor (e.g. WHOI’s RawData.msg)</li>
          <li>Publish a separate message corresponding exactly to the datagrams
sent by the sensor (e.g. PD0.msg)</li>
          <li>Publish a separate message with the additional data, but no duplication
of the standard message, following the Image/CameraInfo pattern.</li>
        </ul>
      </li>
      <li>In order to support generality for a wide range of sensors, there will be some
fields that are not applicable to some sensors.
        <ul>
          <li>If not supported at all, the array may be left empty.</li>
          <li>If value is constant across the data frame, array may be length 1.</li>
          <li>Otherwise, the length of each array should match the length of the data.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>“raw/temporal” Underwater acoustic messages should include the speed of sound
(field will be called sound_speed) that was used by the sensor, as well as any
information required to raytrace the data with a new sound velocity profile.</li>
  <li>“processed/spatial” acoustic messages will have the ray-tracing already performed.</li>
  <li>The beam geometry is specified as a per-beam vector relative to the frame in
the header. This is an alternative to other approaches that have been used, including:
    <ul>
      <li>additional TF frames for individual beams, which will quickly become unwieldy</li>
      <li>an array of beam messages, where each beam includes its geometry relative
to the sensor. Abstracting out the individual beams doesn’t serve to simplify
the interpretation of the data, and doesn’t enable using an empty vector to
indicate that a field isn’t applicable.</li>
      <li>follow LaserScan convention and derive the geometry from min/max/step,
which doesn’t generalize across sonars, since they do not all have beams
spaced equiangualarly.</li>
    </ul>
  </li>
  <li>Individual message types should be based on how the data is used, rather
than similarities in data format. For example:
    <ul>
      <li>DVL and ADCP messages should not be combined, even though there is
significant overlap in hardware and provided data. Consumers of DVL
data expect a single velocity. Consumers of ADCP data expect velocities
at an array of ranges.</li>
      <li>There is a need for a difference between SonarImage and SonarRanges
(aka multibeam), since they are not typically interchangeable in
downstream processing algorithms, even though the newer sensors are
blurring the lines. A sonar image consists of intensities-vs-time,
while sonar ranges identify discrete returns.</li>
    </ul>
  </li>
  <li>In order to be consistent with other messages in sensor_msgs, message
types should be named after the type of data rather than type of sensor:
    <ul>
      <li>SonarImage.msg instead of ImagingSonar.msg</li>
      <li>SonarRanges.msg instead of Multibeam.msg or ProfilingSonar.msg.</li>
    </ul>
  </li>
</ul>

<h2 id="dvl">DVL</h2>
<h3 id="existing-messages">Existing Messages</h3>

<p>The most widely used messages appear to be:</p>
<ul>
  <li>WHOI’s <a href="https://bitbucket.org/whoidsl/ds_msgs/src/master/ds_sensor_msgs/msg/Dvl.msg">ds_sensor_msgs/Dvl.msg</a>.
It is currently in use with both RDI and Nortek instruments.</li>
  <li>UUV Simulator’s <a href="https://github.com/uuvsimulator/uuv_simulator/blob/master/uuv_sensor_plugins/uuv_sensor_ros_plugins_msgs/msg/DVL.msg">uuv_sensor_ros_plugins_msgs/DVL.msg</a>
(This was used as the base for <a href="https://github.com/udgcirs/marine_ros_conventions_discussion/blob/master/sensor_msgs/DVL.msg">marine_ros_conventions_discussion/DVL.msg</a>)
The main implementation difference between ds_sensor_msgs and uuv_simulator is
whether the top-level DVL message includes the beam data in an array,
or whether there is an array of DvlBeam messages.</li>
  <li>UWSim’s <a href="https://github.com/uji-ros-pkg/underwater_simulation/blob/melodic-devel/underwater_sensor_msgs/msg/DVL.msg">underwater_sensor_msgs/DVL.msg</a>.
It is not particularly idiomatic for a ROS message: Rather than using a
Vector3 for velocity, it has individual fields (wi_{x,y,z}_axis); and
rather than using TF to transform between frames, it includes the data in
instrument-referenced and vehicle-referenced frames within the same message.</li>
</ul>

<p>While all options agree that the DVL message should include aggregate data
from the instrument (estimated altitude and velocity), they differ in what else is included:</p>
<ul>
  <li>Per-beam data (range, velocity, and their covariances): WHOI &amp; UUV Simulator</li>
  <li>Both bottom-track and water-track velocities: WHOI &amp; UWSim</li>
  <li>Additional details about the sensor configuration: WHOI</li>
</ul>

<h3 id="dvl-specific-design-decisions">DVL-specific design decisions</h3>
<ul>
  <li>Is there broad support for including water-track velocity in addition to ground-track in the same message definition?
    <ul>
      <li>NPS is currently interleaving DVL &amp; ADCP messages from the same driver for an instrument that provides both an ADCP profile and a DVL bottom-track velocity. I like this approach.</li>
      <li>If the same message type supports both bottom track and water track (single reading, not profile), maybe there should be a convention that bottom track / water track are published on different topics so subscribing nodes can ignore water track velocities if they don’t use them.</li>
    </ul>
  </li>
  <li>Whether the additional information about the sensor configuration (DVL_TYPE) belongs in the top-level message. Other messages in sensor_msgs do not tend to have similar flags; however, this depends on whether we want to be able to perform sound velocity corrections using the data in the DVL message.</li>
  <li>Does a quality flag belong in the standardized message?</li>
</ul>

<h3 id="proposed-message">Proposed Message</h3>

<p>https://github.com/apl-ocean-engineering/marine_msgs/blob/main/marine_acoustic_msgs/msg/Dvl.msg</p>

<p>This message started with WHOI’s definition, which has been used in
drivers for Nortek and RDI DVLs. There are also corresponding rviz
and gazebo plugins. (I have trivial forks of those plugins supporting the proposed message.)</p>

<p>I propose the following changes from WHOI’s original message:</p>
<ul>
  <li>Remove the ds_header – DsHeader was an attempt to add some hardware-specific
metadata to the sensor processing pipeline. It was never fully implemented,
and isn’t consistent with other definitions in sensor_msgs.</li>
  <li>Remove dvl_time – this was originally intended to support integration of
DVL messages from instruments that only provide a monotonic count rather
than fully-synchronized timestamps. With modern instruments, <code class="language-plaintext highlighter-rouge">header.stamp</code>
should capture a posix time suitable for integrating the reported velocity.</li>
  <li>Replace coordinate_mode with beams_valid flag. The 3D velocity and altitude
should always be reported in the instrument frame which is specified in the
header, and beam ranges/velocities are scalars measured along the corresponding <code class="language-plaintext highlighter-rouge">beam_unit_vec</code>.</li>
  <li>speed_sound -&gt; sound_speed for consistency across acoustic messages</li>
</ul>

<h2 id="multibeam-and-forward-looking-sonar-fls-messages">Multibeam and Forward Looking Sonar (FLS) messages</h2>

<h3 id="organization">Organization</h3>
<p><img src="https://user-images.githubusercontent.com/23006525/160207155-eb9c003e-8a9a-460e-8c1d-6240924e81e6.png" alt="data_structure"></p>

<p>Multibeam and FLS sonar data (referred to as sonar data for brevity) are broken into two type categories, detections and images.   Images are intended to represent Watercolumn or FLS imaging data.   Detections represent a detection reported by the sonar for a given beam.</p>

<p>Sonar data is also organized into two domain categories,  temporal and spatial.  Messages are intended to be initially reported in the temporal domain by the sonar drive then converted to the spatial domain through a processing pipeline.   However, some sonars report images and detections directly in the spatial domain.  In this case, sensor drivers may report directly with the appropriate spatial message.</p>

<h3 id="data-structure">Data structure</h3>
<p>the Sonar messages consist of top level messages:</p>
<ul>
  <li>RawSonarImage</li>
  <li>ProjectedSonarImage</li>
  <li>SonarDetection</li>
  <li>SonarRanges</li>
</ul>

<p>These messages share common data in the following sub-messages:</p>
<ul>
  <li>DetectionFlag</li>
  <li>PingInfo</li>
  <li>SonarImageData</li>
</ul>

<h4 id="sonarimagedata-packing">SonarImageData packing</h4>

<p>It’s worth mentioning how the data is packed in the sonar image message as it may not be obvious.</p>

<ul>
  <li>the actual pixel data is in row-major (i.e beam_no major) order.</li>
  <li>the pixel data is stored as an array of bytes (uint8). It should be cast as the type specified in dtype flag. They are enumerated in the message</li>
  <li>to find the range for each cell: (sample_number + sample0) * sound_speed / (2.0 * sample_rate)</li>
</ul>

<p>The image details details how image data is stored.</p>

<p><img src="https://user-images.githubusercontent.com/23006525/160203744-7fc6b06a-ac3d-4419-b6a9-fec83e07cef7.png" alt="wcl_def"></p>

<h3 id="geometry-conventions">Geometry Conventions</h3>
<p><img src="https://user-images.githubusercontent.com/23006525/167165995-ce578962-be79-4219-89a0-920953ca6cb2.png" alt="rx_tx_detail"></p>

<ul>
  <li>angles/beam directions in the spatial domain shall:
    <ul>
      <li>be reported as unit vectors according to the coordinate frame convention specified above.</li>
      <li>be reported at time reported in the header timestamp.  (at or before transmit time)</li>
    </ul>
  </li>
  <li>angles/beam directions in the temporal domain shall be reported as transmit (Tx) and receive (Rx) angles according to the diagram above
    <ul>
      <li>rx_angle is defined as the elevation from the X-Z plane at receive time. This elevation is positive toward the Y axis.  This elevation defines a cone of possible return directions for a given return beam.</li>
      <li>tx_angle is defined as the elevation from the Y-Z plane at transmit time. This elevation is positive toward the X axis.  This elevation defines a cone that represents the area insonified by the tx pulse.</li>
    </ul>
  </li>
</ul>

<h3 id="style-conventions">Style Conventions</h3>
<p>These messages were designed to comply with the conventions set forth by the <a href="http://wiki.ros.org/ROS/Patterns/Conventions#Messages">ROS/Patterns/Conventions guide</a>.   Beyond that, we have set the following conventions:</p>
<ul>
  <li>All vector quantities should have plural names</li>
  <li>Variable length message components should be represented as vectors of core ros messages like std_msgs or geometry_msgs.  Avoid variable length arrays of custom message types.  * In otherwords, favor “structures of arrays” rather than “arrays of structures”. One exception is the case where data must be grouped to be interpreted properly AND is shared across multiple messages.  (eg. an int with an associated enum.  See PingInfo.msg)</li>
  <li>Message components common to several top-level messages should be split into sub-messages.  (eg. PingInfo is shared by SonarRanges, SonarDetections and RawSonarImage)</li>
  <li>
<strong>(PROVISIONAL)</strong> Vector quantities may be of length zero.  This shall be interpreted as “unreported”.  (see internal MSG documentation for more details)</li>
</ul>
</div>
              </div>
            </div>
          </div>
        </div>
      
    
    <div class="row">
      <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-heading"><span class="glyphicon glyphicon-list"></span> CHANGELOG</div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="changelog-for-package-marine_acoustic_msgs">Changelog for package marine_acoustic_msgs</h1>

<h2 id="210-2024-03-15">2.1.0 (2024-03-15)</h2>

<ul>
  <li>Update CMake files to follow established standards</li>
  <li>Add Roland Arsenault as maintainer</li>
  <li>Update ros2 CI to use current ROS2 distributions
(<a href="https://github.com/apl-ocean-engineering/marine_msgs/issues/56">#56</a>)</li>
  <li>Updated ros2 branch to be in line with revisions in main
(<a href="https://github.com/apl-ocean-engineering/marine_msgs/issues/44">#44</a>)</li>
  <li>Contributors: Roland Arsenault, Sean Fish, Laura Lindzey</li>
</ul>

<h2 id="110-2022-11-30">1.1.0 (2022-11-30)</h2>

<ul>
  <li>Fix ProjectedSonarImage comments about frame
(<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/26">#26</a>)</li>
  <li>Add CI, pre-commit, prerelease and dependabot
(<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/27">#27</a>)
Co-authored-by: Laura Lindzey &lt;&lt;lindzey@uw.edu&gt;&gt;</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/25">#25</a>
from apl-ocean-engineering/add_migration_rule Add migration rule
from v0.0.1 to 28ec6a7</li>
  <li>Add migration rule from v0.0.1 to 28ec6a7</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/22">#22</a>
from rolker/fix_variable_name</li>
  <li>Rename num_beams to beam_count.</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/21">#21</a>
from CaptKrasno/acoustic_msg_devel</li>
  <li>Contributors: CaptKrasno, Laura Lindzey, Roland Arsenault, Vatan
Aksoy Tezer, lauralindzey</li>
</ul>

<h2 id="100-2022-05-05">1.0.0 (2022-05-05)</h2>

<ul>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/20">#20</a>
from CaptKrasno/acoustic_msg_devel Acoustic msg devel</li>
  <li>Removed unused (old) sonarImage message</li>
  <li>Merge remote-tracking branch 'apl-ocean-engineering/main' into
acoustic_msg_devel</li>
  <li>added ping info to sonar ranges</li>
  <li>Number of beams has been added to sonarImageData so it can be
decoded independently</li>
  <li>Update README.md</li>
  <li>Merge remote-tracking branch 'origin/main' into
acoustic_msg_devel</li>
  <li>committing changes from meeting</li>
  <li>Update README.md</li>
  <li>Changes after pull request discussion</li>
  <li>update internal documentation</li>
  <li>Merge branch 'main' into acoustic_msg_devel</li>
  <li>Add multibeam detections and watercolumn</li>
  <li>Contributors: CaptKrasno, Kristopher Krasnosky, lauralindzey</li>
</ul>

<h2 id="001-2021-11-23">0.0.1 (2021-11-23)</h2>

<ul>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/13">#13</a>
from amarburg/feature/revise-sonar-image-comment Feature/revise
sonar image comment</li>
  <li>Revised comments based on PR feedback.</li>
  <li>Revised based on comments on PR Removed language on 2D sonars
Revised language on azimuth and elevation angles Revised language on
header timestamp.</li>
  <li>Added note on sound speed.</li>
  <li>Very minor update in spelling.</li>
  <li>Significant rewrite of the explanatory comment in SonarImage.msg</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/10">#10</a>
from valschmidt/main Fixed broken links for proposed messages.</li>
  <li>Merge pull request
<a href="https://github.com/apl-ocean-engineering/hydrographic_msgs/issues/1">#1</a>
from valschmidt/valschmidt-fixed_broken_msg_links Fixed broken
links to proposed messages.</li>
  <li>Fixed broken links to proposed messages.</li>
  <li>Create Contributing.md First pass at the contributing doc adapted
from MBARI's LRAUV contributing guide</li>
  <li>Move acoustic_msgs package out of repo's root directory.</li>
  <li>Contributors: Aaron Marburg, CaptKrasno, Laura Lindzey, braanan,
lauralindzey, valschmidt</li>
</ul>
</div>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="iron-tutorials">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wiki Tutorials</h3>
      </div>
      <div class="panel-body">
        
        <em>This package does not provide any links to tutorials in it's <a href="https://index.ros.org/contribute/metadata/">rosindex metadata</a>.</em>
        <em>You can check on the <a href="http://wiki.ros.org/marine_acoustic_msgs/Tutorials" target="_blank">ROS Wiki Tutorials</a> page for the package.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="iron-deps">
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Package Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th class="text-center">Deps</th>
                  <th style="width: 100%">Name</th>
                </thead>
                <tbody>
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake#iron">ament_cmake  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_generators#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_generators#iron">rosidl_default_generators  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_runtime#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_runtime#iron">rosidl_default_runtime  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/std_msgs#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/std_msgs#iron">std_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/geometry_msgs#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/geometry_msgs#iron">geometry_msgs  </a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
          <div class="panel-heading">
            <h3 class="panel-title">System Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <em>No direct system dependencies.</em>
            
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Dependant Packages</h3>
          </div>
          <div class="panel-body">
            
              <em>No known dependants.</em>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="iron-assets">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Launch files</h3>
      </div>
      <div class="panel-body">
        
          <em>No launch files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Messages</h3>
      </div>
      <div class="panel-body">
        
          <ul>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/RawSonarImage.msg" target="_blank">msg/RawSonarImage.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/DetectionFlag.msg" target="_blank">msg/DetectionFlag.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/SonarRanges.msg" target="_blank">msg/SonarRanges.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/ProjectedSonarImage.msg" target="_blank">msg/ProjectedSonarImage.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/SonarDetections.msg" target="_blank">msg/SonarDetections.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/Dvl.msg" target="_blank">msg/Dvl.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/PingInfo.msg" target="_blank">msg/PingInfo.msg</a></li>
            
              <li><a href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs/msg/SonarImageData.msg" target="_blank">msg/SonarImageData.msg</a></li>
            
          </ul>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Services</h3>
      </div>
      <div class="panel-body">
        
          <em>No service files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Plugins</h3>
      </div>
      <div class="panel-body">
        
          <em>No plugins found.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="iron-questions">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent questions tagged <kbd>marine_acoustic_msgs</kbd> at <strong><a href="https://robotics.stackexchange.com/" target="_blank">Robotics Stack Exchange</a></strong></h3>      </div>
      <div id="iron-question-list" class="panel-body" style="display: none;"></div>
      <div id="iron-no-question-list" class="panel-body" style="display: none;">
        <p>No questions yet, you can ask one <a href="https://robotics.stackexchange.com/questions/tagged/marine_acoustic_msgs+iron">here</a>.</p>
      </div>
      <div id="iron-get-question-fail" class="panel-body alert alert-warning" style="display: none;">
        <p>Failed to get question list, you can ticket an issue <a href="https://github.com/ros-infrastructure/rosindex/issues/new" target="_blank" class="alert-link">here</a> </p>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/package_body_tabs.js"></script>

<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
jQuery(function() {
    // Update the count on the links to the contribution suggestions
    updateContributionSuggestionsCountOnPackage('https://github.com/apl-ocean-engineering/marine_msgs.git');
});
</script>

          </div>
          <div class="col-md-2 hidden-xs hidden-sm">
            
            
            



<div class="list-group list-group-sm ">
  <a class="list-group-item"
     target="_blank"
     href="http://docs.ros.org/en/iron/p/marine_acoustic_msgs"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       
       API Docs
  </a>
  <a class="list-group-item"
     target="_blank"
     href="https://github.com/apl-ocean-engineering/marine_msgs/tree/ros2/marine_acoustic_msgs"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       
       Browse Code
  </a>
  
  
  
  
  
  
</div>

          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-melodic">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>melodic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>



<script id="question-list-template" type="text/html">
  <p>
    Browse <a href="https://robotics.stackexchange.com/questions/tagged/marine_acoustic_msgs?tab=Newest">recent questions</a>
    or see the <a href="https://robotics.stackexchange.com/questions/tagged/marine_acoustic_msgs?tab=Votes">highest voted ones</a>.
  </p>
  
  <table class="table table-striped">
    <thead>
      <tr>
        <th scope="col">Title</th>
        <th scope="col">Answered?</th>
        <th scope="col">Created</th>
        <th scope="col">Active</th>
      </tr>
    </thead>
    <tbody>
      {{#questions}}
      <tr>
        <th scope="row"><a href="{{link}}">{{title}}</a><br><small>Tags: {{strtags}}</small></th>
        <th>{{answered}}</th>
        <th>{{created}}</th>
        <th>{{active}}</th>
      </tr>
      {{/questions}}
    </tbody>
  </table>
  {{#has_more}}
  <hr>
  <h4>Additional questions are available at
    <a href="https://robotics.stackexchange.com/questions/tagged/{{name}}?tab=Newest">Robotics Stack Exchange</a>
  </h4>
  {{/has_more}}
  
</script>

<script type="text/javascript" src="/js/mustache.js"></script>
<script type="text/javascript">
  jQuery(function() {
    jQuery.getJSON(url="https://api.stackexchange.com/2.3/questions?order=desc&site=robotics" +
                       "&tagged=marine_acoustic_msgs&pagesize=50&sort=activity")
    .done(function(feed) {
      if (feed.items.length > 0) {
        var question_count_str = (feed.has_more ? '>' : '') + String(feed.items.length)
        const questions = feed.items.map(
          function(question) {
            question.id = Math.round(Math.random() * 99999.0);
            question.created = (new Date(question.creation_date * 1000)).toDateString()
            question.active = (new Date(question.last_activity_date * 1000)).toDateString()
            question.answered = question.is_answered ? "Yes" : "No"
            question.strtags = question.tags.join(' ')
            return question;
          });
        const template = jQuery("#question-list-template").text();
        Mustache.parse(template);
        var rendered = Mustache.render(
          template, 
          { questions: questions,
            has_more: feed.has_more,
            name: "marine_acoustic_msgs"
          }
        );
      }
      //   TODO(tfoote) Resolve images
      //   jQuery("#-question-list img").each(function() {
      //     if (jQuery(this).attr("src").startsWith("/upfiles")) {
      //        jQuery(this).attr("src", "https://answers.ros.org" + jQuery(this).attr("src"));
      //     }
      //   });
      
      if (feed.items.length > 0) {
        jQuery("#humble-question-list").html(rendered);
        jQuery("#humble-question-list").show();
      } else {
        jQuery("#humble-no-question-list").show();
      }
      jQuery("#humble-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#jazzy-question-list").html(rendered);
        jQuery("#jazzy-question-list").show();
      } else {
        jQuery("#jazzy-no-question-list").show();
      }
      jQuery("#jazzy-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#kilted-question-list").html(rendered);
        jQuery("#kilted-question-list").show();
      } else {
        jQuery("#kilted-no-question-list").show();
      }
      jQuery("#kilted-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#rolling-question-list").html(rendered);
        jQuery("#rolling-question-list").show();
      } else {
        jQuery("#rolling-no-question-list").show();
      }
      jQuery("#rolling-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#github-question-list").html(rendered);
        jQuery("#github-question-list").show();
      } else {
        jQuery("#github-no-question-list").show();
      }
      jQuery("#github-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#noetic-question-list").html(rendered);
        jQuery("#noetic-question-list").show();
      } else {
        jQuery("#noetic-no-question-list").show();
      }
      jQuery("#noetic-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#galactic-question-list").html(rendered);
        jQuery("#galactic-question-list").show();
      } else {
        jQuery("#galactic-no-question-list").show();
      }
      jQuery("#galactic-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#iron-question-list").html(rendered);
        jQuery("#iron-question-list").show();
      } else {
        jQuery("#iron-no-question-list").show();
      }
      jQuery("#iron-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#melodic-question-list").html(rendered);
        jQuery("#melodic-question-list").show();
      } else {
        jQuery("#melodic-no-question-list").show();
      }
      jQuery("#melodic-questions-count").text(question_count_str);
      
    })
    .fail(function(jqxhr, textStatus, error) {
      console.error("Failed to get question data: " + jqxhr.responseText);
      
      jQuery("#humble-get-question-fail").show();
      
      jQuery("#jazzy-get-question-fail").show();
      
      jQuery("#kilted-get-question-fail").show();
      
      jQuery("#rolling-get-question-fail").show();
      
      jQuery("#github-get-question-fail").show();
      
      jQuery("#noetic-get-question-fail").show();
      
      jQuery("#galactic-get-question-fail").show();
      
      jQuery("#iron-get-question-fail").show();
      
      jQuery("#melodic-get-question-fail").show();
      
    });
  });
</script>


<script type="text/javascript">
  $(document).ready(function() {
    setupDistroSwitch("humble");
  });
</script>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="container-fluid">
      <div style="float:left;">
        
          <a href="https://github.com/rkent/rosindex" title="Find rosindex in Github">
          <span class="icon  icon--github">
            <svg viewBox="0 0 16 16">
              <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
            </svg>
          </span>

          <span class="username">rkent/rosindex</span>
        </a>
        <em class="hidden-xs">| generated on 2025-05-05</em>
      
      </div>
      <div style="float:right;">
        <p class="text"><span class="hidden-xs">a community-maintained index of robotics software
 | </span><a href="/privacy.txt">privacy</a></p>
      </div>
    </div>
  </div>

</footer>


  </body>

</html>
