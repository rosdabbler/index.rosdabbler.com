<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Package: performance_test</title>
    <meta name="description" content="a community-maintained index of robotics software
">

    
    <link rel="canonical" href="http://index.rosdabbler.com/p/performance_test/">
    
    
    <link rel="icon" sizes="any" type="image/svg+xml" href="/assets/rosindex_logo.svg">

    

    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">
    

    

    <script type="text/javascript" src=/js/jquery.js></script>
    <script src=/bootstrap/js/bootstrap.min.js type="text/javascript"></script>
    <script src=/js/jquery-cookie.js type="text/javascript"></script>
    
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EVD5Z6G6NH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EVD5Z6G6NH');
</script>

    <script type="text/javascript" src=/js/toc.js></script>

    <script src=/js/distro_switch.js></script>
  </head>

  <body>

    <header class="site-header">

  <div class="wrapper">
    <div class="container-fluid" style="margin-bottom: 10px">
      <div class="row">
        <!-- title -->
        <div class="col-xs-3" style="white-space:nowrap">
          <a class="site-title" href="/">
            <img src="/assets/rosindex_logo.svg" width="26" height="26" alt="ROS index logo" style="padding-bottom: 3px"/>
            ROS Index</a>
        </div>
        <!-- main internal links -->
        <div class="col-xs-6 text-center" style="padding:0px">
          <div class="btn-group hidden-xs" role="group" aria-label="..." style="padding: 6px">
            <div class="btn-group" role="group">
              <a href="/?search_packages=true" class="btn btn-default" role="button">Package List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/?search_repos=true" class="btn btn-default" role="button">Repository List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/search_deps" class="btn btn-default" role="button">System Dependencies</a>
            </div>
          </div>
          <div class="hidden-lg hidden-md hidden-sm">
            <button id="hLabel" class="btn btn-link dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Lists <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="hLabel">
              <li><a href="/?search_packages=true">Package List</a></li>
              <li><a href="/?search_repos=true">Repository List</a></li>
              <li><a href="/search_deps">System Dependencies</a></li>
            </ul>
          </div>
        </div>
        <!-- additional links -->
        <div class="col-xs-3 text-right" style="white-space:nowrap; padding:0px">
          <ul class="list-inline" style="margin-bottom:0px;">
            <li class="dropdown hidden-xs hidden-sm">
              <button id="rLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                ROS Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu" aria-labelledby="rLabel">
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-xs hidden-sm">
              <button id="aLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                About <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="aLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-md hidden-lg">
              <button id="qLabel" class="btn btn-link" type="button"
                      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="qLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
                <hr style="margin:7px" />
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin-top: 20px">
  <div class="container-fluid">
    <div class="row">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/?search_packages=true">Packages</a></li>
        <li class="active">performance_test</li>
      </ol>
    </div>
    <div class="row">
      

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
    <label id="humble-option" class="distro-button btn btn-xs btn-primary" href="#humble" data="humble">
      <input type="radio" name="options" id="humble-radio" autocomplete="off"> humble
    </label>
  
    <label id="jazzy-option" class="distro-button btn btn-xs btn-primary" href="#jazzy" data="jazzy">
      <input type="radio" name="options" id="jazzy-radio" autocomplete="off"> jazzy
    </label>
  
    <label id="kilted-option" class="distro-button btn btn-xs btn-primary" href="#kilted" data="kilted">
      <input type="radio" name="options" id="kilted-radio" autocomplete="off"> kilted
    </label>
  
    <label id="rolling-option" class="distro-button btn btn-xs btn-primary" href="#rolling" data="rolling">
      <input type="radio" name="options" id="rolling-radio" autocomplete="off"> rolling
    </label>
  
    <label id="github-option" class="distro-button btn btn-xs btn-primary" href="#github" data="github">
      <input type="radio" name="options" id="github-radio" autocomplete="off"> github
    </label>
  
    <label id="noetic-option" class="distro-button btn btn-xs btn-default" href="#noetic" data="noetic">
      <input type="radio" name="options" id="noetic-radio" autocomplete="off"> noetic
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-primary" data-toggle="dropdown" id="older-distro-button">
        <input type="radio" name="options" autocomplete="off">
      <span id="older-label">Older</span>
      <span class="caret"></span>
    </label>
    <ul class="dropdown-menu" role="menu">
      
        <li data="galactic" id="galactic-option" class=" older-distro-option"  href="#galactic">
          <a href="#galactic" data="galactic" id="galactic-button">galactic</a>
        </li>
      
        <li data="iron" id="iron-option" class=" older-distro-option"  href="#iron">
          <a href="#iron" data="iron" id="iron-button">iron</a>
        </li>
      
        <li data="melodic" id="melodic-option" class="disabled older-distro-option"  href="#melodic">
          <a href="#melodic" data="melodic" id="melodic-button">melodic</a>
        </li>
      
    </ul>
  </div>
</div>

    </div>
    <div class="row">
      &nbsp;
    </div>
  </div>
</div>


  <div class="distro distro-humble">
    <div class="container-fluid">
      
        
        
        

        <div class="row">
          <div class="col-md-10">
            

<div class="well well-sm">
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px" src="/assets/package.png">
      </td>
      <td>
        <h3 style="margin-top: 5px">
          <a style="text-decoration:none" href="/p/performance_test">performance_test</a> <small>package from <a style="text-decoration:none" href="/r/performance_test/gitlab-ApexAI-performance_test">performance_test</a> repo</small>
        </h3>
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_report">

performance_report
</a>
            
          
            
            
              <span class="label label-default pkg-label">

performance_test
</span>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_test_ros1_msgs">

performance_test_ros1_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_test_ros1_publisher">

performance_test_ros1_publisher
</a>
            
          
      </td>
    </tr>
  </table>
</div>

            <div class="visible-xs visible-sm">
              
              
              



<div class="list-group list-group-sm list-group-horizontal list-group-justified">
  <a class="list-group-item text-center"
     target="_blank"
     href="http://docs.ros.org/en/humble/p/performance_test"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       <br>
       API Docs
  </a>
  <a class="list-group-item text-center"
     target="_blank"
     href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       <br>
       Browse Code
  </a>
  
  
  
  
  
  
</div>

            </div>
            



<ul class="nav nav-tabs nav-justified" id="humble-tabs" style="margin-bottom:20px">
  <li class="better-tabs active">
    <a href="#humble-overview" data-toggle="tab">Overview</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    
    <a href="#humble-assets" data-toggle="tab"><span class="label label-default">0</span> Assets</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    <a href="#humble-deps" data-toggle="tab"><span class="label label-primary">10</span> Dependencies</a>
  </li>
  <li class="better-tabs">
    
    <a href="#humble-tutorials" data-toggle="tab"><span class="label label-default">0</span> Tutorials</a>
  </li>
  <li class="better-tabs">
    <a href="#humble-questions" data-toggle="tab"><span id="humble-questions-count" class="label label-primary">0</span> Q & A</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="humble-overview">
    
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h4 class="panel-title">Package Summary</h4></div>
          <div class="panel-body">
            <table class="table table-condensed">
              <tr>
                <td style="width:100px;" class="text-right"><strong>Tags</strong></td>
                <td>
                  
                  
                    <em>No category tags.</em>
                  
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Version</strong></td>
                <td>2.3.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>License</strong></td>
                <td>Apache 2.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>Build type</strong></td>
                <td>
                  
                    <span class="label label-default">
                  
                    AMENT_CMAKE</span>
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Use</strong></td>
                <td>
                
                  <span class="label label-success">RECOMMENDED</span>
                
                </td>
              </tr>
            </table>
          </div>
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body">
            
            
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default"></span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://gitlab.com/ApexAI/performance_test.git">https://gitlab.com/ApexAI/performance_test.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">master</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-03-25
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="No CI information available for this package.">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/performance_test/#humble-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/performance_test/#humble-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/performance_test/#humble-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Package Description</h3></div>
          <div class="panel-body">
            Tool to test performance of ROS 2 and DDS data layers and communication.
          </div>
          <div class="panel-heading"><h4 class="panel-title">Additional Links</h4></div>
          <div class="panel-body">
            
            
              <em>No additional links.</em>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Maintainers</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Apex.AI, Inc.</li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Authors</h4></div>
          <div class="panel-body">
            
            
              <em>No additional authors.</em>
            
          </div>
        </div>
      </div>
    </div>
    
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-heading"><span class="glyphicon glyphicon-file"></span><a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/README.md" title="Open in git repository">performance_test/README.md</a></div>
              <div class="panel-body">
                    <div class="rendered-markdown">
<h1 id="performance_test">performance_test</h1>

<p>[TOC]</p>

<p>The performance_test tool tests latency and other performance metrics of <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">various middleware
implementations</a> that support a pub/sub pattern. It is used to simulate
non-functional performance of your application.</p>

<p>The performance_test tool allows you to quickly set up a pub/sub configuration,
e.g. number of publisher/subscribers, message size, QOS settings, middleware. The following metrics
are automatically recorded when the application is running:</p>

<ul>
  <li>
<strong>latency</strong>: corresponds to the time a message takes to travel from a publisher to subscriber. The
latency is measured by timestamping the sample when it’s published and subtracting the timestamp
  (from the sample) from the measured time when the sample arrives at the subscriber (only logged when a subscriber is created)</li>
  <li>
<strong>CPU usage</strong>: percentage of the total system wide CPU usage (logged separately for each instance of <code class="language-plaintext highlighter-rouge">perf_test</code>)</li>
  <li>
<strong>resident memory</strong>: heap allocations, shared memory segments, stack (used for system’s internal
work) (logged separately for each instance of <code class="language-plaintext highlighter-rouge">perf_test</code>)</li>
  <li>
<strong>sample statistics</strong>: number of samples received, sent, and lost per experiment run.</li>
</ul>

<p>This <code class="language-plaintext highlighter-rouge">master</code> branch is compatible with the following ROS 2 versions</p>
<ul>
  <li>rolling</li>
  <li>jazzy</li>
  <li>iron</li>
  <li>humble</li>
  <li>galactic</li>
  <li>foxy</li>
  <li>eloquent</li>
  <li>dashing</li>
  <li>Apex.OS</li>
</ul>

<h2 id="how-to-use-this-document">How to use this document</h2>

<ol>
  <li>Start <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#example">here</a> for a quick example of building and running the performance_test tool
with the Cyclone DDS plugin.</li>
  <li>If needed, find more detailed information about <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#building-the-performance_test-tool">building</a>
and <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#running-an-experiment">running</a>
</li>
  <li>Or, if the quick example is good enough, skip ahead to the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">list of supported middleware
plugins</a> to learn how to test a specific middleware implementation.</li>
  <li>Check out the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#analyze-the-results">tools for visualizing the results</a>
</li>
  <li>If desired, read about the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#architecture">design and architecture</a> of the tool.</li>
</ol>

<h2 id="example">Example</h2>

<p>This example shows how to test the non-functional performance of the following configuration:</p>

<table>
  <thead>
    <tr>
      <th>Option</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Plugin</td>
      <td>Cyclone DDS</td>
    </tr>
    <tr>
      <td>Message type</td>
      <td>Array1k</td>
    </tr>
    <tr>
      <td>Publishing rate</td>
      <td>100Hz</td>
    </tr>
    <tr>
      <td>Topic name</td>
      <td>test_topic</td>
    </tr>
    <tr>
      <td>Duration of the experiment</td>
      <td>30s</td>
    </tr>
    <tr>
      <td>Number of publisher(s)</td>
      <td>1 (default)</td>
    </tr>
    <tr>
      <td>Number of subscriber(s)</td>
      <td>1 (default)</td>
    </tr>
  </tbody>
</table>

<ol>
  <li>
    <p>Install <a href="https://docs.ros.org/en/rolling/index.html">ROS 2</a></p>
  </li>
  <li>
    <p>Install <a href="https://github.com/eclipse-cyclonedds/cyclonedds">Cyclone DDS</a> to /opt/cyclonedds</p>
  </li>
  <li>
    <p>Build performance_test with the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#eclipse-cyclone-dds">CMake build flag</a> for Cyclone DDS:</p>
  </li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nb">source</span> /opt/ros/rolling/setup.bash
    <span class="nb">cd</span> ~/perf_test_ws
    colcon build <span class="nt">--cmake-args</span> <span class="nt">-DPERFORMANCE_TEST_PLUGIN</span><span class="o">=</span>CYCLONEDDS
    <span class="nb">source</span> ./install/setup.bash
    
</code></pre></div></div>

<ol>
  <li>Run with the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#eclipse-cyclone-dds">communication plugin option</a> for Cyclone DDS:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>experiment
./install/performance_test/lib/performance_test/perf_test <span class="nt">--communication</span> CycloneDDS
                                                          <span class="nt">--msg</span> Array1k
                                                          <span class="nt">--rate</span> 100
                                                          <span class="nt">--topic</span> test_topic
                                                          <span class="nt">--max-runtime</span> 30
                                                          <span class="nt">--logfile</span> experiment/log.csv

</code></pre></div></div>

<p>At the end of the experiment, a CSV log file will be generated in the experiment folder with a name
that starts with <code class="language-plaintext highlighter-rouge">log</code>.</p>

<h2 id="building-the-performance_test-tool">Building the performance_test tool</h2>

<p>For a simple example, see <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.rclcpp">Dockerfile.rclcpp</a>.</p>

<p>The performance_test tool is structured as a ROS 2 package, so <code class="language-plaintext highlighter-rouge">colcon</code> is used to build it.
Therefore, you must source a ROS 2 installation:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">source</span> /opt/ros/rolling/setup.bash

</code></pre></div></div>

<p>Select a middleware plugin from <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">this list</a>.
Then build the performance_test tool with the selected middleware:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> ~/perf_test_ws/src
<span class="nb">cd</span> ~/perf_test_ws/src
git clone https://gitlab.com/ApexAI/performance_test.git
<span class="nb">cd</span> ..
<span class="c"># At this stage, you need to choose which middleware you want to use</span>
<span class="c"># The list of available flags is described in the middleware plugins section</span>
<span class="c"># Square brackets denote optional arguments, like in the Python documentation.</span>
colcon build <span class="nt">--cmake-args</span> <span class="nt">-DCMAKE_BUILD_TYPE</span><span class="o">=</span>Release <span class="nt">-DPERFORMANCE_TEST_PLUGIN</span><span class="o">=</span>&lt;plugin&gt;
<span class="nb">source install</span>/setup.bash

</code></pre></div></div>

<h2 id="running-an-experiment">Running an experiment</h2>

<p>The performance_test experiments are run through the <code class="language-plaintext highlighter-rouge">perf_test</code> executable.
To find the available settings, run with <code class="language-plaintext highlighter-rouge">--help</code> (note the required and default arguments):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~/perf_test_ws<span class="nv">$ </span>./install/performance_test/lib/performance_test/perf_test <span class="nt">--help</span>

</code></pre></div></div>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">-c</code> argument should match the selected <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">middleware plugin</a>
from the build phase.</li>
  <li>The <code class="language-plaintext highlighter-rouge">--msg</code> argument should be one of the supported message types, which are shown
in the <code class="language-plaintext highlighter-rouge">--help</code> output.</li>
</ul>

<h3 id="single-machine-or-distributed-system">Single machine or distributed system?</h3>

<p>Based on the configuration you want to test, the usage of the performance_test tool differs. The
different possibilities are explained below.</p>

<p>For running tests on a single machine, you can choose between the following options:</p>

<ol>
  <li>Intraprocess means that the publisher and subscriber threads are in the same process.</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    perf_test &lt;options&gt; <span class="nt">--num-sub-threads</span> 1 <span class="nt">--num-pub-threads</span> 1
    
</code></pre></div></div>

<ol>
  <li>Interprocess means that the publisher and subscriber are in different processes. To test
interprocess communication, two instances of the performance_test must be run, e.g.</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c"># Start the subscriber first</span>
    perf_test &lt;options&gt; <span class="nt">--num-sub-threads</span> 1 <span class="nt">--num-pub-threads</span> 0 &amp;
    <span class="nb">sleep </span>1  <span class="c"># give the subscriber time to finish initializing</span>
    perf_test &lt;options&gt; <span class="nt">--num-sub-threads</span> 0 <span class="nt">--num-pub-threads</span> 1
    
</code></pre></div></div>

<p>On a distributed system, testing latency is difficult, because the clocks are probably not
perfectly synchronized between the two devices. To work around this, the performance_test tool
supports relay mode, which allows for a round-trip style of communication:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># On the main machine</span>
perf_test &lt;options&gt; <span class="nt">--roundtrip-mode</span> Main

<span class="c"># On the relay machine:</span>
perf_test &lt;options&gt; <span class="nt">--roundtrip-mode</span> Relay

</code></pre></div></div>

<p>In relay mode, the Main machine sends messages to the Relay machine, which immediately sends the
messages back. The Main machine receives the relayed message, and reports the round-trip latency.
Therefore, the reported latency will be roughly double the latency compared to the latency reported
in non-relay mode.</p>

<h3 id="single-machine-single-thread">Single machine, single thread</h3>

<p>An intra-thread configuration is experimentally supported, in which a publisher and subscriber
both operate in the same thread. The publisher writes a messages, and the subscriber immediately
takes it.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>perf_test &lt;options&gt; <span class="nt">-e</span> INTRA_THREAD

</code></pre></div></div>

<p>Notes:</p>

<ol>
  <li>This is only available when zero copy transfer is enabled</li>
  <li>This requires exactly one publisher and one subscriber</li>
  <li>This is not compatible with roundtrip mode</li>
</ol>

<h2 id="middleware-plugins">Middleware plugins</h2>

<p>The performance test tool can measure the performance of a variety of communication solutions
from different vendors. In this case there is no rclcpp or rmw layer overhead over the publisher
and subscriber routines.</p>

<p>The performance_test tool implements an executor that runs the publisher(s) and/or the subscriber(s) in
their own thread.</p>

<p>The following plugins are currently implemented:</p>

<h3 id="eclipse-cyclone-dds">Eclipse Cyclone DDS</h3>

<ul>
  <li><a href="https://github.com/eclipse-cyclonedds/cyclonedds/tree/0.9.0b1">Eclipse Cyclone DDS 0.9.0b1</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CYCLONEDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c CycloneDDS</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.CycloneDDS">Dockerfile.CycloneDDS</a>
</li>
  <li>Available transports:
    <ul>
      <li>Cyclone DDS zero copy requires
<a href="https://github.com/eclipse-iceoryx/iceoryx/blob/master/doc/website/getting-started/overview.md#roudi">RouDi</a>
to be running.
-
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP |</li>
    </ul>
  </li>
</ul>

<h3 id="eclipse-cyclone-dds-c-binding">Eclipse Cyclone DDS C++ binding</h3>

<ul>
  <li><a href="https://github.com/eclipse-cyclonedds/cyclonedds-cxx/tree/0.9.0b1">Eclipse Cyclone DDS C++ bindings 0.9.0b1</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CYCLONEDDS_CXX</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c CycloneDDS-CXX</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.CycloneDDS-CXX">Dockerfile.CycloneDDS-CXX</a>
</li>
  <li>Available transports:
    <ul>
      <li>Cyclone DDS zero copy requires the
<a href="https://github.com/eclipse-iceoryx/iceoryx/blob/master/doc/website/getting-started/overview.md#roudi">RouDi</a>
to be running.
-
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP |</li>
    </ul>
  </li>
</ul>

<h3 id="eclipse-iceoryx">Eclipse iceoryx</h3>

<ul>
  <li><a href="https://github.com/eclipse-iceoryx/iceoryx/tree/5fe215eab267b0ad68bc5552aecd4b6e728e4c99">iceoryx (latest master as of Feb 13)</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=ICEORYX</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c iceoryx</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.iceoryx">Dockerfile.iceoryx</a>
</li>
  <li>The iceoryx plugin is not a DDS implementation.
    <ul>
      <li>The DDS-specific options (such as domain ID, durability, and reliability) do not apply.</li>
    </ul>
  </li>
  <li>To run with the iceoryx plugin,
<a href="https://github.com/eclipse-iceoryx/iceoryx/blob/master/doc/website/getting-started/overview.md#roudi">RouDi</a>
must be running.</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|———–|———————|———————————–|
| LoanedSamples | LoanedSamples | Not supported by performance_test |</li>
</ul>

<h3 id="eprosima-fast-dds">eProsima Fast DDS</h3>

<ul>
  <li><a href="https://github.com/eProsima/Fast-DDS/tree/v2.6.2">FastDDS 2.6.2</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=FASTDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c FastRTPS</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.FastDDS">Dockerfile.FastDDS</a>
</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA (default), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | SHMEM (default), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP |</li>
</ul>

<h3 id="oci-opendds">OCI OpenDDS</h3>

<ul>
  <li><a href="https://github.com/objectcomputing/OpenDDS/tree/DDS-3.13.2">OpenDDS 3.13.2</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=OPENDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c OpenDDS</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.OpenDDS">Dockerfile.OpenDDS</a>
</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| TCP   | TCP                 | TCP                |</li>
</ul>

<h3 id="rti-connext-dds">RTI Connext DDS</h3>

<ul>
  <li><a href="https://www.rti.com/products/connext-dds-professional">RTI Connext DDS 5.3.1+</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CONNEXTDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c ConnextDDS</code>
</li>
  <li>Docker file: Not available</li>
  <li>A license is required</li>
  <li>You need to source an RTI Connext DDS environment.
    <ul>
      <li>If RTI Connext DDS was installed with ROS 2 (Linux only):
        <ul>
          <li><code class="language-plaintext highlighter-rouge">source /opt/rti.com/rti_connext_dds-5.3.1/setenv_ros2rti.bash</code></li>
        </ul>
      </li>
      <li>If RTI Connext DDS is installed separately, you can source the following script to set the
environment:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">source &lt;connextdds_install_path&gt;/resource/scripts/rtisetenv_&lt;arch&gt;.bash</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA | SHMEM               | UDP                |</li>
</ul>

<h3 id="rti-connext-dds-micro">RTI Connext DDS Micro</h3>

<ul>
  <li><a href="https://www.rti.com/products/connext-dds-micro">Connext DDS Micro 3.0.3</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CONNEXTDDSMICRO</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c ConnextDDSMicro</code>
</li>
  <li>Docker file: Not available</li>
  <li>A license is required</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA | SHMEM               | UDP                |</li>
</ul>

<h2 id="framework-plugins">Framework plugins</h2>

<p>The performance_test tool can also measure the end-to-end latency of a framework. In this case, the
executor of the framework is used to run the publisher(s) and/or the subscriber(s). The potential overhead of the <a href="http://docs.ros2.org/beta2/developer_overview.html#internal-api-architecture-overview">rclcpp or rmw
layer</a> is measured.</p>

<h3 id="ros-2">ROS 2</h3>

<p>The performance test tool can also measure the performance of a variety of RMW implementations,
through the ROS 2 <code class="language-plaintext highlighter-rouge">rclcpp::publisher</code> and <code class="language-plaintext highlighter-rouge">rclcpp::subscriber</code> API.</p>

<ul>
  <li><a href="https://docs.ros.org/en/rolling/Tutorials/Writing-A-Simple-Cpp-Publisher-And-Subscriber.html">ROS 2 <code class="language-plaintext highlighter-rouge">rclcpp::publisher</code> and <code class="language-plaintext highlighter-rouge">rclcpp::subscriber</code></a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=ROS2</code> (default)</li>
  <li>Communication plugin:
    <ul>
      <li>Callback with Single Threaded Executor: <code class="language-plaintext highlighter-rouge">-c rclcpp-single-threaded-executor</code>
</li>
      <li>Callback with Static Single Threaded Executor: <code class="language-plaintext highlighter-rouge">-c rclcpp-static-single-threaded-executor</code>
</li>
      <li>
<a href="https://github.com/ros2/rclcpp/pull/1047"><code class="language-plaintext highlighter-rouge">rclcpp::WaitSet</code></a>: <code class="language-plaintext highlighter-rouge">-c rclcpp-waitset</code>
</li>
    </ul>
  </li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.rclcpp">Dockerfile.rclcpp</a>
</li>
  <li>
<a href="https://docs.ros.org/en/rolling/Concepts/About-Different-Middleware-Vendors.html">Available underlying RMW implementations</a>:
    <ul>
      <li>ROS 2 Rolling is pre-configured to use <code class="language-plaintext highlighter-rouge">rmw_fastrtps_cpp</code>
</li>
      <li>Follow <a href="https://docs.ros.org/en/rolling/Guides/Working-with-multiple-RMW-implementations.html">these instructions</a>
  to use a different RMW implementation</li>
    </ul>
  </li>
  <li>Available transports: depends on underlying RMW implementation
    <ul>
      <li>LoanedSamples are available (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) for <code class="language-plaintext highlighter-rouge">ROS_DISTRO = foxy</code> and above</li>
    </ul>
  </li>
</ul>

<h3 id="apexos">Apex.OS</h3>

<ul>
  <li>Apex.OS</li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=APEX_OS</code>
    <ul>
      <li>It is also required to <code class="language-plaintext highlighter-rouge">source /opt/ApexOS/setup.bash</code> instead of a ROS 2 distribution</li>
    </ul>
  </li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c ApexOSPollingSubscription</code>
</li>
  <li>Docker file: Not available</li>
  <li>Available underlying RMW implementations: <code class="language-plaintext highlighter-rouge">rmw_apex_middleware</code>
</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero_copy</code>) | UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero_copy</code>) | UDP |</li>
</ul>

<h2 id="analyze-the-results">Analyze the results</h2>

<p>After an experiment is run with the <code class="language-plaintext highlighter-rouge">-l</code> flag, a log file is recorded. Both CSV
and JSON formats are supported. It is possible to add custom data to the log
file by setting the<code class="language-plaintext highlighter-rouge">APEX_PERFORMANCE_TEST</code> environment variable before running
an experiment, e.g.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">#</span><span class="w"> </span><span class="err">JSON</span><span class="w"> </span><span class="err">format</span><span class="w">
</span><span class="err">export</span><span class="w"> </span><span class="err">APEX_PERFORMANCE_TEST=</span><span class="s2">"
{
</span><span class="se">\"</span><span class="s2">My Version</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">1.0.4</span><span class="se">\"</span><span class="s2">,
</span><span class="se">\"</span><span class="s2">My Image Version</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">5.2</span><span class="se">\"</span><span class="s2">,
</span><span class="se">\"</span><span class="s2">My OS Version</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">Ubuntu 16.04</span><span class="se">\"</span><span class="s2">
}
"</span><span class="w">

</span></code></pre></div></div>

<h2 id="plot-the-results">Plot the results</h2>

<p>To plot the results in the JSON or CSV log files, see the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/../plotter">plotter README</a>.</p>

<h2 id="architecture">Architecture</h2>

<p>Apex.AI’s <em>Performance Testing in ROS 2</em> white paper
(<a href="https://drive.google.com/file/d/15nX80RK6aS8abZvQAOnMNUEgh7px9V5S/view">available here</a>)
describes how to design a fair and unbiased performance test, and is the basis for this project.</p>
<center><img src="https://gitlab.com/ApexAI/performance_test/-/raw/master/performance_test/architecture.png"></center>

<p>Each middleware has a different API. Thanks to the <code class="language-plaintext highlighter-rouge">Plugin</code> abstraction, the core logic of
setting up and running an experiment is completely decoupled from the implementation details
of sending and receiving individual messages.</p>

<p>Exactly one <code class="language-plaintext highlighter-rouge">Plugin</code> implementation is selected at build time. The design is similar to the
<a href="https://refactoring.guru/design-patterns/abstract-factory">Abstract Factory pattern</a>.
<code class="language-plaintext highlighter-rouge">performance_test</code> declares, but does not define, a static factory method in the <code class="language-plaintext highlighter-rouge">PluginFactory</code>
class. Each middleware provides a definition for this factory method to create a concrete <code class="language-plaintext highlighter-rouge">Plugin</code>
implementation, and <code class="language-plaintext highlighter-rouge">perf_test</code> calls this factory method directly.</p>

<p>An example plugin is available <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/plugins/demo">here</a>.</p>

<h2 id="performance-optimizations">Performance optimizations</h2>

<ul>
  <li>On linux-based platforms, <code class="language-plaintext highlighter-rouge">perf_test</code> writes <code class="language-plaintext highlighter-rouge">0</code> to <code class="language-plaintext highlighter-rouge">/dev/cpu_dma_latency</code>
and holds open the file handle, which will prevent the CPU from entering any
idle states for the duration of the experiment. This should result in lower
message latency and lower variance in that latency.</li>
</ul>

<h2 id="future-extensions-and-limitations">Future extensions and limitations</h2>

<ul>
  <li>Communication frameworks like DDS have a huge amount of settings. This tool only allows the most
common QOS settings to be configured. The other QOS settings are hardcoded in the application.</li>
  <li>Only one publisher per topic is allowed, because the data verification logic does not support
matching data to the different publishers.</li>
  <li>Some communication plugins can get stuck in their internal loops if too much data is received.
Figuring out ways around such issues is one of the goals of this tool.</li>
  <li>FastRTPS wait-set does not support timeouts which can lead to the receiving not aborting. In that
case the performance test must be manually killed.</li>
  <li>Using Connext DDS Micro INTRA transport with <code class="language-plaintext highlighter-rouge">reliable</code> QoS and history kind set to <code class="language-plaintext highlighter-rouge">keep_all</code>
<a href="https://community.rti.com/static/documentation/connext-micro/3.0.3/doc/html/usersmanual/transports/INTRA.html#reliability-and-durability">is not supported with Connext
Micro</a>.
Set <code class="language-plaintext highlighter-rouge">keep-last</code> as QoS history kind always when using <code class="language-plaintext highlighter-rouge">reliable</code>.</li>
</ul>

<p>Possible additional communication which could be implemented are:</p>

<ul>
  <li>Raw UDP communication</li>
</ul>

<h2 id="building-with-limited-resources">Building with limited resources</h2>

<p>When building this tool, the compiler must perform a lot of template expansion. This can be
overwhelming for a system with a low-power CPU or limited RAM. There are some additional CMake
options which can reduce the system load during compilation:</p>

<ol>
  <li>This tool includes many different message types, each with many different sizes. Reduce the number of
messages, and thus the compilation load, by disabling one or more message types. For example, to build
without <code class="language-plaintext highlighter-rouge">PointCloud</code> messages, add <code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_POINDCLOUD=OFF</code> to the <code class="language-plaintext highlighter-rouge">--cmake-args</code>. The message types,
and their options for enabling/disabling, can be found <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/performance_test/msg/CMakeLists.txt">here</a>.</li>
</ol>
</div>
              </div>
            </div>
          </div>
        </div>
      
    
    <div class="row">
      <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-heading"><span class="glyphicon glyphicon-list"></span> CHANGELOG</div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="changelog-for-package-performance_test">Changelog for package performance_test</h1>

<h2 id="xyz-yyyymmdd">X.Y.Z (YYYY/MM/DD)</h2>

<h2 id="230-20240924">2.3.0 (2024/09/24)</h2>

<h3 id="removed">Removed</h3>
<ul>
  <li>Moved <code class="language-plaintext highlighter-rouge">apex_performance_plotter</code> to its own package <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/../plotter">here</a>
</li>
</ul>

<h2 id="220-20240515">2.2.0 (2024/05/15)</h2>

<h3 id="added">Added</h3>
<ul>
  <li>performance_test can be built with ROS 2 Iron and Jazzy
    <h3 id="changed">Changed</h3>
  </li>
  <li>Renamed the <code class="language-plaintext highlighter-rouge">--dds-domain_id</code> CLI arg to <code class="language-plaintext highlighter-rouge">--dds-domain-id</code>
</li>
  <li>When <code class="language-plaintext highlighter-rouge">--dds-domain-id</code> is unspecified, fall back to the <code class="language-plaintext highlighter-rouge">ROS_DOMAIN_ID</code> environment variable</li>
  <li>
<code class="language-plaintext highlighter-rouge">--zero-copy</code> has been separated into two flags:
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">--shared-memory</code>: Enable shared-memory transfer in the plugin. This is meant to replace the
need to manually set runtime flags via <code class="language-plaintext highlighter-rouge">CYCLONEDDS_URI</code>, <code class="language-plaintext highlighter-rouge">APEX_MIDDLEWARE_SETTINGS</code>, etc.</li>
      <li>
<code class="language-plaintext highlighter-rouge">--loaned-samples</code>: When publishing messages in the plugin, borrow loaned samples instead
of publishing by copy</li>
      <li>
<code class="language-plaintext highlighter-rouge">--zero-copy</code> is now an alias for <code class="language-plaintext highlighter-rouge">--shared-memory --loaned-samples</code>
</li>
      <li>Supported plugins include:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">-c CycloneDDS</code></li>
          <li><code class="language-plaintext highlighter-rouge">-c CycloneDDS-CXX</code></li>
          <li><code class="language-plaintext highlighter-rouge">-c ApexOSPollingSubscription</code></li>
          <li>
<code class="language-plaintext highlighter-rouge">-c rclcpp-*</code> with <code class="language-plaintext highlighter-rouge">RMW_IMPLEMENTATION=rmw_cyclonedds_cpp</code>
</li>
          <li>
<code class="language-plaintext highlighter-rouge">-c rclcpp-*</code> with <code class="language-plaintext highlighter-rouge">RMW_IMPLEMENTATION=rmw_fastrtps_cpp</code>
</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="210-20240417">2.1.0 (2024/04/17)</h2>

<h3 id="added-1">Added</h3>
<ul>
  <li>Add new function <code class="language-plaintext highlighter-rouge">prepare()</code> to the Publisher and Subscriber API, intended
to allow participant discovery without blocking the main thread
    <h3 id="changed-1">Changed</h3>
  </li>
  <li>Change the default <code class="language-plaintext highlighter-rouge">--history</code> arg from <code class="language-plaintext highlighter-rouge">KEEP_ALL</code> to <code class="language-plaintext highlighter-rouge">KEEP_LAST</code>
</li>
  <li>Change the default <code class="language-plaintext highlighter-rouge">--history-depth</code> arg from <code class="language-plaintext highlighter-rouge">1000</code> to <code class="language-plaintext highlighter-rouge">16</code>
</li>
  <li>If <code class="language-plaintext highlighter-rouge">--expected-num-pubs</code> is unspecified, set it to the same value as <code class="language-plaintext highlighter-rouge">-p</code>
</li>
  <li>If <code class="language-plaintext highlighter-rouge">--expected-num-subs</code> is unspecified, set it to the same value as <code class="language-plaintext highlighter-rouge">-s</code>
    <h3 id="fixed">Fixed</h3>
  </li>
  <li>Removed an unused variable to fix a Clang build</li>
  <li>Remove unused variable names in the <code class="language-plaintext highlighter-rouge">Plugin</code> abstract class</li>
  <li>Fix a potential lockup in PublisherTask on QNX</li>
</ul>

<h2 id="200-20240319">2.0.0 (2024/03/19)</h2>

<h3 id="added-2">Added</h3>
<ul>
  <li>Add experimental bazel support
    <ul>
      <li><code class="language-plaintext highlighter-rouge">bazel build //performance_test --//:plugin_implementation=//path/to/a/plugin</code></li>
    </ul>
  </li>
  <li>Add a rudimentary socket-based plugin for testing the bazel support
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">bazel run //performance_test --//:plugin_implementation=//performance_test/plugins/demo:demo_plugin -- --help</code>
        <h3 id="changed-2">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Instead of enabling/disabling each plugin, you select exactly one
with a CMake string option, for example:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">colcon build --cmake-args -DPERFORMANCE_TEST_PLUGIN=ROS2</code></li>
    </ul>
  </li>
  <li>Renamed the <code class="language-plaintext highlighter-rouge">--communication</code> CLI arg to <code class="language-plaintext highlighter-rouge">--communicator</code>. The short <code class="language-plaintext highlighter-rouge">-c</code> is unchanged.
    <h3 id="removed-1">Removed</h3>
  </li>
  <li>Removed the deprecated CLI flags for QOS settings:
    <ul>
      <li>Instead of <code class="language-plaintext highlighter-rouge">--reliable</code>, use <code class="language-plaintext highlighter-rouge">--reliability RELIABLE</code>
</li>
      <li>Instead of <code class="language-plaintext highlighter-rouge">--transient</code>, use <code class="language-plaintext highlighter-rouge">--durability TRANSIENT_LOCAL</code>
</li>
      <li>Instead of <code class="language-plaintext highlighter-rouge">--keep-last</code>, use <code class="language-plaintext highlighter-rouge">--history KEEP_LAST</code>
</li>
    </ul>
  </li>
  <li>Removed the obsolete <code class="language-plaintext highlighter-rouge">BoundedSequenceFlat</code> messages</li>
  <li>Removed the superfluous <code class="language-plaintext highlighter-rouge">--msg-list</code> CLI flag. The <code class="language-plaintext highlighter-rouge">--help</code> message
already lists the available messages.
    <h3 id="fixed-1">Fixed</h3>
  </li>
  <li>Update the Apex.OS Runner to use <code class="language-plaintext highlighter-rouge">executor_runner::deferred</code> instead of <code class="language-plaintext highlighter-rouge">executor_runner::deferred_tag()</code>
</li>
  <li>Ensure that the first few published samples are sent at the expected rate</li>
</ul>

<h2 id="152-yyyymmdd">1.5.2 (YYYY/MM/DD)</h2>

<h3 id="added-3">Added</h3>
<ul>
  <li>
<code class="language-plaintext highlighter-rouge">--prevent-cpu-idle</code> is available on QNX
    <h3 id="changed-3">Changed</h3>
  </li>
  <li>JSON log files will contain all values in the <code class="language-plaintext highlighter-rouge">APEX_PERFORMANCE_TEST</code> dictionary, instead of the
five specific values used previously</li>
  <li>Switch to build as C++17 by default
    <h3 id="fixed-2">Fixed</h3>
  </li>
  <li>Zero copy transfer is again enabled for the rclcpp publisher</li>
</ul>

<h2 id="150-20230614">1.5.0 (2023/06/14)</h2>

<h3 id="added-4">Added</h3>
<ul>
  <li>New CLI switch <code class="language-plaintext highlighter-rouge">--prevent-cpu-idle</code> (linux only). When specified,
perf_test will use <code class="language-plaintext highlighter-rouge">/dev/cpu_dma_latency</code> to request that the CPU not enter
any sleep states, to potentially give more consistent results</li>
  <li>Some smaller <code class="language-plaintext highlighter-rouge">Array</code> messages, down to 32 bits</li>
  <li>Added support to the FastDDS plugin for bounded and unbounded sequences
    <h3 id="changed-4">Changed</h3>
  </li>
  <li>Update the README to better explain how to use this tool with Apex.OS</li>
  <li>In the <code class="language-plaintext highlighter-rouge">Runner</code>, allocate the <code class="language-plaintext highlighter-rouge">AnalysisResult</code>s on the stack instead of using <code class="language-plaintext highlighter-rouge">shared_ptr</code>
</li>
  <li>
<code class="language-plaintext highlighter-rouge">Subscriber</code> methods accept a callback parameter, instead of returning a
<code class="language-plaintext highlighter-rouge">vector</code> of results, to reduce heap usage</li>
  <li>Refactored the interaction between <code class="language-plaintext highlighter-rouge">SubscriberStats</code> and <code class="language-plaintext highlighter-rouge">AnalysisResult</code> to
remove the need for a <code class="language-plaintext highlighter-rouge">std::vector</code> of latency samples, to reduce heap usage</li>
  <li>Adjusted the <code class="language-plaintext highlighter-rouge">Array</code> message sizes to make the name match the contents</li>
  <li>Updated <code class="language-plaintext highlighter-rouge">apex_os_communicator</code> to use the new zero-copy API</li>
</ul>

<h2 id="142-20230315">1.4.2 (2023/03/15)</h2>

<h3 id="added-5">Added</h3>
<ul>
  <li>Added <code class="language-plaintext highlighter-rouge">perfplot</code> support for JSON log files
    <h3 id="changed-5">Changed</h3>
  </li>
  <li>Migrate the Apex.OS target to use <code class="language-plaintext highlighter-rouge">rosidl_get_typesupport_target</code>
</li>
  <li>Preallocate the JSON logger’s string buffer to prevent reallocations after the experiment begins</li>
</ul>

<h2 id="141-20230223">1.4.1 (2023/02/23)</h2>

<h3 id="changed-6">Changed</h3>
<ul>
  <li>Updated the iceoryx plugin to the <a href="https://github.com/eclipse-iceoryx/iceoryx/tree/5fe215eab267b0ad68bc5552aecd4b6e728e4c99">latest master as of Feb 13</a>
</li>
</ul>

<h2 id="140-20230220">1.4.0 (2023/02/20)</h2>

<h3 id="added-6">Added</h3>
<ul>
  <li>New message type <code class="language-plaintext highlighter-rouge">BoundedSequenceFlat</code>
    <ul>
      <li>This is a <code class="language-plaintext highlighter-rouge">BoundedSequence</code> with the <code class="language-plaintext highlighter-rouge">@flat</code> annotation</li>
      <li>Sizes range from 1kB to 8MB, like <code class="language-plaintext highlighter-rouge">Array</code> and <code class="language-plaintext highlighter-rouge">BoundedSequence</code>
        <h3 id="changed-7">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Messages of different types can be optionally included via CMake args:
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_ARRAY</code> (default ON)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_STRUCT</code> (default ON)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_POINT_CLOUD</code> (default ON)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_BOUNDED_SEQUENCE</code> (default OFF)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_BOUNDED_SEQUENCE_FLAT</code> (default OFF)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_UNBOUNDED_SEQUENCE</code> (default OFF)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_ALL</code> (default OFF)
        <ul>
          <li>when ON, overrides the other defaults to ON</li>
          <li>you can still optionally exclude some messages by explicitly setting them to OFF
            <h3 id="removed-2">Removed</h3>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Removed a few messages:
    <ul>
      <li>Range</li>
      <li>RadarTrack</li>
      <li>RadarDetection</li>
      <li>NavSatFix
        <h3 id="fixed-3">Fixed</h3>
      </li>
    </ul>
  </li>
  <li>In all cases, including loaned messages, capture the timestamp as the last step of initializing the message</li>
</ul>

<h2 id="137-20230104">1.3.7 (2023/01/04)</h2>

<h2 id="136-20230103">1.3.6 (2023/01/03)</h2>

<h3 id="fixed-4">Fixed</h3>
<ul>
  <li>Set the correct <code class="language-plaintext highlighter-rouge">IDL_GEN_ROOT</code> for rclcpp plugins</li>
</ul>

<h2 id="135-20221205">1.3.5 (2022/12/05)</h2>

<h3 id="fixed-5">Fixed</h3>
<ul>
  <li>Exit cleanly when a publisher process terminates before a subscriber process</li>
</ul>

<h2 id="134-20221128">1.3.4 (2022/11/28)</h2>

<h3 id="changed-8">Changed</h3>
<ul>
  <li>Updated Apex.OS plugins to use the unified <code class="language-plaintext highlighter-rouge">LoanedSample::data()</code>
</li>
</ul>

<h2 id="133-20221128">1.3.3 (2022/11/28)</h2>

<h3 id="fixed-6">Fixed</h3>
<ul>
  <li>Implement the missing <code class="language-plaintext highlighter-rouge">take()</code> method in <code class="language-plaintext highlighter-rouge">ApexOSPollingSubscriptionSubscriber</code>
</li>
</ul>

<h2 id="132-20221121">1.3.2 (2022/11/21)</h2>

<h3 id="fixed-7">Fixed</h3>
<ul>
  <li>Capture the <code class="language-plaintext highlighter-rouge">this</code> pointer in the lambda in the iceoryx publisher</li>
</ul>

<h2 id="131-20221121">1.3.1 (2022/11/21)</h2>

<h3 id="added-7">Added</h3>
<ul>
  <li>New Apex.OS plugin, compatible with the <code class="language-plaintext highlighter-rouge">ThreadedRunner</code>s
    <ul>
      <li>The <code class="language-plaintext highlighter-rouge">INTER_THREAD</code> and <code class="language-plaintext highlighter-rouge">INTRA_THREAD</code> execution strategies, combined with
<code class="language-plaintext highlighter-rouge">-c ApexOSPollingSubscription</code>, will use the <code class="language-plaintext highlighter-rouge">ThreadedRunner</code> instances</li>
      <li>The new <code class="language-plaintext highlighter-rouge">APEX_SINGLE_EXECUTOR</code> execution strategy will add all publishers
and subscribers to a single Apex.OS Executor</li>
      <li>The new <code class="language-plaintext highlighter-rouge">APEX_EXECUTOR_PER_COMMUNICATOR</code> execution strategy will add each
publisher and each subscriber to its own Apex.OS Executor instance</li>
      <li>The new <code class="language-plaintext highlighter-rouge">APEX_CHAIN</code> execution strategy will add a publisher and subscriber
as a chain of nodes to an Apex.OS Executor
        <h3 id="changed-9">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Refactored FastRTPS communicator plugin:
    <ul>
      <li>Uses DDS compliant API</li>
      <li>Code generator updated</li>
      <li>Implementation for <code class="language-plaintext highlighter-rouge">publish_loaned()</code>
</li>
      <li>Dockerfile improvements
        <h3 id="removed-3">Removed</h3>
      </li>
    </ul>
  </li>
  <li>CLI arg <code class="language-plaintext highlighter-rouge">--disable-async</code>. Synchronous / asynchronous publishing should be
configured externally depending on the communication mean used.</li>
</ul>

<h2 id="130-20220825">1.3.0 (2022/08/25)</h2>

<h3 id="added-8">Added</h3>
<ul>
  <li>New execution strategy option:
    <ul>
      <li>The default <code class="language-plaintext highlighter-rouge">-e INTER_THREAD</code> runs each publisher and subscriber in its
own separate thread, which matches the previous behavior</li>
      <li>A new <code class="language-plaintext highlighter-rouge">-e INTRA_THREAD</code>, which runs a single publisher and subscriber in the
same thread. The publisher writes, and the subscriber immediately takes it</li>
      <li>For Apex.OS specifically, some optimized execution strategies which use the
proprietary Apex.OS executor
        <h3 id="changed-10">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Significantly refactored the communicator plugins:
    <ul>
      <li>Each plugin is split into an implementation of a <code class="language-plaintext highlighter-rouge">Publisher</code> and a
<code class="language-plaintext highlighter-rouge">Subscriber</code>, instead of a single <code class="language-plaintext highlighter-rouge">Communicator</code>
</li>
      <li>The plugin is no longer responsible for managing the metrics, such as
sample count, lost samples, and latency</li>
      <li>The plugin does not require any special logic to support roundtrip mode</li>
      <li>It is safe for the plugins to initialize their data writers and readers
at construction time, instead of delaying the initialization to the first
call of <code class="language-plaintext highlighter-rouge">publish()</code> or <code class="language-plaintext highlighter-rouge">update_subscription()</code>
</li>
      <li>Split <code class="language-plaintext highlighter-rouge">publish()</code> into <code class="language-plaintext highlighter-rouge">publish_copy()</code> and <code class="language-plaintext highlighter-rouge">publish_loaned()</code>
</li>
    </ul>
  </li>
  <li>Significantly refactored the runner framework:
    <ul>
      <li>The runner framework is responsible for the experiment metrics</li>
      <li>It manages the roundtrip mode logic</li>
      <li>It is extensible for different execution strategies or thread configurations</li>
    </ul>
  </li>
  <li>The iceoryx plugin now uses the untyped API, for improved performance</li>
</ul>

<h2 id="121-20220630">1.2.1 (2022/06/30)</h2>

<h3 id="fixed-8">Fixed</h3>
<ul>
  <li>Capture the timestamp as soon as a message is received, instead of just before
storing the metrics, to reduce the reported latency to a more correct value</li>
</ul>

<h2 id="120-20220628">1.2.0 (2022/06/28)</h2>

<h3 id="changed-11">Changed</h3>
<ul>
  <li>The CLI arguments for specifying the output type have changed:
    <ul>
      <li>For console output, updated every second, add <code class="language-plaintext highlighter-rouge">--print-to-console</code>
</li>
      <li>For file output, use <code class="language-plaintext highlighter-rouge">--logfile my_file.csv</code> or <code class="language-plaintext highlighter-rouge">--logfile my_file.json</code>
        <ul>
          <li>The type will be deduced from the file name</li>
        </ul>
      </li>
      <li>If neither of these options is specified, then a warning will print,
and the experiment will still run</li>
    </ul>
  </li>
  <li>The linter configurations are now configured locally. This means that the output
of <code class="language-plaintext highlighter-rouge">colcon test</code> should be the same no matter the installed ROS distribution.</li>
  <li>The <code class="language-plaintext highlighter-rouge">--zero-copy</code> arg is now valid even if the publisher and subscriber(s)
are in the same process
    <h3 id="removed-4">Removed</h3>
  </li>
  <li>The publisher and subscriber loop reserve metrics are no longer recorded or reported
    <h3 id="fixed-9">Fixed</h3>
  </li>
  <li>CPU usage will no longer be stuck at <code class="language-plaintext highlighter-rouge">0</code>
</li>
</ul>

<h3 id="removed-5">Removed</h3>
<ul>
  <li>The pub/sub loop reserve time metrics</li>
</ul>

<h2 id="112-20220608">1.1.2 (2022/06/08)</h2>

<h3 id="changed-12">Changed</h3>
<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">steady_clock</code> for all platforms, including QNX QOS</li>
</ul>

<h2 id="111-20220607">1.1.1 (2022/06/07)</h2>

<h3 id="changed-13">Changed</h3>
<ul>
  <li>Significant refactor to simplify the analysis pipeline
    <h3 id="fixed-10">Fixed</h3>
  </li>
  <li>Add some missing definitions when Apex.OS is enabled, but the rclcpp plugins are disabled</li>
</ul>

<h2 id="110-20220602">1.1.0 (2022/06/02)</h2>

<h3 id="added-9">Added</h3>
<ul>
  <li>New Apex.OS Polling Subscription plugin</li>
  <li>Compatibility with ROS 2 Humble</li>
</ul>

<h2 id="100-20220512">1.0.0 (2022/05/12)</h2>

<h3 id="added-10">Added</h3>
<ul>
  <li>More expressive perf_test CLI args for QOS settings</li>
  <li>A plugin for <a href="https://github.com/eclipse-cyclonedds/cyclonedds-cxx/tree/0.9.0b1">Cyclone DDS with C++ bindings v0.9.0b1</a>
    <h3 id="changed-14">Changed</h3>
  </li>
  <li>CLI args for QOS settings:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">--reliability &lt;RELIABLE|BEST_EFFORT&gt;</code></li>
      <li><code class="language-plaintext highlighter-rouge">--durability &lt;TRANSIENT_LOCAL|VOLATILE&gt;</code></li>
      <li><code class="language-plaintext highlighter-rouge">--history &lt;KEEP_LAST|KEEP_ALL&gt;</code></li>
    </ul>
  </li>
  <li>
<code class="language-plaintext highlighter-rouge">master</code> branch is compatible with many ROS 2 distributions:
    <ul>
      <li>dashing</li>
      <li>eloquent</li>
      <li>foxy</li>
      <li>galactic</li>
      <li>rolling
        <h3 id="deprecated">Deprecated</h3>
      </li>
    </ul>
  </li>
  <li>CLI flags for QOS settings:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">--reliable</code></li>
      <li><code class="language-plaintext highlighter-rouge">--transient</code></li>
      <li>
<code class="language-plaintext highlighter-rouge">--keep-last</code>
        <h3 id="removed-6">Removed</h3>
      </li>
    </ul>
  </li>
  <li>The branches for specific ROS 2 distributions have been deleted
    <h3 id="fixed-11">Fixed</h3>
  </li>
  <li>CI jobs and Dockerfiles are decoupled from the middleware bundled with the ROS 2 distribution</li>
</ul>
</div>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="humble-tutorials">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wiki Tutorials</h3>
      </div>
      <div class="panel-body">
        
        <em>This package does not provide any links to tutorials in it's <a href="https://index.ros.org/contribute/metadata/">rosindex metadata</a>.</em>
        <em>You can check on the <a href="http://wiki.ros.org/performance_test/Tutorials" target="_blank">ROS Wiki Tutorials</a> page for the package.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="humble-deps">
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Package Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th class="text-center">Deps</th>
                  <th style="width: 100%">Name</th>
                </thead>
                <tbody>
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rclcpp#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rclcpp#humble">rclcpp  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ros_environment#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ros_environment#humble">ros_environment  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake#humble">ament_cmake  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_generators#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_generators#humble">rosidl_default_generators  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rmw_implementation#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rmw_implementation#humble">rmw_implementation  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_runtime#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_runtime#humble">rosidl_default_runtime  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_gtest#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_gtest#humble">ament_cmake_gtest  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_auto#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_auto#humble">ament_lint_auto  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_common#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_common#humble">ament_lint_common  </a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
          <div class="panel-heading">
            <h3 class="panel-title">System Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                </thead>
                <tbody>
                  
                    
                      <tr>
                        <td><a href="/d/git">git</a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Dependant Packages</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                  <th class="text-center">Deps</th>
                </thead>
                <tbody>
                  
                    
                    
                    <tr>
                      <td><a href="/p/performance_report#humble">performance_report</a></td>
                      <td class="text-center">
                        
                        <a href="/p/performance_report#humble-deps" class="endoftree">
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="humble-assets">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Launch files</h3>
      </div>
      <div class="panel-body">
        
          <em>No launch files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Messages</h3>
      </div>
      <div class="panel-body">
        
          <em>No message files found.</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Services</h3>
      </div>
      <div class="panel-body">
        
          <em>No service files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Plugins</h3>
      </div>
      <div class="panel-body">
        
          <em>No plugins found.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="humble-questions">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent questions tagged <kbd>performance_test</kbd> at <strong><a href="https://robotics.stackexchange.com/" target="_blank">Robotics Stack Exchange</a></strong></h3>      </div>
      <div id="humble-question-list" class="panel-body" style="display: none;"></div>
      <div id="humble-no-question-list" class="panel-body" style="display: none;">
        <p>No questions yet, you can ask one <a href="https://robotics.stackexchange.com/questions/tagged/performance_test+humble">here</a>.</p>
      </div>
      <div id="humble-get-question-fail" class="panel-body alert alert-warning" style="display: none;">
        <p>Failed to get question list, you can ticket an issue <a href="https://github.com/ros-infrastructure/rosindex/issues/new" target="_blank" class="alert-link">here</a> </p>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/package_body_tabs.js"></script>

<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
jQuery(function() {
    // Update the count on the links to the contribution suggestions
    updateContributionSuggestionsCountOnPackage('https://gitlab.com/ApexAI/performance_test.git');
});
</script>

          </div>
          <div class="col-md-2 hidden-xs hidden-sm">
            
            
            



<div class="list-group list-group-sm ">
  <a class="list-group-item"
     target="_blank"
     href="http://docs.ros.org/en/humble/p/performance_test"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       
       API Docs
  </a>
  <a class="list-group-item"
     target="_blank"
     href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       
       Browse Code
  </a>
  
  
  
  
  
  
</div>

          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-jazzy">
    <div class="container-fluid">
      
        
        
        

        <div class="row">
          <div class="col-md-10">
            

<div class="well well-sm">
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px" src="/assets/package.png">
      </td>
      <td>
        <h3 style="margin-top: 5px">
          <a style="text-decoration:none" href="/p/performance_test">performance_test</a> <small>package from <a style="text-decoration:none" href="/r/performance_test/gitlab-ApexAI-performance_test">performance_test</a> repo</small>
        </h3>
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_report">

performance_report
</a>
            
          
            
            
              <span class="label label-default pkg-label">

performance_test
</span>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_test_ros1_msgs">

performance_test_ros1_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_test_ros1_publisher">

performance_test_ros1_publisher
</a>
            
          
      </td>
    </tr>
  </table>
</div>

            <div class="visible-xs visible-sm">
              
              
              



<div class="list-group list-group-sm list-group-horizontal list-group-justified">
  <a class="list-group-item text-center"
     target="_blank"
     href="http://docs.ros.org/en/jazzy/p/performance_test"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       <br>
       API Docs
  </a>
  <a class="list-group-item text-center"
     target="_blank"
     href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       <br>
       Browse Code
  </a>
  
  
  
  
  
  
</div>

            </div>
            



<ul class="nav nav-tabs nav-justified" id="jazzy-tabs" style="margin-bottom:20px">
  <li class="better-tabs active">
    <a href="#jazzy-overview" data-toggle="tab">Overview</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    
    <a href="#jazzy-assets" data-toggle="tab"><span class="label label-default">0</span> Assets</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    <a href="#jazzy-deps" data-toggle="tab"><span class="label label-primary">10</span> Dependencies</a>
  </li>
  <li class="better-tabs">
    
    <a href="#jazzy-tutorials" data-toggle="tab"><span class="label label-default">0</span> Tutorials</a>
  </li>
  <li class="better-tabs">
    <a href="#jazzy-questions" data-toggle="tab"><span id="jazzy-questions-count" class="label label-primary">0</span> Q & A</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="jazzy-overview">
    
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h4 class="panel-title">Package Summary</h4></div>
          <div class="panel-body">
            <table class="table table-condensed">
              <tr>
                <td style="width:100px;" class="text-right"><strong>Tags</strong></td>
                <td>
                  
                  
                    <em>No category tags.</em>
                  
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Version</strong></td>
                <td>2.3.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>License</strong></td>
                <td>Apache 2.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>Build type</strong></td>
                <td>
                  
                    <span class="label label-default">
                  
                    AMENT_CMAKE</span>
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Use</strong></td>
                <td>
                
                  <span class="label label-success">RECOMMENDED</span>
                
                </td>
              </tr>
            </table>
          </div>
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body">
            
            
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default"></span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://gitlab.com/ApexAI/performance_test.git">https://gitlab.com/ApexAI/performance_test.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">master</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-03-25
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="No CI information available for this package.">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/performance_test/#jazzy-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/performance_test/#jazzy-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/performance_test/#jazzy-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Package Description</h3></div>
          <div class="panel-body">
            Tool to test performance of ROS 2 and DDS data layers and communication.
          </div>
          <div class="panel-heading"><h4 class="panel-title">Additional Links</h4></div>
          <div class="panel-body">
            
            
              <em>No additional links.</em>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Maintainers</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Apex.AI, Inc.</li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Authors</h4></div>
          <div class="panel-body">
            
            
              <em>No additional authors.</em>
            
          </div>
        </div>
      </div>
    </div>
    
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-heading"><span class="glyphicon glyphicon-file"></span><a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/README.md" title="Open in git repository">performance_test/README.md</a></div>
              <div class="panel-body">
                    <div class="rendered-markdown">
<h1 id="performance_test">performance_test</h1>

<p>[TOC]</p>

<p>The performance_test tool tests latency and other performance metrics of <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">various middleware
implementations</a> that support a pub/sub pattern. It is used to simulate
non-functional performance of your application.</p>

<p>The performance_test tool allows you to quickly set up a pub/sub configuration,
e.g. number of publisher/subscribers, message size, QOS settings, middleware. The following metrics
are automatically recorded when the application is running:</p>

<ul>
  <li>
<strong>latency</strong>: corresponds to the time a message takes to travel from a publisher to subscriber. The
latency is measured by timestamping the sample when it’s published and subtracting the timestamp
  (from the sample) from the measured time when the sample arrives at the subscriber (only logged when a subscriber is created)</li>
  <li>
<strong>CPU usage</strong>: percentage of the total system wide CPU usage (logged separately for each instance of <code class="language-plaintext highlighter-rouge">perf_test</code>)</li>
  <li>
<strong>resident memory</strong>: heap allocations, shared memory segments, stack (used for system’s internal
work) (logged separately for each instance of <code class="language-plaintext highlighter-rouge">perf_test</code>)</li>
  <li>
<strong>sample statistics</strong>: number of samples received, sent, and lost per experiment run.</li>
</ul>

<p>This <code class="language-plaintext highlighter-rouge">master</code> branch is compatible with the following ROS 2 versions</p>
<ul>
  <li>rolling</li>
  <li>jazzy</li>
  <li>iron</li>
  <li>humble</li>
  <li>galactic</li>
  <li>foxy</li>
  <li>eloquent</li>
  <li>dashing</li>
  <li>Apex.OS</li>
</ul>

<h2 id="how-to-use-this-document">How to use this document</h2>

<ol>
  <li>Start <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#example">here</a> for a quick example of building and running the performance_test tool
with the Cyclone DDS plugin.</li>
  <li>If needed, find more detailed information about <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#building-the-performance_test-tool">building</a>
and <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#running-an-experiment">running</a>
</li>
  <li>Or, if the quick example is good enough, skip ahead to the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">list of supported middleware
plugins</a> to learn how to test a specific middleware implementation.</li>
  <li>Check out the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#analyze-the-results">tools for visualizing the results</a>
</li>
  <li>If desired, read about the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#architecture">design and architecture</a> of the tool.</li>
</ol>

<h2 id="example">Example</h2>

<p>This example shows how to test the non-functional performance of the following configuration:</p>

<table>
  <thead>
    <tr>
      <th>Option</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Plugin</td>
      <td>Cyclone DDS</td>
    </tr>
    <tr>
      <td>Message type</td>
      <td>Array1k</td>
    </tr>
    <tr>
      <td>Publishing rate</td>
      <td>100Hz</td>
    </tr>
    <tr>
      <td>Topic name</td>
      <td>test_topic</td>
    </tr>
    <tr>
      <td>Duration of the experiment</td>
      <td>30s</td>
    </tr>
    <tr>
      <td>Number of publisher(s)</td>
      <td>1 (default)</td>
    </tr>
    <tr>
      <td>Number of subscriber(s)</td>
      <td>1 (default)</td>
    </tr>
  </tbody>
</table>

<ol>
  <li>
    <p>Install <a href="https://docs.ros.org/en/rolling/index.html">ROS 2</a></p>
  </li>
  <li>
    <p>Install <a href="https://github.com/eclipse-cyclonedds/cyclonedds">Cyclone DDS</a> to /opt/cyclonedds</p>
  </li>
  <li>
    <p>Build performance_test with the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#eclipse-cyclone-dds">CMake build flag</a> for Cyclone DDS:</p>
  </li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nb">source</span> /opt/ros/rolling/setup.bash
    <span class="nb">cd</span> ~/perf_test_ws
    colcon build <span class="nt">--cmake-args</span> <span class="nt">-DPERFORMANCE_TEST_PLUGIN</span><span class="o">=</span>CYCLONEDDS
    <span class="nb">source</span> ./install/setup.bash
    
</code></pre></div></div>

<ol>
  <li>Run with the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#eclipse-cyclone-dds">communication plugin option</a> for Cyclone DDS:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>experiment
./install/performance_test/lib/performance_test/perf_test <span class="nt">--communication</span> CycloneDDS
                                                          <span class="nt">--msg</span> Array1k
                                                          <span class="nt">--rate</span> 100
                                                          <span class="nt">--topic</span> test_topic
                                                          <span class="nt">--max-runtime</span> 30
                                                          <span class="nt">--logfile</span> experiment/log.csv

</code></pre></div></div>

<p>At the end of the experiment, a CSV log file will be generated in the experiment folder with a name
that starts with <code class="language-plaintext highlighter-rouge">log</code>.</p>

<h2 id="building-the-performance_test-tool">Building the performance_test tool</h2>

<p>For a simple example, see <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.rclcpp">Dockerfile.rclcpp</a>.</p>

<p>The performance_test tool is structured as a ROS 2 package, so <code class="language-plaintext highlighter-rouge">colcon</code> is used to build it.
Therefore, you must source a ROS 2 installation:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">source</span> /opt/ros/rolling/setup.bash

</code></pre></div></div>

<p>Select a middleware plugin from <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">this list</a>.
Then build the performance_test tool with the selected middleware:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> ~/perf_test_ws/src
<span class="nb">cd</span> ~/perf_test_ws/src
git clone https://gitlab.com/ApexAI/performance_test.git
<span class="nb">cd</span> ..
<span class="c"># At this stage, you need to choose which middleware you want to use</span>
<span class="c"># The list of available flags is described in the middleware plugins section</span>
<span class="c"># Square brackets denote optional arguments, like in the Python documentation.</span>
colcon build <span class="nt">--cmake-args</span> <span class="nt">-DCMAKE_BUILD_TYPE</span><span class="o">=</span>Release <span class="nt">-DPERFORMANCE_TEST_PLUGIN</span><span class="o">=</span>&lt;plugin&gt;
<span class="nb">source install</span>/setup.bash

</code></pre></div></div>

<h2 id="running-an-experiment">Running an experiment</h2>

<p>The performance_test experiments are run through the <code class="language-plaintext highlighter-rouge">perf_test</code> executable.
To find the available settings, run with <code class="language-plaintext highlighter-rouge">--help</code> (note the required and default arguments):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~/perf_test_ws<span class="nv">$ </span>./install/performance_test/lib/performance_test/perf_test <span class="nt">--help</span>

</code></pre></div></div>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">-c</code> argument should match the selected <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">middleware plugin</a>
from the build phase.</li>
  <li>The <code class="language-plaintext highlighter-rouge">--msg</code> argument should be one of the supported message types, which are shown
in the <code class="language-plaintext highlighter-rouge">--help</code> output.</li>
</ul>

<h3 id="single-machine-or-distributed-system">Single machine or distributed system?</h3>

<p>Based on the configuration you want to test, the usage of the performance_test tool differs. The
different possibilities are explained below.</p>

<p>For running tests on a single machine, you can choose between the following options:</p>

<ol>
  <li>Intraprocess means that the publisher and subscriber threads are in the same process.</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    perf_test &lt;options&gt; <span class="nt">--num-sub-threads</span> 1 <span class="nt">--num-pub-threads</span> 1
    
</code></pre></div></div>

<ol>
  <li>Interprocess means that the publisher and subscriber are in different processes. To test
interprocess communication, two instances of the performance_test must be run, e.g.</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c"># Start the subscriber first</span>
    perf_test &lt;options&gt; <span class="nt">--num-sub-threads</span> 1 <span class="nt">--num-pub-threads</span> 0 &amp;
    <span class="nb">sleep </span>1  <span class="c"># give the subscriber time to finish initializing</span>
    perf_test &lt;options&gt; <span class="nt">--num-sub-threads</span> 0 <span class="nt">--num-pub-threads</span> 1
    
</code></pre></div></div>

<p>On a distributed system, testing latency is difficult, because the clocks are probably not
perfectly synchronized between the two devices. To work around this, the performance_test tool
supports relay mode, which allows for a round-trip style of communication:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># On the main machine</span>
perf_test &lt;options&gt; <span class="nt">--roundtrip-mode</span> Main

<span class="c"># On the relay machine:</span>
perf_test &lt;options&gt; <span class="nt">--roundtrip-mode</span> Relay

</code></pre></div></div>

<p>In relay mode, the Main machine sends messages to the Relay machine, which immediately sends the
messages back. The Main machine receives the relayed message, and reports the round-trip latency.
Therefore, the reported latency will be roughly double the latency compared to the latency reported
in non-relay mode.</p>

<h3 id="single-machine-single-thread">Single machine, single thread</h3>

<p>An intra-thread configuration is experimentally supported, in which a publisher and subscriber
both operate in the same thread. The publisher writes a messages, and the subscriber immediately
takes it.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>perf_test &lt;options&gt; <span class="nt">-e</span> INTRA_THREAD

</code></pre></div></div>

<p>Notes:</p>

<ol>
  <li>This is only available when zero copy transfer is enabled</li>
  <li>This requires exactly one publisher and one subscriber</li>
  <li>This is not compatible with roundtrip mode</li>
</ol>

<h2 id="middleware-plugins">Middleware plugins</h2>

<p>The performance test tool can measure the performance of a variety of communication solutions
from different vendors. In this case there is no rclcpp or rmw layer overhead over the publisher
and subscriber routines.</p>

<p>The performance_test tool implements an executor that runs the publisher(s) and/or the subscriber(s) in
their own thread.</p>

<p>The following plugins are currently implemented:</p>

<h3 id="eclipse-cyclone-dds">Eclipse Cyclone DDS</h3>

<ul>
  <li><a href="https://github.com/eclipse-cyclonedds/cyclonedds/tree/0.9.0b1">Eclipse Cyclone DDS 0.9.0b1</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CYCLONEDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c CycloneDDS</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.CycloneDDS">Dockerfile.CycloneDDS</a>
</li>
  <li>Available transports:
    <ul>
      <li>Cyclone DDS zero copy requires
<a href="https://github.com/eclipse-iceoryx/iceoryx/blob/master/doc/website/getting-started/overview.md#roudi">RouDi</a>
to be running.
-
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP |</li>
    </ul>
  </li>
</ul>

<h3 id="eclipse-cyclone-dds-c-binding">Eclipse Cyclone DDS C++ binding</h3>

<ul>
  <li><a href="https://github.com/eclipse-cyclonedds/cyclonedds-cxx/tree/0.9.0b1">Eclipse Cyclone DDS C++ bindings 0.9.0b1</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CYCLONEDDS_CXX</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c CycloneDDS-CXX</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.CycloneDDS-CXX">Dockerfile.CycloneDDS-CXX</a>
</li>
  <li>Available transports:
    <ul>
      <li>Cyclone DDS zero copy requires the
<a href="https://github.com/eclipse-iceoryx/iceoryx/blob/master/doc/website/getting-started/overview.md#roudi">RouDi</a>
to be running.
-
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP |</li>
    </ul>
  </li>
</ul>

<h3 id="eclipse-iceoryx">Eclipse iceoryx</h3>

<ul>
  <li><a href="https://github.com/eclipse-iceoryx/iceoryx/tree/5fe215eab267b0ad68bc5552aecd4b6e728e4c99">iceoryx (latest master as of Feb 13)</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=ICEORYX</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c iceoryx</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.iceoryx">Dockerfile.iceoryx</a>
</li>
  <li>The iceoryx plugin is not a DDS implementation.
    <ul>
      <li>The DDS-specific options (such as domain ID, durability, and reliability) do not apply.</li>
    </ul>
  </li>
  <li>To run with the iceoryx plugin,
<a href="https://github.com/eclipse-iceoryx/iceoryx/blob/master/doc/website/getting-started/overview.md#roudi">RouDi</a>
must be running.</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|———–|———————|———————————–|
| LoanedSamples | LoanedSamples | Not supported by performance_test |</li>
</ul>

<h3 id="eprosima-fast-dds">eProsima Fast DDS</h3>

<ul>
  <li><a href="https://github.com/eProsima/Fast-DDS/tree/v2.6.2">FastDDS 2.6.2</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=FASTDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c FastRTPS</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.FastDDS">Dockerfile.FastDDS</a>
</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA (default), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | SHMEM (default), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP |</li>
</ul>

<h3 id="oci-opendds">OCI OpenDDS</h3>

<ul>
  <li><a href="https://github.com/objectcomputing/OpenDDS/tree/DDS-3.13.2">OpenDDS 3.13.2</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=OPENDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c OpenDDS</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.OpenDDS">Dockerfile.OpenDDS</a>
</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| TCP   | TCP                 | TCP                |</li>
</ul>

<h3 id="rti-connext-dds">RTI Connext DDS</h3>

<ul>
  <li><a href="https://www.rti.com/products/connext-dds-professional">RTI Connext DDS 5.3.1+</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CONNEXTDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c ConnextDDS</code>
</li>
  <li>Docker file: Not available</li>
  <li>A license is required</li>
  <li>You need to source an RTI Connext DDS environment.
    <ul>
      <li>If RTI Connext DDS was installed with ROS 2 (Linux only):
        <ul>
          <li><code class="language-plaintext highlighter-rouge">source /opt/rti.com/rti_connext_dds-5.3.1/setenv_ros2rti.bash</code></li>
        </ul>
      </li>
      <li>If RTI Connext DDS is installed separately, you can source the following script to set the
environment:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">source &lt;connextdds_install_path&gt;/resource/scripts/rtisetenv_&lt;arch&gt;.bash</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA | SHMEM               | UDP                |</li>
</ul>

<h3 id="rti-connext-dds-micro">RTI Connext DDS Micro</h3>

<ul>
  <li><a href="https://www.rti.com/products/connext-dds-micro">Connext DDS Micro 3.0.3</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CONNEXTDDSMICRO</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c ConnextDDSMicro</code>
</li>
  <li>Docker file: Not available</li>
  <li>A license is required</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA | SHMEM               | UDP                |</li>
</ul>

<h2 id="framework-plugins">Framework plugins</h2>

<p>The performance_test tool can also measure the end-to-end latency of a framework. In this case, the
executor of the framework is used to run the publisher(s) and/or the subscriber(s). The potential overhead of the <a href="http://docs.ros2.org/beta2/developer_overview.html#internal-api-architecture-overview">rclcpp or rmw
layer</a> is measured.</p>

<h3 id="ros-2">ROS 2</h3>

<p>The performance test tool can also measure the performance of a variety of RMW implementations,
through the ROS 2 <code class="language-plaintext highlighter-rouge">rclcpp::publisher</code> and <code class="language-plaintext highlighter-rouge">rclcpp::subscriber</code> API.</p>

<ul>
  <li><a href="https://docs.ros.org/en/rolling/Tutorials/Writing-A-Simple-Cpp-Publisher-And-Subscriber.html">ROS 2 <code class="language-plaintext highlighter-rouge">rclcpp::publisher</code> and <code class="language-plaintext highlighter-rouge">rclcpp::subscriber</code></a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=ROS2</code> (default)</li>
  <li>Communication plugin:
    <ul>
      <li>Callback with Single Threaded Executor: <code class="language-plaintext highlighter-rouge">-c rclcpp-single-threaded-executor</code>
</li>
      <li>Callback with Static Single Threaded Executor: <code class="language-plaintext highlighter-rouge">-c rclcpp-static-single-threaded-executor</code>
</li>
      <li>
<a href="https://github.com/ros2/rclcpp/pull/1047"><code class="language-plaintext highlighter-rouge">rclcpp::WaitSet</code></a>: <code class="language-plaintext highlighter-rouge">-c rclcpp-waitset</code>
</li>
    </ul>
  </li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.rclcpp">Dockerfile.rclcpp</a>
</li>
  <li>
<a href="https://docs.ros.org/en/rolling/Concepts/About-Different-Middleware-Vendors.html">Available underlying RMW implementations</a>:
    <ul>
      <li>ROS 2 Rolling is pre-configured to use <code class="language-plaintext highlighter-rouge">rmw_fastrtps_cpp</code>
</li>
      <li>Follow <a href="https://docs.ros.org/en/rolling/Guides/Working-with-multiple-RMW-implementations.html">these instructions</a>
  to use a different RMW implementation</li>
    </ul>
  </li>
  <li>Available transports: depends on underlying RMW implementation
    <ul>
      <li>LoanedSamples are available (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) for <code class="language-plaintext highlighter-rouge">ROS_DISTRO = foxy</code> and above</li>
    </ul>
  </li>
</ul>

<h3 id="apexos">Apex.OS</h3>

<ul>
  <li>Apex.OS</li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=APEX_OS</code>
    <ul>
      <li>It is also required to <code class="language-plaintext highlighter-rouge">source /opt/ApexOS/setup.bash</code> instead of a ROS 2 distribution</li>
    </ul>
  </li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c ApexOSPollingSubscription</code>
</li>
  <li>Docker file: Not available</li>
  <li>Available underlying RMW implementations: <code class="language-plaintext highlighter-rouge">rmw_apex_middleware</code>
</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero_copy</code>) | UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero_copy</code>) | UDP |</li>
</ul>

<h2 id="analyze-the-results">Analyze the results</h2>

<p>After an experiment is run with the <code class="language-plaintext highlighter-rouge">-l</code> flag, a log file is recorded. Both CSV
and JSON formats are supported. It is possible to add custom data to the log
file by setting the<code class="language-plaintext highlighter-rouge">APEX_PERFORMANCE_TEST</code> environment variable before running
an experiment, e.g.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">#</span><span class="w"> </span><span class="err">JSON</span><span class="w"> </span><span class="err">format</span><span class="w">
</span><span class="err">export</span><span class="w"> </span><span class="err">APEX_PERFORMANCE_TEST=</span><span class="s2">"
{
</span><span class="se">\"</span><span class="s2">My Version</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">1.0.4</span><span class="se">\"</span><span class="s2">,
</span><span class="se">\"</span><span class="s2">My Image Version</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">5.2</span><span class="se">\"</span><span class="s2">,
</span><span class="se">\"</span><span class="s2">My OS Version</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">Ubuntu 16.04</span><span class="se">\"</span><span class="s2">
}
"</span><span class="w">

</span></code></pre></div></div>

<h2 id="plot-the-results">Plot the results</h2>

<p>To plot the results in the JSON or CSV log files, see the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/../plotter">plotter README</a>.</p>

<h2 id="architecture">Architecture</h2>

<p>Apex.AI’s <em>Performance Testing in ROS 2</em> white paper
(<a href="https://drive.google.com/file/d/15nX80RK6aS8abZvQAOnMNUEgh7px9V5S/view">available here</a>)
describes how to design a fair and unbiased performance test, and is the basis for this project.</p>
<center><img src="https://gitlab.com/ApexAI/performance_test/-/raw/master/performance_test/architecture.png"></center>

<p>Each middleware has a different API. Thanks to the <code class="language-plaintext highlighter-rouge">Plugin</code> abstraction, the core logic of
setting up and running an experiment is completely decoupled from the implementation details
of sending and receiving individual messages.</p>

<p>Exactly one <code class="language-plaintext highlighter-rouge">Plugin</code> implementation is selected at build time. The design is similar to the
<a href="https://refactoring.guru/design-patterns/abstract-factory">Abstract Factory pattern</a>.
<code class="language-plaintext highlighter-rouge">performance_test</code> declares, but does not define, a static factory method in the <code class="language-plaintext highlighter-rouge">PluginFactory</code>
class. Each middleware provides a definition for this factory method to create a concrete <code class="language-plaintext highlighter-rouge">Plugin</code>
implementation, and <code class="language-plaintext highlighter-rouge">perf_test</code> calls this factory method directly.</p>

<p>An example plugin is available <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/plugins/demo">here</a>.</p>

<h2 id="performance-optimizations">Performance optimizations</h2>

<ul>
  <li>On linux-based platforms, <code class="language-plaintext highlighter-rouge">perf_test</code> writes <code class="language-plaintext highlighter-rouge">0</code> to <code class="language-plaintext highlighter-rouge">/dev/cpu_dma_latency</code>
and holds open the file handle, which will prevent the CPU from entering any
idle states for the duration of the experiment. This should result in lower
message latency and lower variance in that latency.</li>
</ul>

<h2 id="future-extensions-and-limitations">Future extensions and limitations</h2>

<ul>
  <li>Communication frameworks like DDS have a huge amount of settings. This tool only allows the most
common QOS settings to be configured. The other QOS settings are hardcoded in the application.</li>
  <li>Only one publisher per topic is allowed, because the data verification logic does not support
matching data to the different publishers.</li>
  <li>Some communication plugins can get stuck in their internal loops if too much data is received.
Figuring out ways around such issues is one of the goals of this tool.</li>
  <li>FastRTPS wait-set does not support timeouts which can lead to the receiving not aborting. In that
case the performance test must be manually killed.</li>
  <li>Using Connext DDS Micro INTRA transport with <code class="language-plaintext highlighter-rouge">reliable</code> QoS and history kind set to <code class="language-plaintext highlighter-rouge">keep_all</code>
<a href="https://community.rti.com/static/documentation/connext-micro/3.0.3/doc/html/usersmanual/transports/INTRA.html#reliability-and-durability">is not supported with Connext
Micro</a>.
Set <code class="language-plaintext highlighter-rouge">keep-last</code> as QoS history kind always when using <code class="language-plaintext highlighter-rouge">reliable</code>.</li>
</ul>

<p>Possible additional communication which could be implemented are:</p>

<ul>
  <li>Raw UDP communication</li>
</ul>

<h2 id="building-with-limited-resources">Building with limited resources</h2>

<p>When building this tool, the compiler must perform a lot of template expansion. This can be
overwhelming for a system with a low-power CPU or limited RAM. There are some additional CMake
options which can reduce the system load during compilation:</p>

<ol>
  <li>This tool includes many different message types, each with many different sizes. Reduce the number of
messages, and thus the compilation load, by disabling one or more message types. For example, to build
without <code class="language-plaintext highlighter-rouge">PointCloud</code> messages, add <code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_POINDCLOUD=OFF</code> to the <code class="language-plaintext highlighter-rouge">--cmake-args</code>. The message types,
and their options for enabling/disabling, can be found <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/performance_test/msg/CMakeLists.txt">here</a>.</li>
</ol>
</div>
              </div>
            </div>
          </div>
        </div>
      
    
    <div class="row">
      <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-heading"><span class="glyphicon glyphicon-list"></span> CHANGELOG</div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="changelog-for-package-performance_test">Changelog for package performance_test</h1>

<h2 id="xyz-yyyymmdd">X.Y.Z (YYYY/MM/DD)</h2>

<h2 id="230-20240924">2.3.0 (2024/09/24)</h2>

<h3 id="removed">Removed</h3>
<ul>
  <li>Moved <code class="language-plaintext highlighter-rouge">apex_performance_plotter</code> to its own package <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/../plotter">here</a>
</li>
</ul>

<h2 id="220-20240515">2.2.0 (2024/05/15)</h2>

<h3 id="added">Added</h3>
<ul>
  <li>performance_test can be built with ROS 2 Iron and Jazzy
    <h3 id="changed">Changed</h3>
  </li>
  <li>Renamed the <code class="language-plaintext highlighter-rouge">--dds-domain_id</code> CLI arg to <code class="language-plaintext highlighter-rouge">--dds-domain-id</code>
</li>
  <li>When <code class="language-plaintext highlighter-rouge">--dds-domain-id</code> is unspecified, fall back to the <code class="language-plaintext highlighter-rouge">ROS_DOMAIN_ID</code> environment variable</li>
  <li>
<code class="language-plaintext highlighter-rouge">--zero-copy</code> has been separated into two flags:
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">--shared-memory</code>: Enable shared-memory transfer in the plugin. This is meant to replace the
need to manually set runtime flags via <code class="language-plaintext highlighter-rouge">CYCLONEDDS_URI</code>, <code class="language-plaintext highlighter-rouge">APEX_MIDDLEWARE_SETTINGS</code>, etc.</li>
      <li>
<code class="language-plaintext highlighter-rouge">--loaned-samples</code>: When publishing messages in the plugin, borrow loaned samples instead
of publishing by copy</li>
      <li>
<code class="language-plaintext highlighter-rouge">--zero-copy</code> is now an alias for <code class="language-plaintext highlighter-rouge">--shared-memory --loaned-samples</code>
</li>
      <li>Supported plugins include:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">-c CycloneDDS</code></li>
          <li><code class="language-plaintext highlighter-rouge">-c CycloneDDS-CXX</code></li>
          <li><code class="language-plaintext highlighter-rouge">-c ApexOSPollingSubscription</code></li>
          <li>
<code class="language-plaintext highlighter-rouge">-c rclcpp-*</code> with <code class="language-plaintext highlighter-rouge">RMW_IMPLEMENTATION=rmw_cyclonedds_cpp</code>
</li>
          <li>
<code class="language-plaintext highlighter-rouge">-c rclcpp-*</code> with <code class="language-plaintext highlighter-rouge">RMW_IMPLEMENTATION=rmw_fastrtps_cpp</code>
</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="210-20240417">2.1.0 (2024/04/17)</h2>

<h3 id="added-1">Added</h3>
<ul>
  <li>Add new function <code class="language-plaintext highlighter-rouge">prepare()</code> to the Publisher and Subscriber API, intended
to allow participant discovery without blocking the main thread
    <h3 id="changed-1">Changed</h3>
  </li>
  <li>Change the default <code class="language-plaintext highlighter-rouge">--history</code> arg from <code class="language-plaintext highlighter-rouge">KEEP_ALL</code> to <code class="language-plaintext highlighter-rouge">KEEP_LAST</code>
</li>
  <li>Change the default <code class="language-plaintext highlighter-rouge">--history-depth</code> arg from <code class="language-plaintext highlighter-rouge">1000</code> to <code class="language-plaintext highlighter-rouge">16</code>
</li>
  <li>If <code class="language-plaintext highlighter-rouge">--expected-num-pubs</code> is unspecified, set it to the same value as <code class="language-plaintext highlighter-rouge">-p</code>
</li>
  <li>If <code class="language-plaintext highlighter-rouge">--expected-num-subs</code> is unspecified, set it to the same value as <code class="language-plaintext highlighter-rouge">-s</code>
    <h3 id="fixed">Fixed</h3>
  </li>
  <li>Removed an unused variable to fix a Clang build</li>
  <li>Remove unused variable names in the <code class="language-plaintext highlighter-rouge">Plugin</code> abstract class</li>
  <li>Fix a potential lockup in PublisherTask on QNX</li>
</ul>

<h2 id="200-20240319">2.0.0 (2024/03/19)</h2>

<h3 id="added-2">Added</h3>
<ul>
  <li>Add experimental bazel support
    <ul>
      <li><code class="language-plaintext highlighter-rouge">bazel build //performance_test --//:plugin_implementation=//path/to/a/plugin</code></li>
    </ul>
  </li>
  <li>Add a rudimentary socket-based plugin for testing the bazel support
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">bazel run //performance_test --//:plugin_implementation=//performance_test/plugins/demo:demo_plugin -- --help</code>
        <h3 id="changed-2">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Instead of enabling/disabling each plugin, you select exactly one
with a CMake string option, for example:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">colcon build --cmake-args -DPERFORMANCE_TEST_PLUGIN=ROS2</code></li>
    </ul>
  </li>
  <li>Renamed the <code class="language-plaintext highlighter-rouge">--communication</code> CLI arg to <code class="language-plaintext highlighter-rouge">--communicator</code>. The short <code class="language-plaintext highlighter-rouge">-c</code> is unchanged.
    <h3 id="removed-1">Removed</h3>
  </li>
  <li>Removed the deprecated CLI flags for QOS settings:
    <ul>
      <li>Instead of <code class="language-plaintext highlighter-rouge">--reliable</code>, use <code class="language-plaintext highlighter-rouge">--reliability RELIABLE</code>
</li>
      <li>Instead of <code class="language-plaintext highlighter-rouge">--transient</code>, use <code class="language-plaintext highlighter-rouge">--durability TRANSIENT_LOCAL</code>
</li>
      <li>Instead of <code class="language-plaintext highlighter-rouge">--keep-last</code>, use <code class="language-plaintext highlighter-rouge">--history KEEP_LAST</code>
</li>
    </ul>
  </li>
  <li>Removed the obsolete <code class="language-plaintext highlighter-rouge">BoundedSequenceFlat</code> messages</li>
  <li>Removed the superfluous <code class="language-plaintext highlighter-rouge">--msg-list</code> CLI flag. The <code class="language-plaintext highlighter-rouge">--help</code> message
already lists the available messages.
    <h3 id="fixed-1">Fixed</h3>
  </li>
  <li>Update the Apex.OS Runner to use <code class="language-plaintext highlighter-rouge">executor_runner::deferred</code> instead of <code class="language-plaintext highlighter-rouge">executor_runner::deferred_tag()</code>
</li>
  <li>Ensure that the first few published samples are sent at the expected rate</li>
</ul>

<h2 id="152-yyyymmdd">1.5.2 (YYYY/MM/DD)</h2>

<h3 id="added-3">Added</h3>
<ul>
  <li>
<code class="language-plaintext highlighter-rouge">--prevent-cpu-idle</code> is available on QNX
    <h3 id="changed-3">Changed</h3>
  </li>
  <li>JSON log files will contain all values in the <code class="language-plaintext highlighter-rouge">APEX_PERFORMANCE_TEST</code> dictionary, instead of the
five specific values used previously</li>
  <li>Switch to build as C++17 by default
    <h3 id="fixed-2">Fixed</h3>
  </li>
  <li>Zero copy transfer is again enabled for the rclcpp publisher</li>
</ul>

<h2 id="150-20230614">1.5.0 (2023/06/14)</h2>

<h3 id="added-4">Added</h3>
<ul>
  <li>New CLI switch <code class="language-plaintext highlighter-rouge">--prevent-cpu-idle</code> (linux only). When specified,
perf_test will use <code class="language-plaintext highlighter-rouge">/dev/cpu_dma_latency</code> to request that the CPU not enter
any sleep states, to potentially give more consistent results</li>
  <li>Some smaller <code class="language-plaintext highlighter-rouge">Array</code> messages, down to 32 bits</li>
  <li>Added support to the FastDDS plugin for bounded and unbounded sequences
    <h3 id="changed-4">Changed</h3>
  </li>
  <li>Update the README to better explain how to use this tool with Apex.OS</li>
  <li>In the <code class="language-plaintext highlighter-rouge">Runner</code>, allocate the <code class="language-plaintext highlighter-rouge">AnalysisResult</code>s on the stack instead of using <code class="language-plaintext highlighter-rouge">shared_ptr</code>
</li>
  <li>
<code class="language-plaintext highlighter-rouge">Subscriber</code> methods accept a callback parameter, instead of returning a
<code class="language-plaintext highlighter-rouge">vector</code> of results, to reduce heap usage</li>
  <li>Refactored the interaction between <code class="language-plaintext highlighter-rouge">SubscriberStats</code> and <code class="language-plaintext highlighter-rouge">AnalysisResult</code> to
remove the need for a <code class="language-plaintext highlighter-rouge">std::vector</code> of latency samples, to reduce heap usage</li>
  <li>Adjusted the <code class="language-plaintext highlighter-rouge">Array</code> message sizes to make the name match the contents</li>
  <li>Updated <code class="language-plaintext highlighter-rouge">apex_os_communicator</code> to use the new zero-copy API</li>
</ul>

<h2 id="142-20230315">1.4.2 (2023/03/15)</h2>

<h3 id="added-5">Added</h3>
<ul>
  <li>Added <code class="language-plaintext highlighter-rouge">perfplot</code> support for JSON log files
    <h3 id="changed-5">Changed</h3>
  </li>
  <li>Migrate the Apex.OS target to use <code class="language-plaintext highlighter-rouge">rosidl_get_typesupport_target</code>
</li>
  <li>Preallocate the JSON logger’s string buffer to prevent reallocations after the experiment begins</li>
</ul>

<h2 id="141-20230223">1.4.1 (2023/02/23)</h2>

<h3 id="changed-6">Changed</h3>
<ul>
  <li>Updated the iceoryx plugin to the <a href="https://github.com/eclipse-iceoryx/iceoryx/tree/5fe215eab267b0ad68bc5552aecd4b6e728e4c99">latest master as of Feb 13</a>
</li>
</ul>

<h2 id="140-20230220">1.4.0 (2023/02/20)</h2>

<h3 id="added-6">Added</h3>
<ul>
  <li>New message type <code class="language-plaintext highlighter-rouge">BoundedSequenceFlat</code>
    <ul>
      <li>This is a <code class="language-plaintext highlighter-rouge">BoundedSequence</code> with the <code class="language-plaintext highlighter-rouge">@flat</code> annotation</li>
      <li>Sizes range from 1kB to 8MB, like <code class="language-plaintext highlighter-rouge">Array</code> and <code class="language-plaintext highlighter-rouge">BoundedSequence</code>
        <h3 id="changed-7">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Messages of different types can be optionally included via CMake args:
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_ARRAY</code> (default ON)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_STRUCT</code> (default ON)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_POINT_CLOUD</code> (default ON)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_BOUNDED_SEQUENCE</code> (default OFF)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_BOUNDED_SEQUENCE_FLAT</code> (default OFF)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_UNBOUNDED_SEQUENCE</code> (default OFF)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_ALL</code> (default OFF)
        <ul>
          <li>when ON, overrides the other defaults to ON</li>
          <li>you can still optionally exclude some messages by explicitly setting them to OFF
            <h3 id="removed-2">Removed</h3>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Removed a few messages:
    <ul>
      <li>Range</li>
      <li>RadarTrack</li>
      <li>RadarDetection</li>
      <li>NavSatFix
        <h3 id="fixed-3">Fixed</h3>
      </li>
    </ul>
  </li>
  <li>In all cases, including loaned messages, capture the timestamp as the last step of initializing the message</li>
</ul>

<h2 id="137-20230104">1.3.7 (2023/01/04)</h2>

<h2 id="136-20230103">1.3.6 (2023/01/03)</h2>

<h3 id="fixed-4">Fixed</h3>
<ul>
  <li>Set the correct <code class="language-plaintext highlighter-rouge">IDL_GEN_ROOT</code> for rclcpp plugins</li>
</ul>

<h2 id="135-20221205">1.3.5 (2022/12/05)</h2>

<h3 id="fixed-5">Fixed</h3>
<ul>
  <li>Exit cleanly when a publisher process terminates before a subscriber process</li>
</ul>

<h2 id="134-20221128">1.3.4 (2022/11/28)</h2>

<h3 id="changed-8">Changed</h3>
<ul>
  <li>Updated Apex.OS plugins to use the unified <code class="language-plaintext highlighter-rouge">LoanedSample::data()</code>
</li>
</ul>

<h2 id="133-20221128">1.3.3 (2022/11/28)</h2>

<h3 id="fixed-6">Fixed</h3>
<ul>
  <li>Implement the missing <code class="language-plaintext highlighter-rouge">take()</code> method in <code class="language-plaintext highlighter-rouge">ApexOSPollingSubscriptionSubscriber</code>
</li>
</ul>

<h2 id="132-20221121">1.3.2 (2022/11/21)</h2>

<h3 id="fixed-7">Fixed</h3>
<ul>
  <li>Capture the <code class="language-plaintext highlighter-rouge">this</code> pointer in the lambda in the iceoryx publisher</li>
</ul>

<h2 id="131-20221121">1.3.1 (2022/11/21)</h2>

<h3 id="added-7">Added</h3>
<ul>
  <li>New Apex.OS plugin, compatible with the <code class="language-plaintext highlighter-rouge">ThreadedRunner</code>s
    <ul>
      <li>The <code class="language-plaintext highlighter-rouge">INTER_THREAD</code> and <code class="language-plaintext highlighter-rouge">INTRA_THREAD</code> execution strategies, combined with
<code class="language-plaintext highlighter-rouge">-c ApexOSPollingSubscription</code>, will use the <code class="language-plaintext highlighter-rouge">ThreadedRunner</code> instances</li>
      <li>The new <code class="language-plaintext highlighter-rouge">APEX_SINGLE_EXECUTOR</code> execution strategy will add all publishers
and subscribers to a single Apex.OS Executor</li>
      <li>The new <code class="language-plaintext highlighter-rouge">APEX_EXECUTOR_PER_COMMUNICATOR</code> execution strategy will add each
publisher and each subscriber to its own Apex.OS Executor instance</li>
      <li>The new <code class="language-plaintext highlighter-rouge">APEX_CHAIN</code> execution strategy will add a publisher and subscriber
as a chain of nodes to an Apex.OS Executor
        <h3 id="changed-9">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Refactored FastRTPS communicator plugin:
    <ul>
      <li>Uses DDS compliant API</li>
      <li>Code generator updated</li>
      <li>Implementation for <code class="language-plaintext highlighter-rouge">publish_loaned()</code>
</li>
      <li>Dockerfile improvements
        <h3 id="removed-3">Removed</h3>
      </li>
    </ul>
  </li>
  <li>CLI arg <code class="language-plaintext highlighter-rouge">--disable-async</code>. Synchronous / asynchronous publishing should be
configured externally depending on the communication mean used.</li>
</ul>

<h2 id="130-20220825">1.3.0 (2022/08/25)</h2>

<h3 id="added-8">Added</h3>
<ul>
  <li>New execution strategy option:
    <ul>
      <li>The default <code class="language-plaintext highlighter-rouge">-e INTER_THREAD</code> runs each publisher and subscriber in its
own separate thread, which matches the previous behavior</li>
      <li>A new <code class="language-plaintext highlighter-rouge">-e INTRA_THREAD</code>, which runs a single publisher and subscriber in the
same thread. The publisher writes, and the subscriber immediately takes it</li>
      <li>For Apex.OS specifically, some optimized execution strategies which use the
proprietary Apex.OS executor
        <h3 id="changed-10">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Significantly refactored the communicator plugins:
    <ul>
      <li>Each plugin is split into an implementation of a <code class="language-plaintext highlighter-rouge">Publisher</code> and a
<code class="language-plaintext highlighter-rouge">Subscriber</code>, instead of a single <code class="language-plaintext highlighter-rouge">Communicator</code>
</li>
      <li>The plugin is no longer responsible for managing the metrics, such as
sample count, lost samples, and latency</li>
      <li>The plugin does not require any special logic to support roundtrip mode</li>
      <li>It is safe for the plugins to initialize their data writers and readers
at construction time, instead of delaying the initialization to the first
call of <code class="language-plaintext highlighter-rouge">publish()</code> or <code class="language-plaintext highlighter-rouge">update_subscription()</code>
</li>
      <li>Split <code class="language-plaintext highlighter-rouge">publish()</code> into <code class="language-plaintext highlighter-rouge">publish_copy()</code> and <code class="language-plaintext highlighter-rouge">publish_loaned()</code>
</li>
    </ul>
  </li>
  <li>Significantly refactored the runner framework:
    <ul>
      <li>The runner framework is responsible for the experiment metrics</li>
      <li>It manages the roundtrip mode logic</li>
      <li>It is extensible for different execution strategies or thread configurations</li>
    </ul>
  </li>
  <li>The iceoryx plugin now uses the untyped API, for improved performance</li>
</ul>

<h2 id="121-20220630">1.2.1 (2022/06/30)</h2>

<h3 id="fixed-8">Fixed</h3>
<ul>
  <li>Capture the timestamp as soon as a message is received, instead of just before
storing the metrics, to reduce the reported latency to a more correct value</li>
</ul>

<h2 id="120-20220628">1.2.0 (2022/06/28)</h2>

<h3 id="changed-11">Changed</h3>
<ul>
  <li>The CLI arguments for specifying the output type have changed:
    <ul>
      <li>For console output, updated every second, add <code class="language-plaintext highlighter-rouge">--print-to-console</code>
</li>
      <li>For file output, use <code class="language-plaintext highlighter-rouge">--logfile my_file.csv</code> or <code class="language-plaintext highlighter-rouge">--logfile my_file.json</code>
        <ul>
          <li>The type will be deduced from the file name</li>
        </ul>
      </li>
      <li>If neither of these options is specified, then a warning will print,
and the experiment will still run</li>
    </ul>
  </li>
  <li>The linter configurations are now configured locally. This means that the output
of <code class="language-plaintext highlighter-rouge">colcon test</code> should be the same no matter the installed ROS distribution.</li>
  <li>The <code class="language-plaintext highlighter-rouge">--zero-copy</code> arg is now valid even if the publisher and subscriber(s)
are in the same process
    <h3 id="removed-4">Removed</h3>
  </li>
  <li>The publisher and subscriber loop reserve metrics are no longer recorded or reported
    <h3 id="fixed-9">Fixed</h3>
  </li>
  <li>CPU usage will no longer be stuck at <code class="language-plaintext highlighter-rouge">0</code>
</li>
</ul>

<h3 id="removed-5">Removed</h3>
<ul>
  <li>The pub/sub loop reserve time metrics</li>
</ul>

<h2 id="112-20220608">1.1.2 (2022/06/08)</h2>

<h3 id="changed-12">Changed</h3>
<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">steady_clock</code> for all platforms, including QNX QOS</li>
</ul>

<h2 id="111-20220607">1.1.1 (2022/06/07)</h2>

<h3 id="changed-13">Changed</h3>
<ul>
  <li>Significant refactor to simplify the analysis pipeline
    <h3 id="fixed-10">Fixed</h3>
  </li>
  <li>Add some missing definitions when Apex.OS is enabled, but the rclcpp plugins are disabled</li>
</ul>

<h2 id="110-20220602">1.1.0 (2022/06/02)</h2>

<h3 id="added-9">Added</h3>
<ul>
  <li>New Apex.OS Polling Subscription plugin</li>
  <li>Compatibility with ROS 2 Humble</li>
</ul>

<h2 id="100-20220512">1.0.0 (2022/05/12)</h2>

<h3 id="added-10">Added</h3>
<ul>
  <li>More expressive perf_test CLI args for QOS settings</li>
  <li>A plugin for <a href="https://github.com/eclipse-cyclonedds/cyclonedds-cxx/tree/0.9.0b1">Cyclone DDS with C++ bindings v0.9.0b1</a>
    <h3 id="changed-14">Changed</h3>
  </li>
  <li>CLI args for QOS settings:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">--reliability &lt;RELIABLE|BEST_EFFORT&gt;</code></li>
      <li><code class="language-plaintext highlighter-rouge">--durability &lt;TRANSIENT_LOCAL|VOLATILE&gt;</code></li>
      <li><code class="language-plaintext highlighter-rouge">--history &lt;KEEP_LAST|KEEP_ALL&gt;</code></li>
    </ul>
  </li>
  <li>
<code class="language-plaintext highlighter-rouge">master</code> branch is compatible with many ROS 2 distributions:
    <ul>
      <li>dashing</li>
      <li>eloquent</li>
      <li>foxy</li>
      <li>galactic</li>
      <li>rolling
        <h3 id="deprecated">Deprecated</h3>
      </li>
    </ul>
  </li>
  <li>CLI flags for QOS settings:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">--reliable</code></li>
      <li><code class="language-plaintext highlighter-rouge">--transient</code></li>
      <li>
<code class="language-plaintext highlighter-rouge">--keep-last</code>
        <h3 id="removed-6">Removed</h3>
      </li>
    </ul>
  </li>
  <li>The branches for specific ROS 2 distributions have been deleted
    <h3 id="fixed-11">Fixed</h3>
  </li>
  <li>CI jobs and Dockerfiles are decoupled from the middleware bundled with the ROS 2 distribution</li>
</ul>
</div>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="jazzy-tutorials">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wiki Tutorials</h3>
      </div>
      <div class="panel-body">
        
        <em>This package does not provide any links to tutorials in it's <a href="https://index.ros.org/contribute/metadata/">rosindex metadata</a>.</em>
        <em>You can check on the <a href="http://wiki.ros.org/performance_test/Tutorials" target="_blank">ROS Wiki Tutorials</a> page for the package.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="jazzy-deps">
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Package Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th class="text-center">Deps</th>
                  <th style="width: 100%">Name</th>
                </thead>
                <tbody>
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rclcpp#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rclcpp#jazzy">rclcpp  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ros_environment#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ros_environment#jazzy">ros_environment  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake#jazzy">ament_cmake  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_generators#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_generators#jazzy">rosidl_default_generators  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rmw_implementation#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rmw_implementation#jazzy">rmw_implementation  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_runtime#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_runtime#jazzy">rosidl_default_runtime  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_gtest#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_gtest#jazzy">ament_cmake_gtest  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_auto#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_auto#jazzy">ament_lint_auto  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_common#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_common#jazzy">ament_lint_common  </a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
          <div class="panel-heading">
            <h3 class="panel-title">System Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                </thead>
                <tbody>
                  
                    
                      <tr>
                        <td><a href="/d/git">git</a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Dependant Packages</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                  <th class="text-center">Deps</th>
                </thead>
                <tbody>
                  
                    
                    
                    <tr>
                      <td><a href="/p/performance_report#jazzy">performance_report</a></td>
                      <td class="text-center">
                        
                        <a href="/p/performance_report#jazzy-deps" class="endoftree">
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="jazzy-assets">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Launch files</h3>
      </div>
      <div class="panel-body">
        
          <em>No launch files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Messages</h3>
      </div>
      <div class="panel-body">
        
          <em>No message files found.</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Services</h3>
      </div>
      <div class="panel-body">
        
          <em>No service files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Plugins</h3>
      </div>
      <div class="panel-body">
        
          <em>No plugins found.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="jazzy-questions">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent questions tagged <kbd>performance_test</kbd> at <strong><a href="https://robotics.stackexchange.com/" target="_blank">Robotics Stack Exchange</a></strong></h3>      </div>
      <div id="jazzy-question-list" class="panel-body" style="display: none;"></div>
      <div id="jazzy-no-question-list" class="panel-body" style="display: none;">
        <p>No questions yet, you can ask one <a href="https://robotics.stackexchange.com/questions/tagged/performance_test+jazzy">here</a>.</p>
      </div>
      <div id="jazzy-get-question-fail" class="panel-body alert alert-warning" style="display: none;">
        <p>Failed to get question list, you can ticket an issue <a href="https://github.com/ros-infrastructure/rosindex/issues/new" target="_blank" class="alert-link">here</a> </p>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/package_body_tabs.js"></script>

<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
jQuery(function() {
    // Update the count on the links to the contribution suggestions
    updateContributionSuggestionsCountOnPackage('https://gitlab.com/ApexAI/performance_test.git');
});
</script>

          </div>
          <div class="col-md-2 hidden-xs hidden-sm">
            
            
            



<div class="list-group list-group-sm ">
  <a class="list-group-item"
     target="_blank"
     href="http://docs.ros.org/en/jazzy/p/performance_test"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       
       API Docs
  </a>
  <a class="list-group-item"
     target="_blank"
     href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       
       Browse Code
  </a>
  
  
  
  
  
  
</div>

          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-kilted">
    <div class="container-fluid">
      
        
        
        

        <div class="row">
          <div class="col-md-10">
            

<div class="well well-sm">
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px" src="/assets/package.png">
      </td>
      <td>
        <h3 style="margin-top: 5px">
          <a style="text-decoration:none" href="/p/performance_test">performance_test</a> <small>package from <a style="text-decoration:none" href="/r/performance_test/gitlab-ApexAI-performance_test">performance_test</a> repo</small>
        </h3>
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_report">

performance_report
</a>
            
          
            
            
              <span class="label label-default pkg-label">

performance_test
</span>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_test_ros1_msgs">

performance_test_ros1_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_test_ros1_publisher">

performance_test_ros1_publisher
</a>
            
          
      </td>
    </tr>
  </table>
</div>

            <div class="visible-xs visible-sm">
              
              
              



<div class="list-group list-group-sm list-group-horizontal list-group-justified">
  <a class="list-group-item text-center"
     target="_blank"
     href="http://docs.ros.org/en/kilted/p/performance_test"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       <br>
       API Docs
  </a>
  <a class="list-group-item text-center"
     target="_blank"
     href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       <br>
       Browse Code
  </a>
  
  
  
  
  
  
</div>

            </div>
            



<ul class="nav nav-tabs nav-justified" id="kilted-tabs" style="margin-bottom:20px">
  <li class="better-tabs active">
    <a href="#kilted-overview" data-toggle="tab">Overview</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    
    <a href="#kilted-assets" data-toggle="tab"><span class="label label-default">0</span> Assets</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    <a href="#kilted-deps" data-toggle="tab"><span class="label label-primary">10</span> Dependencies</a>
  </li>
  <li class="better-tabs">
    
    <a href="#kilted-tutorials" data-toggle="tab"><span class="label label-default">0</span> Tutorials</a>
  </li>
  <li class="better-tabs">
    <a href="#kilted-questions" data-toggle="tab"><span id="kilted-questions-count" class="label label-primary">0</span> Q & A</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="kilted-overview">
    
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h4 class="panel-title">Package Summary</h4></div>
          <div class="panel-body">
            <table class="table table-condensed">
              <tr>
                <td style="width:100px;" class="text-right"><strong>Tags</strong></td>
                <td>
                  
                  
                    <em>No category tags.</em>
                  
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Version</strong></td>
                <td>2.3.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>License</strong></td>
                <td>Apache 2.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>Build type</strong></td>
                <td>
                  
                    <span class="label label-default">
                  
                    AMENT_CMAKE</span>
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Use</strong></td>
                <td>
                
                  <span class="label label-success">RECOMMENDED</span>
                
                </td>
              </tr>
            </table>
          </div>
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body">
            
            
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default"></span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://gitlab.com/ApexAI/performance_test.git">https://gitlab.com/ApexAI/performance_test.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">master</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-03-25
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="No CI information available for this package.">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/performance_test/#kilted-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/performance_test/#kilted-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/performance_test/#kilted-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Package Description</h3></div>
          <div class="panel-body">
            Tool to test performance of ROS 2 and DDS data layers and communication.
          </div>
          <div class="panel-heading"><h4 class="panel-title">Additional Links</h4></div>
          <div class="panel-body">
            
            
              <em>No additional links.</em>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Maintainers</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Apex.AI, Inc.</li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Authors</h4></div>
          <div class="panel-body">
            
            
              <em>No additional authors.</em>
            
          </div>
        </div>
      </div>
    </div>
    
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-heading"><span class="glyphicon glyphicon-file"></span><a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/README.md" title="Open in git repository">performance_test/README.md</a></div>
              <div class="panel-body">
                    <div class="rendered-markdown">
<h1 id="performance_test">performance_test</h1>

<p>[TOC]</p>

<p>The performance_test tool tests latency and other performance metrics of <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">various middleware
implementations</a> that support a pub/sub pattern. It is used to simulate
non-functional performance of your application.</p>

<p>The performance_test tool allows you to quickly set up a pub/sub configuration,
e.g. number of publisher/subscribers, message size, QOS settings, middleware. The following metrics
are automatically recorded when the application is running:</p>

<ul>
  <li>
<strong>latency</strong>: corresponds to the time a message takes to travel from a publisher to subscriber. The
latency is measured by timestamping the sample when it’s published and subtracting the timestamp
  (from the sample) from the measured time when the sample arrives at the subscriber (only logged when a subscriber is created)</li>
  <li>
<strong>CPU usage</strong>: percentage of the total system wide CPU usage (logged separately for each instance of <code class="language-plaintext highlighter-rouge">perf_test</code>)</li>
  <li>
<strong>resident memory</strong>: heap allocations, shared memory segments, stack (used for system’s internal
work) (logged separately for each instance of <code class="language-plaintext highlighter-rouge">perf_test</code>)</li>
  <li>
<strong>sample statistics</strong>: number of samples received, sent, and lost per experiment run.</li>
</ul>

<p>This <code class="language-plaintext highlighter-rouge">master</code> branch is compatible with the following ROS 2 versions</p>
<ul>
  <li>rolling</li>
  <li>jazzy</li>
  <li>iron</li>
  <li>humble</li>
  <li>galactic</li>
  <li>foxy</li>
  <li>eloquent</li>
  <li>dashing</li>
  <li>Apex.OS</li>
</ul>

<h2 id="how-to-use-this-document">How to use this document</h2>

<ol>
  <li>Start <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#example">here</a> for a quick example of building and running the performance_test tool
with the Cyclone DDS plugin.</li>
  <li>If needed, find more detailed information about <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#building-the-performance_test-tool">building</a>
and <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#running-an-experiment">running</a>
</li>
  <li>Or, if the quick example is good enough, skip ahead to the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">list of supported middleware
plugins</a> to learn how to test a specific middleware implementation.</li>
  <li>Check out the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#analyze-the-results">tools for visualizing the results</a>
</li>
  <li>If desired, read about the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#architecture">design and architecture</a> of the tool.</li>
</ol>

<h2 id="example">Example</h2>

<p>This example shows how to test the non-functional performance of the following configuration:</p>

<table>
  <thead>
    <tr>
      <th>Option</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Plugin</td>
      <td>Cyclone DDS</td>
    </tr>
    <tr>
      <td>Message type</td>
      <td>Array1k</td>
    </tr>
    <tr>
      <td>Publishing rate</td>
      <td>100Hz</td>
    </tr>
    <tr>
      <td>Topic name</td>
      <td>test_topic</td>
    </tr>
    <tr>
      <td>Duration of the experiment</td>
      <td>30s</td>
    </tr>
    <tr>
      <td>Number of publisher(s)</td>
      <td>1 (default)</td>
    </tr>
    <tr>
      <td>Number of subscriber(s)</td>
      <td>1 (default)</td>
    </tr>
  </tbody>
</table>

<ol>
  <li>
    <p>Install <a href="https://docs.ros.org/en/rolling/index.html">ROS 2</a></p>
  </li>
  <li>
    <p>Install <a href="https://github.com/eclipse-cyclonedds/cyclonedds">Cyclone DDS</a> to /opt/cyclonedds</p>
  </li>
  <li>
    <p>Build performance_test with the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#eclipse-cyclone-dds">CMake build flag</a> for Cyclone DDS:</p>
  </li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nb">source</span> /opt/ros/rolling/setup.bash
    <span class="nb">cd</span> ~/perf_test_ws
    colcon build <span class="nt">--cmake-args</span> <span class="nt">-DPERFORMANCE_TEST_PLUGIN</span><span class="o">=</span>CYCLONEDDS
    <span class="nb">source</span> ./install/setup.bash
    
</code></pre></div></div>

<ol>
  <li>Run with the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#eclipse-cyclone-dds">communication plugin option</a> for Cyclone DDS:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>experiment
./install/performance_test/lib/performance_test/perf_test <span class="nt">--communication</span> CycloneDDS
                                                          <span class="nt">--msg</span> Array1k
                                                          <span class="nt">--rate</span> 100
                                                          <span class="nt">--topic</span> test_topic
                                                          <span class="nt">--max-runtime</span> 30
                                                          <span class="nt">--logfile</span> experiment/log.csv

</code></pre></div></div>

<p>At the end of the experiment, a CSV log file will be generated in the experiment folder with a name
that starts with <code class="language-plaintext highlighter-rouge">log</code>.</p>

<h2 id="building-the-performance_test-tool">Building the performance_test tool</h2>

<p>For a simple example, see <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.rclcpp">Dockerfile.rclcpp</a>.</p>

<p>The performance_test tool is structured as a ROS 2 package, so <code class="language-plaintext highlighter-rouge">colcon</code> is used to build it.
Therefore, you must source a ROS 2 installation:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">source</span> /opt/ros/rolling/setup.bash

</code></pre></div></div>

<p>Select a middleware plugin from <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">this list</a>.
Then build the performance_test tool with the selected middleware:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> ~/perf_test_ws/src
<span class="nb">cd</span> ~/perf_test_ws/src
git clone https://gitlab.com/ApexAI/performance_test.git
<span class="nb">cd</span> ..
<span class="c"># At this stage, you need to choose which middleware you want to use</span>
<span class="c"># The list of available flags is described in the middleware plugins section</span>
<span class="c"># Square brackets denote optional arguments, like in the Python documentation.</span>
colcon build <span class="nt">--cmake-args</span> <span class="nt">-DCMAKE_BUILD_TYPE</span><span class="o">=</span>Release <span class="nt">-DPERFORMANCE_TEST_PLUGIN</span><span class="o">=</span>&lt;plugin&gt;
<span class="nb">source install</span>/setup.bash

</code></pre></div></div>

<h2 id="running-an-experiment">Running an experiment</h2>

<p>The performance_test experiments are run through the <code class="language-plaintext highlighter-rouge">perf_test</code> executable.
To find the available settings, run with <code class="language-plaintext highlighter-rouge">--help</code> (note the required and default arguments):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~/perf_test_ws<span class="nv">$ </span>./install/performance_test/lib/performance_test/perf_test <span class="nt">--help</span>

</code></pre></div></div>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">-c</code> argument should match the selected <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">middleware plugin</a>
from the build phase.</li>
  <li>The <code class="language-plaintext highlighter-rouge">--msg</code> argument should be one of the supported message types, which are shown
in the <code class="language-plaintext highlighter-rouge">--help</code> output.</li>
</ul>

<h3 id="single-machine-or-distributed-system">Single machine or distributed system?</h3>

<p>Based on the configuration you want to test, the usage of the performance_test tool differs. The
different possibilities are explained below.</p>

<p>For running tests on a single machine, you can choose between the following options:</p>

<ol>
  <li>Intraprocess means that the publisher and subscriber threads are in the same process.</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    perf_test &lt;options&gt; <span class="nt">--num-sub-threads</span> 1 <span class="nt">--num-pub-threads</span> 1
    
</code></pre></div></div>

<ol>
  <li>Interprocess means that the publisher and subscriber are in different processes. To test
interprocess communication, two instances of the performance_test must be run, e.g.</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c"># Start the subscriber first</span>
    perf_test &lt;options&gt; <span class="nt">--num-sub-threads</span> 1 <span class="nt">--num-pub-threads</span> 0 &amp;
    <span class="nb">sleep </span>1  <span class="c"># give the subscriber time to finish initializing</span>
    perf_test &lt;options&gt; <span class="nt">--num-sub-threads</span> 0 <span class="nt">--num-pub-threads</span> 1
    
</code></pre></div></div>

<p>On a distributed system, testing latency is difficult, because the clocks are probably not
perfectly synchronized between the two devices. To work around this, the performance_test tool
supports relay mode, which allows for a round-trip style of communication:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># On the main machine</span>
perf_test &lt;options&gt; <span class="nt">--roundtrip-mode</span> Main

<span class="c"># On the relay machine:</span>
perf_test &lt;options&gt; <span class="nt">--roundtrip-mode</span> Relay

</code></pre></div></div>

<p>In relay mode, the Main machine sends messages to the Relay machine, which immediately sends the
messages back. The Main machine receives the relayed message, and reports the round-trip latency.
Therefore, the reported latency will be roughly double the latency compared to the latency reported
in non-relay mode.</p>

<h3 id="single-machine-single-thread">Single machine, single thread</h3>

<p>An intra-thread configuration is experimentally supported, in which a publisher and subscriber
both operate in the same thread. The publisher writes a messages, and the subscriber immediately
takes it.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>perf_test &lt;options&gt; <span class="nt">-e</span> INTRA_THREAD

</code></pre></div></div>

<p>Notes:</p>

<ol>
  <li>This is only available when zero copy transfer is enabled</li>
  <li>This requires exactly one publisher and one subscriber</li>
  <li>This is not compatible with roundtrip mode</li>
</ol>

<h2 id="middleware-plugins">Middleware plugins</h2>

<p>The performance test tool can measure the performance of a variety of communication solutions
from different vendors. In this case there is no rclcpp or rmw layer overhead over the publisher
and subscriber routines.</p>

<p>The performance_test tool implements an executor that runs the publisher(s) and/or the subscriber(s) in
their own thread.</p>

<p>The following plugins are currently implemented:</p>

<h3 id="eclipse-cyclone-dds">Eclipse Cyclone DDS</h3>

<ul>
  <li><a href="https://github.com/eclipse-cyclonedds/cyclonedds/tree/0.9.0b1">Eclipse Cyclone DDS 0.9.0b1</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CYCLONEDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c CycloneDDS</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.CycloneDDS">Dockerfile.CycloneDDS</a>
</li>
  <li>Available transports:
    <ul>
      <li>Cyclone DDS zero copy requires
<a href="https://github.com/eclipse-iceoryx/iceoryx/blob/master/doc/website/getting-started/overview.md#roudi">RouDi</a>
to be running.
-
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP |</li>
    </ul>
  </li>
</ul>

<h3 id="eclipse-cyclone-dds-c-binding">Eclipse Cyclone DDS C++ binding</h3>

<ul>
  <li><a href="https://github.com/eclipse-cyclonedds/cyclonedds-cxx/tree/0.9.0b1">Eclipse Cyclone DDS C++ bindings 0.9.0b1</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CYCLONEDDS_CXX</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c CycloneDDS-CXX</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.CycloneDDS-CXX">Dockerfile.CycloneDDS-CXX</a>
</li>
  <li>Available transports:
    <ul>
      <li>Cyclone DDS zero copy requires the
<a href="https://github.com/eclipse-iceoryx/iceoryx/blob/master/doc/website/getting-started/overview.md#roudi">RouDi</a>
to be running.
-
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP |</li>
    </ul>
  </li>
</ul>

<h3 id="eclipse-iceoryx">Eclipse iceoryx</h3>

<ul>
  <li><a href="https://github.com/eclipse-iceoryx/iceoryx/tree/5fe215eab267b0ad68bc5552aecd4b6e728e4c99">iceoryx (latest master as of Feb 13)</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=ICEORYX</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c iceoryx</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.iceoryx">Dockerfile.iceoryx</a>
</li>
  <li>The iceoryx plugin is not a DDS implementation.
    <ul>
      <li>The DDS-specific options (such as domain ID, durability, and reliability) do not apply.</li>
    </ul>
  </li>
  <li>To run with the iceoryx plugin,
<a href="https://github.com/eclipse-iceoryx/iceoryx/blob/master/doc/website/getting-started/overview.md#roudi">RouDi</a>
must be running.</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|———–|———————|———————————–|
| LoanedSamples | LoanedSamples | Not supported by performance_test |</li>
</ul>

<h3 id="eprosima-fast-dds">eProsima Fast DDS</h3>

<ul>
  <li><a href="https://github.com/eProsima/Fast-DDS/tree/v2.6.2">FastDDS 2.6.2</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=FASTDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c FastRTPS</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.FastDDS">Dockerfile.FastDDS</a>
</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA (default), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | SHMEM (default), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP |</li>
</ul>

<h3 id="oci-opendds">OCI OpenDDS</h3>

<ul>
  <li><a href="https://github.com/objectcomputing/OpenDDS/tree/DDS-3.13.2">OpenDDS 3.13.2</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=OPENDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c OpenDDS</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.OpenDDS">Dockerfile.OpenDDS</a>
</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| TCP   | TCP                 | TCP                |</li>
</ul>

<h3 id="rti-connext-dds">RTI Connext DDS</h3>

<ul>
  <li><a href="https://www.rti.com/products/connext-dds-professional">RTI Connext DDS 5.3.1+</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CONNEXTDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c ConnextDDS</code>
</li>
  <li>Docker file: Not available</li>
  <li>A license is required</li>
  <li>You need to source an RTI Connext DDS environment.
    <ul>
      <li>If RTI Connext DDS was installed with ROS 2 (Linux only):
        <ul>
          <li><code class="language-plaintext highlighter-rouge">source /opt/rti.com/rti_connext_dds-5.3.1/setenv_ros2rti.bash</code></li>
        </ul>
      </li>
      <li>If RTI Connext DDS is installed separately, you can source the following script to set the
environment:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">source &lt;connextdds_install_path&gt;/resource/scripts/rtisetenv_&lt;arch&gt;.bash</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA | SHMEM               | UDP                |</li>
</ul>

<h3 id="rti-connext-dds-micro">RTI Connext DDS Micro</h3>

<ul>
  <li><a href="https://www.rti.com/products/connext-dds-micro">Connext DDS Micro 3.0.3</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CONNEXTDDSMICRO</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c ConnextDDSMicro</code>
</li>
  <li>Docker file: Not available</li>
  <li>A license is required</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA | SHMEM               | UDP                |</li>
</ul>

<h2 id="framework-plugins">Framework plugins</h2>

<p>The performance_test tool can also measure the end-to-end latency of a framework. In this case, the
executor of the framework is used to run the publisher(s) and/or the subscriber(s). The potential overhead of the <a href="http://docs.ros2.org/beta2/developer_overview.html#internal-api-architecture-overview">rclcpp or rmw
layer</a> is measured.</p>

<h3 id="ros-2">ROS 2</h3>

<p>The performance test tool can also measure the performance of a variety of RMW implementations,
through the ROS 2 <code class="language-plaintext highlighter-rouge">rclcpp::publisher</code> and <code class="language-plaintext highlighter-rouge">rclcpp::subscriber</code> API.</p>

<ul>
  <li><a href="https://docs.ros.org/en/rolling/Tutorials/Writing-A-Simple-Cpp-Publisher-And-Subscriber.html">ROS 2 <code class="language-plaintext highlighter-rouge">rclcpp::publisher</code> and <code class="language-plaintext highlighter-rouge">rclcpp::subscriber</code></a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=ROS2</code> (default)</li>
  <li>Communication plugin:
    <ul>
      <li>Callback with Single Threaded Executor: <code class="language-plaintext highlighter-rouge">-c rclcpp-single-threaded-executor</code>
</li>
      <li>Callback with Static Single Threaded Executor: <code class="language-plaintext highlighter-rouge">-c rclcpp-static-single-threaded-executor</code>
</li>
      <li>
<a href="https://github.com/ros2/rclcpp/pull/1047"><code class="language-plaintext highlighter-rouge">rclcpp::WaitSet</code></a>: <code class="language-plaintext highlighter-rouge">-c rclcpp-waitset</code>
</li>
    </ul>
  </li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.rclcpp">Dockerfile.rclcpp</a>
</li>
  <li>
<a href="https://docs.ros.org/en/rolling/Concepts/About-Different-Middleware-Vendors.html">Available underlying RMW implementations</a>:
    <ul>
      <li>ROS 2 Rolling is pre-configured to use <code class="language-plaintext highlighter-rouge">rmw_fastrtps_cpp</code>
</li>
      <li>Follow <a href="https://docs.ros.org/en/rolling/Guides/Working-with-multiple-RMW-implementations.html">these instructions</a>
  to use a different RMW implementation</li>
    </ul>
  </li>
  <li>Available transports: depends on underlying RMW implementation
    <ul>
      <li>LoanedSamples are available (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) for <code class="language-plaintext highlighter-rouge">ROS_DISTRO = foxy</code> and above</li>
    </ul>
  </li>
</ul>

<h3 id="apexos">Apex.OS</h3>

<ul>
  <li>Apex.OS</li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=APEX_OS</code>
    <ul>
      <li>It is also required to <code class="language-plaintext highlighter-rouge">source /opt/ApexOS/setup.bash</code> instead of a ROS 2 distribution</li>
    </ul>
  </li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c ApexOSPollingSubscription</code>
</li>
  <li>Docker file: Not available</li>
  <li>Available underlying RMW implementations: <code class="language-plaintext highlighter-rouge">rmw_apex_middleware</code>
</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero_copy</code>) | UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero_copy</code>) | UDP |</li>
</ul>

<h2 id="analyze-the-results">Analyze the results</h2>

<p>After an experiment is run with the <code class="language-plaintext highlighter-rouge">-l</code> flag, a log file is recorded. Both CSV
and JSON formats are supported. It is possible to add custom data to the log
file by setting the<code class="language-plaintext highlighter-rouge">APEX_PERFORMANCE_TEST</code> environment variable before running
an experiment, e.g.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">#</span><span class="w"> </span><span class="err">JSON</span><span class="w"> </span><span class="err">format</span><span class="w">
</span><span class="err">export</span><span class="w"> </span><span class="err">APEX_PERFORMANCE_TEST=</span><span class="s2">"
{
</span><span class="se">\"</span><span class="s2">My Version</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">1.0.4</span><span class="se">\"</span><span class="s2">,
</span><span class="se">\"</span><span class="s2">My Image Version</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">5.2</span><span class="se">\"</span><span class="s2">,
</span><span class="se">\"</span><span class="s2">My OS Version</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">Ubuntu 16.04</span><span class="se">\"</span><span class="s2">
}
"</span><span class="w">

</span></code></pre></div></div>

<h2 id="plot-the-results">Plot the results</h2>

<p>To plot the results in the JSON or CSV log files, see the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/../plotter">plotter README</a>.</p>

<h2 id="architecture">Architecture</h2>

<p>Apex.AI’s <em>Performance Testing in ROS 2</em> white paper
(<a href="https://drive.google.com/file/d/15nX80RK6aS8abZvQAOnMNUEgh7px9V5S/view">available here</a>)
describes how to design a fair and unbiased performance test, and is the basis for this project.</p>
<center><img src="https://gitlab.com/ApexAI/performance_test/-/raw/master/performance_test/architecture.png"></center>

<p>Each middleware has a different API. Thanks to the <code class="language-plaintext highlighter-rouge">Plugin</code> abstraction, the core logic of
setting up and running an experiment is completely decoupled from the implementation details
of sending and receiving individual messages.</p>

<p>Exactly one <code class="language-plaintext highlighter-rouge">Plugin</code> implementation is selected at build time. The design is similar to the
<a href="https://refactoring.guru/design-patterns/abstract-factory">Abstract Factory pattern</a>.
<code class="language-plaintext highlighter-rouge">performance_test</code> declares, but does not define, a static factory method in the <code class="language-plaintext highlighter-rouge">PluginFactory</code>
class. Each middleware provides a definition for this factory method to create a concrete <code class="language-plaintext highlighter-rouge">Plugin</code>
implementation, and <code class="language-plaintext highlighter-rouge">perf_test</code> calls this factory method directly.</p>

<p>An example plugin is available <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/plugins/demo">here</a>.</p>

<h2 id="performance-optimizations">Performance optimizations</h2>

<ul>
  <li>On linux-based platforms, <code class="language-plaintext highlighter-rouge">perf_test</code> writes <code class="language-plaintext highlighter-rouge">0</code> to <code class="language-plaintext highlighter-rouge">/dev/cpu_dma_latency</code>
and holds open the file handle, which will prevent the CPU from entering any
idle states for the duration of the experiment. This should result in lower
message latency and lower variance in that latency.</li>
</ul>

<h2 id="future-extensions-and-limitations">Future extensions and limitations</h2>

<ul>
  <li>Communication frameworks like DDS have a huge amount of settings. This tool only allows the most
common QOS settings to be configured. The other QOS settings are hardcoded in the application.</li>
  <li>Only one publisher per topic is allowed, because the data verification logic does not support
matching data to the different publishers.</li>
  <li>Some communication plugins can get stuck in their internal loops if too much data is received.
Figuring out ways around such issues is one of the goals of this tool.</li>
  <li>FastRTPS wait-set does not support timeouts which can lead to the receiving not aborting. In that
case the performance test must be manually killed.</li>
  <li>Using Connext DDS Micro INTRA transport with <code class="language-plaintext highlighter-rouge">reliable</code> QoS and history kind set to <code class="language-plaintext highlighter-rouge">keep_all</code>
<a href="https://community.rti.com/static/documentation/connext-micro/3.0.3/doc/html/usersmanual/transports/INTRA.html#reliability-and-durability">is not supported with Connext
Micro</a>.
Set <code class="language-plaintext highlighter-rouge">keep-last</code> as QoS history kind always when using <code class="language-plaintext highlighter-rouge">reliable</code>.</li>
</ul>

<p>Possible additional communication which could be implemented are:</p>

<ul>
  <li>Raw UDP communication</li>
</ul>

<h2 id="building-with-limited-resources">Building with limited resources</h2>

<p>When building this tool, the compiler must perform a lot of template expansion. This can be
overwhelming for a system with a low-power CPU or limited RAM. There are some additional CMake
options which can reduce the system load during compilation:</p>

<ol>
  <li>This tool includes many different message types, each with many different sizes. Reduce the number of
messages, and thus the compilation load, by disabling one or more message types. For example, to build
without <code class="language-plaintext highlighter-rouge">PointCloud</code> messages, add <code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_POINDCLOUD=OFF</code> to the <code class="language-plaintext highlighter-rouge">--cmake-args</code>. The message types,
and their options for enabling/disabling, can be found <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/performance_test/msg/CMakeLists.txt">here</a>.</li>
</ol>
</div>
              </div>
            </div>
          </div>
        </div>
      
    
    <div class="row">
      <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-heading"><span class="glyphicon glyphicon-list"></span> CHANGELOG</div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="changelog-for-package-performance_test">Changelog for package performance_test</h1>

<h2 id="xyz-yyyymmdd">X.Y.Z (YYYY/MM/DD)</h2>

<h2 id="230-20240924">2.3.0 (2024/09/24)</h2>

<h3 id="removed">Removed</h3>
<ul>
  <li>Moved <code class="language-plaintext highlighter-rouge">apex_performance_plotter</code> to its own package <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/../plotter">here</a>
</li>
</ul>

<h2 id="220-20240515">2.2.0 (2024/05/15)</h2>

<h3 id="added">Added</h3>
<ul>
  <li>performance_test can be built with ROS 2 Iron and Jazzy
    <h3 id="changed">Changed</h3>
  </li>
  <li>Renamed the <code class="language-plaintext highlighter-rouge">--dds-domain_id</code> CLI arg to <code class="language-plaintext highlighter-rouge">--dds-domain-id</code>
</li>
  <li>When <code class="language-plaintext highlighter-rouge">--dds-domain-id</code> is unspecified, fall back to the <code class="language-plaintext highlighter-rouge">ROS_DOMAIN_ID</code> environment variable</li>
  <li>
<code class="language-plaintext highlighter-rouge">--zero-copy</code> has been separated into two flags:
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">--shared-memory</code>: Enable shared-memory transfer in the plugin. This is meant to replace the
need to manually set runtime flags via <code class="language-plaintext highlighter-rouge">CYCLONEDDS_URI</code>, <code class="language-plaintext highlighter-rouge">APEX_MIDDLEWARE_SETTINGS</code>, etc.</li>
      <li>
<code class="language-plaintext highlighter-rouge">--loaned-samples</code>: When publishing messages in the plugin, borrow loaned samples instead
of publishing by copy</li>
      <li>
<code class="language-plaintext highlighter-rouge">--zero-copy</code> is now an alias for <code class="language-plaintext highlighter-rouge">--shared-memory --loaned-samples</code>
</li>
      <li>Supported plugins include:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">-c CycloneDDS</code></li>
          <li><code class="language-plaintext highlighter-rouge">-c CycloneDDS-CXX</code></li>
          <li><code class="language-plaintext highlighter-rouge">-c ApexOSPollingSubscription</code></li>
          <li>
<code class="language-plaintext highlighter-rouge">-c rclcpp-*</code> with <code class="language-plaintext highlighter-rouge">RMW_IMPLEMENTATION=rmw_cyclonedds_cpp</code>
</li>
          <li>
<code class="language-plaintext highlighter-rouge">-c rclcpp-*</code> with <code class="language-plaintext highlighter-rouge">RMW_IMPLEMENTATION=rmw_fastrtps_cpp</code>
</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="210-20240417">2.1.0 (2024/04/17)</h2>

<h3 id="added-1">Added</h3>
<ul>
  <li>Add new function <code class="language-plaintext highlighter-rouge">prepare()</code> to the Publisher and Subscriber API, intended
to allow participant discovery without blocking the main thread
    <h3 id="changed-1">Changed</h3>
  </li>
  <li>Change the default <code class="language-plaintext highlighter-rouge">--history</code> arg from <code class="language-plaintext highlighter-rouge">KEEP_ALL</code> to <code class="language-plaintext highlighter-rouge">KEEP_LAST</code>
</li>
  <li>Change the default <code class="language-plaintext highlighter-rouge">--history-depth</code> arg from <code class="language-plaintext highlighter-rouge">1000</code> to <code class="language-plaintext highlighter-rouge">16</code>
</li>
  <li>If <code class="language-plaintext highlighter-rouge">--expected-num-pubs</code> is unspecified, set it to the same value as <code class="language-plaintext highlighter-rouge">-p</code>
</li>
  <li>If <code class="language-plaintext highlighter-rouge">--expected-num-subs</code> is unspecified, set it to the same value as <code class="language-plaintext highlighter-rouge">-s</code>
    <h3 id="fixed">Fixed</h3>
  </li>
  <li>Removed an unused variable to fix a Clang build</li>
  <li>Remove unused variable names in the <code class="language-plaintext highlighter-rouge">Plugin</code> abstract class</li>
  <li>Fix a potential lockup in PublisherTask on QNX</li>
</ul>

<h2 id="200-20240319">2.0.0 (2024/03/19)</h2>

<h3 id="added-2">Added</h3>
<ul>
  <li>Add experimental bazel support
    <ul>
      <li><code class="language-plaintext highlighter-rouge">bazel build //performance_test --//:plugin_implementation=//path/to/a/plugin</code></li>
    </ul>
  </li>
  <li>Add a rudimentary socket-based plugin for testing the bazel support
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">bazel run //performance_test --//:plugin_implementation=//performance_test/plugins/demo:demo_plugin -- --help</code>
        <h3 id="changed-2">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Instead of enabling/disabling each plugin, you select exactly one
with a CMake string option, for example:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">colcon build --cmake-args -DPERFORMANCE_TEST_PLUGIN=ROS2</code></li>
    </ul>
  </li>
  <li>Renamed the <code class="language-plaintext highlighter-rouge">--communication</code> CLI arg to <code class="language-plaintext highlighter-rouge">--communicator</code>. The short <code class="language-plaintext highlighter-rouge">-c</code> is unchanged.
    <h3 id="removed-1">Removed</h3>
  </li>
  <li>Removed the deprecated CLI flags for QOS settings:
    <ul>
      <li>Instead of <code class="language-plaintext highlighter-rouge">--reliable</code>, use <code class="language-plaintext highlighter-rouge">--reliability RELIABLE</code>
</li>
      <li>Instead of <code class="language-plaintext highlighter-rouge">--transient</code>, use <code class="language-plaintext highlighter-rouge">--durability TRANSIENT_LOCAL</code>
</li>
      <li>Instead of <code class="language-plaintext highlighter-rouge">--keep-last</code>, use <code class="language-plaintext highlighter-rouge">--history KEEP_LAST</code>
</li>
    </ul>
  </li>
  <li>Removed the obsolete <code class="language-plaintext highlighter-rouge">BoundedSequenceFlat</code> messages</li>
  <li>Removed the superfluous <code class="language-plaintext highlighter-rouge">--msg-list</code> CLI flag. The <code class="language-plaintext highlighter-rouge">--help</code> message
already lists the available messages.
    <h3 id="fixed-1">Fixed</h3>
  </li>
  <li>Update the Apex.OS Runner to use <code class="language-plaintext highlighter-rouge">executor_runner::deferred</code> instead of <code class="language-plaintext highlighter-rouge">executor_runner::deferred_tag()</code>
</li>
  <li>Ensure that the first few published samples are sent at the expected rate</li>
</ul>

<h2 id="152-yyyymmdd">1.5.2 (YYYY/MM/DD)</h2>

<h3 id="added-3">Added</h3>
<ul>
  <li>
<code class="language-plaintext highlighter-rouge">--prevent-cpu-idle</code> is available on QNX
    <h3 id="changed-3">Changed</h3>
  </li>
  <li>JSON log files will contain all values in the <code class="language-plaintext highlighter-rouge">APEX_PERFORMANCE_TEST</code> dictionary, instead of the
five specific values used previously</li>
  <li>Switch to build as C++17 by default
    <h3 id="fixed-2">Fixed</h3>
  </li>
  <li>Zero copy transfer is again enabled for the rclcpp publisher</li>
</ul>

<h2 id="150-20230614">1.5.0 (2023/06/14)</h2>

<h3 id="added-4">Added</h3>
<ul>
  <li>New CLI switch <code class="language-plaintext highlighter-rouge">--prevent-cpu-idle</code> (linux only). When specified,
perf_test will use <code class="language-plaintext highlighter-rouge">/dev/cpu_dma_latency</code> to request that the CPU not enter
any sleep states, to potentially give more consistent results</li>
  <li>Some smaller <code class="language-plaintext highlighter-rouge">Array</code> messages, down to 32 bits</li>
  <li>Added support to the FastDDS plugin for bounded and unbounded sequences
    <h3 id="changed-4">Changed</h3>
  </li>
  <li>Update the README to better explain how to use this tool with Apex.OS</li>
  <li>In the <code class="language-plaintext highlighter-rouge">Runner</code>, allocate the <code class="language-plaintext highlighter-rouge">AnalysisResult</code>s on the stack instead of using <code class="language-plaintext highlighter-rouge">shared_ptr</code>
</li>
  <li>
<code class="language-plaintext highlighter-rouge">Subscriber</code> methods accept a callback parameter, instead of returning a
<code class="language-plaintext highlighter-rouge">vector</code> of results, to reduce heap usage</li>
  <li>Refactored the interaction between <code class="language-plaintext highlighter-rouge">SubscriberStats</code> and <code class="language-plaintext highlighter-rouge">AnalysisResult</code> to
remove the need for a <code class="language-plaintext highlighter-rouge">std::vector</code> of latency samples, to reduce heap usage</li>
  <li>Adjusted the <code class="language-plaintext highlighter-rouge">Array</code> message sizes to make the name match the contents</li>
  <li>Updated <code class="language-plaintext highlighter-rouge">apex_os_communicator</code> to use the new zero-copy API</li>
</ul>

<h2 id="142-20230315">1.4.2 (2023/03/15)</h2>

<h3 id="added-5">Added</h3>
<ul>
  <li>Added <code class="language-plaintext highlighter-rouge">perfplot</code> support for JSON log files
    <h3 id="changed-5">Changed</h3>
  </li>
  <li>Migrate the Apex.OS target to use <code class="language-plaintext highlighter-rouge">rosidl_get_typesupport_target</code>
</li>
  <li>Preallocate the JSON logger’s string buffer to prevent reallocations after the experiment begins</li>
</ul>

<h2 id="141-20230223">1.4.1 (2023/02/23)</h2>

<h3 id="changed-6">Changed</h3>
<ul>
  <li>Updated the iceoryx plugin to the <a href="https://github.com/eclipse-iceoryx/iceoryx/tree/5fe215eab267b0ad68bc5552aecd4b6e728e4c99">latest master as of Feb 13</a>
</li>
</ul>

<h2 id="140-20230220">1.4.0 (2023/02/20)</h2>

<h3 id="added-6">Added</h3>
<ul>
  <li>New message type <code class="language-plaintext highlighter-rouge">BoundedSequenceFlat</code>
    <ul>
      <li>This is a <code class="language-plaintext highlighter-rouge">BoundedSequence</code> with the <code class="language-plaintext highlighter-rouge">@flat</code> annotation</li>
      <li>Sizes range from 1kB to 8MB, like <code class="language-plaintext highlighter-rouge">Array</code> and <code class="language-plaintext highlighter-rouge">BoundedSequence</code>
        <h3 id="changed-7">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Messages of different types can be optionally included via CMake args:
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_ARRAY</code> (default ON)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_STRUCT</code> (default ON)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_POINT_CLOUD</code> (default ON)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_BOUNDED_SEQUENCE</code> (default OFF)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_BOUNDED_SEQUENCE_FLAT</code> (default OFF)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_UNBOUNDED_SEQUENCE</code> (default OFF)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_ALL</code> (default OFF)
        <ul>
          <li>when ON, overrides the other defaults to ON</li>
          <li>you can still optionally exclude some messages by explicitly setting them to OFF
            <h3 id="removed-2">Removed</h3>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Removed a few messages:
    <ul>
      <li>Range</li>
      <li>RadarTrack</li>
      <li>RadarDetection</li>
      <li>NavSatFix
        <h3 id="fixed-3">Fixed</h3>
      </li>
    </ul>
  </li>
  <li>In all cases, including loaned messages, capture the timestamp as the last step of initializing the message</li>
</ul>

<h2 id="137-20230104">1.3.7 (2023/01/04)</h2>

<h2 id="136-20230103">1.3.6 (2023/01/03)</h2>

<h3 id="fixed-4">Fixed</h3>
<ul>
  <li>Set the correct <code class="language-plaintext highlighter-rouge">IDL_GEN_ROOT</code> for rclcpp plugins</li>
</ul>

<h2 id="135-20221205">1.3.5 (2022/12/05)</h2>

<h3 id="fixed-5">Fixed</h3>
<ul>
  <li>Exit cleanly when a publisher process terminates before a subscriber process</li>
</ul>

<h2 id="134-20221128">1.3.4 (2022/11/28)</h2>

<h3 id="changed-8">Changed</h3>
<ul>
  <li>Updated Apex.OS plugins to use the unified <code class="language-plaintext highlighter-rouge">LoanedSample::data()</code>
</li>
</ul>

<h2 id="133-20221128">1.3.3 (2022/11/28)</h2>

<h3 id="fixed-6">Fixed</h3>
<ul>
  <li>Implement the missing <code class="language-plaintext highlighter-rouge">take()</code> method in <code class="language-plaintext highlighter-rouge">ApexOSPollingSubscriptionSubscriber</code>
</li>
</ul>

<h2 id="132-20221121">1.3.2 (2022/11/21)</h2>

<h3 id="fixed-7">Fixed</h3>
<ul>
  <li>Capture the <code class="language-plaintext highlighter-rouge">this</code> pointer in the lambda in the iceoryx publisher</li>
</ul>

<h2 id="131-20221121">1.3.1 (2022/11/21)</h2>

<h3 id="added-7">Added</h3>
<ul>
  <li>New Apex.OS plugin, compatible with the <code class="language-plaintext highlighter-rouge">ThreadedRunner</code>s
    <ul>
      <li>The <code class="language-plaintext highlighter-rouge">INTER_THREAD</code> and <code class="language-plaintext highlighter-rouge">INTRA_THREAD</code> execution strategies, combined with
<code class="language-plaintext highlighter-rouge">-c ApexOSPollingSubscription</code>, will use the <code class="language-plaintext highlighter-rouge">ThreadedRunner</code> instances</li>
      <li>The new <code class="language-plaintext highlighter-rouge">APEX_SINGLE_EXECUTOR</code> execution strategy will add all publishers
and subscribers to a single Apex.OS Executor</li>
      <li>The new <code class="language-plaintext highlighter-rouge">APEX_EXECUTOR_PER_COMMUNICATOR</code> execution strategy will add each
publisher and each subscriber to its own Apex.OS Executor instance</li>
      <li>The new <code class="language-plaintext highlighter-rouge">APEX_CHAIN</code> execution strategy will add a publisher and subscriber
as a chain of nodes to an Apex.OS Executor
        <h3 id="changed-9">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Refactored FastRTPS communicator plugin:
    <ul>
      <li>Uses DDS compliant API</li>
      <li>Code generator updated</li>
      <li>Implementation for <code class="language-plaintext highlighter-rouge">publish_loaned()</code>
</li>
      <li>Dockerfile improvements
        <h3 id="removed-3">Removed</h3>
      </li>
    </ul>
  </li>
  <li>CLI arg <code class="language-plaintext highlighter-rouge">--disable-async</code>. Synchronous / asynchronous publishing should be
configured externally depending on the communication mean used.</li>
</ul>

<h2 id="130-20220825">1.3.0 (2022/08/25)</h2>

<h3 id="added-8">Added</h3>
<ul>
  <li>New execution strategy option:
    <ul>
      <li>The default <code class="language-plaintext highlighter-rouge">-e INTER_THREAD</code> runs each publisher and subscriber in its
own separate thread, which matches the previous behavior</li>
      <li>A new <code class="language-plaintext highlighter-rouge">-e INTRA_THREAD</code>, which runs a single publisher and subscriber in the
same thread. The publisher writes, and the subscriber immediately takes it</li>
      <li>For Apex.OS specifically, some optimized execution strategies which use the
proprietary Apex.OS executor
        <h3 id="changed-10">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Significantly refactored the communicator plugins:
    <ul>
      <li>Each plugin is split into an implementation of a <code class="language-plaintext highlighter-rouge">Publisher</code> and a
<code class="language-plaintext highlighter-rouge">Subscriber</code>, instead of a single <code class="language-plaintext highlighter-rouge">Communicator</code>
</li>
      <li>The plugin is no longer responsible for managing the metrics, such as
sample count, lost samples, and latency</li>
      <li>The plugin does not require any special logic to support roundtrip mode</li>
      <li>It is safe for the plugins to initialize their data writers and readers
at construction time, instead of delaying the initialization to the first
call of <code class="language-plaintext highlighter-rouge">publish()</code> or <code class="language-plaintext highlighter-rouge">update_subscription()</code>
</li>
      <li>Split <code class="language-plaintext highlighter-rouge">publish()</code> into <code class="language-plaintext highlighter-rouge">publish_copy()</code> and <code class="language-plaintext highlighter-rouge">publish_loaned()</code>
</li>
    </ul>
  </li>
  <li>Significantly refactored the runner framework:
    <ul>
      <li>The runner framework is responsible for the experiment metrics</li>
      <li>It manages the roundtrip mode logic</li>
      <li>It is extensible for different execution strategies or thread configurations</li>
    </ul>
  </li>
  <li>The iceoryx plugin now uses the untyped API, for improved performance</li>
</ul>

<h2 id="121-20220630">1.2.1 (2022/06/30)</h2>

<h3 id="fixed-8">Fixed</h3>
<ul>
  <li>Capture the timestamp as soon as a message is received, instead of just before
storing the metrics, to reduce the reported latency to a more correct value</li>
</ul>

<h2 id="120-20220628">1.2.0 (2022/06/28)</h2>

<h3 id="changed-11">Changed</h3>
<ul>
  <li>The CLI arguments for specifying the output type have changed:
    <ul>
      <li>For console output, updated every second, add <code class="language-plaintext highlighter-rouge">--print-to-console</code>
</li>
      <li>For file output, use <code class="language-plaintext highlighter-rouge">--logfile my_file.csv</code> or <code class="language-plaintext highlighter-rouge">--logfile my_file.json</code>
        <ul>
          <li>The type will be deduced from the file name</li>
        </ul>
      </li>
      <li>If neither of these options is specified, then a warning will print,
and the experiment will still run</li>
    </ul>
  </li>
  <li>The linter configurations are now configured locally. This means that the output
of <code class="language-plaintext highlighter-rouge">colcon test</code> should be the same no matter the installed ROS distribution.</li>
  <li>The <code class="language-plaintext highlighter-rouge">--zero-copy</code> arg is now valid even if the publisher and subscriber(s)
are in the same process
    <h3 id="removed-4">Removed</h3>
  </li>
  <li>The publisher and subscriber loop reserve metrics are no longer recorded or reported
    <h3 id="fixed-9">Fixed</h3>
  </li>
  <li>CPU usage will no longer be stuck at <code class="language-plaintext highlighter-rouge">0</code>
</li>
</ul>

<h3 id="removed-5">Removed</h3>
<ul>
  <li>The pub/sub loop reserve time metrics</li>
</ul>

<h2 id="112-20220608">1.1.2 (2022/06/08)</h2>

<h3 id="changed-12">Changed</h3>
<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">steady_clock</code> for all platforms, including QNX QOS</li>
</ul>

<h2 id="111-20220607">1.1.1 (2022/06/07)</h2>

<h3 id="changed-13">Changed</h3>
<ul>
  <li>Significant refactor to simplify the analysis pipeline
    <h3 id="fixed-10">Fixed</h3>
  </li>
  <li>Add some missing definitions when Apex.OS is enabled, but the rclcpp plugins are disabled</li>
</ul>

<h2 id="110-20220602">1.1.0 (2022/06/02)</h2>

<h3 id="added-9">Added</h3>
<ul>
  <li>New Apex.OS Polling Subscription plugin</li>
  <li>Compatibility with ROS 2 Humble</li>
</ul>

<h2 id="100-20220512">1.0.0 (2022/05/12)</h2>

<h3 id="added-10">Added</h3>
<ul>
  <li>More expressive perf_test CLI args for QOS settings</li>
  <li>A plugin for <a href="https://github.com/eclipse-cyclonedds/cyclonedds-cxx/tree/0.9.0b1">Cyclone DDS with C++ bindings v0.9.0b1</a>
    <h3 id="changed-14">Changed</h3>
  </li>
  <li>CLI args for QOS settings:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">--reliability &lt;RELIABLE|BEST_EFFORT&gt;</code></li>
      <li><code class="language-plaintext highlighter-rouge">--durability &lt;TRANSIENT_LOCAL|VOLATILE&gt;</code></li>
      <li><code class="language-plaintext highlighter-rouge">--history &lt;KEEP_LAST|KEEP_ALL&gt;</code></li>
    </ul>
  </li>
  <li>
<code class="language-plaintext highlighter-rouge">master</code> branch is compatible with many ROS 2 distributions:
    <ul>
      <li>dashing</li>
      <li>eloquent</li>
      <li>foxy</li>
      <li>galactic</li>
      <li>rolling
        <h3 id="deprecated">Deprecated</h3>
      </li>
    </ul>
  </li>
  <li>CLI flags for QOS settings:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">--reliable</code></li>
      <li><code class="language-plaintext highlighter-rouge">--transient</code></li>
      <li>
<code class="language-plaintext highlighter-rouge">--keep-last</code>
        <h3 id="removed-6">Removed</h3>
      </li>
    </ul>
  </li>
  <li>The branches for specific ROS 2 distributions have been deleted
    <h3 id="fixed-11">Fixed</h3>
  </li>
  <li>CI jobs and Dockerfiles are decoupled from the middleware bundled with the ROS 2 distribution</li>
</ul>
</div>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="kilted-tutorials">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wiki Tutorials</h3>
      </div>
      <div class="panel-body">
        
        <em>This package does not provide any links to tutorials in it's <a href="https://index.ros.org/contribute/metadata/">rosindex metadata</a>.</em>
        <em>You can check on the <a href="http://wiki.ros.org/performance_test/Tutorials" target="_blank">ROS Wiki Tutorials</a> page for the package.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="kilted-deps">
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Package Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th class="text-center">Deps</th>
                  <th style="width: 100%">Name</th>
                </thead>
                <tbody>
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rclcpp#kilted-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rclcpp#kilted">rclcpp  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ros_environment#kilted-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ros_environment#kilted">ros_environment  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake#kilted-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake#kilted">ament_cmake  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_generators#kilted-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_generators#kilted">rosidl_default_generators  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rmw_implementation#kilted-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rmw_implementation#kilted">rmw_implementation  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_runtime#kilted-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_runtime#kilted">rosidl_default_runtime  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_gtest#kilted-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_gtest#kilted">ament_cmake_gtest  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_auto#kilted-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_auto#kilted">ament_lint_auto  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_common#kilted-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_common#kilted">ament_lint_common  </a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
          <div class="panel-heading">
            <h3 class="panel-title">System Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                </thead>
                <tbody>
                  
                    
                      <tr>
                        <td><a href="/d/git">git</a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Dependant Packages</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                  <th class="text-center">Deps</th>
                </thead>
                <tbody>
                  
                    
                    
                    <tr>
                      <td><a href="/p/performance_report#kilted">performance_report</a></td>
                      <td class="text-center">
                        
                        <a href="/p/performance_report#kilted-deps" class="endoftree">
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="kilted-assets">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Launch files</h3>
      </div>
      <div class="panel-body">
        
          <em>No launch files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Messages</h3>
      </div>
      <div class="panel-body">
        
          <em>No message files found.</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Services</h3>
      </div>
      <div class="panel-body">
        
          <em>No service files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Plugins</h3>
      </div>
      <div class="panel-body">
        
          <em>No plugins found.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="kilted-questions">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent questions tagged <kbd>performance_test</kbd> at <strong><a href="https://robotics.stackexchange.com/" target="_blank">Robotics Stack Exchange</a></strong></h3>      </div>
      <div id="kilted-question-list" class="panel-body" style="display: none;"></div>
      <div id="kilted-no-question-list" class="panel-body" style="display: none;">
        <p>No questions yet, you can ask one <a href="https://robotics.stackexchange.com/questions/tagged/performance_test+kilted">here</a>.</p>
      </div>
      <div id="kilted-get-question-fail" class="panel-body alert alert-warning" style="display: none;">
        <p>Failed to get question list, you can ticket an issue <a href="https://github.com/ros-infrastructure/rosindex/issues/new" target="_blank" class="alert-link">here</a> </p>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/package_body_tabs.js"></script>

<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
jQuery(function() {
    // Update the count on the links to the contribution suggestions
    updateContributionSuggestionsCountOnPackage('https://gitlab.com/ApexAI/performance_test.git');
});
</script>

          </div>
          <div class="col-md-2 hidden-xs hidden-sm">
            
            
            



<div class="list-group list-group-sm ">
  <a class="list-group-item"
     target="_blank"
     href="http://docs.ros.org/en/kilted/p/performance_test"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       
       API Docs
  </a>
  <a class="list-group-item"
     target="_blank"
     href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       
       Browse Code
  </a>
  
  
  
  
  
  
</div>

          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-rolling">
    <div class="container-fluid">
      
        
        
        

        <div class="row">
          <div class="col-md-10">
            

<div class="well well-sm">
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px" src="/assets/package.png">
      </td>
      <td>
        <h3 style="margin-top: 5px">
          <a style="text-decoration:none" href="/p/performance_test">performance_test</a> <small>package from <a style="text-decoration:none" href="/r/performance_test/gitlab-ApexAI-performance_test">performance_test</a> repo</small>
        </h3>
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_report">

performance_report
</a>
            
          
            
            
              <span class="label label-default pkg-label">

performance_test
</span>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_test_ros1_msgs">

performance_test_ros1_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_test_ros1_publisher">

performance_test_ros1_publisher
</a>
            
          
      </td>
    </tr>
  </table>
</div>

            <div class="visible-xs visible-sm">
              
              
              



<div class="list-group list-group-sm list-group-horizontal list-group-justified">
  <a class="list-group-item text-center"
     target="_blank"
     href="http://docs.ros.org/en/rolling/p/performance_test"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       <br>
       API Docs
  </a>
  <a class="list-group-item text-center"
     target="_blank"
     href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       <br>
       Browse Code
  </a>
  
  
  
  
  
  
</div>

            </div>
            



<ul class="nav nav-tabs nav-justified" id="rolling-tabs" style="margin-bottom:20px">
  <li class="better-tabs active">
    <a href="#rolling-overview" data-toggle="tab">Overview</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    
    <a href="#rolling-assets" data-toggle="tab"><span class="label label-default">0</span> Assets</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    <a href="#rolling-deps" data-toggle="tab"><span class="label label-primary">10</span> Dependencies</a>
  </li>
  <li class="better-tabs">
    
    <a href="#rolling-tutorials" data-toggle="tab"><span class="label label-default">0</span> Tutorials</a>
  </li>
  <li class="better-tabs">
    <a href="#rolling-questions" data-toggle="tab"><span id="rolling-questions-count" class="label label-primary">0</span> Q & A</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="rolling-overview">
    
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h4 class="panel-title">Package Summary</h4></div>
          <div class="panel-body">
            <table class="table table-condensed">
              <tr>
                <td style="width:100px;" class="text-right"><strong>Tags</strong></td>
                <td>
                  
                  
                    <em>No category tags.</em>
                  
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Version</strong></td>
                <td>2.3.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>License</strong></td>
                <td>Apache 2.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>Build type</strong></td>
                <td>
                  
                    <span class="label label-default">
                  
                    AMENT_CMAKE</span>
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Use</strong></td>
                <td>
                
                  <span class="label label-success">RECOMMENDED</span>
                
                </td>
              </tr>
            </table>
          </div>
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body">
            
            
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default"></span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://gitlab.com/ApexAI/performance_test.git">https://gitlab.com/ApexAI/performance_test.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">master</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-03-25
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="No CI information available for this package.">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/performance_test/#rolling-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/performance_test/#rolling-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/performance_test/#rolling-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Package Description</h3></div>
          <div class="panel-body">
            Tool to test performance of ROS 2 and DDS data layers and communication.
          </div>
          <div class="panel-heading"><h4 class="panel-title">Additional Links</h4></div>
          <div class="panel-body">
            
            
              <em>No additional links.</em>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Maintainers</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Apex.AI, Inc.</li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Authors</h4></div>
          <div class="panel-body">
            
            
              <em>No additional authors.</em>
            
          </div>
        </div>
      </div>
    </div>
    
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-heading"><span class="glyphicon glyphicon-file"></span><a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/README.md" title="Open in git repository">performance_test/README.md</a></div>
              <div class="panel-body">
                    <div class="rendered-markdown">
<h1 id="performance_test">performance_test</h1>

<p>[TOC]</p>

<p>The performance_test tool tests latency and other performance metrics of <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">various middleware
implementations</a> that support a pub/sub pattern. It is used to simulate
non-functional performance of your application.</p>

<p>The performance_test tool allows you to quickly set up a pub/sub configuration,
e.g. number of publisher/subscribers, message size, QOS settings, middleware. The following metrics
are automatically recorded when the application is running:</p>

<ul>
  <li>
<strong>latency</strong>: corresponds to the time a message takes to travel from a publisher to subscriber. The
latency is measured by timestamping the sample when it’s published and subtracting the timestamp
  (from the sample) from the measured time when the sample arrives at the subscriber (only logged when a subscriber is created)</li>
  <li>
<strong>CPU usage</strong>: percentage of the total system wide CPU usage (logged separately for each instance of <code class="language-plaintext highlighter-rouge">perf_test</code>)</li>
  <li>
<strong>resident memory</strong>: heap allocations, shared memory segments, stack (used for system’s internal
work) (logged separately for each instance of <code class="language-plaintext highlighter-rouge">perf_test</code>)</li>
  <li>
<strong>sample statistics</strong>: number of samples received, sent, and lost per experiment run.</li>
</ul>

<p>This <code class="language-plaintext highlighter-rouge">master</code> branch is compatible with the following ROS 2 versions</p>
<ul>
  <li>rolling</li>
  <li>jazzy</li>
  <li>iron</li>
  <li>humble</li>
  <li>galactic</li>
  <li>foxy</li>
  <li>eloquent</li>
  <li>dashing</li>
  <li>Apex.OS</li>
</ul>

<h2 id="how-to-use-this-document">How to use this document</h2>

<ol>
  <li>Start <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#example">here</a> for a quick example of building and running the performance_test tool
with the Cyclone DDS plugin.</li>
  <li>If needed, find more detailed information about <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#building-the-performance_test-tool">building</a>
and <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#running-an-experiment">running</a>
</li>
  <li>Or, if the quick example is good enough, skip ahead to the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">list of supported middleware
plugins</a> to learn how to test a specific middleware implementation.</li>
  <li>Check out the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#analyze-the-results">tools for visualizing the results</a>
</li>
  <li>If desired, read about the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#architecture">design and architecture</a> of the tool.</li>
</ol>

<h2 id="example">Example</h2>

<p>This example shows how to test the non-functional performance of the following configuration:</p>

<table>
  <thead>
    <tr>
      <th>Option</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Plugin</td>
      <td>Cyclone DDS</td>
    </tr>
    <tr>
      <td>Message type</td>
      <td>Array1k</td>
    </tr>
    <tr>
      <td>Publishing rate</td>
      <td>100Hz</td>
    </tr>
    <tr>
      <td>Topic name</td>
      <td>test_topic</td>
    </tr>
    <tr>
      <td>Duration of the experiment</td>
      <td>30s</td>
    </tr>
    <tr>
      <td>Number of publisher(s)</td>
      <td>1 (default)</td>
    </tr>
    <tr>
      <td>Number of subscriber(s)</td>
      <td>1 (default)</td>
    </tr>
  </tbody>
</table>

<ol>
  <li>
    <p>Install <a href="https://docs.ros.org/en/rolling/index.html">ROS 2</a></p>
  </li>
  <li>
    <p>Install <a href="https://github.com/eclipse-cyclonedds/cyclonedds">Cyclone DDS</a> to /opt/cyclonedds</p>
  </li>
  <li>
    <p>Build performance_test with the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#eclipse-cyclone-dds">CMake build flag</a> for Cyclone DDS:</p>
  </li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nb">source</span> /opt/ros/rolling/setup.bash
    <span class="nb">cd</span> ~/perf_test_ws
    colcon build <span class="nt">--cmake-args</span> <span class="nt">-DPERFORMANCE_TEST_PLUGIN</span><span class="o">=</span>CYCLONEDDS
    <span class="nb">source</span> ./install/setup.bash
    
</code></pre></div></div>

<ol>
  <li>Run with the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#eclipse-cyclone-dds">communication plugin option</a> for Cyclone DDS:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>experiment
./install/performance_test/lib/performance_test/perf_test <span class="nt">--communication</span> CycloneDDS
                                                          <span class="nt">--msg</span> Array1k
                                                          <span class="nt">--rate</span> 100
                                                          <span class="nt">--topic</span> test_topic
                                                          <span class="nt">--max-runtime</span> 30
                                                          <span class="nt">--logfile</span> experiment/log.csv

</code></pre></div></div>

<p>At the end of the experiment, a CSV log file will be generated in the experiment folder with a name
that starts with <code class="language-plaintext highlighter-rouge">log</code>.</p>

<h2 id="building-the-performance_test-tool">Building the performance_test tool</h2>

<p>For a simple example, see <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.rclcpp">Dockerfile.rclcpp</a>.</p>

<p>The performance_test tool is structured as a ROS 2 package, so <code class="language-plaintext highlighter-rouge">colcon</code> is used to build it.
Therefore, you must source a ROS 2 installation:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">source</span> /opt/ros/rolling/setup.bash

</code></pre></div></div>

<p>Select a middleware plugin from <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">this list</a>.
Then build the performance_test tool with the selected middleware:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> ~/perf_test_ws/src
<span class="nb">cd</span> ~/perf_test_ws/src
git clone https://gitlab.com/ApexAI/performance_test.git
<span class="nb">cd</span> ..
<span class="c"># At this stage, you need to choose which middleware you want to use</span>
<span class="c"># The list of available flags is described in the middleware plugins section</span>
<span class="c"># Square brackets denote optional arguments, like in the Python documentation.</span>
colcon build <span class="nt">--cmake-args</span> <span class="nt">-DCMAKE_BUILD_TYPE</span><span class="o">=</span>Release <span class="nt">-DPERFORMANCE_TEST_PLUGIN</span><span class="o">=</span>&lt;plugin&gt;
<span class="nb">source install</span>/setup.bash

</code></pre></div></div>

<h2 id="running-an-experiment">Running an experiment</h2>

<p>The performance_test experiments are run through the <code class="language-plaintext highlighter-rouge">perf_test</code> executable.
To find the available settings, run with <code class="language-plaintext highlighter-rouge">--help</code> (note the required and default arguments):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~/perf_test_ws<span class="nv">$ </span>./install/performance_test/lib/performance_test/perf_test <span class="nt">--help</span>

</code></pre></div></div>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">-c</code> argument should match the selected <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">middleware plugin</a>
from the build phase.</li>
  <li>The <code class="language-plaintext highlighter-rouge">--msg</code> argument should be one of the supported message types, which are shown
in the <code class="language-plaintext highlighter-rouge">--help</code> output.</li>
</ul>

<h3 id="single-machine-or-distributed-system">Single machine or distributed system?</h3>

<p>Based on the configuration you want to test, the usage of the performance_test tool differs. The
different possibilities are explained below.</p>

<p>For running tests on a single machine, you can choose between the following options:</p>

<ol>
  <li>Intraprocess means that the publisher and subscriber threads are in the same process.</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    perf_test &lt;options&gt; <span class="nt">--num-sub-threads</span> 1 <span class="nt">--num-pub-threads</span> 1
    
</code></pre></div></div>

<ol>
  <li>Interprocess means that the publisher and subscriber are in different processes. To test
interprocess communication, two instances of the performance_test must be run, e.g.</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c"># Start the subscriber first</span>
    perf_test &lt;options&gt; <span class="nt">--num-sub-threads</span> 1 <span class="nt">--num-pub-threads</span> 0 &amp;
    <span class="nb">sleep </span>1  <span class="c"># give the subscriber time to finish initializing</span>
    perf_test &lt;options&gt; <span class="nt">--num-sub-threads</span> 0 <span class="nt">--num-pub-threads</span> 1
    
</code></pre></div></div>

<p>On a distributed system, testing latency is difficult, because the clocks are probably not
perfectly synchronized between the two devices. To work around this, the performance_test tool
supports relay mode, which allows for a round-trip style of communication:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># On the main machine</span>
perf_test &lt;options&gt; <span class="nt">--roundtrip-mode</span> Main

<span class="c"># On the relay machine:</span>
perf_test &lt;options&gt; <span class="nt">--roundtrip-mode</span> Relay

</code></pre></div></div>

<p>In relay mode, the Main machine sends messages to the Relay machine, which immediately sends the
messages back. The Main machine receives the relayed message, and reports the round-trip latency.
Therefore, the reported latency will be roughly double the latency compared to the latency reported
in non-relay mode.</p>

<h3 id="single-machine-single-thread">Single machine, single thread</h3>

<p>An intra-thread configuration is experimentally supported, in which a publisher and subscriber
both operate in the same thread. The publisher writes a messages, and the subscriber immediately
takes it.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>perf_test &lt;options&gt; <span class="nt">-e</span> INTRA_THREAD

</code></pre></div></div>

<p>Notes:</p>

<ol>
  <li>This is only available when zero copy transfer is enabled</li>
  <li>This requires exactly one publisher and one subscriber</li>
  <li>This is not compatible with roundtrip mode</li>
</ol>

<h2 id="middleware-plugins">Middleware plugins</h2>

<p>The performance test tool can measure the performance of a variety of communication solutions
from different vendors. In this case there is no rclcpp or rmw layer overhead over the publisher
and subscriber routines.</p>

<p>The performance_test tool implements an executor that runs the publisher(s) and/or the subscriber(s) in
their own thread.</p>

<p>The following plugins are currently implemented:</p>

<h3 id="eclipse-cyclone-dds">Eclipse Cyclone DDS</h3>

<ul>
  <li><a href="https://github.com/eclipse-cyclonedds/cyclonedds/tree/0.9.0b1">Eclipse Cyclone DDS 0.9.0b1</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CYCLONEDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c CycloneDDS</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.CycloneDDS">Dockerfile.CycloneDDS</a>
</li>
  <li>Available transports:
    <ul>
      <li>Cyclone DDS zero copy requires
<a href="https://github.com/eclipse-iceoryx/iceoryx/blob/master/doc/website/getting-started/overview.md#roudi">RouDi</a>
to be running.
-
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP |</li>
    </ul>
  </li>
</ul>

<h3 id="eclipse-cyclone-dds-c-binding">Eclipse Cyclone DDS C++ binding</h3>

<ul>
  <li><a href="https://github.com/eclipse-cyclonedds/cyclonedds-cxx/tree/0.9.0b1">Eclipse Cyclone DDS C++ bindings 0.9.0b1</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CYCLONEDDS_CXX</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c CycloneDDS-CXX</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.CycloneDDS-CXX">Dockerfile.CycloneDDS-CXX</a>
</li>
  <li>Available transports:
    <ul>
      <li>Cyclone DDS zero copy requires the
<a href="https://github.com/eclipse-iceoryx/iceoryx/blob/master/doc/website/getting-started/overview.md#roudi">RouDi</a>
to be running.
-
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP |</li>
    </ul>
  </li>
</ul>

<h3 id="eclipse-iceoryx">Eclipse iceoryx</h3>

<ul>
  <li><a href="https://github.com/eclipse-iceoryx/iceoryx/tree/5fe215eab267b0ad68bc5552aecd4b6e728e4c99">iceoryx (latest master as of Feb 13)</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=ICEORYX</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c iceoryx</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.iceoryx">Dockerfile.iceoryx</a>
</li>
  <li>The iceoryx plugin is not a DDS implementation.
    <ul>
      <li>The DDS-specific options (such as domain ID, durability, and reliability) do not apply.</li>
    </ul>
  </li>
  <li>To run with the iceoryx plugin,
<a href="https://github.com/eclipse-iceoryx/iceoryx/blob/master/doc/website/getting-started/overview.md#roudi">RouDi</a>
must be running.</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|———–|———————|———————————–|
| LoanedSamples | LoanedSamples | Not supported by performance_test |</li>
</ul>

<h3 id="eprosima-fast-dds">eProsima Fast DDS</h3>

<ul>
  <li><a href="https://github.com/eProsima/Fast-DDS/tree/v2.6.2">FastDDS 2.6.2</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=FASTDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c FastRTPS</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.FastDDS">Dockerfile.FastDDS</a>
</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA (default), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | SHMEM (default), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP |</li>
</ul>

<h3 id="oci-opendds">OCI OpenDDS</h3>

<ul>
  <li><a href="https://github.com/objectcomputing/OpenDDS/tree/DDS-3.13.2">OpenDDS 3.13.2</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=OPENDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c OpenDDS</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.OpenDDS">Dockerfile.OpenDDS</a>
</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| TCP   | TCP                 | TCP                |</li>
</ul>

<h3 id="rti-connext-dds">RTI Connext DDS</h3>

<ul>
  <li><a href="https://www.rti.com/products/connext-dds-professional">RTI Connext DDS 5.3.1+</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CONNEXTDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c ConnextDDS</code>
</li>
  <li>Docker file: Not available</li>
  <li>A license is required</li>
  <li>You need to source an RTI Connext DDS environment.
    <ul>
      <li>If RTI Connext DDS was installed with ROS 2 (Linux only):
        <ul>
          <li><code class="language-plaintext highlighter-rouge">source /opt/rti.com/rti_connext_dds-5.3.1/setenv_ros2rti.bash</code></li>
        </ul>
      </li>
      <li>If RTI Connext DDS is installed separately, you can source the following script to set the
environment:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">source &lt;connextdds_install_path&gt;/resource/scripts/rtisetenv_&lt;arch&gt;.bash</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA | SHMEM               | UDP                |</li>
</ul>

<h3 id="rti-connext-dds-micro">RTI Connext DDS Micro</h3>

<ul>
  <li><a href="https://www.rti.com/products/connext-dds-micro">Connext DDS Micro 3.0.3</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CONNEXTDDSMICRO</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c ConnextDDSMicro</code>
</li>
  <li>Docker file: Not available</li>
  <li>A license is required</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA | SHMEM               | UDP                |</li>
</ul>

<h2 id="framework-plugins">Framework plugins</h2>

<p>The performance_test tool can also measure the end-to-end latency of a framework. In this case, the
executor of the framework is used to run the publisher(s) and/or the subscriber(s). The potential overhead of the <a href="http://docs.ros2.org/beta2/developer_overview.html#internal-api-architecture-overview">rclcpp or rmw
layer</a> is measured.</p>

<h3 id="ros-2">ROS 2</h3>

<p>The performance test tool can also measure the performance of a variety of RMW implementations,
through the ROS 2 <code class="language-plaintext highlighter-rouge">rclcpp::publisher</code> and <code class="language-plaintext highlighter-rouge">rclcpp::subscriber</code> API.</p>

<ul>
  <li><a href="https://docs.ros.org/en/rolling/Tutorials/Writing-A-Simple-Cpp-Publisher-And-Subscriber.html">ROS 2 <code class="language-plaintext highlighter-rouge">rclcpp::publisher</code> and <code class="language-plaintext highlighter-rouge">rclcpp::subscriber</code></a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=ROS2</code> (default)</li>
  <li>Communication plugin:
    <ul>
      <li>Callback with Single Threaded Executor: <code class="language-plaintext highlighter-rouge">-c rclcpp-single-threaded-executor</code>
</li>
      <li>Callback with Static Single Threaded Executor: <code class="language-plaintext highlighter-rouge">-c rclcpp-static-single-threaded-executor</code>
</li>
      <li>
<a href="https://github.com/ros2/rclcpp/pull/1047"><code class="language-plaintext highlighter-rouge">rclcpp::WaitSet</code></a>: <code class="language-plaintext highlighter-rouge">-c rclcpp-waitset</code>
</li>
    </ul>
  </li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.rclcpp">Dockerfile.rclcpp</a>
</li>
  <li>
<a href="https://docs.ros.org/en/rolling/Concepts/About-Different-Middleware-Vendors.html">Available underlying RMW implementations</a>:
    <ul>
      <li>ROS 2 Rolling is pre-configured to use <code class="language-plaintext highlighter-rouge">rmw_fastrtps_cpp</code>
</li>
      <li>Follow <a href="https://docs.ros.org/en/rolling/Guides/Working-with-multiple-RMW-implementations.html">these instructions</a>
  to use a different RMW implementation</li>
    </ul>
  </li>
  <li>Available transports: depends on underlying RMW implementation
    <ul>
      <li>LoanedSamples are available (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) for <code class="language-plaintext highlighter-rouge">ROS_DISTRO = foxy</code> and above</li>
    </ul>
  </li>
</ul>

<h3 id="apexos">Apex.OS</h3>

<ul>
  <li>Apex.OS</li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=APEX_OS</code>
    <ul>
      <li>It is also required to <code class="language-plaintext highlighter-rouge">source /opt/ApexOS/setup.bash</code> instead of a ROS 2 distribution</li>
    </ul>
  </li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c ApexOSPollingSubscription</code>
</li>
  <li>Docker file: Not available</li>
  <li>Available underlying RMW implementations: <code class="language-plaintext highlighter-rouge">rmw_apex_middleware</code>
</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero_copy</code>) | UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero_copy</code>) | UDP |</li>
</ul>

<h2 id="analyze-the-results">Analyze the results</h2>

<p>After an experiment is run with the <code class="language-plaintext highlighter-rouge">-l</code> flag, a log file is recorded. Both CSV
and JSON formats are supported. It is possible to add custom data to the log
file by setting the<code class="language-plaintext highlighter-rouge">APEX_PERFORMANCE_TEST</code> environment variable before running
an experiment, e.g.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">#</span><span class="w"> </span><span class="err">JSON</span><span class="w"> </span><span class="err">format</span><span class="w">
</span><span class="err">export</span><span class="w"> </span><span class="err">APEX_PERFORMANCE_TEST=</span><span class="s2">"
{
</span><span class="se">\"</span><span class="s2">My Version</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">1.0.4</span><span class="se">\"</span><span class="s2">,
</span><span class="se">\"</span><span class="s2">My Image Version</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">5.2</span><span class="se">\"</span><span class="s2">,
</span><span class="se">\"</span><span class="s2">My OS Version</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">Ubuntu 16.04</span><span class="se">\"</span><span class="s2">
}
"</span><span class="w">

</span></code></pre></div></div>

<h2 id="plot-the-results">Plot the results</h2>

<p>To plot the results in the JSON or CSV log files, see the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/../plotter">plotter README</a>.</p>

<h2 id="architecture">Architecture</h2>

<p>Apex.AI’s <em>Performance Testing in ROS 2</em> white paper
(<a href="https://drive.google.com/file/d/15nX80RK6aS8abZvQAOnMNUEgh7px9V5S/view">available here</a>)
describes how to design a fair and unbiased performance test, and is the basis for this project.</p>
<center><img src="https://gitlab.com/ApexAI/performance_test/-/raw/master/performance_test/architecture.png"></center>

<p>Each middleware has a different API. Thanks to the <code class="language-plaintext highlighter-rouge">Plugin</code> abstraction, the core logic of
setting up and running an experiment is completely decoupled from the implementation details
of sending and receiving individual messages.</p>

<p>Exactly one <code class="language-plaintext highlighter-rouge">Plugin</code> implementation is selected at build time. The design is similar to the
<a href="https://refactoring.guru/design-patterns/abstract-factory">Abstract Factory pattern</a>.
<code class="language-plaintext highlighter-rouge">performance_test</code> declares, but does not define, a static factory method in the <code class="language-plaintext highlighter-rouge">PluginFactory</code>
class. Each middleware provides a definition for this factory method to create a concrete <code class="language-plaintext highlighter-rouge">Plugin</code>
implementation, and <code class="language-plaintext highlighter-rouge">perf_test</code> calls this factory method directly.</p>

<p>An example plugin is available <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/plugins/demo">here</a>.</p>

<h2 id="performance-optimizations">Performance optimizations</h2>

<ul>
  <li>On linux-based platforms, <code class="language-plaintext highlighter-rouge">perf_test</code> writes <code class="language-plaintext highlighter-rouge">0</code> to <code class="language-plaintext highlighter-rouge">/dev/cpu_dma_latency</code>
and holds open the file handle, which will prevent the CPU from entering any
idle states for the duration of the experiment. This should result in lower
message latency and lower variance in that latency.</li>
</ul>

<h2 id="future-extensions-and-limitations">Future extensions and limitations</h2>

<ul>
  <li>Communication frameworks like DDS have a huge amount of settings. This tool only allows the most
common QOS settings to be configured. The other QOS settings are hardcoded in the application.</li>
  <li>Only one publisher per topic is allowed, because the data verification logic does not support
matching data to the different publishers.</li>
  <li>Some communication plugins can get stuck in their internal loops if too much data is received.
Figuring out ways around such issues is one of the goals of this tool.</li>
  <li>FastRTPS wait-set does not support timeouts which can lead to the receiving not aborting. In that
case the performance test must be manually killed.</li>
  <li>Using Connext DDS Micro INTRA transport with <code class="language-plaintext highlighter-rouge">reliable</code> QoS and history kind set to <code class="language-plaintext highlighter-rouge">keep_all</code>
<a href="https://community.rti.com/static/documentation/connext-micro/3.0.3/doc/html/usersmanual/transports/INTRA.html#reliability-and-durability">is not supported with Connext
Micro</a>.
Set <code class="language-plaintext highlighter-rouge">keep-last</code> as QoS history kind always when using <code class="language-plaintext highlighter-rouge">reliable</code>.</li>
</ul>

<p>Possible additional communication which could be implemented are:</p>

<ul>
  <li>Raw UDP communication</li>
</ul>

<h2 id="building-with-limited-resources">Building with limited resources</h2>

<p>When building this tool, the compiler must perform a lot of template expansion. This can be
overwhelming for a system with a low-power CPU or limited RAM. There are some additional CMake
options which can reduce the system load during compilation:</p>

<ol>
  <li>This tool includes many different message types, each with many different sizes. Reduce the number of
messages, and thus the compilation load, by disabling one or more message types. For example, to build
without <code class="language-plaintext highlighter-rouge">PointCloud</code> messages, add <code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_POINDCLOUD=OFF</code> to the <code class="language-plaintext highlighter-rouge">--cmake-args</code>. The message types,
and their options for enabling/disabling, can be found <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/performance_test/msg/CMakeLists.txt">here</a>.</li>
</ol>
</div>
              </div>
            </div>
          </div>
        </div>
      
    
    <div class="row">
      <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-heading"><span class="glyphicon glyphicon-list"></span> CHANGELOG</div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="changelog-for-package-performance_test">Changelog for package performance_test</h1>

<h2 id="xyz-yyyymmdd">X.Y.Z (YYYY/MM/DD)</h2>

<h2 id="230-20240924">2.3.0 (2024/09/24)</h2>

<h3 id="removed">Removed</h3>
<ul>
  <li>Moved <code class="language-plaintext highlighter-rouge">apex_performance_plotter</code> to its own package <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/../plotter">here</a>
</li>
</ul>

<h2 id="220-20240515">2.2.0 (2024/05/15)</h2>

<h3 id="added">Added</h3>
<ul>
  <li>performance_test can be built with ROS 2 Iron and Jazzy
    <h3 id="changed">Changed</h3>
  </li>
  <li>Renamed the <code class="language-plaintext highlighter-rouge">--dds-domain_id</code> CLI arg to <code class="language-plaintext highlighter-rouge">--dds-domain-id</code>
</li>
  <li>When <code class="language-plaintext highlighter-rouge">--dds-domain-id</code> is unspecified, fall back to the <code class="language-plaintext highlighter-rouge">ROS_DOMAIN_ID</code> environment variable</li>
  <li>
<code class="language-plaintext highlighter-rouge">--zero-copy</code> has been separated into two flags:
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">--shared-memory</code>: Enable shared-memory transfer in the plugin. This is meant to replace the
need to manually set runtime flags via <code class="language-plaintext highlighter-rouge">CYCLONEDDS_URI</code>, <code class="language-plaintext highlighter-rouge">APEX_MIDDLEWARE_SETTINGS</code>, etc.</li>
      <li>
<code class="language-plaintext highlighter-rouge">--loaned-samples</code>: When publishing messages in the plugin, borrow loaned samples instead
of publishing by copy</li>
      <li>
<code class="language-plaintext highlighter-rouge">--zero-copy</code> is now an alias for <code class="language-plaintext highlighter-rouge">--shared-memory --loaned-samples</code>
</li>
      <li>Supported plugins include:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">-c CycloneDDS</code></li>
          <li><code class="language-plaintext highlighter-rouge">-c CycloneDDS-CXX</code></li>
          <li><code class="language-plaintext highlighter-rouge">-c ApexOSPollingSubscription</code></li>
          <li>
<code class="language-plaintext highlighter-rouge">-c rclcpp-*</code> with <code class="language-plaintext highlighter-rouge">RMW_IMPLEMENTATION=rmw_cyclonedds_cpp</code>
</li>
          <li>
<code class="language-plaintext highlighter-rouge">-c rclcpp-*</code> with <code class="language-plaintext highlighter-rouge">RMW_IMPLEMENTATION=rmw_fastrtps_cpp</code>
</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="210-20240417">2.1.0 (2024/04/17)</h2>

<h3 id="added-1">Added</h3>
<ul>
  <li>Add new function <code class="language-plaintext highlighter-rouge">prepare()</code> to the Publisher and Subscriber API, intended
to allow participant discovery without blocking the main thread
    <h3 id="changed-1">Changed</h3>
  </li>
  <li>Change the default <code class="language-plaintext highlighter-rouge">--history</code> arg from <code class="language-plaintext highlighter-rouge">KEEP_ALL</code> to <code class="language-plaintext highlighter-rouge">KEEP_LAST</code>
</li>
  <li>Change the default <code class="language-plaintext highlighter-rouge">--history-depth</code> arg from <code class="language-plaintext highlighter-rouge">1000</code> to <code class="language-plaintext highlighter-rouge">16</code>
</li>
  <li>If <code class="language-plaintext highlighter-rouge">--expected-num-pubs</code> is unspecified, set it to the same value as <code class="language-plaintext highlighter-rouge">-p</code>
</li>
  <li>If <code class="language-plaintext highlighter-rouge">--expected-num-subs</code> is unspecified, set it to the same value as <code class="language-plaintext highlighter-rouge">-s</code>
    <h3 id="fixed">Fixed</h3>
  </li>
  <li>Removed an unused variable to fix a Clang build</li>
  <li>Remove unused variable names in the <code class="language-plaintext highlighter-rouge">Plugin</code> abstract class</li>
  <li>Fix a potential lockup in PublisherTask on QNX</li>
</ul>

<h2 id="200-20240319">2.0.0 (2024/03/19)</h2>

<h3 id="added-2">Added</h3>
<ul>
  <li>Add experimental bazel support
    <ul>
      <li><code class="language-plaintext highlighter-rouge">bazel build //performance_test --//:plugin_implementation=//path/to/a/plugin</code></li>
    </ul>
  </li>
  <li>Add a rudimentary socket-based plugin for testing the bazel support
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">bazel run //performance_test --//:plugin_implementation=//performance_test/plugins/demo:demo_plugin -- --help</code>
        <h3 id="changed-2">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Instead of enabling/disabling each plugin, you select exactly one
with a CMake string option, for example:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">colcon build --cmake-args -DPERFORMANCE_TEST_PLUGIN=ROS2</code></li>
    </ul>
  </li>
  <li>Renamed the <code class="language-plaintext highlighter-rouge">--communication</code> CLI arg to <code class="language-plaintext highlighter-rouge">--communicator</code>. The short <code class="language-plaintext highlighter-rouge">-c</code> is unchanged.
    <h3 id="removed-1">Removed</h3>
  </li>
  <li>Removed the deprecated CLI flags for QOS settings:
    <ul>
      <li>Instead of <code class="language-plaintext highlighter-rouge">--reliable</code>, use <code class="language-plaintext highlighter-rouge">--reliability RELIABLE</code>
</li>
      <li>Instead of <code class="language-plaintext highlighter-rouge">--transient</code>, use <code class="language-plaintext highlighter-rouge">--durability TRANSIENT_LOCAL</code>
</li>
      <li>Instead of <code class="language-plaintext highlighter-rouge">--keep-last</code>, use <code class="language-plaintext highlighter-rouge">--history KEEP_LAST</code>
</li>
    </ul>
  </li>
  <li>Removed the obsolete <code class="language-plaintext highlighter-rouge">BoundedSequenceFlat</code> messages</li>
  <li>Removed the superfluous <code class="language-plaintext highlighter-rouge">--msg-list</code> CLI flag. The <code class="language-plaintext highlighter-rouge">--help</code> message
already lists the available messages.
    <h3 id="fixed-1">Fixed</h3>
  </li>
  <li>Update the Apex.OS Runner to use <code class="language-plaintext highlighter-rouge">executor_runner::deferred</code> instead of <code class="language-plaintext highlighter-rouge">executor_runner::deferred_tag()</code>
</li>
  <li>Ensure that the first few published samples are sent at the expected rate</li>
</ul>

<h2 id="152-yyyymmdd">1.5.2 (YYYY/MM/DD)</h2>

<h3 id="added-3">Added</h3>
<ul>
  <li>
<code class="language-plaintext highlighter-rouge">--prevent-cpu-idle</code> is available on QNX
    <h3 id="changed-3">Changed</h3>
  </li>
  <li>JSON log files will contain all values in the <code class="language-plaintext highlighter-rouge">APEX_PERFORMANCE_TEST</code> dictionary, instead of the
five specific values used previously</li>
  <li>Switch to build as C++17 by default
    <h3 id="fixed-2">Fixed</h3>
  </li>
  <li>Zero copy transfer is again enabled for the rclcpp publisher</li>
</ul>

<h2 id="150-20230614">1.5.0 (2023/06/14)</h2>

<h3 id="added-4">Added</h3>
<ul>
  <li>New CLI switch <code class="language-plaintext highlighter-rouge">--prevent-cpu-idle</code> (linux only). When specified,
perf_test will use <code class="language-plaintext highlighter-rouge">/dev/cpu_dma_latency</code> to request that the CPU not enter
any sleep states, to potentially give more consistent results</li>
  <li>Some smaller <code class="language-plaintext highlighter-rouge">Array</code> messages, down to 32 bits</li>
  <li>Added support to the FastDDS plugin for bounded and unbounded sequences
    <h3 id="changed-4">Changed</h3>
  </li>
  <li>Update the README to better explain how to use this tool with Apex.OS</li>
  <li>In the <code class="language-plaintext highlighter-rouge">Runner</code>, allocate the <code class="language-plaintext highlighter-rouge">AnalysisResult</code>s on the stack instead of using <code class="language-plaintext highlighter-rouge">shared_ptr</code>
</li>
  <li>
<code class="language-plaintext highlighter-rouge">Subscriber</code> methods accept a callback parameter, instead of returning a
<code class="language-plaintext highlighter-rouge">vector</code> of results, to reduce heap usage</li>
  <li>Refactored the interaction between <code class="language-plaintext highlighter-rouge">SubscriberStats</code> and <code class="language-plaintext highlighter-rouge">AnalysisResult</code> to
remove the need for a <code class="language-plaintext highlighter-rouge">std::vector</code> of latency samples, to reduce heap usage</li>
  <li>Adjusted the <code class="language-plaintext highlighter-rouge">Array</code> message sizes to make the name match the contents</li>
  <li>Updated <code class="language-plaintext highlighter-rouge">apex_os_communicator</code> to use the new zero-copy API</li>
</ul>

<h2 id="142-20230315">1.4.2 (2023/03/15)</h2>

<h3 id="added-5">Added</h3>
<ul>
  <li>Added <code class="language-plaintext highlighter-rouge">perfplot</code> support for JSON log files
    <h3 id="changed-5">Changed</h3>
  </li>
  <li>Migrate the Apex.OS target to use <code class="language-plaintext highlighter-rouge">rosidl_get_typesupport_target</code>
</li>
  <li>Preallocate the JSON logger’s string buffer to prevent reallocations after the experiment begins</li>
</ul>

<h2 id="141-20230223">1.4.1 (2023/02/23)</h2>

<h3 id="changed-6">Changed</h3>
<ul>
  <li>Updated the iceoryx plugin to the <a href="https://github.com/eclipse-iceoryx/iceoryx/tree/5fe215eab267b0ad68bc5552aecd4b6e728e4c99">latest master as of Feb 13</a>
</li>
</ul>

<h2 id="140-20230220">1.4.0 (2023/02/20)</h2>

<h3 id="added-6">Added</h3>
<ul>
  <li>New message type <code class="language-plaintext highlighter-rouge">BoundedSequenceFlat</code>
    <ul>
      <li>This is a <code class="language-plaintext highlighter-rouge">BoundedSequence</code> with the <code class="language-plaintext highlighter-rouge">@flat</code> annotation</li>
      <li>Sizes range from 1kB to 8MB, like <code class="language-plaintext highlighter-rouge">Array</code> and <code class="language-plaintext highlighter-rouge">BoundedSequence</code>
        <h3 id="changed-7">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Messages of different types can be optionally included via CMake args:
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_ARRAY</code> (default ON)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_STRUCT</code> (default ON)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_POINT_CLOUD</code> (default ON)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_BOUNDED_SEQUENCE</code> (default OFF)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_BOUNDED_SEQUENCE_FLAT</code> (default OFF)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_UNBOUNDED_SEQUENCE</code> (default OFF)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_ALL</code> (default OFF)
        <ul>
          <li>when ON, overrides the other defaults to ON</li>
          <li>you can still optionally exclude some messages by explicitly setting them to OFF
            <h3 id="removed-2">Removed</h3>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Removed a few messages:
    <ul>
      <li>Range</li>
      <li>RadarTrack</li>
      <li>RadarDetection</li>
      <li>NavSatFix
        <h3 id="fixed-3">Fixed</h3>
      </li>
    </ul>
  </li>
  <li>In all cases, including loaned messages, capture the timestamp as the last step of initializing the message</li>
</ul>

<h2 id="137-20230104">1.3.7 (2023/01/04)</h2>

<h2 id="136-20230103">1.3.6 (2023/01/03)</h2>

<h3 id="fixed-4">Fixed</h3>
<ul>
  <li>Set the correct <code class="language-plaintext highlighter-rouge">IDL_GEN_ROOT</code> for rclcpp plugins</li>
</ul>

<h2 id="135-20221205">1.3.5 (2022/12/05)</h2>

<h3 id="fixed-5">Fixed</h3>
<ul>
  <li>Exit cleanly when a publisher process terminates before a subscriber process</li>
</ul>

<h2 id="134-20221128">1.3.4 (2022/11/28)</h2>

<h3 id="changed-8">Changed</h3>
<ul>
  <li>Updated Apex.OS plugins to use the unified <code class="language-plaintext highlighter-rouge">LoanedSample::data()</code>
</li>
</ul>

<h2 id="133-20221128">1.3.3 (2022/11/28)</h2>

<h3 id="fixed-6">Fixed</h3>
<ul>
  <li>Implement the missing <code class="language-plaintext highlighter-rouge">take()</code> method in <code class="language-plaintext highlighter-rouge">ApexOSPollingSubscriptionSubscriber</code>
</li>
</ul>

<h2 id="132-20221121">1.3.2 (2022/11/21)</h2>

<h3 id="fixed-7">Fixed</h3>
<ul>
  <li>Capture the <code class="language-plaintext highlighter-rouge">this</code> pointer in the lambda in the iceoryx publisher</li>
</ul>

<h2 id="131-20221121">1.3.1 (2022/11/21)</h2>

<h3 id="added-7">Added</h3>
<ul>
  <li>New Apex.OS plugin, compatible with the <code class="language-plaintext highlighter-rouge">ThreadedRunner</code>s
    <ul>
      <li>The <code class="language-plaintext highlighter-rouge">INTER_THREAD</code> and <code class="language-plaintext highlighter-rouge">INTRA_THREAD</code> execution strategies, combined with
<code class="language-plaintext highlighter-rouge">-c ApexOSPollingSubscription</code>, will use the <code class="language-plaintext highlighter-rouge">ThreadedRunner</code> instances</li>
      <li>The new <code class="language-plaintext highlighter-rouge">APEX_SINGLE_EXECUTOR</code> execution strategy will add all publishers
and subscribers to a single Apex.OS Executor</li>
      <li>The new <code class="language-plaintext highlighter-rouge">APEX_EXECUTOR_PER_COMMUNICATOR</code> execution strategy will add each
publisher and each subscriber to its own Apex.OS Executor instance</li>
      <li>The new <code class="language-plaintext highlighter-rouge">APEX_CHAIN</code> execution strategy will add a publisher and subscriber
as a chain of nodes to an Apex.OS Executor
        <h3 id="changed-9">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Refactored FastRTPS communicator plugin:
    <ul>
      <li>Uses DDS compliant API</li>
      <li>Code generator updated</li>
      <li>Implementation for <code class="language-plaintext highlighter-rouge">publish_loaned()</code>
</li>
      <li>Dockerfile improvements
        <h3 id="removed-3">Removed</h3>
      </li>
    </ul>
  </li>
  <li>CLI arg <code class="language-plaintext highlighter-rouge">--disable-async</code>. Synchronous / asynchronous publishing should be
configured externally depending on the communication mean used.</li>
</ul>

<h2 id="130-20220825">1.3.0 (2022/08/25)</h2>

<h3 id="added-8">Added</h3>
<ul>
  <li>New execution strategy option:
    <ul>
      <li>The default <code class="language-plaintext highlighter-rouge">-e INTER_THREAD</code> runs each publisher and subscriber in its
own separate thread, which matches the previous behavior</li>
      <li>A new <code class="language-plaintext highlighter-rouge">-e INTRA_THREAD</code>, which runs a single publisher and subscriber in the
same thread. The publisher writes, and the subscriber immediately takes it</li>
      <li>For Apex.OS specifically, some optimized execution strategies which use the
proprietary Apex.OS executor
        <h3 id="changed-10">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Significantly refactored the communicator plugins:
    <ul>
      <li>Each plugin is split into an implementation of a <code class="language-plaintext highlighter-rouge">Publisher</code> and a
<code class="language-plaintext highlighter-rouge">Subscriber</code>, instead of a single <code class="language-plaintext highlighter-rouge">Communicator</code>
</li>
      <li>The plugin is no longer responsible for managing the metrics, such as
sample count, lost samples, and latency</li>
      <li>The plugin does not require any special logic to support roundtrip mode</li>
      <li>It is safe for the plugins to initialize their data writers and readers
at construction time, instead of delaying the initialization to the first
call of <code class="language-plaintext highlighter-rouge">publish()</code> or <code class="language-plaintext highlighter-rouge">update_subscription()</code>
</li>
      <li>Split <code class="language-plaintext highlighter-rouge">publish()</code> into <code class="language-plaintext highlighter-rouge">publish_copy()</code> and <code class="language-plaintext highlighter-rouge">publish_loaned()</code>
</li>
    </ul>
  </li>
  <li>Significantly refactored the runner framework:
    <ul>
      <li>The runner framework is responsible for the experiment metrics</li>
      <li>It manages the roundtrip mode logic</li>
      <li>It is extensible for different execution strategies or thread configurations</li>
    </ul>
  </li>
  <li>The iceoryx plugin now uses the untyped API, for improved performance</li>
</ul>

<h2 id="121-20220630">1.2.1 (2022/06/30)</h2>

<h3 id="fixed-8">Fixed</h3>
<ul>
  <li>Capture the timestamp as soon as a message is received, instead of just before
storing the metrics, to reduce the reported latency to a more correct value</li>
</ul>

<h2 id="120-20220628">1.2.0 (2022/06/28)</h2>

<h3 id="changed-11">Changed</h3>
<ul>
  <li>The CLI arguments for specifying the output type have changed:
    <ul>
      <li>For console output, updated every second, add <code class="language-plaintext highlighter-rouge">--print-to-console</code>
</li>
      <li>For file output, use <code class="language-plaintext highlighter-rouge">--logfile my_file.csv</code> or <code class="language-plaintext highlighter-rouge">--logfile my_file.json</code>
        <ul>
          <li>The type will be deduced from the file name</li>
        </ul>
      </li>
      <li>If neither of these options is specified, then a warning will print,
and the experiment will still run</li>
    </ul>
  </li>
  <li>The linter configurations are now configured locally. This means that the output
of <code class="language-plaintext highlighter-rouge">colcon test</code> should be the same no matter the installed ROS distribution.</li>
  <li>The <code class="language-plaintext highlighter-rouge">--zero-copy</code> arg is now valid even if the publisher and subscriber(s)
are in the same process
    <h3 id="removed-4">Removed</h3>
  </li>
  <li>The publisher and subscriber loop reserve metrics are no longer recorded or reported
    <h3 id="fixed-9">Fixed</h3>
  </li>
  <li>CPU usage will no longer be stuck at <code class="language-plaintext highlighter-rouge">0</code>
</li>
</ul>

<h3 id="removed-5">Removed</h3>
<ul>
  <li>The pub/sub loop reserve time metrics</li>
</ul>

<h2 id="112-20220608">1.1.2 (2022/06/08)</h2>

<h3 id="changed-12">Changed</h3>
<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">steady_clock</code> for all platforms, including QNX QOS</li>
</ul>

<h2 id="111-20220607">1.1.1 (2022/06/07)</h2>

<h3 id="changed-13">Changed</h3>
<ul>
  <li>Significant refactor to simplify the analysis pipeline
    <h3 id="fixed-10">Fixed</h3>
  </li>
  <li>Add some missing definitions when Apex.OS is enabled, but the rclcpp plugins are disabled</li>
</ul>

<h2 id="110-20220602">1.1.0 (2022/06/02)</h2>

<h3 id="added-9">Added</h3>
<ul>
  <li>New Apex.OS Polling Subscription plugin</li>
  <li>Compatibility with ROS 2 Humble</li>
</ul>

<h2 id="100-20220512">1.0.0 (2022/05/12)</h2>

<h3 id="added-10">Added</h3>
<ul>
  <li>More expressive perf_test CLI args for QOS settings</li>
  <li>A plugin for <a href="https://github.com/eclipse-cyclonedds/cyclonedds-cxx/tree/0.9.0b1">Cyclone DDS with C++ bindings v0.9.0b1</a>
    <h3 id="changed-14">Changed</h3>
  </li>
  <li>CLI args for QOS settings:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">--reliability &lt;RELIABLE|BEST_EFFORT&gt;</code></li>
      <li><code class="language-plaintext highlighter-rouge">--durability &lt;TRANSIENT_LOCAL|VOLATILE&gt;</code></li>
      <li><code class="language-plaintext highlighter-rouge">--history &lt;KEEP_LAST|KEEP_ALL&gt;</code></li>
    </ul>
  </li>
  <li>
<code class="language-plaintext highlighter-rouge">master</code> branch is compatible with many ROS 2 distributions:
    <ul>
      <li>dashing</li>
      <li>eloquent</li>
      <li>foxy</li>
      <li>galactic</li>
      <li>rolling
        <h3 id="deprecated">Deprecated</h3>
      </li>
    </ul>
  </li>
  <li>CLI flags for QOS settings:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">--reliable</code></li>
      <li><code class="language-plaintext highlighter-rouge">--transient</code></li>
      <li>
<code class="language-plaintext highlighter-rouge">--keep-last</code>
        <h3 id="removed-6">Removed</h3>
      </li>
    </ul>
  </li>
  <li>The branches for specific ROS 2 distributions have been deleted
    <h3 id="fixed-11">Fixed</h3>
  </li>
  <li>CI jobs and Dockerfiles are decoupled from the middleware bundled with the ROS 2 distribution</li>
</ul>
</div>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="rolling-tutorials">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wiki Tutorials</h3>
      </div>
      <div class="panel-body">
        
        <em>This package does not provide any links to tutorials in it's <a href="https://index.ros.org/contribute/metadata/">rosindex metadata</a>.</em>
        <em>You can check on the <a href="http://wiki.ros.org/performance_test/Tutorials" target="_blank">ROS Wiki Tutorials</a> page for the package.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="rolling-deps">
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Package Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th class="text-center">Deps</th>
                  <th style="width: 100%">Name</th>
                </thead>
                <tbody>
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rclcpp#rolling-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rclcpp#rolling">rclcpp  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ros_environment#rolling-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ros_environment#rolling">ros_environment  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake#rolling-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake#rolling">ament_cmake  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_generators#rolling-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_generators#rolling">rosidl_default_generators  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rmw_implementation#rolling-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rmw_implementation#rolling">rmw_implementation  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_runtime#rolling-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_runtime#rolling">rosidl_default_runtime  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_gtest#rolling-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_gtest#rolling">ament_cmake_gtest  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_auto#rolling-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_auto#rolling">ament_lint_auto  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_common#rolling-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_common#rolling">ament_lint_common  </a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
          <div class="panel-heading">
            <h3 class="panel-title">System Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                </thead>
                <tbody>
                  
                    
                      <tr>
                        <td><a href="/d/git">git</a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Dependant Packages</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                  <th class="text-center">Deps</th>
                </thead>
                <tbody>
                  
                    
                    
                    <tr>
                      <td><a href="/p/performance_report#rolling">performance_report</a></td>
                      <td class="text-center">
                        
                        <a href="/p/performance_report#rolling-deps" class="endoftree">
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="rolling-assets">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Launch files</h3>
      </div>
      <div class="panel-body">
        
          <em>No launch files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Messages</h3>
      </div>
      <div class="panel-body">
        
          <em>No message files found.</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Services</h3>
      </div>
      <div class="panel-body">
        
          <em>No service files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Plugins</h3>
      </div>
      <div class="panel-body">
        
          <em>No plugins found.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="rolling-questions">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent questions tagged <kbd>performance_test</kbd> at <strong><a href="https://robotics.stackexchange.com/" target="_blank">Robotics Stack Exchange</a></strong></h3>      </div>
      <div id="rolling-question-list" class="panel-body" style="display: none;"></div>
      <div id="rolling-no-question-list" class="panel-body" style="display: none;">
        <p>No questions yet, you can ask one <a href="https://robotics.stackexchange.com/questions/tagged/performance_test+rolling">here</a>.</p>
      </div>
      <div id="rolling-get-question-fail" class="panel-body alert alert-warning" style="display: none;">
        <p>Failed to get question list, you can ticket an issue <a href="https://github.com/ros-infrastructure/rosindex/issues/new" target="_blank" class="alert-link">here</a> </p>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/package_body_tabs.js"></script>

<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
jQuery(function() {
    // Update the count on the links to the contribution suggestions
    updateContributionSuggestionsCountOnPackage('https://gitlab.com/ApexAI/performance_test.git');
});
</script>

          </div>
          <div class="col-md-2 hidden-xs hidden-sm">
            
            
            



<div class="list-group list-group-sm ">
  <a class="list-group-item"
     target="_blank"
     href="http://docs.ros.org/en/rolling/p/performance_test"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       
       API Docs
  </a>
  <a class="list-group-item"
     target="_blank"
     href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       
       Browse Code
  </a>
  
  
  
  
  
  
</div>

          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-github">
    <div class="container-fluid">
      
        
        
        

        <div class="row">
          <div class="col-md-10">
            

<div class="well well-sm">
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px" src="/assets/package.png">
      </td>
      <td>
        <h3 style="margin-top: 5px">
          <a style="text-decoration:none" href="/p/performance_test">performance_test</a> <small>package from <a style="text-decoration:none" href="/r/ros2-performance/github-irobot-ros-ros2-performance">ros2-performance</a> repo</small>
        </h3>
          
            
            
              <a class="label label-primary pkg-label" href="/p/composition_benchmark">

composition_benchmark
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/irobot_benchmark">

irobot_benchmark
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/irobot_interfaces_plugin">

irobot_interfaces_plugin
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/memory_benchmark">

memory_benchmark
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_metrics">

performance_metrics
</a>
            
          
            
            
              <span class="label label-default pkg-label">

performance_test
</span>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_test_examples">

performance_test_examples
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_test_factory">

performance_test_factory
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_test_msgs">

performance_test_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_test_plugin_cmake">

performance_test_plugin_cmake
</a>
            
          
      </td>
    </tr>
  </table>
</div>

            <div class="visible-xs visible-sm">
              
              
              



<div class="list-group list-group-sm list-group-horizontal list-group-justified">
  <a class="list-group-item text-center"
     target="_blank"
     href="http://docs.ros.org/en/github/p/performance_test"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       <br>
       API Docs
  </a>
  <a class="list-group-item text-center"
     target="_blank"
     href="https://github.com/irobot-ros/ros2-performance/tree/rolling/performance_test"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       <br>
       Browse Code
  </a>
  
  
  
  
  
  
</div>

            </div>
            



<ul class="nav nav-tabs nav-justified" id="github-tabs" style="margin-bottom:20px">
  <li class="better-tabs active">
    <a href="#github-overview" data-toggle="tab">Overview</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    
    <a href="#github-assets" data-toggle="tab"><span class="label label-default">0</span> Assets</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    <a href="#github-deps" data-toggle="tab"><span class="label label-primary">15</span> Dependencies</a>
  </li>
  <li class="better-tabs">
    
    <a href="#github-tutorials" data-toggle="tab"><span class="label label-default">0</span> Tutorials</a>
  </li>
  <li class="better-tabs">
    <a href="#github-questions" data-toggle="tab"><span id="github-questions-count" class="label label-primary">0</span> Q & A</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="github-overview">
    
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h4 class="panel-title">Package Summary</h4></div>
          <div class="panel-body">
            <table class="table table-condensed">
              <tr>
                <td style="width:100px;" class="text-right"><strong>Tags</strong></td>
                <td>
                  
                  
                    <em>No category tags.</em>
                  
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Version</strong></td>
                <td>0.2.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>License</strong></td>
                <td>BSD 3.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>Build type</strong></td>
                <td>
                  
                    <span class="label label-default">
                  
                    AMENT_CMAKE</span>
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Use</strong></td>
                <td>
                
                  <span class="label label-success">RECOMMENDED</span>
                
                </td>
              </tr>
            </table>
          </div>
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body">
            
            
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">Framework to evaluate peformance of ROS 2</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/irobot-ros/ros2-performance.git">https://github.com/irobot-ros/ros2-performance.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">rolling</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-04-10
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          <span class="label label-warning">UNKNOWN
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="No CI information available for this package.">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-default">UNRELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <span class="label label-default">benchmark</span> <span class="label label-default">performance</span> <span class="label label-default">cpp</span> <span class="label label-default">ros2</span> 
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/ros2-performance/#github-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ros2-performance/#github-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ros2-performance/#github-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Package Description</h3></div>
          <div class="panel-body">
            Classes for generating ROS2 nodes and measuring their performance
          </div>
          <div class="panel-heading"><h4 class="panel-title">Additional Links</h4></div>
          <div class="panel-body">
            
            
              <em>No additional links.</em>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Maintainers</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Alberto Soragna</li>
                
                  <li>Juan Oxoby</li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Authors</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Alberto Soragna</li>
                
              </ul>
            
          </div>
        </div>
      </div>
    </div>
    
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-heading"><span class="glyphicon glyphicon-file"></span><a href="https://github.com/irobot-ros/ros2-performance/tree/rolling/performance_test/README.md" title="Open in git repository">performance_test/README.md</a></div>
              <div class="panel-body">
                    <div class="rendered-markdown">
<h1 id="ros2-performance-test">ROS2 Performance Test</h1>

<h2 id="create-a-sample-application">Create a sample application</h2>

<p>This package defines the <code class="language-plaintext highlighter-rouge">performance_test::PerformanceNode</code> class.
This class inherits from <code class="language-plaintext highlighter-rouge">rclcpp::Node</code> and provides APIs for easily adding any number of publishers, subscriptions, clients and servers to the node.</p>

<p>Each of the <code class="language-plaintext highlighter-rouge">PerformanceNode::add_periodic_publisher</code>, <code class="language-plaintext highlighter-rouge">PerformanceNode::add_subscriber</code>, etc. methods are based on a template in order to allow the creation of systems with different types of messages.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include "performance_test/performance_node_base.hpp"
auto sub_node = std::make_shared&lt;performance_test::PerformanceNode&lt;rclcpp::Node&gt;&gt;("my_sub_node");
sub_node-&gt;add_subscriber&lt;performance_test_msgs::msg::Stamped10b&gt;("my_topic_name");

</code></pre></div></div>

<p>This snippet of code will create a new node called <code class="language-plaintext highlighter-rouge">my_sub_node</code> and this node will have a subscriber on <code class="language-plaintext highlighter-rouge">my_topic_name</code> where are published messages of type <code class="language-plaintext highlighter-rouge">10b</code>, i.e. a message with an header field and a statically allocated array of size 10 bytes.</p>

<p>Similarly you can create a second node which publishes data periodically.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include "performance_test/performance_node_base.hpp"
auto pub_node = std::make_shared&lt;performance_test::PerformanceNode&lt;rclcpp::Node&gt;&gt;("my_pub_node");
pub_node-&gt;add_periodic_publisher("my_topic_name", std::chrono::milliseconds(100));

</code></pre></div></div>

<p><strong>Note:</strong> you can create nodes with any number of publishers/subscribers/clients/servers, with no constraints on their types.</p>

<p>Once you have defined all your nodes, you have to start them.
We provide the <code class="language-plaintext highlighter-rouge">performance_test::System</code> class for managing the nodes execution.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include "performance_test/system.hpp"
auto experiment_duration = std::chrono::seconds(10);
System ros2_system();
ros2_system.add_node(pub_node);
ros2_system.add_node(sub_node);
ros2_system.spin(experiment_duration);

</code></pre></div></div>

<p>This is enough for running your nodes.
While they communicate, they will internally record latency and reliability statistics.
At the end of the experiment, you can use the <code class="language-plaintext highlighter-rouge">performance_test::System</code> API to print them.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2_system.print_latency_stats();
ros2_system.save_latency_stats_to_file("my_output_file.txt");

</code></pre></div></div>

<p>Additionally, you can also monitor other type of statistics: resource usage and events.
Resource usage consists of <code class="language-plaintext highlighter-rouge">CPU</code> and several <code class="language-plaintext highlighter-rouge">RAM</code> metrics (heap, RSS, VRT).
Events on the other hand are for example the end of the discovery phase and late or lost messages.</p>

<p>In order to enable monitoring or resource usage you have to add the following snippet to your code:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include "performance_metrics/resource_usage_logger.hpp"
performance_metrics::ResourceUsageLogger ru_logger("resource_usage_output.txt");
auto sampling_period = std::chrono::milliseconds(500);
ru_logger.start(sampling_period);

/**
 * your code to monitor goes here
 */

ru_logger.stop();

</code></pre></div></div>

<h2 id="visualizing-the-results">Visualizing the results</h2>

<p>This repository contains Python scripts useful for plotting and aggregating data from multiple CSV files.
You can find them under <code class="language-plaintext highlighter-rouge">scripts/plot_scripts</code>.</p>

<p>Note that these scripts require <code class="language-plaintext highlighter-rouge">Python3</code> and should be run on your laptop once you have copied there the experiment results from the embedded platform.</p>

<p>There are two different types of CSV currently produced by our experiments.
For this reason we have two different scripts to plot them.</p>

<ul>
  <li>
    <p>Latency and reliability: <code class="language-plaintext highlighter-rouge">scripts/plot_scripts/latency_reliability_plot.py</code></p>
  </li>
  <li>
    <p>CPU and Memory: <code class="language-plaintext highlighter-rouge">scripts/plot_scripts/cpu_ram_plot.py</code></p>
  </li>
</ul>

<p>The two scripts share most of the code, located under <code class="language-plaintext highlighter-rouge">scripts/plot_scripts/plot_common.py</code>.
So let’s first describe some common features.</p>

<p>You have to use command line arguments to tell the script which CSV files you want to load and which data you want to plot.</p>

<p>For a full description of the command line options, as well as an up-to-date list of the accpted values, use</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 scripts/plot_scripts/cpu_ram_plot.py --help
</code></pre></div></div>

<ul>
  <li>
<strong>dir_paths</strong>: This is a mandatory positional argument which requires one or more paths to the CSV files.
 Note that it is possible to pass paths of files, directories or a mixture of them.</li>
  <li>
<strong>x</strong>: the metric to show on the X axis.</li>
  <li>
<strong>y</strong>: the metric(s) to show on the Y axis.</li>
  <li>
<strong>y2</strong>: the metric(s) to show on the secon Y axis (optional).</li>
  <li>
<strong>separator</strong>: a value according to which you want to separate your data creating different plot lines on the same axes (optional).</li>
</ul>

<p>Starting from the easy things, you may want to plot the average CPU usage of running a ROS2 system.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 scripts/plot_scripts/cpu_ram_plot.py path_to_a_csv_file --x time --y cpu
</code></pre></div></div>

<p>You can add a second metric on a second Y axis using the <code class="language-plaintext highlighter-rouge">--y2</code> option.
For example you may want to check also the pyhsical memory usage</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 scripts/plot_scripts/cpu_ram_plot.py path_to_a_csv_file --x time --y cpu --y2 rss
</code></pre></div></div>

<p>It is possible to have more than a single value plotted against the same axis.
For example you may want to check both virtual as well as physical memory usage.
Note that this is just an example, the two metrics should have values with a similar magnitude or the resulting plot will be difficult to understand.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 scripts/plot_scripts/cpu_ram_plot.py path_to_a_csv_file --x time --y cpu --y2 rss vsz
</code></pre></div></div>

<p>In all these examples, you could have also specified more than a single CSV file.
The results would have been averaged.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 scripts/plot_scripts/cpu_ram_plot.py path_to_csv_file1 path_to_csv_file2 --x time --y cpu --y2 rss vsz
</code></pre></div></div>

<p>Now let’s assume that you want to compare data coming from different experiments, i.e. for different values of number of nodes, frequencies or message sizes.
This can be done in the same plot using the <code class="language-plaintext highlighter-rouge">--separator</code> option.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>export MAX_PUBLISHERS=1
export MAX_SUBSCRIBERS=5
export NUM_EXPERIMENTS=5
export MSG_TYPES=stamped10b
export PUBLISH_FREQUENCIES=100
export DIR_PATH=my_experiment
bash scripts/pub_sub_ros2.sh

python3 scripts/plot_scripts/cpu_ram_plot.py results/my_experiment/cpu_ram_* --x time --y rss --separator subs
</code></pre></div></div>

<p>The output will be a plot with 5 different “separated” lines, one for each possible number of subscribers.
Each line will be the average of the 5 requested experiments.</p>

<p>Sometimes you may want to compare the content of different experiments directories, for example run with different DDS or ROS2 distributions.
This can still be done using the <code class="language-plaintext highlighter-rouge">--separator</code> option and setting it to <code class="language-plaintext highlighter-rouge">directory</code>.
This means that csv files will be divided according to the directory in which they are stored.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 scripts/plot_scripts/cpu_ram_plot.py results/my_experiment1/cpu_ram_* results/my_experiment2/cpu_ram_* --x time --y rss --separator directory
</code></pre></div></div>

<p>You can also specify more than one value for the <code class="language-plaintext highlighter-rouge">--separator</code> option, however, the resulting plot may become quite clogged.</p>

<p><strong>NOTE:</strong> The <code class="language-plaintext highlighter-rouge">--x time</code> value is the only one which is meaningful to use if you want to plot a single csv file.
This value can be used only with the <code class="language-plaintext highlighter-rouge">scripts/plot_scripts/cpu_ram_plot.py</code> script because latency and reliability are measured once for each node at the end of the execution so you don’t have instantaneous values.</p>

<p><strong>NOTE:</strong> When using the <code class="language-plaintext highlighter-rouge">scripts/plot_scripts/cpu_ram_plot.py</code> script, if <code class="language-plaintext highlighter-rouge">--x</code> is set to something different than <code class="language-plaintext highlighter-rouge">time</code>, you will get only 1 value out of each CSV, i.e. the average of all the lines.
Otherwise you will get one value for each line.</p>

<p>Some examples for using the <code class="language-plaintext highlighter-rouge">scripts/plot_scripts/latency_reliability_plot.py</code> script.</p>

<p>Plot the average latency for different numbers of subscriber nodes</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 scripts/plot_scripts/latency_reliability_plot.py path_to_a_csv_directory --x subs --y latency
</code></pre></div></div>

<p>Separate the values according to the number of publishers</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 scripts/plot_scripts/latency_reliability_plot.py path_to_a_csv_directory --x subs --y latency --separator pubs
</code></pre></div></div>

</div>
              </div>
            </div>
          </div>
        </div>
      
    
    <div class="row">
      <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-heading"><span class="glyphicon glyphicon-list"></span> CHANGELOG</div>
          <div class="panel-body">
            
              <em>No CHANGELOG found.</em>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="github-tutorials">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wiki Tutorials</h3>
      </div>
      <div class="panel-body">
        
        <em>This package does not provide any links to tutorials in it's <a href="https://index.ros.org/contribute/metadata/">rosindex metadata</a>.</em>
        <em>You can check on the <a href="http://wiki.ros.org/performance_test/Tutorials" target="_blank">ROS Wiki Tutorials</a> page for the package.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="github-deps">
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Package Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th class="text-center">Deps</th>
                  <th style="width: 100%">Name</th>
                </thead>
                <tbody>
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake#github-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake#github">ament_cmake  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_common#github-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_common#github">ament_lint_common  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_auto#github-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_auto#github">ament_lint_auto  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_gtest#github-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_gtest#github">ament_cmake_gtest  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_pytest#github-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_pytest#github">ament_cmake_pytest  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_cppcheck#github-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_cppcheck#github">ament_cmake_cppcheck  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_cpplint#github-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_cpplint#github">ament_cmake_cpplint  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_lint_cmake#github-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_lint_cmake#github">ament_cmake_lint_cmake  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_uncrustify#github-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_uncrustify#github">ament_cmake_uncrustify  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_xmllint#github-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_xmllint#github">ament_cmake_xmllint  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rclcpp_lifecycle#github-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rclcpp_lifecycle#github">rclcpp_lifecycle  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rclcpp#github-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rclcpp#github">rclcpp  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rclcpp_action#github-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rclcpp_action#github">rclcpp_action  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/performance_metrics#github-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/performance_metrics#github">performance_metrics  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/performance_test_msgs#github-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/performance_test_msgs#github">performance_test_msgs  </a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
          <div class="panel-heading">
            <h3 class="panel-title">System Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <em>No direct system dependencies.</em>
            
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Dependant Packages</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                  <th class="text-center">Deps</th>
                </thead>
                <tbody>
                  
                    
                    
                    <tr>
                      <td><a href="/p/performance_report#github">performance_report</a></td>
                      <td class="text-center">
                        
                        <a href="/p/performance_report#github-deps" class="endoftree">
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                    
                    
                    <tr>
                      <td><a href="/p/buildfarm_perf_tests#github">buildfarm_perf_tests</a></td>
                      <td class="text-center">
                        
                        <a href="/p/buildfarm_perf_tests#github-deps" class="endoftree">
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                    
                    
                    <tr>
                      <td><a href="/p/composition_benchmark#github">composition_benchmark</a></td>
                      <td class="text-center">
                        
                        <a href="/p/composition_benchmark#github-deps" class="endoftree">
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                    
                    
                    <tr>
                      <td><a href="/p/irobot_benchmark#github">irobot_benchmark</a></td>
                      <td class="text-center">
                        
                        <a href="/p/irobot_benchmark#github-deps" class="endoftree">
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                    
                    
                    <tr>
                      <td><a href="/p/performance_test_examples#github">performance_test_examples</a></td>
                      <td class="text-center">
                        
                        <a href="/p/performance_test_examples#github-deps" class="endoftree">
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                    
                    
                    <tr>
                      <td><a href="/p/performance_test_factory#github">performance_test_factory</a></td>
                      <td class="text-center">
                        
                        <a href="/p/performance_test_factory#github-deps" >
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                    
                    
                    <tr>
                      <td><a href="/p/performance_test_plugin_cmake#github">performance_test_plugin_cmake</a></td>
                      <td class="text-center">
                        
                        <a href="/p/performance_test_plugin_cmake#github-deps" >
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="github-assets">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Launch files</h3>
      </div>
      <div class="panel-body">
        
          <em>No launch files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Messages</h3>
      </div>
      <div class="panel-body">
        
          <em>No message files found.</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Services</h3>
      </div>
      <div class="panel-body">
        
          <em>No service files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Plugins</h3>
      </div>
      <div class="panel-body">
        
          <em>No plugins found.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="github-questions">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent questions tagged <kbd>performance_test</kbd> at <strong><a href="https://robotics.stackexchange.com/" target="_blank">Robotics Stack Exchange</a></strong></h3>      </div>
      <div id="github-question-list" class="panel-body" style="display: none;"></div>
      <div id="github-no-question-list" class="panel-body" style="display: none;">
        <p>No questions yet, you can ask one <a href="https://robotics.stackexchange.com/questions/tagged/performance_test+github">here</a>.</p>
      </div>
      <div id="github-get-question-fail" class="panel-body alert alert-warning" style="display: none;">
        <p>Failed to get question list, you can ticket an issue <a href="https://github.com/ros-infrastructure/rosindex/issues/new" target="_blank" class="alert-link">here</a> </p>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/package_body_tabs.js"></script>

<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
jQuery(function() {
    // Update the count on the links to the contribution suggestions
    updateContributionSuggestionsCountOnPackage('https://github.com/irobot-ros/ros2-performance.git');
});
</script>

          </div>
          <div class="col-md-2 hidden-xs hidden-sm">
            
            
            



<div class="list-group list-group-sm ">
  <a class="list-group-item"
     target="_blank"
     href="http://docs.ros.org/en/github/p/performance_test"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       
       API Docs
  </a>
  <a class="list-group-item"
     target="_blank"
     href="https://github.com/irobot-ros/ros2-performance/tree/rolling/performance_test"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       
       Browse Code
  </a>
  
  
  
  
  
  
</div>

          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-noetic">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>noetic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-galactic">
    <div class="container-fluid">
      
        
        
        

        <div class="row">
          <div class="col-md-10">
            

<div class="well well-sm">
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px" src="/assets/package.png">
      </td>
      <td>
        <h3 style="margin-top: 5px">
          <a style="text-decoration:none" href="/p/performance_test">performance_test</a> <small>package from <a style="text-decoration:none" href="/r/performance_test/gitlab-ApexAI-performance_test">performance_test</a> repo</small>
        </h3>
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_report">

performance_report
</a>
            
          
            
            
              <span class="label label-default pkg-label">

performance_test
</span>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_test_ros1_msgs">

performance_test_ros1_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_test_ros1_publisher">

performance_test_ros1_publisher
</a>
            
          
      </td>
    </tr>
  </table>
</div>

            <div class="visible-xs visible-sm">
              
              
              



<div class="list-group list-group-sm list-group-horizontal list-group-justified">
  <a class="list-group-item text-center"
     target="_blank"
     href="http://docs.ros.org/en/galactic/p/performance_test"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       <br>
       API Docs
  </a>
  <a class="list-group-item text-center"
     target="_blank"
     href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       <br>
       Browse Code
  </a>
  
  
  
  
  
  
</div>

            </div>
            



<ul class="nav nav-tabs nav-justified" id="galactic-tabs" style="margin-bottom:20px">
  <li class="better-tabs active">
    <a href="#galactic-overview" data-toggle="tab">Overview</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    
    <a href="#galactic-assets" data-toggle="tab"><span class="label label-default">0</span> Assets</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    <a href="#galactic-deps" data-toggle="tab"><span class="label label-primary">10</span> Dependencies</a>
  </li>
  <li class="better-tabs">
    
    <a href="#galactic-tutorials" data-toggle="tab"><span class="label label-default">0</span> Tutorials</a>
  </li>
  <li class="better-tabs">
    <a href="#galactic-questions" data-toggle="tab"><span id="galactic-questions-count" class="label label-primary">0</span> Q & A</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="galactic-overview">
    
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h4 class="panel-title">Package Summary</h4></div>
          <div class="panel-body">
            <table class="table table-condensed">
              <tr>
                <td style="width:100px;" class="text-right"><strong>Tags</strong></td>
                <td>
                  
                  
                    <em>No category tags.</em>
                  
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Version</strong></td>
                <td>2.3.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>License</strong></td>
                <td>Apache 2.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>Build type</strong></td>
                <td>
                  
                    <span class="label label-default">
                  
                    AMENT_CMAKE</span>
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Use</strong></td>
                <td>
                
                  <span class="label label-success">RECOMMENDED</span>
                
                </td>
              </tr>
            </table>
          </div>
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body">
            
            
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default"></span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://gitlab.com/ApexAI/performance_test.git">https://gitlab.com/ApexAI/performance_test.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">master</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-03-25
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="No CI information available for this package.">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/performance_test/#galactic-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/performance_test/#galactic-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/performance_test/#galactic-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Package Description</h3></div>
          <div class="panel-body">
            Tool to test performance of ROS 2 and DDS data layers and communication.
          </div>
          <div class="panel-heading"><h4 class="panel-title">Additional Links</h4></div>
          <div class="panel-body">
            
            
              <em>No additional links.</em>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Maintainers</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Apex.AI, Inc.</li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Authors</h4></div>
          <div class="panel-body">
            
            
              <em>No additional authors.</em>
            
          </div>
        </div>
      </div>
    </div>
    
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-heading"><span class="glyphicon glyphicon-file"></span><a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/README.md" title="Open in git repository">performance_test/README.md</a></div>
              <div class="panel-body">
                    <div class="rendered-markdown">
<h1 id="performance_test">performance_test</h1>

<p>[TOC]</p>

<p>The performance_test tool tests latency and other performance metrics of <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">various middleware
implementations</a> that support a pub/sub pattern. It is used to simulate
non-functional performance of your application.</p>

<p>The performance_test tool allows you to quickly set up a pub/sub configuration,
e.g. number of publisher/subscribers, message size, QOS settings, middleware. The following metrics
are automatically recorded when the application is running:</p>

<ul>
  <li>
<strong>latency</strong>: corresponds to the time a message takes to travel from a publisher to subscriber. The
latency is measured by timestamping the sample when it’s published and subtracting the timestamp
  (from the sample) from the measured time when the sample arrives at the subscriber (only logged when a subscriber is created)</li>
  <li>
<strong>CPU usage</strong>: percentage of the total system wide CPU usage (logged separately for each instance of <code class="language-plaintext highlighter-rouge">perf_test</code>)</li>
  <li>
<strong>resident memory</strong>: heap allocations, shared memory segments, stack (used for system’s internal
work) (logged separately for each instance of <code class="language-plaintext highlighter-rouge">perf_test</code>)</li>
  <li>
<strong>sample statistics</strong>: number of samples received, sent, and lost per experiment run.</li>
</ul>

<p>This <code class="language-plaintext highlighter-rouge">master</code> branch is compatible with the following ROS 2 versions</p>
<ul>
  <li>rolling</li>
  <li>jazzy</li>
  <li>iron</li>
  <li>humble</li>
  <li>galactic</li>
  <li>foxy</li>
  <li>eloquent</li>
  <li>dashing</li>
  <li>Apex.OS</li>
</ul>

<h2 id="how-to-use-this-document">How to use this document</h2>

<ol>
  <li>Start <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#example">here</a> for a quick example of building and running the performance_test tool
with the Cyclone DDS plugin.</li>
  <li>If needed, find more detailed information about <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#building-the-performance_test-tool">building</a>
and <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#running-an-experiment">running</a>
</li>
  <li>Or, if the quick example is good enough, skip ahead to the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">list of supported middleware
plugins</a> to learn how to test a specific middleware implementation.</li>
  <li>Check out the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#analyze-the-results">tools for visualizing the results</a>
</li>
  <li>If desired, read about the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#architecture">design and architecture</a> of the tool.</li>
</ol>

<h2 id="example">Example</h2>

<p>This example shows how to test the non-functional performance of the following configuration:</p>

<table>
  <thead>
    <tr>
      <th>Option</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Plugin</td>
      <td>Cyclone DDS</td>
    </tr>
    <tr>
      <td>Message type</td>
      <td>Array1k</td>
    </tr>
    <tr>
      <td>Publishing rate</td>
      <td>100Hz</td>
    </tr>
    <tr>
      <td>Topic name</td>
      <td>test_topic</td>
    </tr>
    <tr>
      <td>Duration of the experiment</td>
      <td>30s</td>
    </tr>
    <tr>
      <td>Number of publisher(s)</td>
      <td>1 (default)</td>
    </tr>
    <tr>
      <td>Number of subscriber(s)</td>
      <td>1 (default)</td>
    </tr>
  </tbody>
</table>

<ol>
  <li>
    <p>Install <a href="https://docs.ros.org/en/rolling/index.html">ROS 2</a></p>
  </li>
  <li>
    <p>Install <a href="https://github.com/eclipse-cyclonedds/cyclonedds">Cyclone DDS</a> to /opt/cyclonedds</p>
  </li>
  <li>
    <p>Build performance_test with the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#eclipse-cyclone-dds">CMake build flag</a> for Cyclone DDS:</p>
  </li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nb">source</span> /opt/ros/rolling/setup.bash
    <span class="nb">cd</span> ~/perf_test_ws
    colcon build <span class="nt">--cmake-args</span> <span class="nt">-DPERFORMANCE_TEST_PLUGIN</span><span class="o">=</span>CYCLONEDDS
    <span class="nb">source</span> ./install/setup.bash
    
</code></pre></div></div>

<ol>
  <li>Run with the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#eclipse-cyclone-dds">communication plugin option</a> for Cyclone DDS:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>experiment
./install/performance_test/lib/performance_test/perf_test <span class="nt">--communication</span> CycloneDDS
                                                          <span class="nt">--msg</span> Array1k
                                                          <span class="nt">--rate</span> 100
                                                          <span class="nt">--topic</span> test_topic
                                                          <span class="nt">--max-runtime</span> 30
                                                          <span class="nt">--logfile</span> experiment/log.csv

</code></pre></div></div>

<p>At the end of the experiment, a CSV log file will be generated in the experiment folder with a name
that starts with <code class="language-plaintext highlighter-rouge">log</code>.</p>

<h2 id="building-the-performance_test-tool">Building the performance_test tool</h2>

<p>For a simple example, see <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.rclcpp">Dockerfile.rclcpp</a>.</p>

<p>The performance_test tool is structured as a ROS 2 package, so <code class="language-plaintext highlighter-rouge">colcon</code> is used to build it.
Therefore, you must source a ROS 2 installation:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">source</span> /opt/ros/rolling/setup.bash

</code></pre></div></div>

<p>Select a middleware plugin from <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">this list</a>.
Then build the performance_test tool with the selected middleware:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> ~/perf_test_ws/src
<span class="nb">cd</span> ~/perf_test_ws/src
git clone https://gitlab.com/ApexAI/performance_test.git
<span class="nb">cd</span> ..
<span class="c"># At this stage, you need to choose which middleware you want to use</span>
<span class="c"># The list of available flags is described in the middleware plugins section</span>
<span class="c"># Square brackets denote optional arguments, like in the Python documentation.</span>
colcon build <span class="nt">--cmake-args</span> <span class="nt">-DCMAKE_BUILD_TYPE</span><span class="o">=</span>Release <span class="nt">-DPERFORMANCE_TEST_PLUGIN</span><span class="o">=</span>&lt;plugin&gt;
<span class="nb">source install</span>/setup.bash

</code></pre></div></div>

<h2 id="running-an-experiment">Running an experiment</h2>

<p>The performance_test experiments are run through the <code class="language-plaintext highlighter-rouge">perf_test</code> executable.
To find the available settings, run with <code class="language-plaintext highlighter-rouge">--help</code> (note the required and default arguments):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~/perf_test_ws<span class="nv">$ </span>./install/performance_test/lib/performance_test/perf_test <span class="nt">--help</span>

</code></pre></div></div>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">-c</code> argument should match the selected <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">middleware plugin</a>
from the build phase.</li>
  <li>The <code class="language-plaintext highlighter-rouge">--msg</code> argument should be one of the supported message types, which are shown
in the <code class="language-plaintext highlighter-rouge">--help</code> output.</li>
</ul>

<h3 id="single-machine-or-distributed-system">Single machine or distributed system?</h3>

<p>Based on the configuration you want to test, the usage of the performance_test tool differs. The
different possibilities are explained below.</p>

<p>For running tests on a single machine, you can choose between the following options:</p>

<ol>
  <li>Intraprocess means that the publisher and subscriber threads are in the same process.</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    perf_test &lt;options&gt; <span class="nt">--num-sub-threads</span> 1 <span class="nt">--num-pub-threads</span> 1
    
</code></pre></div></div>

<ol>
  <li>Interprocess means that the publisher and subscriber are in different processes. To test
interprocess communication, two instances of the performance_test must be run, e.g.</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c"># Start the subscriber first</span>
    perf_test &lt;options&gt; <span class="nt">--num-sub-threads</span> 1 <span class="nt">--num-pub-threads</span> 0 &amp;
    <span class="nb">sleep </span>1  <span class="c"># give the subscriber time to finish initializing</span>
    perf_test &lt;options&gt; <span class="nt">--num-sub-threads</span> 0 <span class="nt">--num-pub-threads</span> 1
    
</code></pre></div></div>

<p>On a distributed system, testing latency is difficult, because the clocks are probably not
perfectly synchronized between the two devices. To work around this, the performance_test tool
supports relay mode, which allows for a round-trip style of communication:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># On the main machine</span>
perf_test &lt;options&gt; <span class="nt">--roundtrip-mode</span> Main

<span class="c"># On the relay machine:</span>
perf_test &lt;options&gt; <span class="nt">--roundtrip-mode</span> Relay

</code></pre></div></div>

<p>In relay mode, the Main machine sends messages to the Relay machine, which immediately sends the
messages back. The Main machine receives the relayed message, and reports the round-trip latency.
Therefore, the reported latency will be roughly double the latency compared to the latency reported
in non-relay mode.</p>

<h3 id="single-machine-single-thread">Single machine, single thread</h3>

<p>An intra-thread configuration is experimentally supported, in which a publisher and subscriber
both operate in the same thread. The publisher writes a messages, and the subscriber immediately
takes it.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>perf_test &lt;options&gt; <span class="nt">-e</span> INTRA_THREAD

</code></pre></div></div>

<p>Notes:</p>

<ol>
  <li>This is only available when zero copy transfer is enabled</li>
  <li>This requires exactly one publisher and one subscriber</li>
  <li>This is not compatible with roundtrip mode</li>
</ol>

<h2 id="middleware-plugins">Middleware plugins</h2>

<p>The performance test tool can measure the performance of a variety of communication solutions
from different vendors. In this case there is no rclcpp or rmw layer overhead over the publisher
and subscriber routines.</p>

<p>The performance_test tool implements an executor that runs the publisher(s) and/or the subscriber(s) in
their own thread.</p>

<p>The following plugins are currently implemented:</p>

<h3 id="eclipse-cyclone-dds">Eclipse Cyclone DDS</h3>

<ul>
  <li><a href="https://github.com/eclipse-cyclonedds/cyclonedds/tree/0.9.0b1">Eclipse Cyclone DDS 0.9.0b1</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CYCLONEDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c CycloneDDS</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.CycloneDDS">Dockerfile.CycloneDDS</a>
</li>
  <li>Available transports:
    <ul>
      <li>Cyclone DDS zero copy requires
<a href="https://github.com/eclipse-iceoryx/iceoryx/blob/master/doc/website/getting-started/overview.md#roudi">RouDi</a>
to be running.
-
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP |</li>
    </ul>
  </li>
</ul>

<h3 id="eclipse-cyclone-dds-c-binding">Eclipse Cyclone DDS C++ binding</h3>

<ul>
  <li><a href="https://github.com/eclipse-cyclonedds/cyclonedds-cxx/tree/0.9.0b1">Eclipse Cyclone DDS C++ bindings 0.9.0b1</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CYCLONEDDS_CXX</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c CycloneDDS-CXX</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.CycloneDDS-CXX">Dockerfile.CycloneDDS-CXX</a>
</li>
  <li>Available transports:
    <ul>
      <li>Cyclone DDS zero copy requires the
<a href="https://github.com/eclipse-iceoryx/iceoryx/blob/master/doc/website/getting-started/overview.md#roudi">RouDi</a>
to be running.
-
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP |</li>
    </ul>
  </li>
</ul>

<h3 id="eclipse-iceoryx">Eclipse iceoryx</h3>

<ul>
  <li><a href="https://github.com/eclipse-iceoryx/iceoryx/tree/5fe215eab267b0ad68bc5552aecd4b6e728e4c99">iceoryx (latest master as of Feb 13)</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=ICEORYX</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c iceoryx</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.iceoryx">Dockerfile.iceoryx</a>
</li>
  <li>The iceoryx plugin is not a DDS implementation.
    <ul>
      <li>The DDS-specific options (such as domain ID, durability, and reliability) do not apply.</li>
    </ul>
  </li>
  <li>To run with the iceoryx plugin,
<a href="https://github.com/eclipse-iceoryx/iceoryx/blob/master/doc/website/getting-started/overview.md#roudi">RouDi</a>
must be running.</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|———–|———————|———————————–|
| LoanedSamples | LoanedSamples | Not supported by performance_test |</li>
</ul>

<h3 id="eprosima-fast-dds">eProsima Fast DDS</h3>

<ul>
  <li><a href="https://github.com/eProsima/Fast-DDS/tree/v2.6.2">FastDDS 2.6.2</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=FASTDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c FastRTPS</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.FastDDS">Dockerfile.FastDDS</a>
</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA (default), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | SHMEM (default), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP |</li>
</ul>

<h3 id="oci-opendds">OCI OpenDDS</h3>

<ul>
  <li><a href="https://github.com/objectcomputing/OpenDDS/tree/DDS-3.13.2">OpenDDS 3.13.2</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=OPENDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c OpenDDS</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.OpenDDS">Dockerfile.OpenDDS</a>
</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| TCP   | TCP                 | TCP                |</li>
</ul>

<h3 id="rti-connext-dds">RTI Connext DDS</h3>

<ul>
  <li><a href="https://www.rti.com/products/connext-dds-professional">RTI Connext DDS 5.3.1+</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CONNEXTDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c ConnextDDS</code>
</li>
  <li>Docker file: Not available</li>
  <li>A license is required</li>
  <li>You need to source an RTI Connext DDS environment.
    <ul>
      <li>If RTI Connext DDS was installed with ROS 2 (Linux only):
        <ul>
          <li><code class="language-plaintext highlighter-rouge">source /opt/rti.com/rti_connext_dds-5.3.1/setenv_ros2rti.bash</code></li>
        </ul>
      </li>
      <li>If RTI Connext DDS is installed separately, you can source the following script to set the
environment:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">source &lt;connextdds_install_path&gt;/resource/scripts/rtisetenv_&lt;arch&gt;.bash</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA | SHMEM               | UDP                |</li>
</ul>

<h3 id="rti-connext-dds-micro">RTI Connext DDS Micro</h3>

<ul>
  <li><a href="https://www.rti.com/products/connext-dds-micro">Connext DDS Micro 3.0.3</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CONNEXTDDSMICRO</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c ConnextDDSMicro</code>
</li>
  <li>Docker file: Not available</li>
  <li>A license is required</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA | SHMEM               | UDP                |</li>
</ul>

<h2 id="framework-plugins">Framework plugins</h2>

<p>The performance_test tool can also measure the end-to-end latency of a framework. In this case, the
executor of the framework is used to run the publisher(s) and/or the subscriber(s). The potential overhead of the <a href="http://docs.ros2.org/beta2/developer_overview.html#internal-api-architecture-overview">rclcpp or rmw
layer</a> is measured.</p>

<h3 id="ros-2">ROS 2</h3>

<p>The performance test tool can also measure the performance of a variety of RMW implementations,
through the ROS 2 <code class="language-plaintext highlighter-rouge">rclcpp::publisher</code> and <code class="language-plaintext highlighter-rouge">rclcpp::subscriber</code> API.</p>

<ul>
  <li><a href="https://docs.ros.org/en/rolling/Tutorials/Writing-A-Simple-Cpp-Publisher-And-Subscriber.html">ROS 2 <code class="language-plaintext highlighter-rouge">rclcpp::publisher</code> and <code class="language-plaintext highlighter-rouge">rclcpp::subscriber</code></a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=ROS2</code> (default)</li>
  <li>Communication plugin:
    <ul>
      <li>Callback with Single Threaded Executor: <code class="language-plaintext highlighter-rouge">-c rclcpp-single-threaded-executor</code>
</li>
      <li>Callback with Static Single Threaded Executor: <code class="language-plaintext highlighter-rouge">-c rclcpp-static-single-threaded-executor</code>
</li>
      <li>
<a href="https://github.com/ros2/rclcpp/pull/1047"><code class="language-plaintext highlighter-rouge">rclcpp::WaitSet</code></a>: <code class="language-plaintext highlighter-rouge">-c rclcpp-waitset</code>
</li>
    </ul>
  </li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.rclcpp">Dockerfile.rclcpp</a>
</li>
  <li>
<a href="https://docs.ros.org/en/rolling/Concepts/About-Different-Middleware-Vendors.html">Available underlying RMW implementations</a>:
    <ul>
      <li>ROS 2 Rolling is pre-configured to use <code class="language-plaintext highlighter-rouge">rmw_fastrtps_cpp</code>
</li>
      <li>Follow <a href="https://docs.ros.org/en/rolling/Guides/Working-with-multiple-RMW-implementations.html">these instructions</a>
  to use a different RMW implementation</li>
    </ul>
  </li>
  <li>Available transports: depends on underlying RMW implementation
    <ul>
      <li>LoanedSamples are available (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) for <code class="language-plaintext highlighter-rouge">ROS_DISTRO = foxy</code> and above</li>
    </ul>
  </li>
</ul>

<h3 id="apexos">Apex.OS</h3>

<ul>
  <li>Apex.OS</li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=APEX_OS</code>
    <ul>
      <li>It is also required to <code class="language-plaintext highlighter-rouge">source /opt/ApexOS/setup.bash</code> instead of a ROS 2 distribution</li>
    </ul>
  </li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c ApexOSPollingSubscription</code>
</li>
  <li>Docker file: Not available</li>
  <li>Available underlying RMW implementations: <code class="language-plaintext highlighter-rouge">rmw_apex_middleware</code>
</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero_copy</code>) | UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero_copy</code>) | UDP |</li>
</ul>

<h2 id="analyze-the-results">Analyze the results</h2>

<p>After an experiment is run with the <code class="language-plaintext highlighter-rouge">-l</code> flag, a log file is recorded. Both CSV
and JSON formats are supported. It is possible to add custom data to the log
file by setting the<code class="language-plaintext highlighter-rouge">APEX_PERFORMANCE_TEST</code> environment variable before running
an experiment, e.g.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">#</span><span class="w"> </span><span class="err">JSON</span><span class="w"> </span><span class="err">format</span><span class="w">
</span><span class="err">export</span><span class="w"> </span><span class="err">APEX_PERFORMANCE_TEST=</span><span class="s2">"
{
</span><span class="se">\"</span><span class="s2">My Version</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">1.0.4</span><span class="se">\"</span><span class="s2">,
</span><span class="se">\"</span><span class="s2">My Image Version</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">5.2</span><span class="se">\"</span><span class="s2">,
</span><span class="se">\"</span><span class="s2">My OS Version</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">Ubuntu 16.04</span><span class="se">\"</span><span class="s2">
}
"</span><span class="w">

</span></code></pre></div></div>

<h2 id="plot-the-results">Plot the results</h2>

<p>To plot the results in the JSON or CSV log files, see the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/../plotter">plotter README</a>.</p>

<h2 id="architecture">Architecture</h2>

<p>Apex.AI’s <em>Performance Testing in ROS 2</em> white paper
(<a href="https://drive.google.com/file/d/15nX80RK6aS8abZvQAOnMNUEgh7px9V5S/view">available here</a>)
describes how to design a fair and unbiased performance test, and is the basis for this project.</p>
<center><img src="https://gitlab.com/ApexAI/performance_test/-/raw/master/performance_test/architecture.png"></center>

<p>Each middleware has a different API. Thanks to the <code class="language-plaintext highlighter-rouge">Plugin</code> abstraction, the core logic of
setting up and running an experiment is completely decoupled from the implementation details
of sending and receiving individual messages.</p>

<p>Exactly one <code class="language-plaintext highlighter-rouge">Plugin</code> implementation is selected at build time. The design is similar to the
<a href="https://refactoring.guru/design-patterns/abstract-factory">Abstract Factory pattern</a>.
<code class="language-plaintext highlighter-rouge">performance_test</code> declares, but does not define, a static factory method in the <code class="language-plaintext highlighter-rouge">PluginFactory</code>
class. Each middleware provides a definition for this factory method to create a concrete <code class="language-plaintext highlighter-rouge">Plugin</code>
implementation, and <code class="language-plaintext highlighter-rouge">perf_test</code> calls this factory method directly.</p>

<p>An example plugin is available <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/plugins/demo">here</a>.</p>

<h2 id="performance-optimizations">Performance optimizations</h2>

<ul>
  <li>On linux-based platforms, <code class="language-plaintext highlighter-rouge">perf_test</code> writes <code class="language-plaintext highlighter-rouge">0</code> to <code class="language-plaintext highlighter-rouge">/dev/cpu_dma_latency</code>
and holds open the file handle, which will prevent the CPU from entering any
idle states for the duration of the experiment. This should result in lower
message latency and lower variance in that latency.</li>
</ul>

<h2 id="future-extensions-and-limitations">Future extensions and limitations</h2>

<ul>
  <li>Communication frameworks like DDS have a huge amount of settings. This tool only allows the most
common QOS settings to be configured. The other QOS settings are hardcoded in the application.</li>
  <li>Only one publisher per topic is allowed, because the data verification logic does not support
matching data to the different publishers.</li>
  <li>Some communication plugins can get stuck in their internal loops if too much data is received.
Figuring out ways around such issues is one of the goals of this tool.</li>
  <li>FastRTPS wait-set does not support timeouts which can lead to the receiving not aborting. In that
case the performance test must be manually killed.</li>
  <li>Using Connext DDS Micro INTRA transport with <code class="language-plaintext highlighter-rouge">reliable</code> QoS and history kind set to <code class="language-plaintext highlighter-rouge">keep_all</code>
<a href="https://community.rti.com/static/documentation/connext-micro/3.0.3/doc/html/usersmanual/transports/INTRA.html#reliability-and-durability">is not supported with Connext
Micro</a>.
Set <code class="language-plaintext highlighter-rouge">keep-last</code> as QoS history kind always when using <code class="language-plaintext highlighter-rouge">reliable</code>.</li>
</ul>

<p>Possible additional communication which could be implemented are:</p>

<ul>
  <li>Raw UDP communication</li>
</ul>

<h2 id="building-with-limited-resources">Building with limited resources</h2>

<p>When building this tool, the compiler must perform a lot of template expansion. This can be
overwhelming for a system with a low-power CPU or limited RAM. There are some additional CMake
options which can reduce the system load during compilation:</p>

<ol>
  <li>This tool includes many different message types, each with many different sizes. Reduce the number of
messages, and thus the compilation load, by disabling one or more message types. For example, to build
without <code class="language-plaintext highlighter-rouge">PointCloud</code> messages, add <code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_POINDCLOUD=OFF</code> to the <code class="language-plaintext highlighter-rouge">--cmake-args</code>. The message types,
and their options for enabling/disabling, can be found <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/performance_test/msg/CMakeLists.txt">here</a>.</li>
</ol>
</div>
              </div>
            </div>
          </div>
        </div>
      
    
    <div class="row">
      <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-heading"><span class="glyphicon glyphicon-list"></span> CHANGELOG</div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="changelog-for-package-performance_test">Changelog for package performance_test</h1>

<h2 id="xyz-yyyymmdd">X.Y.Z (YYYY/MM/DD)</h2>

<h2 id="230-20240924">2.3.0 (2024/09/24)</h2>

<h3 id="removed">Removed</h3>
<ul>
  <li>Moved <code class="language-plaintext highlighter-rouge">apex_performance_plotter</code> to its own package <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/../plotter">here</a>
</li>
</ul>

<h2 id="220-20240515">2.2.0 (2024/05/15)</h2>

<h3 id="added">Added</h3>
<ul>
  <li>performance_test can be built with ROS 2 Iron and Jazzy
    <h3 id="changed">Changed</h3>
  </li>
  <li>Renamed the <code class="language-plaintext highlighter-rouge">--dds-domain_id</code> CLI arg to <code class="language-plaintext highlighter-rouge">--dds-domain-id</code>
</li>
  <li>When <code class="language-plaintext highlighter-rouge">--dds-domain-id</code> is unspecified, fall back to the <code class="language-plaintext highlighter-rouge">ROS_DOMAIN_ID</code> environment variable</li>
  <li>
<code class="language-plaintext highlighter-rouge">--zero-copy</code> has been separated into two flags:
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">--shared-memory</code>: Enable shared-memory transfer in the plugin. This is meant to replace the
need to manually set runtime flags via <code class="language-plaintext highlighter-rouge">CYCLONEDDS_URI</code>, <code class="language-plaintext highlighter-rouge">APEX_MIDDLEWARE_SETTINGS</code>, etc.</li>
      <li>
<code class="language-plaintext highlighter-rouge">--loaned-samples</code>: When publishing messages in the plugin, borrow loaned samples instead
of publishing by copy</li>
      <li>
<code class="language-plaintext highlighter-rouge">--zero-copy</code> is now an alias for <code class="language-plaintext highlighter-rouge">--shared-memory --loaned-samples</code>
</li>
      <li>Supported plugins include:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">-c CycloneDDS</code></li>
          <li><code class="language-plaintext highlighter-rouge">-c CycloneDDS-CXX</code></li>
          <li><code class="language-plaintext highlighter-rouge">-c ApexOSPollingSubscription</code></li>
          <li>
<code class="language-plaintext highlighter-rouge">-c rclcpp-*</code> with <code class="language-plaintext highlighter-rouge">RMW_IMPLEMENTATION=rmw_cyclonedds_cpp</code>
</li>
          <li>
<code class="language-plaintext highlighter-rouge">-c rclcpp-*</code> with <code class="language-plaintext highlighter-rouge">RMW_IMPLEMENTATION=rmw_fastrtps_cpp</code>
</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="210-20240417">2.1.0 (2024/04/17)</h2>

<h3 id="added-1">Added</h3>
<ul>
  <li>Add new function <code class="language-plaintext highlighter-rouge">prepare()</code> to the Publisher and Subscriber API, intended
to allow participant discovery without blocking the main thread
    <h3 id="changed-1">Changed</h3>
  </li>
  <li>Change the default <code class="language-plaintext highlighter-rouge">--history</code> arg from <code class="language-plaintext highlighter-rouge">KEEP_ALL</code> to <code class="language-plaintext highlighter-rouge">KEEP_LAST</code>
</li>
  <li>Change the default <code class="language-plaintext highlighter-rouge">--history-depth</code> arg from <code class="language-plaintext highlighter-rouge">1000</code> to <code class="language-plaintext highlighter-rouge">16</code>
</li>
  <li>If <code class="language-plaintext highlighter-rouge">--expected-num-pubs</code> is unspecified, set it to the same value as <code class="language-plaintext highlighter-rouge">-p</code>
</li>
  <li>If <code class="language-plaintext highlighter-rouge">--expected-num-subs</code> is unspecified, set it to the same value as <code class="language-plaintext highlighter-rouge">-s</code>
    <h3 id="fixed">Fixed</h3>
  </li>
  <li>Removed an unused variable to fix a Clang build</li>
  <li>Remove unused variable names in the <code class="language-plaintext highlighter-rouge">Plugin</code> abstract class</li>
  <li>Fix a potential lockup in PublisherTask on QNX</li>
</ul>

<h2 id="200-20240319">2.0.0 (2024/03/19)</h2>

<h3 id="added-2">Added</h3>
<ul>
  <li>Add experimental bazel support
    <ul>
      <li><code class="language-plaintext highlighter-rouge">bazel build //performance_test --//:plugin_implementation=//path/to/a/plugin</code></li>
    </ul>
  </li>
  <li>Add a rudimentary socket-based plugin for testing the bazel support
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">bazel run //performance_test --//:plugin_implementation=//performance_test/plugins/demo:demo_plugin -- --help</code>
        <h3 id="changed-2">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Instead of enabling/disabling each plugin, you select exactly one
with a CMake string option, for example:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">colcon build --cmake-args -DPERFORMANCE_TEST_PLUGIN=ROS2</code></li>
    </ul>
  </li>
  <li>Renamed the <code class="language-plaintext highlighter-rouge">--communication</code> CLI arg to <code class="language-plaintext highlighter-rouge">--communicator</code>. The short <code class="language-plaintext highlighter-rouge">-c</code> is unchanged.
    <h3 id="removed-1">Removed</h3>
  </li>
  <li>Removed the deprecated CLI flags for QOS settings:
    <ul>
      <li>Instead of <code class="language-plaintext highlighter-rouge">--reliable</code>, use <code class="language-plaintext highlighter-rouge">--reliability RELIABLE</code>
</li>
      <li>Instead of <code class="language-plaintext highlighter-rouge">--transient</code>, use <code class="language-plaintext highlighter-rouge">--durability TRANSIENT_LOCAL</code>
</li>
      <li>Instead of <code class="language-plaintext highlighter-rouge">--keep-last</code>, use <code class="language-plaintext highlighter-rouge">--history KEEP_LAST</code>
</li>
    </ul>
  </li>
  <li>Removed the obsolete <code class="language-plaintext highlighter-rouge">BoundedSequenceFlat</code> messages</li>
  <li>Removed the superfluous <code class="language-plaintext highlighter-rouge">--msg-list</code> CLI flag. The <code class="language-plaintext highlighter-rouge">--help</code> message
already lists the available messages.
    <h3 id="fixed-1">Fixed</h3>
  </li>
  <li>Update the Apex.OS Runner to use <code class="language-plaintext highlighter-rouge">executor_runner::deferred</code> instead of <code class="language-plaintext highlighter-rouge">executor_runner::deferred_tag()</code>
</li>
  <li>Ensure that the first few published samples are sent at the expected rate</li>
</ul>

<h2 id="152-yyyymmdd">1.5.2 (YYYY/MM/DD)</h2>

<h3 id="added-3">Added</h3>
<ul>
  <li>
<code class="language-plaintext highlighter-rouge">--prevent-cpu-idle</code> is available on QNX
    <h3 id="changed-3">Changed</h3>
  </li>
  <li>JSON log files will contain all values in the <code class="language-plaintext highlighter-rouge">APEX_PERFORMANCE_TEST</code> dictionary, instead of the
five specific values used previously</li>
  <li>Switch to build as C++17 by default
    <h3 id="fixed-2">Fixed</h3>
  </li>
  <li>Zero copy transfer is again enabled for the rclcpp publisher</li>
</ul>

<h2 id="150-20230614">1.5.0 (2023/06/14)</h2>

<h3 id="added-4">Added</h3>
<ul>
  <li>New CLI switch <code class="language-plaintext highlighter-rouge">--prevent-cpu-idle</code> (linux only). When specified,
perf_test will use <code class="language-plaintext highlighter-rouge">/dev/cpu_dma_latency</code> to request that the CPU not enter
any sleep states, to potentially give more consistent results</li>
  <li>Some smaller <code class="language-plaintext highlighter-rouge">Array</code> messages, down to 32 bits</li>
  <li>Added support to the FastDDS plugin for bounded and unbounded sequences
    <h3 id="changed-4">Changed</h3>
  </li>
  <li>Update the README to better explain how to use this tool with Apex.OS</li>
  <li>In the <code class="language-plaintext highlighter-rouge">Runner</code>, allocate the <code class="language-plaintext highlighter-rouge">AnalysisResult</code>s on the stack instead of using <code class="language-plaintext highlighter-rouge">shared_ptr</code>
</li>
  <li>
<code class="language-plaintext highlighter-rouge">Subscriber</code> methods accept a callback parameter, instead of returning a
<code class="language-plaintext highlighter-rouge">vector</code> of results, to reduce heap usage</li>
  <li>Refactored the interaction between <code class="language-plaintext highlighter-rouge">SubscriberStats</code> and <code class="language-plaintext highlighter-rouge">AnalysisResult</code> to
remove the need for a <code class="language-plaintext highlighter-rouge">std::vector</code> of latency samples, to reduce heap usage</li>
  <li>Adjusted the <code class="language-plaintext highlighter-rouge">Array</code> message sizes to make the name match the contents</li>
  <li>Updated <code class="language-plaintext highlighter-rouge">apex_os_communicator</code> to use the new zero-copy API</li>
</ul>

<h2 id="142-20230315">1.4.2 (2023/03/15)</h2>

<h3 id="added-5">Added</h3>
<ul>
  <li>Added <code class="language-plaintext highlighter-rouge">perfplot</code> support for JSON log files
    <h3 id="changed-5">Changed</h3>
  </li>
  <li>Migrate the Apex.OS target to use <code class="language-plaintext highlighter-rouge">rosidl_get_typesupport_target</code>
</li>
  <li>Preallocate the JSON logger’s string buffer to prevent reallocations after the experiment begins</li>
</ul>

<h2 id="141-20230223">1.4.1 (2023/02/23)</h2>

<h3 id="changed-6">Changed</h3>
<ul>
  <li>Updated the iceoryx plugin to the <a href="https://github.com/eclipse-iceoryx/iceoryx/tree/5fe215eab267b0ad68bc5552aecd4b6e728e4c99">latest master as of Feb 13</a>
</li>
</ul>

<h2 id="140-20230220">1.4.0 (2023/02/20)</h2>

<h3 id="added-6">Added</h3>
<ul>
  <li>New message type <code class="language-plaintext highlighter-rouge">BoundedSequenceFlat</code>
    <ul>
      <li>This is a <code class="language-plaintext highlighter-rouge">BoundedSequence</code> with the <code class="language-plaintext highlighter-rouge">@flat</code> annotation</li>
      <li>Sizes range from 1kB to 8MB, like <code class="language-plaintext highlighter-rouge">Array</code> and <code class="language-plaintext highlighter-rouge">BoundedSequence</code>
        <h3 id="changed-7">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Messages of different types can be optionally included via CMake args:
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_ARRAY</code> (default ON)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_STRUCT</code> (default ON)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_POINT_CLOUD</code> (default ON)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_BOUNDED_SEQUENCE</code> (default OFF)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_BOUNDED_SEQUENCE_FLAT</code> (default OFF)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_UNBOUNDED_SEQUENCE</code> (default OFF)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_ALL</code> (default OFF)
        <ul>
          <li>when ON, overrides the other defaults to ON</li>
          <li>you can still optionally exclude some messages by explicitly setting them to OFF
            <h3 id="removed-2">Removed</h3>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Removed a few messages:
    <ul>
      <li>Range</li>
      <li>RadarTrack</li>
      <li>RadarDetection</li>
      <li>NavSatFix
        <h3 id="fixed-3">Fixed</h3>
      </li>
    </ul>
  </li>
  <li>In all cases, including loaned messages, capture the timestamp as the last step of initializing the message</li>
</ul>

<h2 id="137-20230104">1.3.7 (2023/01/04)</h2>

<h2 id="136-20230103">1.3.6 (2023/01/03)</h2>

<h3 id="fixed-4">Fixed</h3>
<ul>
  <li>Set the correct <code class="language-plaintext highlighter-rouge">IDL_GEN_ROOT</code> for rclcpp plugins</li>
</ul>

<h2 id="135-20221205">1.3.5 (2022/12/05)</h2>

<h3 id="fixed-5">Fixed</h3>
<ul>
  <li>Exit cleanly when a publisher process terminates before a subscriber process</li>
</ul>

<h2 id="134-20221128">1.3.4 (2022/11/28)</h2>

<h3 id="changed-8">Changed</h3>
<ul>
  <li>Updated Apex.OS plugins to use the unified <code class="language-plaintext highlighter-rouge">LoanedSample::data()</code>
</li>
</ul>

<h2 id="133-20221128">1.3.3 (2022/11/28)</h2>

<h3 id="fixed-6">Fixed</h3>
<ul>
  <li>Implement the missing <code class="language-plaintext highlighter-rouge">take()</code> method in <code class="language-plaintext highlighter-rouge">ApexOSPollingSubscriptionSubscriber</code>
</li>
</ul>

<h2 id="132-20221121">1.3.2 (2022/11/21)</h2>

<h3 id="fixed-7">Fixed</h3>
<ul>
  <li>Capture the <code class="language-plaintext highlighter-rouge">this</code> pointer in the lambda in the iceoryx publisher</li>
</ul>

<h2 id="131-20221121">1.3.1 (2022/11/21)</h2>

<h3 id="added-7">Added</h3>
<ul>
  <li>New Apex.OS plugin, compatible with the <code class="language-plaintext highlighter-rouge">ThreadedRunner</code>s
    <ul>
      <li>The <code class="language-plaintext highlighter-rouge">INTER_THREAD</code> and <code class="language-plaintext highlighter-rouge">INTRA_THREAD</code> execution strategies, combined with
<code class="language-plaintext highlighter-rouge">-c ApexOSPollingSubscription</code>, will use the <code class="language-plaintext highlighter-rouge">ThreadedRunner</code> instances</li>
      <li>The new <code class="language-plaintext highlighter-rouge">APEX_SINGLE_EXECUTOR</code> execution strategy will add all publishers
and subscribers to a single Apex.OS Executor</li>
      <li>The new <code class="language-plaintext highlighter-rouge">APEX_EXECUTOR_PER_COMMUNICATOR</code> execution strategy will add each
publisher and each subscriber to its own Apex.OS Executor instance</li>
      <li>The new <code class="language-plaintext highlighter-rouge">APEX_CHAIN</code> execution strategy will add a publisher and subscriber
as a chain of nodes to an Apex.OS Executor
        <h3 id="changed-9">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Refactored FastRTPS communicator plugin:
    <ul>
      <li>Uses DDS compliant API</li>
      <li>Code generator updated</li>
      <li>Implementation for <code class="language-plaintext highlighter-rouge">publish_loaned()</code>
</li>
      <li>Dockerfile improvements
        <h3 id="removed-3">Removed</h3>
      </li>
    </ul>
  </li>
  <li>CLI arg <code class="language-plaintext highlighter-rouge">--disable-async</code>. Synchronous / asynchronous publishing should be
configured externally depending on the communication mean used.</li>
</ul>

<h2 id="130-20220825">1.3.0 (2022/08/25)</h2>

<h3 id="added-8">Added</h3>
<ul>
  <li>New execution strategy option:
    <ul>
      <li>The default <code class="language-plaintext highlighter-rouge">-e INTER_THREAD</code> runs each publisher and subscriber in its
own separate thread, which matches the previous behavior</li>
      <li>A new <code class="language-plaintext highlighter-rouge">-e INTRA_THREAD</code>, which runs a single publisher and subscriber in the
same thread. The publisher writes, and the subscriber immediately takes it</li>
      <li>For Apex.OS specifically, some optimized execution strategies which use the
proprietary Apex.OS executor
        <h3 id="changed-10">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Significantly refactored the communicator plugins:
    <ul>
      <li>Each plugin is split into an implementation of a <code class="language-plaintext highlighter-rouge">Publisher</code> and a
<code class="language-plaintext highlighter-rouge">Subscriber</code>, instead of a single <code class="language-plaintext highlighter-rouge">Communicator</code>
</li>
      <li>The plugin is no longer responsible for managing the metrics, such as
sample count, lost samples, and latency</li>
      <li>The plugin does not require any special logic to support roundtrip mode</li>
      <li>It is safe for the plugins to initialize their data writers and readers
at construction time, instead of delaying the initialization to the first
call of <code class="language-plaintext highlighter-rouge">publish()</code> or <code class="language-plaintext highlighter-rouge">update_subscription()</code>
</li>
      <li>Split <code class="language-plaintext highlighter-rouge">publish()</code> into <code class="language-plaintext highlighter-rouge">publish_copy()</code> and <code class="language-plaintext highlighter-rouge">publish_loaned()</code>
</li>
    </ul>
  </li>
  <li>Significantly refactored the runner framework:
    <ul>
      <li>The runner framework is responsible for the experiment metrics</li>
      <li>It manages the roundtrip mode logic</li>
      <li>It is extensible for different execution strategies or thread configurations</li>
    </ul>
  </li>
  <li>The iceoryx plugin now uses the untyped API, for improved performance</li>
</ul>

<h2 id="121-20220630">1.2.1 (2022/06/30)</h2>

<h3 id="fixed-8">Fixed</h3>
<ul>
  <li>Capture the timestamp as soon as a message is received, instead of just before
storing the metrics, to reduce the reported latency to a more correct value</li>
</ul>

<h2 id="120-20220628">1.2.0 (2022/06/28)</h2>

<h3 id="changed-11">Changed</h3>
<ul>
  <li>The CLI arguments for specifying the output type have changed:
    <ul>
      <li>For console output, updated every second, add <code class="language-plaintext highlighter-rouge">--print-to-console</code>
</li>
      <li>For file output, use <code class="language-plaintext highlighter-rouge">--logfile my_file.csv</code> or <code class="language-plaintext highlighter-rouge">--logfile my_file.json</code>
        <ul>
          <li>The type will be deduced from the file name</li>
        </ul>
      </li>
      <li>If neither of these options is specified, then a warning will print,
and the experiment will still run</li>
    </ul>
  </li>
  <li>The linter configurations are now configured locally. This means that the output
of <code class="language-plaintext highlighter-rouge">colcon test</code> should be the same no matter the installed ROS distribution.</li>
  <li>The <code class="language-plaintext highlighter-rouge">--zero-copy</code> arg is now valid even if the publisher and subscriber(s)
are in the same process
    <h3 id="removed-4">Removed</h3>
  </li>
  <li>The publisher and subscriber loop reserve metrics are no longer recorded or reported
    <h3 id="fixed-9">Fixed</h3>
  </li>
  <li>CPU usage will no longer be stuck at <code class="language-plaintext highlighter-rouge">0</code>
</li>
</ul>

<h3 id="removed-5">Removed</h3>
<ul>
  <li>The pub/sub loop reserve time metrics</li>
</ul>

<h2 id="112-20220608">1.1.2 (2022/06/08)</h2>

<h3 id="changed-12">Changed</h3>
<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">steady_clock</code> for all platforms, including QNX QOS</li>
</ul>

<h2 id="111-20220607">1.1.1 (2022/06/07)</h2>

<h3 id="changed-13">Changed</h3>
<ul>
  <li>Significant refactor to simplify the analysis pipeline
    <h3 id="fixed-10">Fixed</h3>
  </li>
  <li>Add some missing definitions when Apex.OS is enabled, but the rclcpp plugins are disabled</li>
</ul>

<h2 id="110-20220602">1.1.0 (2022/06/02)</h2>

<h3 id="added-9">Added</h3>
<ul>
  <li>New Apex.OS Polling Subscription plugin</li>
  <li>Compatibility with ROS 2 Humble</li>
</ul>

<h2 id="100-20220512">1.0.0 (2022/05/12)</h2>

<h3 id="added-10">Added</h3>
<ul>
  <li>More expressive perf_test CLI args for QOS settings</li>
  <li>A plugin for <a href="https://github.com/eclipse-cyclonedds/cyclonedds-cxx/tree/0.9.0b1">Cyclone DDS with C++ bindings v0.9.0b1</a>
    <h3 id="changed-14">Changed</h3>
  </li>
  <li>CLI args for QOS settings:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">--reliability &lt;RELIABLE|BEST_EFFORT&gt;</code></li>
      <li><code class="language-plaintext highlighter-rouge">--durability &lt;TRANSIENT_LOCAL|VOLATILE&gt;</code></li>
      <li><code class="language-plaintext highlighter-rouge">--history &lt;KEEP_LAST|KEEP_ALL&gt;</code></li>
    </ul>
  </li>
  <li>
<code class="language-plaintext highlighter-rouge">master</code> branch is compatible with many ROS 2 distributions:
    <ul>
      <li>dashing</li>
      <li>eloquent</li>
      <li>foxy</li>
      <li>galactic</li>
      <li>rolling
        <h3 id="deprecated">Deprecated</h3>
      </li>
    </ul>
  </li>
  <li>CLI flags for QOS settings:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">--reliable</code></li>
      <li><code class="language-plaintext highlighter-rouge">--transient</code></li>
      <li>
<code class="language-plaintext highlighter-rouge">--keep-last</code>
        <h3 id="removed-6">Removed</h3>
      </li>
    </ul>
  </li>
  <li>The branches for specific ROS 2 distributions have been deleted
    <h3 id="fixed-11">Fixed</h3>
  </li>
  <li>CI jobs and Dockerfiles are decoupled from the middleware bundled with the ROS 2 distribution</li>
</ul>
</div>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="galactic-tutorials">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wiki Tutorials</h3>
      </div>
      <div class="panel-body">
        
        <em>This package does not provide any links to tutorials in it's <a href="https://index.ros.org/contribute/metadata/">rosindex metadata</a>.</em>
        <em>You can check on the <a href="http://wiki.ros.org/performance_test/Tutorials" target="_blank">ROS Wiki Tutorials</a> page for the package.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="galactic-deps">
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Package Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th class="text-center">Deps</th>
                  <th style="width: 100%">Name</th>
                </thead>
                <tbody>
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rclcpp#galactic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rclcpp#galactic">rclcpp  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ros_environment#galactic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ros_environment#galactic">ros_environment  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake#galactic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake#galactic">ament_cmake  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_generators#galactic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_generators#galactic">rosidl_default_generators  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rmw_implementation#galactic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rmw_implementation#galactic">rmw_implementation  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_runtime#galactic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_runtime#galactic">rosidl_default_runtime  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_gtest#galactic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_gtest#galactic">ament_cmake_gtest  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_auto#galactic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_auto#galactic">ament_lint_auto  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_common#galactic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_common#galactic">ament_lint_common  </a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
          <div class="panel-heading">
            <h3 class="panel-title">System Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                </thead>
                <tbody>
                  
                    
                      <tr>
                        <td><a href="/d/git">git</a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Dependant Packages</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                  <th class="text-center">Deps</th>
                </thead>
                <tbody>
                  
                    
                    
                    <tr>
                      <td><a href="/p/performance_report#galactic">performance_report</a></td>
                      <td class="text-center">
                        
                        <a href="/p/performance_report#galactic-deps" class="endoftree">
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="galactic-assets">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Launch files</h3>
      </div>
      <div class="panel-body">
        
          <em>No launch files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Messages</h3>
      </div>
      <div class="panel-body">
        
          <em>No message files found.</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Services</h3>
      </div>
      <div class="panel-body">
        
          <em>No service files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Plugins</h3>
      </div>
      <div class="panel-body">
        
          <em>No plugins found.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="galactic-questions">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent questions tagged <kbd>performance_test</kbd> at <strong><a href="https://robotics.stackexchange.com/" target="_blank">Robotics Stack Exchange</a></strong></h3>      </div>
      <div id="galactic-question-list" class="panel-body" style="display: none;"></div>
      <div id="galactic-no-question-list" class="panel-body" style="display: none;">
        <p>No questions yet, you can ask one <a href="https://robotics.stackexchange.com/questions/tagged/performance_test+galactic">here</a>.</p>
      </div>
      <div id="galactic-get-question-fail" class="panel-body alert alert-warning" style="display: none;">
        <p>Failed to get question list, you can ticket an issue <a href="https://github.com/ros-infrastructure/rosindex/issues/new" target="_blank" class="alert-link">here</a> </p>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/package_body_tabs.js"></script>

<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
jQuery(function() {
    // Update the count on the links to the contribution suggestions
    updateContributionSuggestionsCountOnPackage('https://gitlab.com/ApexAI/performance_test.git');
});
</script>

          </div>
          <div class="col-md-2 hidden-xs hidden-sm">
            
            
            



<div class="list-group list-group-sm ">
  <a class="list-group-item"
     target="_blank"
     href="http://docs.ros.org/en/galactic/p/performance_test"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       
       API Docs
  </a>
  <a class="list-group-item"
     target="_blank"
     href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       
       Browse Code
  </a>
  
  
  
  
  
  
</div>

          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-iron">
    <div class="container-fluid">
      
        
        
        

        <div class="row">
          <div class="col-md-10">
            

<div class="well well-sm">
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px" src="/assets/package.png">
      </td>
      <td>
        <h3 style="margin-top: 5px">
          <a style="text-decoration:none" href="/p/performance_test">performance_test</a> <small>package from <a style="text-decoration:none" href="/r/performance_test/gitlab-ApexAI-performance_test">performance_test</a> repo</small>
        </h3>
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_report">

performance_report
</a>
            
          
            
            
              <span class="label label-default pkg-label">

performance_test
</span>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_test_ros1_msgs">

performance_test_ros1_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/performance_test_ros1_publisher">

performance_test_ros1_publisher
</a>
            
          
      </td>
    </tr>
  </table>
</div>

            <div class="visible-xs visible-sm">
              
              
              



<div class="list-group list-group-sm list-group-horizontal list-group-justified">
  <a class="list-group-item text-center"
     target="_blank"
     href="http://docs.ros.org/en/iron/p/performance_test"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       <br>
       API Docs
  </a>
  <a class="list-group-item text-center"
     target="_blank"
     href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       <br>
       Browse Code
  </a>
  
  
  
  
  
  
</div>

            </div>
            



<ul class="nav nav-tabs nav-justified" id="iron-tabs" style="margin-bottom:20px">
  <li class="better-tabs active">
    <a href="#iron-overview" data-toggle="tab">Overview</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    
    <a href="#iron-assets" data-toggle="tab"><span class="label label-default">0</span> Assets</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    <a href="#iron-deps" data-toggle="tab"><span class="label label-primary">10</span> Dependencies</a>
  </li>
  <li class="better-tabs">
    
    <a href="#iron-tutorials" data-toggle="tab"><span class="label label-default">0</span> Tutorials</a>
  </li>
  <li class="better-tabs">
    <a href="#iron-questions" data-toggle="tab"><span id="iron-questions-count" class="label label-primary">0</span> Q & A</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="iron-overview">
    
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h4 class="panel-title">Package Summary</h4></div>
          <div class="panel-body">
            <table class="table table-condensed">
              <tr>
                <td style="width:100px;" class="text-right"><strong>Tags</strong></td>
                <td>
                  
                  
                    <em>No category tags.</em>
                  
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Version</strong></td>
                <td>2.3.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>License</strong></td>
                <td>Apache 2.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>Build type</strong></td>
                <td>
                  
                    <span class="label label-default">
                  
                    AMENT_CMAKE</span>
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Use</strong></td>
                <td>
                
                  <span class="label label-success">RECOMMENDED</span>
                
                </td>
              </tr>
            </table>
          </div>
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body">
            
            
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default"></span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://gitlab.com/ApexAI/performance_test.git">https://gitlab.com/ApexAI/performance_test.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">master</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-03-25
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="No CI information available for this package.">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/performance_test/#iron-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/performance_test/#iron-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/performance_test/#iron-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Package Description</h3></div>
          <div class="panel-body">
            Tool to test performance of ROS 2 and DDS data layers and communication.
          </div>
          <div class="panel-heading"><h4 class="panel-title">Additional Links</h4></div>
          <div class="panel-body">
            
            
              <em>No additional links.</em>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Maintainers</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Apex.AI, Inc.</li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Authors</h4></div>
          <div class="panel-body">
            
            
              <em>No additional authors.</em>
            
          </div>
        </div>
      </div>
    </div>
    
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-heading"><span class="glyphicon glyphicon-file"></span><a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/README.md" title="Open in git repository">performance_test/README.md</a></div>
              <div class="panel-body">
                    <div class="rendered-markdown">
<h1 id="performance_test">performance_test</h1>

<p>[TOC]</p>

<p>The performance_test tool tests latency and other performance metrics of <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">various middleware
implementations</a> that support a pub/sub pattern. It is used to simulate
non-functional performance of your application.</p>

<p>The performance_test tool allows you to quickly set up a pub/sub configuration,
e.g. number of publisher/subscribers, message size, QOS settings, middleware. The following metrics
are automatically recorded when the application is running:</p>

<ul>
  <li>
<strong>latency</strong>: corresponds to the time a message takes to travel from a publisher to subscriber. The
latency is measured by timestamping the sample when it’s published and subtracting the timestamp
  (from the sample) from the measured time when the sample arrives at the subscriber (only logged when a subscriber is created)</li>
  <li>
<strong>CPU usage</strong>: percentage of the total system wide CPU usage (logged separately for each instance of <code class="language-plaintext highlighter-rouge">perf_test</code>)</li>
  <li>
<strong>resident memory</strong>: heap allocations, shared memory segments, stack (used for system’s internal
work) (logged separately for each instance of <code class="language-plaintext highlighter-rouge">perf_test</code>)</li>
  <li>
<strong>sample statistics</strong>: number of samples received, sent, and lost per experiment run.</li>
</ul>

<p>This <code class="language-plaintext highlighter-rouge">master</code> branch is compatible with the following ROS 2 versions</p>
<ul>
  <li>rolling</li>
  <li>jazzy</li>
  <li>iron</li>
  <li>humble</li>
  <li>galactic</li>
  <li>foxy</li>
  <li>eloquent</li>
  <li>dashing</li>
  <li>Apex.OS</li>
</ul>

<h2 id="how-to-use-this-document">How to use this document</h2>

<ol>
  <li>Start <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#example">here</a> for a quick example of building and running the performance_test tool
with the Cyclone DDS plugin.</li>
  <li>If needed, find more detailed information about <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#building-the-performance_test-tool">building</a>
and <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#running-an-experiment">running</a>
</li>
  <li>Or, if the quick example is good enough, skip ahead to the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">list of supported middleware
plugins</a> to learn how to test a specific middleware implementation.</li>
  <li>Check out the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#analyze-the-results">tools for visualizing the results</a>
</li>
  <li>If desired, read about the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#architecture">design and architecture</a> of the tool.</li>
</ol>

<h2 id="example">Example</h2>

<p>This example shows how to test the non-functional performance of the following configuration:</p>

<table>
  <thead>
    <tr>
      <th>Option</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Plugin</td>
      <td>Cyclone DDS</td>
    </tr>
    <tr>
      <td>Message type</td>
      <td>Array1k</td>
    </tr>
    <tr>
      <td>Publishing rate</td>
      <td>100Hz</td>
    </tr>
    <tr>
      <td>Topic name</td>
      <td>test_topic</td>
    </tr>
    <tr>
      <td>Duration of the experiment</td>
      <td>30s</td>
    </tr>
    <tr>
      <td>Number of publisher(s)</td>
      <td>1 (default)</td>
    </tr>
    <tr>
      <td>Number of subscriber(s)</td>
      <td>1 (default)</td>
    </tr>
  </tbody>
</table>

<ol>
  <li>
    <p>Install <a href="https://docs.ros.org/en/rolling/index.html">ROS 2</a></p>
  </li>
  <li>
    <p>Install <a href="https://github.com/eclipse-cyclonedds/cyclonedds">Cyclone DDS</a> to /opt/cyclonedds</p>
  </li>
  <li>
    <p>Build performance_test with the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#eclipse-cyclone-dds">CMake build flag</a> for Cyclone DDS:</p>
  </li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nb">source</span> /opt/ros/rolling/setup.bash
    <span class="nb">cd</span> ~/perf_test_ws
    colcon build <span class="nt">--cmake-args</span> <span class="nt">-DPERFORMANCE_TEST_PLUGIN</span><span class="o">=</span>CYCLONEDDS
    <span class="nb">source</span> ./install/setup.bash
    
</code></pre></div></div>

<ol>
  <li>Run with the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#eclipse-cyclone-dds">communication plugin option</a> for Cyclone DDS:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>experiment
./install/performance_test/lib/performance_test/perf_test <span class="nt">--communication</span> CycloneDDS
                                                          <span class="nt">--msg</span> Array1k
                                                          <span class="nt">--rate</span> 100
                                                          <span class="nt">--topic</span> test_topic
                                                          <span class="nt">--max-runtime</span> 30
                                                          <span class="nt">--logfile</span> experiment/log.csv

</code></pre></div></div>

<p>At the end of the experiment, a CSV log file will be generated in the experiment folder with a name
that starts with <code class="language-plaintext highlighter-rouge">log</code>.</p>

<h2 id="building-the-performance_test-tool">Building the performance_test tool</h2>

<p>For a simple example, see <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.rclcpp">Dockerfile.rclcpp</a>.</p>

<p>The performance_test tool is structured as a ROS 2 package, so <code class="language-plaintext highlighter-rouge">colcon</code> is used to build it.
Therefore, you must source a ROS 2 installation:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">source</span> /opt/ros/rolling/setup.bash

</code></pre></div></div>

<p>Select a middleware plugin from <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">this list</a>.
Then build the performance_test tool with the selected middleware:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> ~/perf_test_ws/src
<span class="nb">cd</span> ~/perf_test_ws/src
git clone https://gitlab.com/ApexAI/performance_test.git
<span class="nb">cd</span> ..
<span class="c"># At this stage, you need to choose which middleware you want to use</span>
<span class="c"># The list of available flags is described in the middleware plugins section</span>
<span class="c"># Square brackets denote optional arguments, like in the Python documentation.</span>
colcon build <span class="nt">--cmake-args</span> <span class="nt">-DCMAKE_BUILD_TYPE</span><span class="o">=</span>Release <span class="nt">-DPERFORMANCE_TEST_PLUGIN</span><span class="o">=</span>&lt;plugin&gt;
<span class="nb">source install</span>/setup.bash

</code></pre></div></div>

<h2 id="running-an-experiment">Running an experiment</h2>

<p>The performance_test experiments are run through the <code class="language-plaintext highlighter-rouge">perf_test</code> executable.
To find the available settings, run with <code class="language-plaintext highlighter-rouge">--help</code> (note the required and default arguments):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~/perf_test_ws<span class="nv">$ </span>./install/performance_test/lib/performance_test/perf_test <span class="nt">--help</span>

</code></pre></div></div>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">-c</code> argument should match the selected <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/#middleware-plugins">middleware plugin</a>
from the build phase.</li>
  <li>The <code class="language-plaintext highlighter-rouge">--msg</code> argument should be one of the supported message types, which are shown
in the <code class="language-plaintext highlighter-rouge">--help</code> output.</li>
</ul>

<h3 id="single-machine-or-distributed-system">Single machine or distributed system?</h3>

<p>Based on the configuration you want to test, the usage of the performance_test tool differs. The
different possibilities are explained below.</p>

<p>For running tests on a single machine, you can choose between the following options:</p>

<ol>
  <li>Intraprocess means that the publisher and subscriber threads are in the same process.</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    perf_test &lt;options&gt; <span class="nt">--num-sub-threads</span> 1 <span class="nt">--num-pub-threads</span> 1
    
</code></pre></div></div>

<ol>
  <li>Interprocess means that the publisher and subscriber are in different processes. To test
interprocess communication, two instances of the performance_test must be run, e.g.</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c"># Start the subscriber first</span>
    perf_test &lt;options&gt; <span class="nt">--num-sub-threads</span> 1 <span class="nt">--num-pub-threads</span> 0 &amp;
    <span class="nb">sleep </span>1  <span class="c"># give the subscriber time to finish initializing</span>
    perf_test &lt;options&gt; <span class="nt">--num-sub-threads</span> 0 <span class="nt">--num-pub-threads</span> 1
    
</code></pre></div></div>

<p>On a distributed system, testing latency is difficult, because the clocks are probably not
perfectly synchronized between the two devices. To work around this, the performance_test tool
supports relay mode, which allows for a round-trip style of communication:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># On the main machine</span>
perf_test &lt;options&gt; <span class="nt">--roundtrip-mode</span> Main

<span class="c"># On the relay machine:</span>
perf_test &lt;options&gt; <span class="nt">--roundtrip-mode</span> Relay

</code></pre></div></div>

<p>In relay mode, the Main machine sends messages to the Relay machine, which immediately sends the
messages back. The Main machine receives the relayed message, and reports the round-trip latency.
Therefore, the reported latency will be roughly double the latency compared to the latency reported
in non-relay mode.</p>

<h3 id="single-machine-single-thread">Single machine, single thread</h3>

<p>An intra-thread configuration is experimentally supported, in which a publisher and subscriber
both operate in the same thread. The publisher writes a messages, and the subscriber immediately
takes it.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>perf_test &lt;options&gt; <span class="nt">-e</span> INTRA_THREAD

</code></pre></div></div>

<p>Notes:</p>

<ol>
  <li>This is only available when zero copy transfer is enabled</li>
  <li>This requires exactly one publisher and one subscriber</li>
  <li>This is not compatible with roundtrip mode</li>
</ol>

<h2 id="middleware-plugins">Middleware plugins</h2>

<p>The performance test tool can measure the performance of a variety of communication solutions
from different vendors. In this case there is no rclcpp or rmw layer overhead over the publisher
and subscriber routines.</p>

<p>The performance_test tool implements an executor that runs the publisher(s) and/or the subscriber(s) in
their own thread.</p>

<p>The following plugins are currently implemented:</p>

<h3 id="eclipse-cyclone-dds">Eclipse Cyclone DDS</h3>

<ul>
  <li><a href="https://github.com/eclipse-cyclonedds/cyclonedds/tree/0.9.0b1">Eclipse Cyclone DDS 0.9.0b1</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CYCLONEDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c CycloneDDS</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.CycloneDDS">Dockerfile.CycloneDDS</a>
</li>
  <li>Available transports:
    <ul>
      <li>Cyclone DDS zero copy requires
<a href="https://github.com/eclipse-iceoryx/iceoryx/blob/master/doc/website/getting-started/overview.md#roudi">RouDi</a>
to be running.
-
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP |</li>
    </ul>
  </li>
</ul>

<h3 id="eclipse-cyclone-dds-c-binding">Eclipse Cyclone DDS C++ binding</h3>

<ul>
  <li><a href="https://github.com/eclipse-cyclonedds/cyclonedds-cxx/tree/0.9.0b1">Eclipse Cyclone DDS C++ bindings 0.9.0b1</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CYCLONEDDS_CXX</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c CycloneDDS-CXX</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.CycloneDDS-CXX">Dockerfile.CycloneDDS-CXX</a>
</li>
  <li>Available transports:
    <ul>
      <li>Cyclone DDS zero copy requires the
<a href="https://github.com/eclipse-iceoryx/iceoryx/blob/master/doc/website/getting-started/overview.md#roudi">RouDi</a>
to be running.
-
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP |</li>
    </ul>
  </li>
</ul>

<h3 id="eclipse-iceoryx">Eclipse iceoryx</h3>

<ul>
  <li><a href="https://github.com/eclipse-iceoryx/iceoryx/tree/5fe215eab267b0ad68bc5552aecd4b6e728e4c99">iceoryx (latest master as of Feb 13)</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=ICEORYX</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c iceoryx</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.iceoryx">Dockerfile.iceoryx</a>
</li>
  <li>The iceoryx plugin is not a DDS implementation.
    <ul>
      <li>The DDS-specific options (such as domain ID, durability, and reliability) do not apply.</li>
    </ul>
  </li>
  <li>To run with the iceoryx plugin,
<a href="https://github.com/eclipse-iceoryx/iceoryx/blob/master/doc/website/getting-started/overview.md#roudi">RouDi</a>
must be running.</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|———–|———————|———————————–|
| LoanedSamples | LoanedSamples | Not supported by performance_test |</li>
</ul>

<h3 id="eprosima-fast-dds">eProsima Fast DDS</h3>

<ul>
  <li><a href="https://github.com/eProsima/Fast-DDS/tree/v2.6.2">FastDDS 2.6.2</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=FASTDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c FastRTPS</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.FastDDS">Dockerfile.FastDDS</a>
</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA (default), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | SHMEM (default), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) | UDP |</li>
</ul>

<h3 id="oci-opendds">OCI OpenDDS</h3>

<ul>
  <li><a href="https://github.com/objectcomputing/OpenDDS/tree/DDS-3.13.2">OpenDDS 3.13.2</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=OPENDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c OpenDDS</code>
</li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.OpenDDS">Dockerfile.OpenDDS</a>
</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| TCP   | TCP                 | TCP                |</li>
</ul>

<h3 id="rti-connext-dds">RTI Connext DDS</h3>

<ul>
  <li><a href="https://www.rti.com/products/connext-dds-professional">RTI Connext DDS 5.3.1+</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CONNEXTDDS</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c ConnextDDS</code>
</li>
  <li>Docker file: Not available</li>
  <li>A license is required</li>
  <li>You need to source an RTI Connext DDS environment.
    <ul>
      <li>If RTI Connext DDS was installed with ROS 2 (Linux only):
        <ul>
          <li><code class="language-plaintext highlighter-rouge">source /opt/rti.com/rti_connext_dds-5.3.1/setenv_ros2rti.bash</code></li>
        </ul>
      </li>
      <li>If RTI Connext DDS is installed separately, you can source the following script to set the
environment:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">source &lt;connextdds_install_path&gt;/resource/scripts/rtisetenv_&lt;arch&gt;.bash</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA | SHMEM               | UDP                |</li>
</ul>

<h3 id="rti-connext-dds-micro">RTI Connext DDS Micro</h3>

<ul>
  <li><a href="https://www.rti.com/products/connext-dds-micro">Connext DDS Micro 3.0.3</a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=CONNEXTDDSMICRO</code>
</li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c ConnextDDSMicro</code>
</li>
  <li>Docker file: Not available</li>
  <li>A license is required</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| INTRA | SHMEM               | UDP                |</li>
</ul>

<h2 id="framework-plugins">Framework plugins</h2>

<p>The performance_test tool can also measure the end-to-end latency of a framework. In this case, the
executor of the framework is used to run the publisher(s) and/or the subscriber(s). The potential overhead of the <a href="http://docs.ros2.org/beta2/developer_overview.html#internal-api-architecture-overview">rclcpp or rmw
layer</a> is measured.</p>

<h3 id="ros-2">ROS 2</h3>

<p>The performance test tool can also measure the performance of a variety of RMW implementations,
through the ROS 2 <code class="language-plaintext highlighter-rouge">rclcpp::publisher</code> and <code class="language-plaintext highlighter-rouge">rclcpp::subscriber</code> API.</p>

<ul>
  <li><a href="https://docs.ros.org/en/rolling/Tutorials/Writing-A-Simple-Cpp-Publisher-And-Subscriber.html">ROS 2 <code class="language-plaintext highlighter-rouge">rclcpp::publisher</code> and <code class="language-plaintext highlighter-rouge">rclcpp::subscriber</code></a></li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=ROS2</code> (default)</li>
  <li>Communication plugin:
    <ul>
      <li>Callback with Single Threaded Executor: <code class="language-plaintext highlighter-rouge">-c rclcpp-single-threaded-executor</code>
</li>
      <li>Callback with Static Single Threaded Executor: <code class="language-plaintext highlighter-rouge">-c rclcpp-static-single-threaded-executor</code>
</li>
      <li>
<a href="https://github.com/ros2/rclcpp/pull/1047"><code class="language-plaintext highlighter-rouge">rclcpp::WaitSet</code></a>: <code class="language-plaintext highlighter-rouge">-c rclcpp-waitset</code>
</li>
    </ul>
  </li>
  <li>Docker file: <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/dockerfiles/Dockerfile.rclcpp">Dockerfile.rclcpp</a>
</li>
  <li>
<a href="https://docs.ros.org/en/rolling/Concepts/About-Different-Middleware-Vendors.html">Available underlying RMW implementations</a>:
    <ul>
      <li>ROS 2 Rolling is pre-configured to use <code class="language-plaintext highlighter-rouge">rmw_fastrtps_cpp</code>
</li>
      <li>Follow <a href="https://docs.ros.org/en/rolling/Guides/Working-with-multiple-RMW-implementations.html">these instructions</a>
  to use a different RMW implementation</li>
    </ul>
  </li>
  <li>Available transports: depends on underlying RMW implementation
    <ul>
      <li>LoanedSamples are available (<code class="language-plaintext highlighter-rouge">--zero-copy</code>) for <code class="language-plaintext highlighter-rouge">ROS_DISTRO = foxy</code> and above</li>
    </ul>
  </li>
</ul>

<h3 id="apexos">Apex.OS</h3>

<ul>
  <li>Apex.OS</li>
  <li>CMake build flag: <code class="language-plaintext highlighter-rouge">-DPERFORMANCE_TEST_PLUGIN=APEX_OS</code>
    <ul>
      <li>It is also required to <code class="language-plaintext highlighter-rouge">source /opt/ApexOS/setup.bash</code> instead of a ROS 2 distribution</li>
    </ul>
  </li>
  <li>Communication plugin: <code class="language-plaintext highlighter-rouge">-c ApexOSPollingSubscription</code>
</li>
  <li>Docker file: Not available</li>
  <li>Available underlying RMW implementations: <code class="language-plaintext highlighter-rouge">rmw_apex_middleware</code>
</li>
  <li>Available transports:
| Pub/sub in same process | Pub/sub in different processes on same machine | Pub/sub in different machines |
|——-|———————|——————–|
| UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero_copy</code>) | UDP (default), SHMEM (<code class="language-plaintext highlighter-rouge">--shared-memory</code>), LoanedSamples (<code class="language-plaintext highlighter-rouge">--zero_copy</code>) | UDP |</li>
</ul>

<h2 id="analyze-the-results">Analyze the results</h2>

<p>After an experiment is run with the <code class="language-plaintext highlighter-rouge">-l</code> flag, a log file is recorded. Both CSV
and JSON formats are supported. It is possible to add custom data to the log
file by setting the<code class="language-plaintext highlighter-rouge">APEX_PERFORMANCE_TEST</code> environment variable before running
an experiment, e.g.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">#</span><span class="w"> </span><span class="err">JSON</span><span class="w"> </span><span class="err">format</span><span class="w">
</span><span class="err">export</span><span class="w"> </span><span class="err">APEX_PERFORMANCE_TEST=</span><span class="s2">"
{
</span><span class="se">\"</span><span class="s2">My Version</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">1.0.4</span><span class="se">\"</span><span class="s2">,
</span><span class="se">\"</span><span class="s2">My Image Version</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">5.2</span><span class="se">\"</span><span class="s2">,
</span><span class="se">\"</span><span class="s2">My OS Version</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">Ubuntu 16.04</span><span class="se">\"</span><span class="s2">
}
"</span><span class="w">

</span></code></pre></div></div>

<h2 id="plot-the-results">Plot the results</h2>

<p>To plot the results in the JSON or CSV log files, see the <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/../plotter">plotter README</a>.</p>

<h2 id="architecture">Architecture</h2>

<p>Apex.AI’s <em>Performance Testing in ROS 2</em> white paper
(<a href="https://drive.google.com/file/d/15nX80RK6aS8abZvQAOnMNUEgh7px9V5S/view">available here</a>)
describes how to design a fair and unbiased performance test, and is the basis for this project.</p>
<center><img src="https://gitlab.com/ApexAI/performance_test/-/raw/master/performance_test/architecture.png"></center>

<p>Each middleware has a different API. Thanks to the <code class="language-plaintext highlighter-rouge">Plugin</code> abstraction, the core logic of
setting up and running an experiment is completely decoupled from the implementation details
of sending and receiving individual messages.</p>

<p>Exactly one <code class="language-plaintext highlighter-rouge">Plugin</code> implementation is selected at build time. The design is similar to the
<a href="https://refactoring.guru/design-patterns/abstract-factory">Abstract Factory pattern</a>.
<code class="language-plaintext highlighter-rouge">performance_test</code> declares, but does not define, a static factory method in the <code class="language-plaintext highlighter-rouge">PluginFactory</code>
class. Each middleware provides a definition for this factory method to create a concrete <code class="language-plaintext highlighter-rouge">Plugin</code>
implementation, and <code class="language-plaintext highlighter-rouge">perf_test</code> calls this factory method directly.</p>

<p>An example plugin is available <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/plugins/demo">here</a>.</p>

<h2 id="performance-optimizations">Performance optimizations</h2>

<ul>
  <li>On linux-based platforms, <code class="language-plaintext highlighter-rouge">perf_test</code> writes <code class="language-plaintext highlighter-rouge">0</code> to <code class="language-plaintext highlighter-rouge">/dev/cpu_dma_latency</code>
and holds open the file handle, which will prevent the CPU from entering any
idle states for the duration of the experiment. This should result in lower
message latency and lower variance in that latency.</li>
</ul>

<h2 id="future-extensions-and-limitations">Future extensions and limitations</h2>

<ul>
  <li>Communication frameworks like DDS have a huge amount of settings. This tool only allows the most
common QOS settings to be configured. The other QOS settings are hardcoded in the application.</li>
  <li>Only one publisher per topic is allowed, because the data verification logic does not support
matching data to the different publishers.</li>
  <li>Some communication plugins can get stuck in their internal loops if too much data is received.
Figuring out ways around such issues is one of the goals of this tool.</li>
  <li>FastRTPS wait-set does not support timeouts which can lead to the receiving not aborting. In that
case the performance test must be manually killed.</li>
  <li>Using Connext DDS Micro INTRA transport with <code class="language-plaintext highlighter-rouge">reliable</code> QoS and history kind set to <code class="language-plaintext highlighter-rouge">keep_all</code>
<a href="https://community.rti.com/static/documentation/connext-micro/3.0.3/doc/html/usersmanual/transports/INTRA.html#reliability-and-durability">is not supported with Connext
Micro</a>.
Set <code class="language-plaintext highlighter-rouge">keep-last</code> as QoS history kind always when using <code class="language-plaintext highlighter-rouge">reliable</code>.</li>
</ul>

<p>Possible additional communication which could be implemented are:</p>

<ul>
  <li>Raw UDP communication</li>
</ul>

<h2 id="building-with-limited-resources">Building with limited resources</h2>

<p>When building this tool, the compiler must perform a lot of template expansion. This can be
overwhelming for a system with a low-power CPU or limited RAM. There are some additional CMake
options which can reduce the system load during compilation:</p>

<ol>
  <li>This tool includes many different message types, each with many different sizes. Reduce the number of
messages, and thus the compilation load, by disabling one or more message types. For example, to build
without <code class="language-plaintext highlighter-rouge">PointCloud</code> messages, add <code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_POINDCLOUD=OFF</code> to the <code class="language-plaintext highlighter-rouge">--cmake-args</code>. The message types,
and their options for enabling/disabling, can be found <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/performance_test/msg/CMakeLists.txt">here</a>.</li>
</ol>
</div>
              </div>
            </div>
          </div>
        </div>
      
    
    <div class="row">
      <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-heading"><span class="glyphicon glyphicon-list"></span> CHANGELOG</div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="changelog-for-package-performance_test">Changelog for package performance_test</h1>

<h2 id="xyz-yyyymmdd">X.Y.Z (YYYY/MM/DD)</h2>

<h2 id="230-20240924">2.3.0 (2024/09/24)</h2>

<h3 id="removed">Removed</h3>
<ul>
  <li>Moved <code class="language-plaintext highlighter-rouge">apex_performance_plotter</code> to its own package <a href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test/../plotter">here</a>
</li>
</ul>

<h2 id="220-20240515">2.2.0 (2024/05/15)</h2>

<h3 id="added">Added</h3>
<ul>
  <li>performance_test can be built with ROS 2 Iron and Jazzy
    <h3 id="changed">Changed</h3>
  </li>
  <li>Renamed the <code class="language-plaintext highlighter-rouge">--dds-domain_id</code> CLI arg to <code class="language-plaintext highlighter-rouge">--dds-domain-id</code>
</li>
  <li>When <code class="language-plaintext highlighter-rouge">--dds-domain-id</code> is unspecified, fall back to the <code class="language-plaintext highlighter-rouge">ROS_DOMAIN_ID</code> environment variable</li>
  <li>
<code class="language-plaintext highlighter-rouge">--zero-copy</code> has been separated into two flags:
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">--shared-memory</code>: Enable shared-memory transfer in the plugin. This is meant to replace the
need to manually set runtime flags via <code class="language-plaintext highlighter-rouge">CYCLONEDDS_URI</code>, <code class="language-plaintext highlighter-rouge">APEX_MIDDLEWARE_SETTINGS</code>, etc.</li>
      <li>
<code class="language-plaintext highlighter-rouge">--loaned-samples</code>: When publishing messages in the plugin, borrow loaned samples instead
of publishing by copy</li>
      <li>
<code class="language-plaintext highlighter-rouge">--zero-copy</code> is now an alias for <code class="language-plaintext highlighter-rouge">--shared-memory --loaned-samples</code>
</li>
      <li>Supported plugins include:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">-c CycloneDDS</code></li>
          <li><code class="language-plaintext highlighter-rouge">-c CycloneDDS-CXX</code></li>
          <li><code class="language-plaintext highlighter-rouge">-c ApexOSPollingSubscription</code></li>
          <li>
<code class="language-plaintext highlighter-rouge">-c rclcpp-*</code> with <code class="language-plaintext highlighter-rouge">RMW_IMPLEMENTATION=rmw_cyclonedds_cpp</code>
</li>
          <li>
<code class="language-plaintext highlighter-rouge">-c rclcpp-*</code> with <code class="language-plaintext highlighter-rouge">RMW_IMPLEMENTATION=rmw_fastrtps_cpp</code>
</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="210-20240417">2.1.0 (2024/04/17)</h2>

<h3 id="added-1">Added</h3>
<ul>
  <li>Add new function <code class="language-plaintext highlighter-rouge">prepare()</code> to the Publisher and Subscriber API, intended
to allow participant discovery without blocking the main thread
    <h3 id="changed-1">Changed</h3>
  </li>
  <li>Change the default <code class="language-plaintext highlighter-rouge">--history</code> arg from <code class="language-plaintext highlighter-rouge">KEEP_ALL</code> to <code class="language-plaintext highlighter-rouge">KEEP_LAST</code>
</li>
  <li>Change the default <code class="language-plaintext highlighter-rouge">--history-depth</code> arg from <code class="language-plaintext highlighter-rouge">1000</code> to <code class="language-plaintext highlighter-rouge">16</code>
</li>
  <li>If <code class="language-plaintext highlighter-rouge">--expected-num-pubs</code> is unspecified, set it to the same value as <code class="language-plaintext highlighter-rouge">-p</code>
</li>
  <li>If <code class="language-plaintext highlighter-rouge">--expected-num-subs</code> is unspecified, set it to the same value as <code class="language-plaintext highlighter-rouge">-s</code>
    <h3 id="fixed">Fixed</h3>
  </li>
  <li>Removed an unused variable to fix a Clang build</li>
  <li>Remove unused variable names in the <code class="language-plaintext highlighter-rouge">Plugin</code> abstract class</li>
  <li>Fix a potential lockup in PublisherTask on QNX</li>
</ul>

<h2 id="200-20240319">2.0.0 (2024/03/19)</h2>

<h3 id="added-2">Added</h3>
<ul>
  <li>Add experimental bazel support
    <ul>
      <li><code class="language-plaintext highlighter-rouge">bazel build //performance_test --//:plugin_implementation=//path/to/a/plugin</code></li>
    </ul>
  </li>
  <li>Add a rudimentary socket-based plugin for testing the bazel support
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">bazel run //performance_test --//:plugin_implementation=//performance_test/plugins/demo:demo_plugin -- --help</code>
        <h3 id="changed-2">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Instead of enabling/disabling each plugin, you select exactly one
with a CMake string option, for example:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">colcon build --cmake-args -DPERFORMANCE_TEST_PLUGIN=ROS2</code></li>
    </ul>
  </li>
  <li>Renamed the <code class="language-plaintext highlighter-rouge">--communication</code> CLI arg to <code class="language-plaintext highlighter-rouge">--communicator</code>. The short <code class="language-plaintext highlighter-rouge">-c</code> is unchanged.
    <h3 id="removed-1">Removed</h3>
  </li>
  <li>Removed the deprecated CLI flags for QOS settings:
    <ul>
      <li>Instead of <code class="language-plaintext highlighter-rouge">--reliable</code>, use <code class="language-plaintext highlighter-rouge">--reliability RELIABLE</code>
</li>
      <li>Instead of <code class="language-plaintext highlighter-rouge">--transient</code>, use <code class="language-plaintext highlighter-rouge">--durability TRANSIENT_LOCAL</code>
</li>
      <li>Instead of <code class="language-plaintext highlighter-rouge">--keep-last</code>, use <code class="language-plaintext highlighter-rouge">--history KEEP_LAST</code>
</li>
    </ul>
  </li>
  <li>Removed the obsolete <code class="language-plaintext highlighter-rouge">BoundedSequenceFlat</code> messages</li>
  <li>Removed the superfluous <code class="language-plaintext highlighter-rouge">--msg-list</code> CLI flag. The <code class="language-plaintext highlighter-rouge">--help</code> message
already lists the available messages.
    <h3 id="fixed-1">Fixed</h3>
  </li>
  <li>Update the Apex.OS Runner to use <code class="language-plaintext highlighter-rouge">executor_runner::deferred</code> instead of <code class="language-plaintext highlighter-rouge">executor_runner::deferred_tag()</code>
</li>
  <li>Ensure that the first few published samples are sent at the expected rate</li>
</ul>

<h2 id="152-yyyymmdd">1.5.2 (YYYY/MM/DD)</h2>

<h3 id="added-3">Added</h3>
<ul>
  <li>
<code class="language-plaintext highlighter-rouge">--prevent-cpu-idle</code> is available on QNX
    <h3 id="changed-3">Changed</h3>
  </li>
  <li>JSON log files will contain all values in the <code class="language-plaintext highlighter-rouge">APEX_PERFORMANCE_TEST</code> dictionary, instead of the
five specific values used previously</li>
  <li>Switch to build as C++17 by default
    <h3 id="fixed-2">Fixed</h3>
  </li>
  <li>Zero copy transfer is again enabled for the rclcpp publisher</li>
</ul>

<h2 id="150-20230614">1.5.0 (2023/06/14)</h2>

<h3 id="added-4">Added</h3>
<ul>
  <li>New CLI switch <code class="language-plaintext highlighter-rouge">--prevent-cpu-idle</code> (linux only). When specified,
perf_test will use <code class="language-plaintext highlighter-rouge">/dev/cpu_dma_latency</code> to request that the CPU not enter
any sleep states, to potentially give more consistent results</li>
  <li>Some smaller <code class="language-plaintext highlighter-rouge">Array</code> messages, down to 32 bits</li>
  <li>Added support to the FastDDS plugin for bounded and unbounded sequences
    <h3 id="changed-4">Changed</h3>
  </li>
  <li>Update the README to better explain how to use this tool with Apex.OS</li>
  <li>In the <code class="language-plaintext highlighter-rouge">Runner</code>, allocate the <code class="language-plaintext highlighter-rouge">AnalysisResult</code>s on the stack instead of using <code class="language-plaintext highlighter-rouge">shared_ptr</code>
</li>
  <li>
<code class="language-plaintext highlighter-rouge">Subscriber</code> methods accept a callback parameter, instead of returning a
<code class="language-plaintext highlighter-rouge">vector</code> of results, to reduce heap usage</li>
  <li>Refactored the interaction between <code class="language-plaintext highlighter-rouge">SubscriberStats</code> and <code class="language-plaintext highlighter-rouge">AnalysisResult</code> to
remove the need for a <code class="language-plaintext highlighter-rouge">std::vector</code> of latency samples, to reduce heap usage</li>
  <li>Adjusted the <code class="language-plaintext highlighter-rouge">Array</code> message sizes to make the name match the contents</li>
  <li>Updated <code class="language-plaintext highlighter-rouge">apex_os_communicator</code> to use the new zero-copy API</li>
</ul>

<h2 id="142-20230315">1.4.2 (2023/03/15)</h2>

<h3 id="added-5">Added</h3>
<ul>
  <li>Added <code class="language-plaintext highlighter-rouge">perfplot</code> support for JSON log files
    <h3 id="changed-5">Changed</h3>
  </li>
  <li>Migrate the Apex.OS target to use <code class="language-plaintext highlighter-rouge">rosidl_get_typesupport_target</code>
</li>
  <li>Preallocate the JSON logger’s string buffer to prevent reallocations after the experiment begins</li>
</ul>

<h2 id="141-20230223">1.4.1 (2023/02/23)</h2>

<h3 id="changed-6">Changed</h3>
<ul>
  <li>Updated the iceoryx plugin to the <a href="https://github.com/eclipse-iceoryx/iceoryx/tree/5fe215eab267b0ad68bc5552aecd4b6e728e4c99">latest master as of Feb 13</a>
</li>
</ul>

<h2 id="140-20230220">1.4.0 (2023/02/20)</h2>

<h3 id="added-6">Added</h3>
<ul>
  <li>New message type <code class="language-plaintext highlighter-rouge">BoundedSequenceFlat</code>
    <ul>
      <li>This is a <code class="language-plaintext highlighter-rouge">BoundedSequence</code> with the <code class="language-plaintext highlighter-rouge">@flat</code> annotation</li>
      <li>Sizes range from 1kB to 8MB, like <code class="language-plaintext highlighter-rouge">Array</code> and <code class="language-plaintext highlighter-rouge">BoundedSequence</code>
        <h3 id="changed-7">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Messages of different types can be optionally included via CMake args:
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_ARRAY</code> (default ON)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_STRUCT</code> (default ON)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_POINT_CLOUD</code> (default ON)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_BOUNDED_SEQUENCE</code> (default OFF)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_BOUNDED_SEQUENCE_FLAT</code> (default OFF)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_UNBOUNDED_SEQUENCE</code> (default OFF)</li>
      <li>
<code class="language-plaintext highlighter-rouge">-DENABLE_MSGS_ALL</code> (default OFF)
        <ul>
          <li>when ON, overrides the other defaults to ON</li>
          <li>you can still optionally exclude some messages by explicitly setting them to OFF
            <h3 id="removed-2">Removed</h3>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Removed a few messages:
    <ul>
      <li>Range</li>
      <li>RadarTrack</li>
      <li>RadarDetection</li>
      <li>NavSatFix
        <h3 id="fixed-3">Fixed</h3>
      </li>
    </ul>
  </li>
  <li>In all cases, including loaned messages, capture the timestamp as the last step of initializing the message</li>
</ul>

<h2 id="137-20230104">1.3.7 (2023/01/04)</h2>

<h2 id="136-20230103">1.3.6 (2023/01/03)</h2>

<h3 id="fixed-4">Fixed</h3>
<ul>
  <li>Set the correct <code class="language-plaintext highlighter-rouge">IDL_GEN_ROOT</code> for rclcpp plugins</li>
</ul>

<h2 id="135-20221205">1.3.5 (2022/12/05)</h2>

<h3 id="fixed-5">Fixed</h3>
<ul>
  <li>Exit cleanly when a publisher process terminates before a subscriber process</li>
</ul>

<h2 id="134-20221128">1.3.4 (2022/11/28)</h2>

<h3 id="changed-8">Changed</h3>
<ul>
  <li>Updated Apex.OS plugins to use the unified <code class="language-plaintext highlighter-rouge">LoanedSample::data()</code>
</li>
</ul>

<h2 id="133-20221128">1.3.3 (2022/11/28)</h2>

<h3 id="fixed-6">Fixed</h3>
<ul>
  <li>Implement the missing <code class="language-plaintext highlighter-rouge">take()</code> method in <code class="language-plaintext highlighter-rouge">ApexOSPollingSubscriptionSubscriber</code>
</li>
</ul>

<h2 id="132-20221121">1.3.2 (2022/11/21)</h2>

<h3 id="fixed-7">Fixed</h3>
<ul>
  <li>Capture the <code class="language-plaintext highlighter-rouge">this</code> pointer in the lambda in the iceoryx publisher</li>
</ul>

<h2 id="131-20221121">1.3.1 (2022/11/21)</h2>

<h3 id="added-7">Added</h3>
<ul>
  <li>New Apex.OS plugin, compatible with the <code class="language-plaintext highlighter-rouge">ThreadedRunner</code>s
    <ul>
      <li>The <code class="language-plaintext highlighter-rouge">INTER_THREAD</code> and <code class="language-plaintext highlighter-rouge">INTRA_THREAD</code> execution strategies, combined with
<code class="language-plaintext highlighter-rouge">-c ApexOSPollingSubscription</code>, will use the <code class="language-plaintext highlighter-rouge">ThreadedRunner</code> instances</li>
      <li>The new <code class="language-plaintext highlighter-rouge">APEX_SINGLE_EXECUTOR</code> execution strategy will add all publishers
and subscribers to a single Apex.OS Executor</li>
      <li>The new <code class="language-plaintext highlighter-rouge">APEX_EXECUTOR_PER_COMMUNICATOR</code> execution strategy will add each
publisher and each subscriber to its own Apex.OS Executor instance</li>
      <li>The new <code class="language-plaintext highlighter-rouge">APEX_CHAIN</code> execution strategy will add a publisher and subscriber
as a chain of nodes to an Apex.OS Executor
        <h3 id="changed-9">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Refactored FastRTPS communicator plugin:
    <ul>
      <li>Uses DDS compliant API</li>
      <li>Code generator updated</li>
      <li>Implementation for <code class="language-plaintext highlighter-rouge">publish_loaned()</code>
</li>
      <li>Dockerfile improvements
        <h3 id="removed-3">Removed</h3>
      </li>
    </ul>
  </li>
  <li>CLI arg <code class="language-plaintext highlighter-rouge">--disable-async</code>. Synchronous / asynchronous publishing should be
configured externally depending on the communication mean used.</li>
</ul>

<h2 id="130-20220825">1.3.0 (2022/08/25)</h2>

<h3 id="added-8">Added</h3>
<ul>
  <li>New execution strategy option:
    <ul>
      <li>The default <code class="language-plaintext highlighter-rouge">-e INTER_THREAD</code> runs each publisher and subscriber in its
own separate thread, which matches the previous behavior</li>
      <li>A new <code class="language-plaintext highlighter-rouge">-e INTRA_THREAD</code>, which runs a single publisher and subscriber in the
same thread. The publisher writes, and the subscriber immediately takes it</li>
      <li>For Apex.OS specifically, some optimized execution strategies which use the
proprietary Apex.OS executor
        <h3 id="changed-10">Changed</h3>
      </li>
    </ul>
  </li>
  <li>Significantly refactored the communicator plugins:
    <ul>
      <li>Each plugin is split into an implementation of a <code class="language-plaintext highlighter-rouge">Publisher</code> and a
<code class="language-plaintext highlighter-rouge">Subscriber</code>, instead of a single <code class="language-plaintext highlighter-rouge">Communicator</code>
</li>
      <li>The plugin is no longer responsible for managing the metrics, such as
sample count, lost samples, and latency</li>
      <li>The plugin does not require any special logic to support roundtrip mode</li>
      <li>It is safe for the plugins to initialize their data writers and readers
at construction time, instead of delaying the initialization to the first
call of <code class="language-plaintext highlighter-rouge">publish()</code> or <code class="language-plaintext highlighter-rouge">update_subscription()</code>
</li>
      <li>Split <code class="language-plaintext highlighter-rouge">publish()</code> into <code class="language-plaintext highlighter-rouge">publish_copy()</code> and <code class="language-plaintext highlighter-rouge">publish_loaned()</code>
</li>
    </ul>
  </li>
  <li>Significantly refactored the runner framework:
    <ul>
      <li>The runner framework is responsible for the experiment metrics</li>
      <li>It manages the roundtrip mode logic</li>
      <li>It is extensible for different execution strategies or thread configurations</li>
    </ul>
  </li>
  <li>The iceoryx plugin now uses the untyped API, for improved performance</li>
</ul>

<h2 id="121-20220630">1.2.1 (2022/06/30)</h2>

<h3 id="fixed-8">Fixed</h3>
<ul>
  <li>Capture the timestamp as soon as a message is received, instead of just before
storing the metrics, to reduce the reported latency to a more correct value</li>
</ul>

<h2 id="120-20220628">1.2.0 (2022/06/28)</h2>

<h3 id="changed-11">Changed</h3>
<ul>
  <li>The CLI arguments for specifying the output type have changed:
    <ul>
      <li>For console output, updated every second, add <code class="language-plaintext highlighter-rouge">--print-to-console</code>
</li>
      <li>For file output, use <code class="language-plaintext highlighter-rouge">--logfile my_file.csv</code> or <code class="language-plaintext highlighter-rouge">--logfile my_file.json</code>
        <ul>
          <li>The type will be deduced from the file name</li>
        </ul>
      </li>
      <li>If neither of these options is specified, then a warning will print,
and the experiment will still run</li>
    </ul>
  </li>
  <li>The linter configurations are now configured locally. This means that the output
of <code class="language-plaintext highlighter-rouge">colcon test</code> should be the same no matter the installed ROS distribution.</li>
  <li>The <code class="language-plaintext highlighter-rouge">--zero-copy</code> arg is now valid even if the publisher and subscriber(s)
are in the same process
    <h3 id="removed-4">Removed</h3>
  </li>
  <li>The publisher and subscriber loop reserve metrics are no longer recorded or reported
    <h3 id="fixed-9">Fixed</h3>
  </li>
  <li>CPU usage will no longer be stuck at <code class="language-plaintext highlighter-rouge">0</code>
</li>
</ul>

<h3 id="removed-5">Removed</h3>
<ul>
  <li>The pub/sub loop reserve time metrics</li>
</ul>

<h2 id="112-20220608">1.1.2 (2022/06/08)</h2>

<h3 id="changed-12">Changed</h3>
<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">steady_clock</code> for all platforms, including QNX QOS</li>
</ul>

<h2 id="111-20220607">1.1.1 (2022/06/07)</h2>

<h3 id="changed-13">Changed</h3>
<ul>
  <li>Significant refactor to simplify the analysis pipeline
    <h3 id="fixed-10">Fixed</h3>
  </li>
  <li>Add some missing definitions when Apex.OS is enabled, but the rclcpp plugins are disabled</li>
</ul>

<h2 id="110-20220602">1.1.0 (2022/06/02)</h2>

<h3 id="added-9">Added</h3>
<ul>
  <li>New Apex.OS Polling Subscription plugin</li>
  <li>Compatibility with ROS 2 Humble</li>
</ul>

<h2 id="100-20220512">1.0.0 (2022/05/12)</h2>

<h3 id="added-10">Added</h3>
<ul>
  <li>More expressive perf_test CLI args for QOS settings</li>
  <li>A plugin for <a href="https://github.com/eclipse-cyclonedds/cyclonedds-cxx/tree/0.9.0b1">Cyclone DDS with C++ bindings v0.9.0b1</a>
    <h3 id="changed-14">Changed</h3>
  </li>
  <li>CLI args for QOS settings:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">--reliability &lt;RELIABLE|BEST_EFFORT&gt;</code></li>
      <li><code class="language-plaintext highlighter-rouge">--durability &lt;TRANSIENT_LOCAL|VOLATILE&gt;</code></li>
      <li><code class="language-plaintext highlighter-rouge">--history &lt;KEEP_LAST|KEEP_ALL&gt;</code></li>
    </ul>
  </li>
  <li>
<code class="language-plaintext highlighter-rouge">master</code> branch is compatible with many ROS 2 distributions:
    <ul>
      <li>dashing</li>
      <li>eloquent</li>
      <li>foxy</li>
      <li>galactic</li>
      <li>rolling
        <h3 id="deprecated">Deprecated</h3>
      </li>
    </ul>
  </li>
  <li>CLI flags for QOS settings:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">--reliable</code></li>
      <li><code class="language-plaintext highlighter-rouge">--transient</code></li>
      <li>
<code class="language-plaintext highlighter-rouge">--keep-last</code>
        <h3 id="removed-6">Removed</h3>
      </li>
    </ul>
  </li>
  <li>The branches for specific ROS 2 distributions have been deleted
    <h3 id="fixed-11">Fixed</h3>
  </li>
  <li>CI jobs and Dockerfiles are decoupled from the middleware bundled with the ROS 2 distribution</li>
</ul>
</div>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="iron-tutorials">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wiki Tutorials</h3>
      </div>
      <div class="panel-body">
        
        <em>This package does not provide any links to tutorials in it's <a href="https://index.ros.org/contribute/metadata/">rosindex metadata</a>.</em>
        <em>You can check on the <a href="http://wiki.ros.org/performance_test/Tutorials" target="_blank">ROS Wiki Tutorials</a> page for the package.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="iron-deps">
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Package Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th class="text-center">Deps</th>
                  <th style="width: 100%">Name</th>
                </thead>
                <tbody>
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rclcpp#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rclcpp#iron">rclcpp  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ros_environment#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ros_environment#iron">ros_environment  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake#iron">ament_cmake  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_generators#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_generators#iron">rosidl_default_generators  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rmw_implementation#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rmw_implementation#iron">rmw_implementation  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rosidl_default_runtime#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rosidl_default_runtime#iron">rosidl_default_runtime  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_gtest#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_gtest#iron">ament_cmake_gtest  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_auto#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_auto#iron">ament_lint_auto  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_common#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_common#iron">ament_lint_common  </a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
          <div class="panel-heading">
            <h3 class="panel-title">System Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                </thead>
                <tbody>
                  
                    
                      <tr>
                        <td><a href="/d/git">git</a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Dependant Packages</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                  <th class="text-center">Deps</th>
                </thead>
                <tbody>
                  
                    
                    
                    <tr>
                      <td><a href="/p/performance_report#iron">performance_report</a></td>
                      <td class="text-center">
                        
                        <a href="/p/performance_report#iron-deps" class="endoftree">
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="iron-assets">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Launch files</h3>
      </div>
      <div class="panel-body">
        
          <em>No launch files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Messages</h3>
      </div>
      <div class="panel-body">
        
          <em>No message files found.</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Services</h3>
      </div>
      <div class="panel-body">
        
          <em>No service files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Plugins</h3>
      </div>
      <div class="panel-body">
        
          <em>No plugins found.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="iron-questions">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent questions tagged <kbd>performance_test</kbd> at <strong><a href="https://robotics.stackexchange.com/" target="_blank">Robotics Stack Exchange</a></strong></h3>      </div>
      <div id="iron-question-list" class="panel-body" style="display: none;"></div>
      <div id="iron-no-question-list" class="panel-body" style="display: none;">
        <p>No questions yet, you can ask one <a href="https://robotics.stackexchange.com/questions/tagged/performance_test+iron">here</a>.</p>
      </div>
      <div id="iron-get-question-fail" class="panel-body alert alert-warning" style="display: none;">
        <p>Failed to get question list, you can ticket an issue <a href="https://github.com/ros-infrastructure/rosindex/issues/new" target="_blank" class="alert-link">here</a> </p>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/package_body_tabs.js"></script>

<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
jQuery(function() {
    // Update the count on the links to the contribution suggestions
    updateContributionSuggestionsCountOnPackage('https://gitlab.com/ApexAI/performance_test.git');
});
</script>

          </div>
          <div class="col-md-2 hidden-xs hidden-sm">
            
            
            



<div class="list-group list-group-sm ">
  <a class="list-group-item"
     target="_blank"
     href="http://docs.ros.org/en/iron/p/performance_test"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       
       API Docs
  </a>
  <a class="list-group-item"
     target="_blank"
     href="https://gitlab.com/ApexAI/performance_test/-/tree/master/performance_test"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       
       Browse Code
  </a>
  
  
  
  
  
  
</div>

          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-melodic">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>melodic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>



<script id="question-list-template" type="text/html">
  <p>
    Browse <a href="https://robotics.stackexchange.com/questions/tagged/performance_test?tab=Newest">recent questions</a>
    or see the <a href="https://robotics.stackexchange.com/questions/tagged/performance_test?tab=Votes">highest voted ones</a>.
  </p>
  
  <table class="table table-striped">
    <thead>
      <tr>
        <th scope="col">Title</th>
        <th scope="col">Answered?</th>
        <th scope="col">Created</th>
        <th scope="col">Active</th>
      </tr>
    </thead>
    <tbody>
      {{#questions}}
      <tr>
        <th scope="row"><a href="{{link}}">{{title}}</a><br><small>Tags: {{strtags}}</small></th>
        <th>{{answered}}</th>
        <th>{{created}}</th>
        <th>{{active}}</th>
      </tr>
      {{/questions}}
    </tbody>
  </table>
  {{#has_more}}
  <hr>
  <h4>Additional questions are available at
    <a href="https://robotics.stackexchange.com/questions/tagged/{{name}}?tab=Newest">Robotics Stack Exchange</a>
  </h4>
  {{/has_more}}
  
</script>

<script type="text/javascript" src="/js/mustache.js"></script>
<script type="text/javascript">
  jQuery(function() {
    jQuery.getJSON(url="https://api.stackexchange.com/2.3/questions?order=desc&site=robotics" +
                       "&tagged=performance_test&pagesize=50&sort=activity")
    .done(function(feed) {
      if (feed.items.length > 0) {
        var question_count_str = (feed.has_more ? '>' : '') + String(feed.items.length)
        const questions = feed.items.map(
          function(question) {
            question.id = Math.round(Math.random() * 99999.0);
            question.created = (new Date(question.creation_date * 1000)).toDateString()
            question.active = (new Date(question.last_activity_date * 1000)).toDateString()
            question.answered = question.is_answered ? "Yes" : "No"
            question.strtags = question.tags.join(' ')
            return question;
          });
        const template = jQuery("#question-list-template").text();
        Mustache.parse(template);
        var rendered = Mustache.render(
          template, 
          { questions: questions,
            has_more: feed.has_more,
            name: "performance_test"
          }
        );
      }
      //   TODO(tfoote) Resolve images
      //   jQuery("#-question-list img").each(function() {
      //     if (jQuery(this).attr("src").startsWith("/upfiles")) {
      //        jQuery(this).attr("src", "https://answers.ros.org" + jQuery(this).attr("src"));
      //     }
      //   });
      
      if (feed.items.length > 0) {
        jQuery("#humble-question-list").html(rendered);
        jQuery("#humble-question-list").show();
      } else {
        jQuery("#humble-no-question-list").show();
      }
      jQuery("#humble-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#jazzy-question-list").html(rendered);
        jQuery("#jazzy-question-list").show();
      } else {
        jQuery("#jazzy-no-question-list").show();
      }
      jQuery("#jazzy-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#kilted-question-list").html(rendered);
        jQuery("#kilted-question-list").show();
      } else {
        jQuery("#kilted-no-question-list").show();
      }
      jQuery("#kilted-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#rolling-question-list").html(rendered);
        jQuery("#rolling-question-list").show();
      } else {
        jQuery("#rolling-no-question-list").show();
      }
      jQuery("#rolling-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#github-question-list").html(rendered);
        jQuery("#github-question-list").show();
      } else {
        jQuery("#github-no-question-list").show();
      }
      jQuery("#github-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#noetic-question-list").html(rendered);
        jQuery("#noetic-question-list").show();
      } else {
        jQuery("#noetic-no-question-list").show();
      }
      jQuery("#noetic-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#galactic-question-list").html(rendered);
        jQuery("#galactic-question-list").show();
      } else {
        jQuery("#galactic-no-question-list").show();
      }
      jQuery("#galactic-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#iron-question-list").html(rendered);
        jQuery("#iron-question-list").show();
      } else {
        jQuery("#iron-no-question-list").show();
      }
      jQuery("#iron-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#melodic-question-list").html(rendered);
        jQuery("#melodic-question-list").show();
      } else {
        jQuery("#melodic-no-question-list").show();
      }
      jQuery("#melodic-questions-count").text(question_count_str);
      
    })
    .fail(function(jqxhr, textStatus, error) {
      console.error("Failed to get question data: " + jqxhr.responseText);
      
      jQuery("#humble-get-question-fail").show();
      
      jQuery("#jazzy-get-question-fail").show();
      
      jQuery("#kilted-get-question-fail").show();
      
      jQuery("#rolling-get-question-fail").show();
      
      jQuery("#github-get-question-fail").show();
      
      jQuery("#noetic-get-question-fail").show();
      
      jQuery("#galactic-get-question-fail").show();
      
      jQuery("#iron-get-question-fail").show();
      
      jQuery("#melodic-get-question-fail").show();
      
    });
  });
</script>


<script type="text/javascript">
  $(document).ready(function() {
    setupDistroSwitch("humble");
  });
</script>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="container-fluid">
      <div style="float:left;">
        
          <a href="https://github.com/rkent/rosindex" title="Find rosindex in Github">
          <span class="icon  icon--github">
            <svg viewBox="0 0 16 16">
              <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
            </svg>
          </span>

          <span class="username">rkent/rosindex</span>
        </a>
        <em class="hidden-xs">| generated on 2025-05-05</em>
      
      </div>
      <div style="float:right;">
        <p class="text"><span class="hidden-xs">a community-maintained index of robotics software
 | </span><a href="/privacy.txt">privacy</a></p>
      </div>
    </div>
  </div>

</footer>


  </body>

</html>
