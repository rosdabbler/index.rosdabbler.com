<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Package: rsm_core</title>
    <meta name="description" content="a community-maintained index of robotics software
">

    
    <link rel="canonical" href="http://index.rosdabbler.com/p/rsm_core/">
    
    
    <link rel="icon" sizes="any" type="image/svg+xml" href="/assets/rosindex_logo.svg">

    

    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">
    

    

    <script type="text/javascript" src=/js/jquery.js></script>
    <script src=/bootstrap/js/bootstrap.min.js type="text/javascript"></script>
    <script src=/js/jquery-cookie.js type="text/javascript"></script>
    
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EVD5Z6G6NH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EVD5Z6G6NH');
</script>

    <script type="text/javascript" src=/js/toc.js></script>

    <script src=/js/distro_switch.js></script>
  </head>

  <body>

    <header class="site-header">

  <div class="wrapper">
    <div class="container-fluid" style="margin-bottom: 10px">
      <div class="row">
        <!-- title -->
        <div class="col-xs-3" style="white-space:nowrap">
          <a class="site-title" href="/">
            <img src="/assets/rosindex_logo.svg" width="26" height="26" alt="ROS index logo" style="padding-bottom: 3px"/>
            ROS Index</a>
        </div>
        <!-- main internal links -->
        <div class="col-xs-6 text-center" style="padding:0px">
          <div class="btn-group hidden-xs" role="group" aria-label="..." style="padding: 6px">
            <div class="btn-group" role="group">
              <a href="/?search_packages=true" class="btn btn-default" role="button">Package List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/?search_repos=true" class="btn btn-default" role="button">Repository List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/search_deps" class="btn btn-default" role="button">System Dependencies</a>
            </div>
          </div>
          <div class="hidden-lg hidden-md hidden-sm">
            <button id="hLabel" class="btn btn-link dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Lists <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="hLabel">
              <li><a href="/?search_packages=true">Package List</a></li>
              <li><a href="/?search_repos=true">Repository List</a></li>
              <li><a href="/search_deps">System Dependencies</a></li>
            </ul>
          </div>
        </div>
        <!-- additional links -->
        <div class="col-xs-3 text-right" style="white-space:nowrap; padding:0px">
          <ul class="list-inline" style="margin-bottom:0px;">
            <li class="dropdown hidden-xs hidden-sm">
              <button id="rLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                ROS Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu" aria-labelledby="rLabel">
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-xs hidden-sm">
              <button id="aLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                About <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="aLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-md hidden-lg">
              <button id="qLabel" class="btn btn-link" type="button"
                      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="qLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
                <hr style="margin:7px" />
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin-top: 20px">
  <div class="container-fluid">
    <div class="row">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/?search_packages=true">Packages</a></li>
        <li class="active">rsm_core</li>
      </ol>
    </div>
    <div class="row">
      

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
    <label id="humble-option" class="distro-button btn btn-xs btn-default" href="#humble" data="humble">
      <input type="radio" name="options" id="humble-radio" autocomplete="off"> humble
    </label>
  
    <label id="jazzy-option" class="distro-button btn btn-xs btn-default" href="#jazzy" data="jazzy">
      <input type="radio" name="options" id="jazzy-radio" autocomplete="off"> jazzy
    </label>
  
    <label id="kilted-option" class="distro-button btn btn-xs btn-default" href="#kilted" data="kilted">
      <input type="radio" name="options" id="kilted-radio" autocomplete="off"> kilted
    </label>
  
    <label id="rolling-option" class="distro-button btn btn-xs btn-default" href="#rolling" data="rolling">
      <input type="radio" name="options" id="rolling-radio" autocomplete="off"> rolling
    </label>
  
    <label id="github-option" class="distro-button btn btn-xs btn-default" href="#github" data="github">
      <input type="radio" name="options" id="github-radio" autocomplete="off"> github
    </label>
  
    <label id="noetic-option" class="distro-button btn btn-xs btn-default" href="#noetic" data="noetic">
      <input type="radio" name="options" id="noetic-radio" autocomplete="off"> noetic
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-primary" data-toggle="dropdown" id="older-distro-button">
        <input type="radio" name="options" autocomplete="off">
      <span id="older-label">Older</span>
      <span class="caret"></span>
    </label>
    <ul class="dropdown-menu" role="menu">
      
        <li data="galactic" id="galactic-option" class="disabled older-distro-option"  href="#galactic">
          <a href="#galactic" data="galactic" id="galactic-button">galactic</a>
        </li>
      
        <li data="iron" id="iron-option" class="disabled older-distro-option"  href="#iron">
          <a href="#iron" data="iron" id="iron-button">iron</a>
        </li>
      
        <li data="melodic" id="melodic-option" class=" older-distro-option"  href="#melodic">
          <a href="#melodic" data="melodic" id="melodic-button">melodic</a>
        </li>
      
    </ul>
  </div>
</div>

    </div>
    <div class="row">
      &nbsp;
    </div>
  </div>
</div>


  <div class="distro distro-humble">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>humble</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-jazzy">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>jazzy</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-kilted">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>kilted</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-rolling">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>rolling</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-github">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>github</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-noetic">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>noetic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-galactic">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>galactic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-iron">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>iron</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-melodic">
    <div class="container-fluid">
      
        
        
        

        <div class="row">
          <div class="col-md-10">
            

<div class="well well-sm">
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px" src="/assets/package.png">
      </td>
      <td>
        <h3 style="margin-top: 5px">
          <a style="text-decoration:none" href="/p/rsm_core">rsm_core</a> <small>package from <a style="text-decoration:none" href="/r/robot_statemachine/github-MarcoStb1993-robot_statemachine">robot_statemachine</a> repo</small>
        </h3>
          
            
            
              <a class="label label-primary pkg-label" href="/p/robot_statemachine">

robot_statemachine
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/rsm_additions">

rsm_additions
</a>
            
          
            
            
              <span class="label label-default pkg-label">

rsm_core
</span>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/rsm_msgs">

rsm_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/rsm_rqt_plugins">

rsm_rqt_plugins
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/rsm_rviz_plugins">

rsm_rviz_plugins
</a>
            
          
      </td>
    </tr>
  </table>
</div>

            <div class="visible-xs visible-sm">
              
              
              



<div class="list-group list-group-sm list-group-horizontal list-group-justified">
  <a class="list-group-item text-center"
     target="_blank"
     href="http://docs.ros.org/en/melodic/api/rsm_core/html/"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       <br>
       API Docs
  </a>
  <a class="list-group-item text-center"
     target="_blank"
     href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       <br>
       Browse Code
  </a>
  
  
  
  
  
  <a class="list-group-item text-center "
     target="_blank"
     href="http://wiki.ros.org/rsm_core?distro=melodic"
     title="View this package on wiki.ros.org">
       <span style="margin-right: 5px;" class="glyphicon glyphicon-info-sign"></span>
       <br>
       Wiki
  </a>
  
  
</div>

            </div>
            



<ul class="nav nav-tabs nav-justified" id="melodic-tabs" style="margin-bottom:20px">
  <li class="better-tabs active">
    <a href="#melodic-overview" data-toggle="tab">Overview</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    
    <a href="#melodic-assets" data-toggle="tab"><span class="label label-primary">1</span> Assets</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    <a href="#melodic-deps" data-toggle="tab"><span class="label label-primary">11</span> Dependencies</a>
  </li>
  <li class="better-tabs">
    
    <a href="#melodic-tutorials" data-toggle="tab"><span class="label label-default">0</span> Tutorials</a>
  </li>
  <li class="better-tabs">
    <a href="#melodic-questions" data-toggle="tab"><span id="melodic-questions-count" class="label label-primary">0</span> Q & A</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="melodic-overview">
    
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h4 class="panel-title">Package Summary</h4></div>
          <div class="panel-body">
            <table class="table table-condensed">
              <tr>
                <td style="width:100px;" class="text-right"><strong>Tags</strong></td>
                <td>
                  
                  
                    <em>No category tags.</em>
                  
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Version</strong></td>
                <td>1.2.1</td>
              </tr>
              <tr>
                <td class="text-right"><strong>License</strong></td>
                <td>BSD</td>
              </tr>
              <tr>
                <td class="text-right"><strong>Build type</strong></td>
                <td>
                  
                    <span class="label label-info">
                  
                    CATKIN</span>
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Use</strong></td>
                <td>
                
                  <span class="label label-success">RECOMMENDED</span>
                
                </td>
              </tr>
            </table>
          </div>
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body">
            
            
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">Robot Statemachine</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/MarcoStb1993/robot_statemachine.git">https://github.com/MarcoStb1993/robot_statemachine.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">melodic-devel</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2022-02-10
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-primary">
          
          MAINTAINED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    
                      <a href="https://build.ros.org/view/Mdev/job/Mdev__robot_statemachine__ubuntu_bionic_amd64" class="label ci-result-success" title="Latest build information: Thu, 10 Feb 2022 07:26:20 GMT
  Total tests: 0
  Succeeded: 0
  Skipped: 0
  Failed: 0
No build history available for this repository.">
                        <span class="glyphicon glyphicon-check"></span>
                        Continuous Integration
                        
                          : 0 / 0
                        
                      </a>
                    
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <span class="label label-default">state-machine</span> <span class="label label-default">ros</span> <span class="label label-default">exploration</span> <span class="label label-default">inspection</span> <span class="label label-default">statemachine</span> 
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/robot_statemachine/#melodic-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/robot_statemachine/#melodic-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/robot_statemachine/#melodic-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Package Description</h3></div>
          <div class="panel-body">
            The statemachine package includes the Robot Statemachine's
		main functionality
          </div>
          <div class="panel-heading"><h4 class="panel-title">Additional Links</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li><a href="https://github.com/MarcoStb1993/robot_statemachine">Repository</a></li>
                
                  <li><a href="https://github.com/MarcoStb1993/robot_statemachine/issues
	">Bugtracker</a></li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Maintainers</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Marco Steinbrink</li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Authors</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Marco Steinbrink</li>
                
              </ul>
            
          </div>
        </div>
      </div>
    </div>
    
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-heading"><span class="glyphicon glyphicon-file"></span><a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/README.md" title="Open in git repository">rsm_core/README.md</a></div>
              <div class="panel-body">
                    <div class="rendered-markdown">
<h1 id="rsm-core">RSM Core</h1>

<p>The Robot Statemachine’s core components will be explained first and it’s usage afterwards, including examples and tutorials for writing plugins, including them into the RSM and setting up a robot. Also, handling the GUI and starting a simulation with the RSM is explained.</p>

<h2 id="documentation">Documentation</h2>

<p>The RSM consists of various non-customizable and custom states that are based on the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/#base-state">Base State</a>. The former <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/#non-customizable-states">non-customizable states</a> and the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/#base-state">Base State</a> are a part of this package containing the RSM’s basics.<br>
To handle state transitions the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/#state-interface">State Interface</a> is used. <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/#robot-control-mux">Robot Control Mux</a> coordinates the actual control of the robot’s movement while the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/#service-provider">Service Provider</a> contains services, publishers and subscribers for communication between states and updating the GUI. To be able to handle arbitrary robots, the RSM relies on <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/#plugins">Plugins</a> that can be implemented depending on the robot. The implemented states can be seen in the biref class diagram below. It only shows the most important aspects and is not complete!</p>

<p><img src="https://raw.githubusercontent.com/MarcoStb1993/robot_statemachine/melodic-devel/rsm_core/../images/class_diagram.png" alt="RSM Class Diagram"></p>

<h3 id="base-state">Base State</h3>

<p>The base state for all states of the RSM features the following four main functions:</p>
<ul>
  <li>onSetup</li>
  <li>onEntry</li>
  <li>onActive</li>
  <li>onExit</li>
</ul>

<p>The function <code class="language-plaintext highlighter-rouge">onSetup</code> is called immediately after it was constructed and should be used to initialize the state. The function <code class="language-plaintext highlighter-rouge">onEntry</code> is run before the state’s <code class="language-plaintext highlighter-rouge">onActive</code> method is executed for the first time and should be used to start up the processing in the state. The latter is the state’s primary method that is executed periodically and contains it’s main logic. <code class="language-plaintext highlighter-rouge">onExit</code> is called before the state will be destroyed and should take care of leaving the state cleanly.</p>

<p>To realize interrupts in the RSM, the following five functions need to be implemented:</p>
<ul>
  <li>onExplorationStart</li>
  <li>onExplorationStop</li>
  <li>onWaypointFollowingStart</li>
  <li>onWaypointFollowingStop</li>
  <li>onInterrupt</li>
</ul>

<p>These functions handle commands issued from the GUI or the use of teleoperation by telling the current state which command or interrupt occurred and let the state handle it. The method <code class="language-plaintext highlighter-rouge">onInterrupt</code> receives the type of interrupt which are also defined in the Base State and are listed below:</p>
<ul>
  <li>INTERRUPT_END: Former interrupt ended (only relevant to specific interrupt handlers)</li>
  <li>EMERGENCY_STOP_INTERRUPT: Emergency Software Stop was pushed in the GUI</li>
  <li>TELEOPERATION_INTERRUPT: Teleoperation was used</li>
  <li>SIMPLE_GOAL_INTERRUPT: A navigation goal was issued through the RViz GUI</li>
  <li>SIMPLE_GOAL_STOP_INTERRUPT: The navigation goal was stopped in the GUI</li>
</ul>

<p>The four other methods receive a reference to a bool and a string variable. The former informs if the request was successful and the desired action will be executed (true) or not (false) and the latter features a descriptive text.</p>

<p>The Base State holds a reference to the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/#state-interface">State Interface</a> which has to be used for state transitions. It also has a variable with it’s name that is necessary to display the current state in the GUI and needs to be set in the <code class="language-plaintext highlighter-rouge">onSetup</code> or <code class="language-plaintext highlighter-rouge">onEntry</code> method. Furthermore, this name contains information if the state is part of an autonomous behavior. More details will follow <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/#writing-a-plugin-state">later</a></p>

<h3 id="state-interface">State Interface</h3>

<p>The State Interface holds a reference to the current state and handles state transitions. It also provides references to plugins created for exploration, navigation, mapping or routines.
The State Interface provides the method <code class="language-plaintext highlighter-rouge">transitionToVolatileState</code> which will initiate a transition to the state provided as an argument. The provided argument is a <code class="language-plaintext highlighter-rouge">boost::shared_ptr</code> of the Base State type. This can be one of the known <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/#non-customizable-states">non-customizable states</a> or a custom state defined through a plugin.</p>

<p>To access these plugins State Interface offers the method <code class="language-plaintext highlighter-rouge">getPluginState</code> which takes the plugin type and optionally a plugin routine name as parameters. The former can be one of the following types:</p>
<ul>
  <li>CALCULATEGOAL_STATE</li>
  <li>NAVIGATION_STATE</li>
  <li>MAPPING_STATE</li>
  <li>ROUTINE_STATE</li>
</ul>

<p>For a <em>ROUTINE_STATE</em> the routine name needs to be provided as well, otherwise this parameter can remain empty. The other plugin states are set by parameters provided to State Interface on launch. If no plugin type was specified but only a name, arbitrary plugins can be created and returned for state transition. If no plugin type and name were received or the desired plugin to be created does not exist, the <strong>Idle State</strong> will be returned and an error message put out.</p>

<p>State Interface subscribes to the <em>stateInfo</em> and <em>simpleGoal</em> topics to issue interrupts to the currently active state. Furthermore, it offers the two services <em>startStopExploration</em> and <em>startStopWaypointFollowing</em> which call the particular function in the active state.</p>

<p>The State Interface updates the currently active state periodically through it’s <code class="language-plaintext highlighter-rouge">awake</code> function. This function also executes the state transition initiated by <code class="language-plaintext highlighter-rouge">transitionToVolatileState</code> and calls the active state’s methods.</p>

<h3 id="robot-control-mux">Robot Control Mux</h3>

<p>The Robot Control Mux (=Multiplexer) controls the velocity commands sent to the ROS node interfacing the motor controllers. In a simple configuration, a navigation or teleoperation node would output velocity commands that will be received by the motor controller interface and move the robot. To enable high level control of the input the motor controller receives, the Robot Control Mux should be the only node in the setup publishing directly on the topic the motor controller interface subscribes to.</p>

<p>Velocity commands generated by navigation should be published to an autonomy topic and velocity commands issued by teleoperation to a teleoperation topic. These two topics are subscribed by the Robot Control Mux that decides which or if any topic will be forwarded. The two input and the output topic’s names are set by parameters at launch.</p>

<p>Which topic will be conducted is based on the operation mode which can be one of the following:</p>
<ul>
  <li>Autonomy</li>
  <li>Stopped</li>
  <li>Teleoperation</li>
</ul>

<p>For <em>Autonomy</em> and <em>Teleoperation</em> the respective topic is propagated to the motor controller interface. If the operation mode is set to <em>Stopped</em> a command velocity of zero for all directions is published. The operation mode can be set through the GUI by a service Robot Control Mux is providing. It is published to the GUI for display as well. If a teleoperation command is issued, the mode automatically switches to <em>Teleoperation</em>. When in <em>Teleoperation</em> mode, a timer is started to supervise if new commands are being issued. If no new commands are received for the timer duration (which is set through a parameter), <em>Teleoperation</em> is replaced with the <em>Stopped</em> mode. The same functionality can also be activated for commands from a joystick by setting the respective parameters.</p>

<p>If the software emergency stop is activated in the GUI, the operation mode is handled as <em>Stopped</em> and cannot be changed until the stop button is released again.</p>

<h3 id="service-provider">Service Provider</h3>

<p>The Service Provider handles the communication between the different states and saves data throughout state transitions. Therefore it offers a lot of services to save and retrieve variables for the core functionality of the RSM.</p>

<p>It offers all services to control waypoint following which includes adding, moving and removing single waypoints, setting their <code class="language-plaintext highlighter-rouge">visited</code> and <code class="language-plaintext highlighter-rouge">unreachable</code> variables and the routine to be executed upon reaching the waypoint. Furthermore, all waypoints can be retrieved and reset which effectively sets <code class="language-plaintext highlighter-rouge">visited</code> and <code class="language-plaintext highlighter-rouge">unreachable</code> to false. The waypoint following mode can be set and the list of all available routines retrieved. The latter is given as a parameter to the Service Provider. The list of waypoints is also published.</p>

<p>For setting and retrieving the current navigation goal the Service Provider is offering services. In addition, the current robot pose can be retrieved and is calculated from the transform of the map to the robot’s base footprint. Furthermore, when a navigation goal is completed, a respective service must be called
that handles waypoint following and exploration for a successful or unsuccessful completion.</p>

<p>The Service Provider hosts services for exploration that enable setting and getting the exploration mode. It is also published. When the mode is set to <em>Interrupt</em>, goals can become obsolete. This means the exploration algorithm has found more rewarding goals to go to.</p>

<p>Furthermore, it advertises services for setting and retrieving the reverse mode, which is also published.</p>

<h3 id="non-customizable-states">Non-customizable states</h3>

<p>The core state machine already features the following states for direct usage:</p>
<ul>
  <li>
<strong>Boot State:</strong> Is the first state to be called and subscribes to a service which tells it when all necessary systems are available and ready to use. Then it initiates a transition to the <strong>Idle State</strong>. Can only be interrupted by the software emergency stop.</li>
  <li>
<strong>Emergency Stop State:</strong> State being called when the software emergency stop was pushed. Only allows transition to <strong>Idle State</strong> when button is released.</li>
  <li>
<strong>Idle State:</strong> Standard state when no commands were issued. Allows transitions to all other states through interrupts.</li>
  <li>
<strong>Teleoperation State:</strong> State being called when teleoperation commands were issued. Only transitions to <strong>Idle State</strong> when teleoperation timed out and <strong>Emergency Stop State</strong> when receiving the respective interrupt.</li>
  <li>
<strong>Waypoint Following State:</strong> Handles the waypoint following functionality by providing the next navigation goal depending on the status of all waypoints and the waypoint following mode. Normally transitions to the navigation state plugin. Can be interrupted by the software emergency stop and teleoperation which leads to a transition to the particular state. If waypoint following is stopped, transitions to <strong>Idle State</strong>.</li>
</ul>

<h3 id="plugins">Plugins</h3>

<p>The RSM package requires three different plugin states, one for exploration to calculate the next goal, one for navigation and one for mapping. The first is called when exploration is started or a previous exploration target was mapped successfully and  should interface an exploration package like <a href="http://wiki.ros.org/explore_lite">explore lite</a> which finds unexplored regions in the map and extract a next goal from it. The second should interface a package for navigation like the <a href="http://wiki.ros.org/navigation">ROS navigation stack</a> and update the RSM according to the navigation’s progress. The last is called when an exploration goal is reached and can include movements for better map acquisition or similar behaviors.</p>

<p>Also, up to ten plugins states can be included for the waypoint following routines that are executed upon reaching a waypoint. They are not necessary for the RSM like the plugins mentioned above. These routines can be implemented to enable arbitrary behavior when reaching a certain waypoint, for example inspecting gauge valves with a camera.</p>

<p>More plugins can be added if additional states during exploration or waypoint following are desired. These can only be called from other implemented plugin states as the basic RSM only includes transitions to the plugins described above. For example, if you have a robot able to climb stairs and you detect stairs during navigation, you can then call another plugin for stair-climbing and afterwards transition back to normal navigation.</p>

<p>An exemplary state diagram with plugin states being shown with a bold border can be seen below.</p>

<p><img src="https://raw.githubusercontent.com/MarcoStb1993/robot_statemachine/melodic-devel/rsm_core/../images/state_diagram.png" alt="RSM State Diagram"></p>

<h2 id="tutorials">Tutorials</h2>

<p>The following section displays some examples and tutorials on how to use the RSM, starting with the required setup to use the RSM. Afterwards, running and launching the RSM on its own and in a simulation environment is presented. The provided GUI and it’s controls are shown and a tutorial on writing and including your own plugin state is presented last.</p>

<h3 id="set-up-a-robot-for-use-with-rsm">Set up a robot for use with RSM</h3>

<p>Setting up a robot for the basic RSM usage is fairly straightforward since it only requires setting up a robot motor controller interface that subscribes to command velocity messages of type <a href="http://docs.ros.org/api/geometry_msgs/html/msg/Twist.html">geometry_msgs/Twist</a> and generates actual motor commands from them.</p>

<p>A service provider to tell the <strong>Boot State</strong> that the boot is finished is also required. This should ideally check if all necessary systems on your robot are up and running. The service provider needs to offer a service of type <a href="http://docs.ros.org/api/std_srvs/html/srv/SetBool.html">std_srvs/SetBool</a> under the name “rsm/bootUpFinished”. The following code snippet shows a rudimentary sample implementation in a node:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"ros/ros.h"</span><span class="cp">
#include</span> <span class="cpf">"std_srvs/SetBool.h"</span><span class="cp">
</span>
<span class="kt">bool</span> <span class="n">boot_finished</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

<span class="kt">bool</span> <span class="nf">bootUpService</span><span class="p">(</span><span class="n">std_srvs</span><span class="o">::</span><span class="n">SetBool</span><span class="o">::</span><span class="n">Request</span> <span class="o">&amp;</span><span class="n">req</span><span class="p">,</span>
		<span class="n">std_srvs</span><span class="o">::</span><span class="n">SetBool</span><span class="o">::</span><span class="n">Response</span> <span class="o">&amp;</span><span class="n">res</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">boot_finished</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">res</span><span class="p">.</span><span class="n">success</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">res</span><span class="p">.</span><span class="n">message</span> <span class="o">=</span> <span class="s">"Finished"</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">res</span><span class="p">.</span><span class="n">success</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
		<span class="n">res</span><span class="p">.</span><span class="n">message</span> <span class="o">=</span> <span class="s">"Still booting ..."</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">ros</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">,</span> <span class="s">"bootUpNode"</span><span class="p">);</span>
	<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">(</span><span class="s">"rsm"</span><span class="p">);</span>
	<span class="n">ros</span><span class="o">::</span><span class="n">ServiceServer</span> <span class="n">bootup_service</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">advertiseService</span><span class="p">(</span><span class="s">"bootUpFinished"</span><span class="p">,</span>
			<span class="n">bootUpService</span><span class="p">);</span>
	<span class="c1">//checking boot process and setting boot_finished to true if finished</span>
	<span class="n">ros</span><span class="o">::</span><span class="n">spin</span><span class="p">();</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>

<p>If this is not possible or necessary for your configuration, you can just launch the <code class="language-plaintext highlighter-rouge">bootUpNode</code> from the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions#rsm-additions">RSM additions package</a> that sets up the service provider and returns a successful boot message after default 1 second. The delay can be set using the parameter <code class="language-plaintext highlighter-rouge">wait_time</code>.</p>

<p>The setup for navigating to set goals and executing mapping behaviors or routines depends on the defined plugins and can therefore not generally be declared.</p>

<p><em>Note</em>: If you plan on using the plugins for <a href="http://wiki.ros.org/navigation">ROS navigation</a> provided in the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions#rsm-additions">RSM additions package</a>, you need to follow the <a href="http://wiki.ros.org/navigation/Tutorials/RobotSetup">navigation stack robot setup tutorial</a>.</p>

<p>In general, a tool for navigation, a tool for mapping and a tool for exploration are necessary to fully exploit the robot RSM. This includes at least one sensor for sensing the environment, creating a 2D or 3D map and running SLAM. When provided with the particular exploration and navigation plugins, the RSM will work for 3D maps.</p>

<h3 id="run-rsm">Run RSM</h3>

<p>The RSM’s core functionality is distributed over several nodes that can simply be started with the launchfile <code class="language-plaintext highlighter-rouge">rsm.launch</code> which requires the following arguments:</p>
<ul>
  <li>
<code class="language-plaintext highlighter-rouge">update_frequency</code>: The update rate in Hz of the RSM (default: 20)</li>
  <li>
<code class="language-plaintext highlighter-rouge">robot_frame</code>: The robot base frame (default: “base_footprint”)</li>
  <li>
<code class="language-plaintext highlighter-rouge">mapping_plugin</code>: The plugin used for mapping (default: <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions#mapping-dummy-state">“rsm::MappingDummyState”</a>)</li>
  <li>
<code class="language-plaintext highlighter-rouge">calculate_goal_plugin</code>: The plugin used to calculate the next goal for exploration	 (default: <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions#calculate-goal-state">“rsm::CalculateGoalState”</a>)</li>
  <li>
<code class="language-plaintext highlighter-rouge">navigation_plugin</code>: The plugin used for navigation (default: <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions#navigation-state">“rsm::NavigationState”</a>)</li>
  <li>
<code class="language-plaintext highlighter-rouge">autonomy_cmd_vel_topic</code>: The name of the command velocity topic for messages from exploration, waypoint following or simple goals (default: “/autonomy/cmd_vel”)</li>
  <li>
<code class="language-plaintext highlighter-rouge">teleoperation_cmd_vel_topic</code>:	The name of the command velocity topic for messages from teleoperation (default: “/teleoperation/cmd_vel”)</li>
  <li>
<code class="language-plaintext highlighter-rouge">cmd_vel_topic</code>: The name of the command velocity topic that the motor controller interface subscribes to (default: “/cmd_vel)</li>
  <li>
<code class="language-plaintext highlighter-rouge">joystick_used</code>: Is a joystick used for control and should autonomy be stopped when it is handled (default: “false”)</li>
  <li>
<code class="language-plaintext highlighter-rouge">joystick_topic</code>: The name of the joystick topic for messages from handling the joystick (default: “/joy”)</li>
  <li>
<code class="language-plaintext highlighter-rouge">teleoperation_idle_timer</code>: Time in seconds without input from teleoperation that leads to a transition to <strong>Idle State</strong> (default: 0.5)</li>
  <li>
<code class="language-plaintext highlighter-rouge">waypoint_routines</code>: List of all plugins to be used as routines for waypoints (default: [])</li>
</ul>

<p><em>Note</em>: The default plugins mentioned above all exist in the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions#rsm-additions">RSM additions package</a>.</p>

<p>The nodes can of course be started separately though it is easier to use the launch file.</p>

<h3 id="launch-simulation">Launch simulation</h3>

<p>To demonstrate the RSM and get used to it’s controls, the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions#rsm-additions">RSM additions package</a> offers three launch files that start a simulation including a complete robot and environment to start right away.</p>

<p>The first two simulations use the 3D <a href="http://gazebosim.org/">Gazebo</a> simulator which has to be <a href="http://gazebosim.org/tutorials?cat=install">installed</a> before (If you have installed ROS with <code class="language-plaintext highlighter-rouge">ros-melodic-desktop-full</code>, it is already included).</p>

<p>If you want to simulate a <a href="https://emanual.robotis.com/docs/en/platform/turtlebot3/overview">TurtleBot3 Burger</a>, your system requires the following two meta-packages: <a href="http://wiki.ros.org/turtlebot3">turtlebot3</a> and <a href="http://wiki.ros.org/turtlebot3_simulations">turtlebot3_simulations</a>. The <a href="https://clearpathrobotics.com/husky-unmanned-ground-vehicle-robot/">Clearpath Robotics Husky</a> simulation depends on the <a href="http://wiki.ros.org/husky_simulator">husky simulator package</a> which includes the robot to be simulated. Both TurtleBot3 and Husky had their URDFs customized to add a front-facing simulated RealSense depth camera. For the Husky it comes on an arch with a swivelling joint as a mount. Therefore, when running the exploration, the Mapping State actually moves the camera around to increase the perceived area.</p>

<p>The third simulation depends on the <a href="http://wiki.ros.org/stdr_simulator">stdr simulator package</a> which is solely in 2D and offers a much less CPU-intensive alternative to Gazebo. If your machine is not very powerful or you just want to have a quick peek at what the RSM has to offer, stick with the stdr simulator. Screenshots from two simulations can be seen below, <a href="http://gazebosim.org/">Gazebo</a> first and <a href="http://wiki.ros.org/stdr_simulator">stdr simulator</a> last, the simulation on the left and RViz on the right.</p>

<p><img src="https://raw.githubusercontent.com/MarcoStb1993/robot_statemachine/melodic-devel/rsm_core/../images/simulations.png" alt="Simulations"></p>

<p>All simulations use the plugins implemented in <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions#rsm-additions">RSM additions</a> which need the following packages to be installed:</p>
<ul>
  <li>
<a href="http://wiki.ros.org/gmapping">gmapping</a> for SLAM</li>
  <li>
<a href="http://wiki.ros.org/navigation">ROS navigation stack</a> for the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions#navigation-state">Navigation State</a>
</li>
  <li>
<a href="http://wiki.ros.org/explore_lite">explore lite</a> for the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions#calculate-goal-state">Calculate Goal State</a>
</li>
</ul>

<p>Follow these steps for installation (this tutorial assumes you are using <a href="https://catkin-tools.readthedocs.io/en/latest/installing.html">catkin_tools</a>, if you don’t, replace <code class="language-plaintext highlighter-rouge">catkin build ...</code> with <code class="language-plaintext highlighter-rouge">catkin make</code>):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo apt install ros-melodic-gmapping ros-melodic-navigation
cd /path/to/your/catkin_ws/src
git clone https://github.com/hrnr/m-explore.git
catkin build explore_lite

</code></pre></div></div>

<p>To install all dependencies for the TurtleBot3 Burger simulation, run these commands in a terminal:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo apt install ros-melodic-turtlebot3
sudo apt install ros-melodic-turtlebot3-simulations

</code></pre></div></div>

<p>To install the Husky simulation, run the following command in a terminal:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo apt install ros-melodic-husky-simulator

</code></pre></div></div>

<p>For the stdr simulator, follow these instructions (without qt4 the build will fail):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo apt install qt4-default
cd /path/to/your/catkin_ws/src
git clone https://github.com/stdr-simulator-ros-pkg/stdr_simulator.git
catkin build stdr_simulator

</code></pre></div></div>

<p>When the above prerequisites are met, the simulations can be launched with the following commands including a pre-configured RViz display. If you do not want to start RViz, just add  <code class="language-plaintext highlighter-rouge">rviz:=false</code>.</p>

<p>For gazebo with the TurtleBot3 Burger robot:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>roslaunch rsm_additions simulation_turtlebot3.launch

</code></pre></div></div>

<p>For gazebo with the Husky UGV:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>roslaunch rsm_additions simulation_husky.launch

</code></pre></div></div>

<p>For the stdr simulator:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>roslaunch rsm_additions simulation_stdr.launch

</code></pre></div></div>

<h3 id="gui-introduction">GUI introduction</h3>

<p>The RSM can be operated through a GUI that enables the use of all it’s core functionalities. The GUI panel is depicted below and can be integrated into <a href="http://wiki.ros.org/rviz">RViz</a> or <a href="http://wiki.ros.org/rqt">rqt</a>. To the former by adding a new panel through <em>Panels-&gt;Add New Panel</em> and then choose <em>RSMControlPanel</em> under <em>rsm_rviz_plugins</em>. To the latter by adding a new plugin through <em>Plugins-&gt;RSM Control</em>. The GUI always shows which state is currently active and provides the options explained below.</p>

<p><img src="https://raw.githubusercontent.com/MarcoStb1993/robot_statemachine/melodic-devel/rsm_core/../images/rsm_control_panel.png" alt="RSM Control Panel"></p>

<p>The GUI offers control over the class handling the command velocities forwarded to the motor controller interface. This includes the software emergency stop as well as choosing autonomy, teleoperation or stopped. When the software emergency stop is active, the other choices are disabled and the command velocity is set to stopped until the software emergency stop is released again.</p>

<p>The exploration can be started and stopped by using the respective buttons in the GUI. Next to the button is a drop-down box where the exploration mode can be set. This mode can either be <em>Finish</em> or <em>Interrupt</em> where the former lets the robot reach each goal before transitioning to <strong>Mapping State</strong> while the latter starts the transition as soon as the current goal is no longer listed as an exploration goal. The mode can only be set before starting
exploration and not while it is running.</p>

<p>Waypoint following can also be started and stopped through the respective buttons. Furthermore, when waypoint following is stopped, there is the option to reset the current progress and restore all waypoints to their initial values. It is possible to set the waypoint following mode using the drop-down box next to the formerly mentioned buttons. The waypoint following mode can be one of the following three and only changed when stopped:</p>
<ul>
  <li>single</li>
  <li>roundtrip</li>
  <li>patrol</li>
</ul>

<p>The single mode lets the robot start from the first waypoint and then to all consecutive ones. Upon reaching the last one it stops. In roundtrip mode, after reaching the last waypoint all waypoints are reset and it starts anew from waypoint one. This is repeated until manually stopped. Patrol mode works in a similar fashion. After reaching the last waypoint all waypoints are reset and it starts again in reverse order. The first and last waypoints are only targeted once and their attached routines executed only once as well. Also, it can only be stopped manually.</p>

<p>The GUI also offers the possibility to set a waypoint at the robot’s current location and with the robot’s current orientation. These waypoint’s routines can be set from the drop-down box next to the button setting the actual waypoint.</p>

<p>Furthermore, a checkbox enables setting the reverse mode manually. When the box is checked the robot moves in reverse. A button next to the checkbox enables stopping the navigation when a simple navigation goal was set through RViz.</p>

<p>When using <a href="http://wiki.ros.org/rviz">RViz</a>, waypoints can be set by utilizing the <strong>Plant Waypoint Tool</strong> (Hotkey: “w”). It can be added through the plus button (Add a new tool) in the toolbar and then choosing <em>PlantWaypointTool</em> under <em>rsm_rviz_plugins</em>. This enables putting waypoints on the ground plane, determining their x- and y-coordinates, and orientate them  in yaw by dragging the mouse in the desired direction. They are depicted as <a href="http://wiki.ros.org/interactive_markers">interactive markers</a> with a flagpole mesh and the number of the waypoint above. Accordingly, an interactive marker display needs to be added with the topic name <em>waypoint_markers/update</em> to show them. The color of the marker corresponds to the waypoint’s status: blue is the default color, green means the waypoint has been visited and red that it is unreachable.</p>

<p>The displayed markers are interactive and can be seen below. Using the circle around them, they can be dragged in the desired direction, changing their x-y-position and yaw-orientation. The arrows above and below can be used to drag them in the respective direction, altering it’s z-coordinate. Clicking on the waypoint marker opens a menu that offers the options to set the routine to be executed when reaching the waypoint and to delete the waypoint. The routine can also be set to none.</p>

<p><img src="https://raw.githubusercontent.com/MarcoStb1993/robot_statemachine/melodic-devel/rsm_core/../images/waypoints.png" alt="Waypoint in RViz"></p>

<p><em>Note</em>: When the robot is moving towards a waypoint, the specific waypoint can be manipulated but these changes will not be forwarded to the current navigation. So, changes made after the robot started to move towards the waypoint, will not be regarded until the waypoint and it’s possible routine was finished.</p>

<p>The <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions#rsm-additions">RSM additions package</a> features some exemplary <a href="http://wiki.ros.org/rviz/UserGuide#Configurations">RViz configuration</a> files for the respective launch files that automatically include the GUI and <strong>Plant Waypoint Tool</strong> as well as adding the waypoint <a href="http://wiki.ros.org/interactive_markers">interactive marker</a> topic to the display.</p>

<p><em>Note:</em> When saving the RViz configuration, the <strong>Plant Waypoint Tool</strong> sometimes does not get included in the configuration and has to be added each time RViz is started manually. To fix this, you need to add <code class="language-plaintext highlighter-rouge">- Class: rsm::PlantWaypointTool</code> to your RViz configuration file by hand. It has to be appended under <em>Visualization Manager: Tools</em> as can be seen in the snippet below.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
Visualization Manager:
  Class: ""
  Displays:
  ...
  Name: root
  Tools:
    ...
    - Class: rsm::PlantWaypointTool 
  Value: true
  ...

</code></pre></div></div>

<p>If the <strong>2D Nav Goal Tool</strong> (Hotkey: “g”) from RViz should be used, the respective topic from RViz needs to be remapped, so that it works with the RSM. The following remap needs to be added to the RViz launch, otherwise the <strong>2D Nav Goal Tool</strong> cannot be used:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;node if="$(arg rviz)" pkg="rviz" type="rviz" name="rviz" args="-d ..."&gt;
	&lt;remap from="/move_base_simple/goal" to="/rsm/simpleGoal" /&gt;
&lt;/node&gt;

</code></pre></div></div>

<p><em>Note</em>: Replace the dots with the path to your configuration file.</p>

<h3 id="writing-a-plugin-state">Writing a plugin state</h3>

<p>To create a plugin state to be used with the robot RSM follow the upcoming steps. This is very similar to the ROS tutorial <a href="http://wiki.ros.org/pluginlib/Tutorials/Writing%20and%20Using%20a%20Simple%20Plugin">Writing and Using a Simple Plugin</a> but also includes some specific details for the RSM.</p>

<p>In your package, add the following code to the respective files:</p>

<p><em>CMakeLists.txt:</em></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>find_package(catkin REQUIRED COMPONENTS
  roscpp
  pluginlib
  rsm_core
  rsm_msgs
  ...
)

</code></pre></div></div>

<p><em>package.xml:</em></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
<span class="nt">&lt;build_depend&gt;</span>pluginlib<span class="nt">&lt;/build_depend&gt;</span>
<span class="nt">&lt;build_export_depend&gt;</span>pluginlib<span class="nt">&lt;/build_export_depend&gt;</span>
<span class="nt">&lt;exec_depend&gt;</span>pluginlib<span class="nt">&lt;/exec_depend&gt;</span>
<span class="nt">&lt;exec_depend&gt;</span>rsm_core<span class="nt">&lt;/exec_depend&gt;</span>
<span class="nt">&lt;build_depend&gt;</span>rsm_core<span class="nt">&lt;/build_depend&gt;</span>
<span class="nt">&lt;build_export_depend&gt;</span>rsm_core<span class="nt">&lt;/build_export_depend&gt;</span>
<span class="nt">&lt;build_depend&gt;</span>rsm_msgs<span class="nt">&lt;/build_depend&gt;</span>
<span class="nt">&lt;build_export_depend&gt;</span>rsm_msgs<span class="nt">&lt;/build_export_depend&gt;</span>
<span class="nt">&lt;exec_depend&gt;</span>rsm_msgs<span class="nt">&lt;/exec_depend&gt;</span>
...

</code></pre></div></div>

<p>This adds all dependencies needed to use the <a href="http://wiki.ros.org/pluginlib">pluginlib</a> and include the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/#base-state">Base State</a>.<br>
Next, create a class consisting of a header and source file in the respective directory in your package. The class needs to inherit from the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/#base-state">Base State</a>, interact with the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/#state-interface">State Interface</a> and declare it is a plugin. If the plugin is part of exploration or waypoint following, its name
must start with a leading <code class="language-plaintext highlighter-rouge">"E:"</code> or <code class="language-plaintext highlighter-rouge">"W:"</code> respectively. This is used to check, if the particular behavior is still active. The sample code for header and source are shown below.</p>

<p><em>ExampleState.h</em>:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;pluginlib/class_list_macros.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;rsm_core/BaseState.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;rsm_core/StateInterface.h&gt;</span><span class="cp">
</span>
<span class="k">namespace</span> <span class="n">rsm</span> <span class="p">{</span>

<span class="k">class</span> <span class="nc">ExampleState</span><span class="o">:</span> <span class="k">public</span> <span class="n">BaseState</span> <span class="p">{</span>

<span class="nl">public:</span>
	<span class="n">ExampleState</span><span class="p">();</span>
	<span class="o">~</span><span class="n">ExampleState</span><span class="p">();</span>
	<span class="kt">void</span> <span class="n">onSetup</span><span class="p">();</span>
	<span class="kt">void</span> <span class="n">onEntry</span><span class="p">();</span>
	<span class="kt">void</span> <span class="n">onActive</span><span class="p">();</span>
	<span class="kt">void</span> <span class="n">onExit</span><span class="p">();</span>
	<span class="kt">void</span> <span class="n">onExplorationStart</span><span class="p">(</span><span class="kt">bool</span> <span class="o">&amp;</span><span class="n">success</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">message</span><span class="p">);</span>
	<span class="kt">void</span> <span class="n">onExplorationStop</span><span class="p">(</span><span class="kt">bool</span> <span class="o">&amp;</span><span class="n">success</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">message</span><span class="p">);</span>
	<span class="kt">void</span> <span class="n">onWaypointFollowingStart</span><span class="p">(</span><span class="kt">bool</span> <span class="o">&amp;</span><span class="n">success</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">message</span><span class="p">);</span>
	<span class="kt">void</span> <span class="n">onWaypointFollowingStop</span><span class="p">(</span><span class="kt">bool</span> <span class="o">&amp;</span><span class="n">success</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">message</span><span class="p">);</span>
	<span class="kt">void</span> <span class="n">onInterrupt</span><span class="p">(</span><span class="kt">int</span> <span class="n">interrupt</span><span class="p">);</span>
<span class="p">};</span>

<span class="p">}</span>

</code></pre></div></div>

<p><em>ExampleState.cpp</em>:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">"ExampleState.h"</span><span class="cp">
</span>
<span class="k">namespace</span> <span class="n">rsm</span> <span class="p">{</span>

<span class="n">ExampleState</span><span class="o">::</span><span class="n">ExampleState</span><span class="p">()</span> <span class="p">{</span>
	<span class="c1">//...</span>
<span class="p">}</span>

<span class="n">ExampleState</span><span class="o">::~</span><span class="n">ExampleState</span><span class="p">()</span> <span class="p">{</span>
	<span class="c1">//...</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">ExampleState</span><span class="o">::</span><span class="n">onSetup</span><span class="p">()</span> <span class="p">{</span>
	<span class="c1">//...</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">ExampleState</span><span class="o">::</span><span class="n">onEntry</span><span class="p">()</span> <span class="p">{</span>
	<span class="c1">//...</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">ExampleState</span><span class="o">::</span><span class="n">onActive</span><span class="p">()</span> <span class="p">{</span>
	<span class="c1">//...</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">ExampleState</span><span class="o">::</span><span class="n">onExit</span><span class="p">()</span> <span class="p">{</span>
	<span class="c1">//...</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">ExampleState</span><span class="o">::</span><span class="n">onExplorationStart</span><span class="p">(</span><span class="kt">bool</span> <span class="o">&amp;</span><span class="n">success</span><span class="p">,</span>
		<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">message</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">//...</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">ExampleState</span><span class="o">::</span><span class="n">onExplorationStop</span><span class="p">(</span><span class="kt">bool</span> <span class="o">&amp;</span><span class="n">success</span><span class="p">,</span>
		<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">message</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">//...</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">ExampleState</span><span class="o">::</span><span class="n">onWaypointFollowingStart</span><span class="p">(</span><span class="kt">bool</span> <span class="o">&amp;</span><span class="n">success</span><span class="p">,</span>
		<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">message</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">//...</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">ExampleState</span><span class="o">::</span><span class="n">onWaypointFollowingStop</span><span class="p">(</span><span class="kt">bool</span> <span class="o">&amp;</span><span class="n">success</span><span class="p">,</span>
		<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">message</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">//...</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">ExampleState</span><span class="o">::</span><span class="n">onInterrupt</span><span class="p">(</span><span class="kt">int</span> <span class="n">interrupt</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">//...</span>
<span class="p">}</span>

<span class="p">}</span>

<span class="n">PLUGINLIB_EXPORT_CLASS</span><span class="p">(</span><span class="n">rsm</span><span class="o">::</span><span class="n">ExampleState</span><span class="p">,</span>
		<span class="n">rsm</span><span class="o">::</span><span class="n">BaseState</span><span class="p">)</span>


</code></pre></div></div>

<p>The state plugin needs to implement all methods declared in the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/#base-state">Base State</a> as <code class="language-plaintext highlighter-rouge">virtual</code> and enables to add arbitrary functionality to them. The <code class="language-plaintext highlighter-rouge">PLUGINLIB_EXPORT_CLASS</code> macro registers the class as a plugin to the pluginlib.</p>

<p>To make the plugin available to ROS, an XML file needs to be added in the package that declares them as a library. The file should look like this:<br>
<em>rsm_example_plugins.xml</em>:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;library</span> <span class="na">path=</span><span class="s">"lib/librsm_example_plugins"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;class</span> <span class="na">type=</span><span class="s">"rsm::ExampleState"</span>
		<span class="na">base_class_type=</span><span class="s">"rsm::BaseState"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;description&gt;</span>This is the example state.<span class="nt">&lt;/description&gt;</span>
	<span class="nt">&lt;/class&gt;</span>
	...
<span class="nt">&lt;/library&gt;</span>

</code></pre></div></div>

<p>It can feature multiple classes to declare in the same manner.<br>
The plugin library needs to be exported as well. Therefore the following lines need to be added to the <em>package.xml</em>:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;export&gt;</span>
	<span class="nt">&lt;rsm</span> <span class="na">plugin=</span><span class="s">"${prefix}/rsm_example_plugins.xml"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/export&gt;</span>

</code></pre></div></div>

<p><em>Note:</em> There can only be one <code class="language-plaintext highlighter-rouge">export</code> bracket in each <em>package.xml</em>.</p>

<p>With the following statement you can check in the terminal if the plugin was registered correctly:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rospack plugins --attrib=plugin rsm
</code></pre></div></div>

<p>It should show:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"your_package_name" /"your_workspace_path"/src/"your_package_name"/rsm_example_plugins.xml
rsm_additions /home/marco/catkin_ws/src/robot_rsm/rsm_additions/rsm_plugins.xml

</code></pre></div></div>
<p>You are now able to use the plugin state in the RSM.</p>

<h3 id="use-plugin-state-in-the-rsm">Use plugin state in the RSM</h3>

<p>To use the created plugin from above in the RSM, it has to be made known to the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/#state-interface">State Interface</a>. This needs to be done by setting the respective parameters, either through the launch file or manually when starting the nodes from console. The <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/#state-interface">State Interface</a> expects the names for the <strong>Calculate Goal State</strong>, the <strong>Mapping State</strong> and the <strong>Navigation State</strong> plugins. The waypoint <strong>Routine State</strong> plugins need to be given to the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/#service-provider">Service Provider</a>. A sample launch with set parameters can be seen in the snippet below, where the plugins defined in <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions#rsm-additions">RSM additions</a> are used. A detailed example can be seen in the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions/launch">RSM additions launch files</a>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;include file="$(find rsm_core)/launch/rsm.launch"&gt;
	&lt;arg name="calculate_goal_plugin" value="rsm::CalculateGoalState" /&gt;
	&lt;arg name="navigation_plugin" value="rsm::NavigationState" /&gt;
	&lt;arg name="mapping_plugin" value="rsm::MappingState" /&gt;
	&lt;arg name="waypoint_routines" value="['Reversing']" /&gt;
	...
&lt;/include&gt;

</code></pre></div></div>

<p>The provided plugins can have arbitrary names, though it is recommended to use the <em>rsm</em> namespace to avoid collisions with other packages since the plugin names need to be unique.</p>

<p>For waypoint routines up to ten routines can be provided as an array. Each routine plugin must be named like this &lt;pre&gt;rsm::<i>Name</i>RoutineState&lt;/pre&gt;
<em>Name</em> has to be replaced by a uniquely identifying name for the particular routine. For the routines parameter provided only the <em>Name</em> needs to be set. So in the above example the plugin corresponding to the <code class="language-plaintext highlighter-rouge">Reversing</code> routine is called <code class="language-plaintext highlighter-rouge">rsm::ReversingRoutineState</code>.</p>

<p>If additional plugins should be used, their names do not need to be made known to the RSM up front. How to include them will be explained below.</p>

<p>For a transition to another state, in your implementation of a state the <code class="language-plaintext highlighter-rouge">transitionToVolatileState</code> method from <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/#state-interface">State Interface</a> needs to be called. If a transition to one of the included states is desired, it needs to be included in the header file and and then initialized and handed over as a parameter to the previously mentioned method. This is the first of the below examples. The second is a transition to a plugin state, which is made by providing one of the predefined types from <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/#state-interface">State Interface</a> to the method. If it is a routine plugin that should be called, the routine plugin’s name needs to be provided as well, see the third example. The last example shows a transition to an additional plugin, where a 0 for the plugin type needs to be given and the name of the plugin without a leading <code class="language-plaintext highlighter-rouge">rsm::</code> prefix.</p>

<ol>
  <li>Transition to already included state:<br>
<code class="language-plaintext highlighter-rouge">_stateinterface-&gt;transitionToVolatileState(boost::make_shared&lt;IdleState&gt;());</code>
</li>
  <li>Transition to plugin state for navigation:<br>
<code class="language-plaintext highlighter-rouge">_stateinterface-&gt;transitionToVolatileState(_stateinterface-&gt;getPluginState(NAVIGATION_STATE));</code>
</li>
  <li>Transition to routine plugin state:<br>
<code class="language-plaintext highlighter-rouge">_stateinterface-&gt;transitionToVolatileState(_stateinterface-&gt;getPluginState(ROUTINE_STATE, "Reversing"));</code>
</li>
  <li>Transition to additional plugin state:<br>
<code class="language-plaintext highlighter-rouge">_stateinterface-&gt;transitionToVolatileState(_stateinterface-&gt;getPluginState(0, "ClimbStairsState"));</code>
</li>
</ol>

<p>For a reference implementation of the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions#calculate-goal-state">Calculate Goal State</a>, the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions#navigation-state">Navigation State</a>, the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions#mapping-state">Mapping State</a> and a routine plugin called <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions#reversing-routine-state">Reversing Routine State</a>, see the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions#rsm-additions">rsm additions package</a>.</p>

<p>If additional data has to be passed between plugin states, that is not already covered by the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/#service-provider">Service Provider</a>, it is recommended to implement an additional data handler for this. See the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions#additions-service-provider">Additions Service Provider</a> in the package <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions#rsm-additions">RSM addtions</a> for an example.</p>

<p>If you want to create your own plugin for calculating an exploration goal
or navigation, you should meet the following requirements to enable all of the RSM’s functionalities.</p>

<h4 id="calculate-goal-plugin">Calculate Goal Plugin</h4>

<p>The calculate goal plugin is required to set a new navigation goal before transitioning to the navigation state.
Therefore, it has to call the respective service as shown in the exemplary code below.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="nf">nh</span><span class="p">(</span><span class="s">"rsm"</span><span class="p">);</span>
<span class="n">ros</span><span class="o">::</span><span class="n">ServiceServer</span> <span class="n">set_navigation_goal_service</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">serviceClient</span><span class="o">&lt;</span><span class="n">rsm_msgs</span><span class="o">::</span><span class="n">SetNavigationGoal</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"setNavigationGoal"</span><span class="p">);</span>
<span class="p">...</span>
<span class="n">rsm_msgs</span><span class="o">::</span><span class="n">SetNavigationGoal</span> <span class="n">srv</span><span class="p">;</span>
<span class="n">geometry_msgs</span><span class="o">::</span><span class="n">Pose</span> <span class="n">goal</span><span class="p">;</span>
<span class="c1">// set goal to the new exploration target calculated by your algorithm</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">goal</span> <span class="o">=</span> <span class="n">goal</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">navigationMode</span> <span class="o">=</span> <span class="n">EXPLORATION</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">set_navigation_goal_service</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="n">srv</span><span class="p">))</span> <span class="p">{</span>
	<span class="n">ROS_ERROR</span><span class="p">(</span><span class="s">"Failed to call Set Navigation Goal service"</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">...</span>

</code></pre></div></div>

<p>Furthermore, if the Exploration is run in <em>Interrupt</em> mode, the additional service provider is required to publish a <code class="language-plaintext highlighter-rouge">goalObsolete</code>
topic of type <a href="http://docs.ros.org/api/std_msgs/html/msg/Bool.html">std_msgs/Bool</a>, publishing the value “true” if the goal has become
obsolete.</p>

<h4 id="navigation-plugin">Navigation Plugin</h4>

<p>The navigation plugin requires a larger number of services and topics that need to be processed to fully interface all
of the RSM’s abilities.</p>

<p>First, to retrieve the navigation goal, the <code class="language-plaintext highlighter-rouge">getNavigationGoal</code> service has to be called. Furthermore, the <code class="language-plaintext highlighter-rouge">getReverseMode</code>
service needs to be called as well. And in case the reverse mode changes, a callback for the <code class="language-plaintext highlighter-rouge">reverseMode</code> topic is also
necessary. To properly interact with exploration, the <code class="language-plaintext highlighter-rouge">getExplorationMode</code> service must be called and if the mode is set
to <em>Interrupt</em>, the <code class="language-plaintext highlighter-rouge">goalObsolete</code> topic must be subscribed to. In case the goal becomes obsolete, the navigation finishes.</p>

<p>When a goal is reached or cannot be reached, the navigation ends and the <code class="language-plaintext highlighter-rouge">navigationGoalCompleted</code> service must be called, providing
information about the success of the navigation to it. Have a look at the <strong>Navigation</strong> plugin state in the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions">rsm_additions package</a>
for details regarding the implementation.</p>

<p>If the robot should be able to move in reverse mode, a service needs to be implemented called <code class="language-plaintext highlighter-rouge">setNavigationToReverse</code> which changes the navigation’s mode interface in the <a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_additions#navigation-state">Navigation State</a> plugin and switches between forward and reverse movement. A sample to include into the additional data handler can be seen below. If it is missing, activating reverse mode will only output a matching error.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="nf">nh</span><span class="p">(</span><span class="s">"rsm"</span><span class="p">);</span>
<span class="n">ros</span><span class="o">::</span><span class="n">ServiceServer</span> <span class="n">set_navigation_to_reverse_service</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">advertiseService</span><span class="p">(</span><span class="s">"setNavigationToReverse"</span><span class="p">,</span> <span class="n">setNavigationToReverse</span><span class="p">);</span>
<span class="p">...</span>

<span class="kt">bool</span> <span class="nf">setNavigationToReverse</span><span class="p">(</span><span class="n">std_srvs</span><span class="o">::</span><span class="n">SetBool</span><span class="o">::</span><span class="n">Request</span> <span class="o">&amp;</span><span class="n">req</span><span class="p">,</span> <span class="n">std_srvs</span><span class="o">::</span><span class="n">SetBool</span><span class="o">::</span><span class="n">Response</span> <span class="o">&amp;</span><span class="n">res</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="c1">//set mode to forward/reverse depending on req.data) {</span>
		<span class="n">res</span><span class="p">.</span><span class="n">success</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">res</span><span class="p">.</span><span class="n">message</span> <span class="o">=</span> <span class="s">"Mode set"</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">res</span><span class="p">.</span><span class="n">success</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">res</span><span class="p">.</span><span class="n">message</span> <span class="o">=</span> <span class="s">"Mode not set"</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>

<h2 id="nodes">Nodes</h2>

<h3 id="rsmnode">rsmNode</h3>

<p>This node realizes transitions between the different states.</p>

<p><em>Note:</em> All topics and services are in the <strong>rsm</strong> namespace.</p>

<h4 id="subscribed-topics">Subscribed Topics</h4>

<p><strong>operationMode</strong> (<a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_msgs/msg/OperationMode.msg">rsm_msgs/OperationMode</a>)<br>
The current operation mode as set by the GUI or interrupts</p>

<p><strong>simpleGoal</strong> (<a href="http://docs.ros.org/api/geometry_msgs/html/msg/PoseStamped.html">geometry_msgs/PoseStamped</a>)<br>
Navigation goal set in RViz</p>

<h4 id="published-topics">Published Topics</h4>

<p><strong>stateInfo</strong> (<a href="http://docs.ros.org/api/std_msgs/html/msg/String.html">std_msgs/String</a>)<br>
Current state info text</p>

<h4 id="services">Services</h4>

<p><strong>startStopExploration</strong> (<a href="http://docs.ros.org/api/std_srvs/html/srv/SetBool.html">std_srvs/SetBool</a>)<br>
Call to start or stop exploration, depending on the bool value (true: start, false: stop)</p>

<p><strong>startStopWaypointFollowing</strong> (<a href="http://docs.ros.org/api/std_srvs/html/srv/SetBool.html">std_srvs/SetBool</a>)<br>
Call to start or stop waypoint following, depending on the bool value (true: start, false: stop)</p>

<p><strong>stateInfo</strong> (<a href="http://docs.ros.org/api/std_srvs/html/srv/Trigger.html">std_srvs/Trigger</a>)<br>
Get current state info text</p>

<p><strong>stop2DNavGoal</strong> (<a href="http://docs.ros.org/api/std_srvs/html/srv/Trigger.html">std_srvs/Trigger</a>)
Call to stop navigation started through RViz tool <strong>2D Nav Goal</strong></p>

<h4 id="parameters">Parameters</h4>

<p><strong>~update_frequency</strong> (float, default: 20)<br>
Update rate in Hz</p>

<p><strong>~calculate_goal_plugin</strong> (string, default: “rsm::CalculateGoalPlugin”)<br>
Sets the plugin’s name for the state calculating the next goal.</p>

<p><strong>~navigation_plugin</strong> (string, default: “rsm::NavigationPlugin”)<br>
Sets the plugin’s name for the navigation state.</p>

<p><strong>~mapping_plugin</strong> (string, default: “rsm::MappingPlugin”)<br>
Sets the plugin’s name for the mapping state.</p>

<h3 id="robotcontrolmuxnode">robotControlMuxNode</h3>

<p>This node is for controlling if the robot is running autonomous, by teleoperation or is stopped.</p>

<p><em>Note:</em> All topics and services are in the <strong>rsm</strong> namespace.</p>

<h4 id="subscribed-topics-1">Subscribed Topics</h4>

<p>**<teleoperation_cmd_vel_topic>** ([std_msgs/String](http://docs.ros.org/api/std_msgs/html/msg/String.html))  
Publishes teleoperation command velocities</teleoperation_cmd_vel_topic></p>

<p>**<autonomy_operation_cmd_vel_topic>** ([std_msgs/String](http://docs.ros.org/api/std_msgs/html/msg/String.html))  
Publishes autonomy command velocities</autonomy_operation_cmd_vel_topic></p>

<p>**<joy_topic>** ([std_msgs/String](http://docs.ros.org/api/std_msgs/html/msg/String.html))  
Publishes joystick commands</joy_topic></p>

<h4 id="published-topics-1">Published Topics</h4>

<p>**<cmd_vel_topic>** ([std_msgs/String](http://docs.ros.org/api/std_msgs/html/msg/String.html))  
Command velocity that the robot should follow.</cmd_vel_topic></p>

<p><strong>operationMode</strong> (<a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_msgs/msg/OperationMode.msg">rsm_msgs/OperationMode</a>)<br>
The current operation mode as set by the GUI or interrupts</p>

<h4 id="services-1">Services</h4>

<p><strong>setOperationMode</strong> (<a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_msgs/msg/OperationMode.msg">rsm_msgs/SetOperationMode</a>)<br>
Sets the operation mode to the given parameter</p>

<h4 id="parameters-1">Parameters</h4>

<p><strong>~update_frequency</strong> (float, default: 20)<br>
Update rate in Hz</p>

<p><strong>~autonomy_cmd_vel_topic</strong> (string, default: “autonomy/cmd_vel”)<br>
Topic name for the autonomy command velocity</p>

<p><strong>~teleoperation_cmd_vel_topic</strong> (string, default: “teleoperation/cmd_vel”)<br>
Topic name for the teleoperation command velocity</p>

<p><strong>~cmd_vel_topic</strong> (string, default: “cmd_vel”)<br>
Topic name for the command velocity the robot should follow</p>

<p><strong>~joystick_used</strong> (bool, default: “false”)<br>
Is a joystick used to command the robot</p>

<p><strong>~joystick_topic</strong> (string, default: “joy”)<br>
Topic name for the joystick commands the robot is listening to</p>

<p><strong>~teleoperation_idle_timer</strong> (double, default: 0.5)<br>
Time until teleoperation is stopped when no new command is received</p>

<h3 id="serviceprovidernode">serviceProviderNode</h3>

<p>This node provides services for saving and receiving data needed by the volatile states.</p>

<p><em>Note:</em> All topics and services are in the <strong>rsm</strong> namespace.</p>

<h4 id="published-topics-2">Published Topics</h4>

<p><strong>waypoints</strong> (<a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_msgs/msg/WaypointArray.msg">rsm_msgs/WaypointArray</a>)<br>
List of all waypoints and their information</p>

<p><strong>explorationMode</strong> (<a href="http://docs.ros.org/api/std_msgs/html/msg/Bool.html">std_msgs/Bool</a>)<br>
The current exploration mode (true: interrupt, false: finish)</p>

<p><strong>explorationGoalStatus</strong> (<a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_msgs/msg/GoalStatus.msg">rsm_msgs/GoalStatus</a>)<br>
The currently active goal’s status and pose</p>

<p><strong>reverseMode</strong> (<a href="http://docs.ros.org/api/std_msgs/html/msg/Bool.html">std_msgs/Bool</a>)<br>
Information if the robot is currently moving in reverse (true: reverse, false: forward)</p>

<h4 id="services-2">Services</h4>

<p><strong>addWaypoint</strong> (<a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_msgs/srv/AddWaypoint.srv">rsm_msgs/AddWaypoint</a>)<br>
Add a waypoint to the list of waypoints</p>

<p><strong>getWaypoints</strong> (<a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_msgs/srv/GetWaypoints.srv">rsm_msgs/GetWaypoints</a>)<br>
Get list of waypoints</p>

<p><strong>moveWaypoint</strong> (<a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_msgs/srv/MoveWaypoint.srv">rsm_msgs/MoveWaypoint</a>)<br>
Move the waypoint at the given position in the waypoint list</p>

<p><strong>removeWaypoint</strong> (<a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_msgs/srv/RemoveWaypoint.srv">rsm_msgs/RemoveWaypoint</a>)<br>
Remove the waypoint at the given position in the waypoint list</p>

<p><strong>waypointVisited</strong> (<a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_msgs/srv/WaypointVisited.srv">rsm_msgs/WaypointVisited</a>)<br>
Set the waypoint at the given position in the waypoint list to visited</p>

<p><strong>waypointUnreachable</strong> (<a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_msgs/srv/WaypointUnreachable.srv">rsm_msgs/WaypointUnreachable</a>)<br>
Set the waypoint at the given position in the waypoint list to unreachable</p>

<p><strong>resetWaypoints</strong> (<a href="http://docs.ros.org/api/std_srvs/html/srv/Trigger.html">std_srvs/Trigger</a>)<br>
Reset all waypoint’s status to default</p>

<p><strong>setWaypointFollowingMode</strong> (<a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_msgs/srv/SetWaypointFollowingMode.srv">rsm_msgs/SetWaypointFollowingMode</a>)<br>
Sets the waypoint following mode (0: single, 1: roundtrip, 2: patrol)</p>

<p><strong>setWaypointRoutine</strong> (<a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_msgs/srv/SetWaypointRoutine.srv">rsm_msgs/SetWaypointRoutine</a>)<br>
Sets the routine of the waypoint at the given position in the waypoint list</p>

<p><strong>getWaypointRoutines</strong> (<a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_msgs/srv/GetWaypointRoutines.srv">rsm_msgs/GetWaypointRoutines</a>)<br>
Return the list of all waypoint routines available</p>

<p><strong>setNavigationGoal</strong> (<a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_msgs/srv/SetNavigationGoal.srv">rsm_msgs/SetNavigationGoal</a>)<br>
Sets the current navigation goal</p>

<p><strong>getNavigationGoal</strong> (<a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_msgs/srv/GetNavigationGoal.srv">rsm_msgs/GetNavigationGoal</a>)<br>
Gets the current navigation goal</p>

<p><strong>NavigationGoalCompleted</strong> (<a href="http://docs.ros.org/api/std_srvs/html/srv/SetBool.html">std_srvs/Trigger</a>)<br>
Handles exploration and waypoint following when a goal was completed</p>

<p><strong>getRobotPose</strong> (<a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/../rsm_msgs/srv/GetRobotPose.srv">rsm_msgs/GetRobotPose</a>) <br>
Return the current robot pose in relation to the map frame</p>

<p><strong>setExplorationMode</strong> (<a href="http://docs.ros.org/api/std_srvs/html/srv/SetBool.html">std_srvs/SetBool</a>)<br>
Set the exploration mode (true: interrupt, false: finish)</p>

<p><strong>getExplorationMode</strong> (<a href="http://docs.ros.org/api/std_srvs/html/srv/Trigger.html">std_srvs/Trigger</a>)<br>
Get the exploration mode</p>

<p><strong>SetReverseMode</strong> (<a href="http://docs.ros.org/api/std_srvs/html/srv/SetBool.html">std_srvs/SetBool</a>)<br>
Set the robot to reverse mode (true: reverse, false: forward)</p>

<p><strong>GetReverseMode</strong> (<a href="http://docs.ros.org/api/std_srvs/html/srv/Trigger.html">std_srvs/Trigger</a>)<br>
Return the reverse mode (true: reverse, false: forward)</p>

<h4 id="parameters-2">Parameters</h4>

<p><strong>~update_frequency</strong> (float, default: 20)<br>
Update rate in Hz</p>

<p><strong>~robot_frame</strong> (string, default: “/base_link”)<br>
Transform frame for the robot</p>

<p><strong>~waypoint_routines</strong> (std::vector<string>, default: [])  
Vector with waypoint routines available as state plugins</string></p>

<h4 id="required-tf-transforms">Required tf Transforms</h4>

<p>**<robot_frame> -&gt; map**  
Usually provided by SLAM</robot_frame></p>
</div>
              </div>
            </div>
          </div>
        </div>
      
    
    <div class="row">
      <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-heading"><span class="glyphicon glyphicon-list"></span> CHANGELOG</div>
          <div class="panel-body">
            
              <div class="rendered-markdown">
<h1 id="changelog-for-package-rsm_core">Changelog for package rsm_core</h1>

<h2 id="121-2020-11-24">1.2.1 (2020-11-24)</h2>

<h2 id="120-2020-11-04">1.2.0 (2020-11-04)</h2>

<ul>
  <li>Added parameter for navigation behavior on idle timer callback and
gazeboToTf changed to ground plane</li>
  <li>Replaced simulated kinect with Intel RealSense to adapt to husky
simulator melodic</li>
  <li>Now starts exploration with mapping state</li>
  <li>Exploration Goal Status is now published as a topic to prevent
service deadlocks</li>
  <li>Removed failed goal services and added a publisher</li>
  <li>Added GoalCompleted service to give more detailed feedback over
navigation completed status</li>
  <li>Added prefix to state name to identify autonomy behavior</li>
  <li>moved goalObsolete service to Additions and exploration completed
goal out of navigation completed service</li>
  <li>Fix wrong error message on service failure</li>
  <li>Added class and state diagram to documentation</li>
  <li>Added tutorial details for creating Calculate Goal and Navigation
plugins</li>
  <li>Added services for handling completed navigation goals to remove the
logic from the navigation plugin</li>
  <li>Moved logic regarding explore_lite to AdditionsServiceProvider from
ServiceProvider where they should belong</li>
  <li>Removed double maintainer tags</li>
  <li>Updated README with joystick listener addition</li>
  <li>Added joystick topic for teleoperation interrupt</li>
  <li>Properly reset shared_ptr to prevent errors on close</li>
  <li>Contributors: Marco Steinbrink, MarcoStb1993, marco</li>
</ul>

<h2 id="113-2019-08-29">1.1.3 (2019-08-29)</h2>

<ul>
  <li>Added all dependencies to CMakeLists and package.xml, that were
missing previously</li>
  <li>Contributors: MarcoStb1993</li>
</ul>

<h2 id="112-2019-08-28">1.1.2 (2019-08-28)</h2>

<h2 id="111-2019-08-05">1.1.1 (2019-08-05)</h2>

<ul>
  <li>added changelogs</li>
  <li>Fixed some dependencies for the new names</li>
  <li>Changed package names, this time for real</li>
  <li>Contributors: MarcoStb1993</li>
</ul>
</div>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="melodic-tutorials">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wiki Tutorials</h3>
      </div>
      <div class="panel-body">
        
        <em>This package does not provide any links to tutorials in it's <a href="https://index.ros.org/contribute/metadata/">rosindex metadata</a>.</em>
        <em>You can check on the <a href="http://wiki.ros.org/rsm_core/Tutorials" target="_blank">ROS Wiki Tutorials</a> page for the package.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="melodic-deps">
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Package Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th class="text-center">Deps</th>
                  <th style="width: 100%">Name</th>
                </thead>
                <tbody>
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/roscpp#melodic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/roscpp#melodic">roscpp  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/tf#melodic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/tf#melodic">tf  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/actionlib#melodic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/actionlib#melodic">actionlib  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/actionlib_msgs#melodic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/actionlib_msgs#melodic">actionlib_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/pluginlib#melodic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/pluginlib#melodic">pluginlib  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rsm_msgs#melodic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rsm_msgs#melodic">rsm_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/std_msgs#melodic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/std_msgs#melodic">std_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/std_srvs#melodic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/std_srvs#melodic">std_srvs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/geometry_msgs#melodic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/geometry_msgs#melodic">geometry_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/sensor_msgs#melodic-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/sensor_msgs#melodic">sensor_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/catkin#melodic-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/catkin#melodic">catkin  </a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
          <div class="panel-heading">
            <h3 class="panel-title">System Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <em>No direct system dependencies.</em>
            
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Dependant Packages</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                  <th class="text-center">Deps</th>
                </thead>
                <tbody>
                  
                    
                    
                    <tr>
                      <td><a href="/p/robot_statemachine#melodic">robot_statemachine</a></td>
                      <td class="text-center">
                        
                        <a href="/p/robot_statemachine#melodic-deps" class="endoftree">
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                    
                    
                    <tr>
                      <td><a href="/p/rsm_additions#melodic">rsm_additions</a></td>
                      <td class="text-center">
                        
                        <a href="/p/rsm_additions#melodic-deps" >
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="melodic-assets">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Launch files</h3>
      </div>
      <div class="panel-body">
        
          <ul>
            
              <li><a href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core/launch/rsm.launch" target="_blank">launch/rsm.launch</a>
                <ul class="list-unstyled">
                  
                    <li><em> launch RSM </em></li>
                  
                  <li>
                    <ul>
                      
                        
                          <li><strong>update_frequency</strong> <em>&#91;default: 20&#93; </em></li>
                        
                      
                        
                          <li><strong>robot_frame</strong> <em>&#91;default: /base_footprint&#93; </em></li>
                        
                      
                        
                          <li><strong>mapping_plugin</strong> <em>&#91;default: rsm::MappingDummyState&#93; </em></li>
                        
                      
                        
                          <li><strong>calculate_goal_plugin</strong> <em>&#91;default: rsm::CalculateGoalState&#93; </em></li>
                        
                      
                        
                          <li><strong>navigation_plugin</strong> <em>&#91;default: rsm::NavigationState&#93; </em></li>
                        
                      
                        
                          <li><strong>autonomy_cmd_vel_topic</strong> <em>&#91;default: /autonomy/cmd_vel&#93; </em></li>
                        
                      
                        
                          <li><strong>teleoperation_cmd_vel_topic</strong> <em>&#91;default: /teleoperation/cmd_vel&#93; </em></li>
                        
                      
                        
                          <li><strong>cmd_vel_topic</strong> <em>&#91;default: /cmd_vel&#93; </em></li>
                        
                      
                        
                          <li><strong>joystick_used</strong> <em>&#91;default: false&#93; </em></li>
                        
                      
                        
                          <li><strong>joystick_topic</strong> <em>&#91;default: joy&#93; </em></li>
                        
                      
                        
                          <li><strong>teleoperation_idle_timer</strong> <em>&#91;default: 0.5&#93; </em></li>
                        
                      
                        
                          <li><strong>waypoint_routines</strong> <em>&#91;default: []&#93; </em></li>
                        
                      
                    </ul>
                  </li>
                </ul>
              </li>
            
          </ul>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Messages</h3>
      </div>
      <div class="panel-body">
        
          <em>No message files found.</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Services</h3>
      </div>
      <div class="panel-body">
        
          <em>No service files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Plugins</h3>
      </div>
      <div class="panel-body">
        
          <em>No plugins found.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="melodic-questions">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent questions tagged <kbd>rsm_core</kbd> at <strong><a href="https://robotics.stackexchange.com/" target="_blank">Robotics Stack Exchange</a></strong></h3>      </div>
      <div id="melodic-question-list" class="panel-body" style="display: none;"></div>
      <div id="melodic-no-question-list" class="panel-body" style="display: none;">
        <p>No questions yet, you can ask one <a href="https://robotics.stackexchange.com/questions/tagged/rsm_core+melodic">here</a>.</p>
      </div>
      <div id="melodic-get-question-fail" class="panel-body alert alert-warning" style="display: none;">
        <p>Failed to get question list, you can ticket an issue <a href="https://github.com/ros-infrastructure/rosindex/issues/new" target="_blank" class="alert-link">here</a> </p>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/package_body_tabs.js"></script>

<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
jQuery(function() {
    // Update the count on the links to the contribution suggestions
    updateContributionSuggestionsCountOnPackage('https://github.com/MarcoStb1993/robot_statemachine.git');
});
</script>

          </div>
          <div class="col-md-2 hidden-xs hidden-sm">
            
            
            



<div class="list-group list-group-sm ">
  <a class="list-group-item"
     target="_blank"
     href="http://docs.ros.org/en/melodic/api/rsm_core/html/"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       
       API Docs
  </a>
  <a class="list-group-item"
     target="_blank"
     href="https://github.com/MarcoStb1993/robot_statemachine/tree/melodic-devel/rsm_core"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       
       Browse Code
  </a>
  
  
  
  
  
  <a class="list-group-item "
     target="_blank"
     href="http://wiki.ros.org/rsm_core?distro=melodic"
     title="View this package on wiki.ros.org">
       <span style="margin-right: 5px;" class="glyphicon glyphicon-info-sign"></span>
       
       Wiki
  </a>
  
  
</div>

          </div>
        </div>
      
    </div>
  </div>



<script id="question-list-template" type="text/html">
  <p>
    Browse <a href="https://robotics.stackexchange.com/questions/tagged/rsm_core?tab=Newest">recent questions</a>
    or see the <a href="https://robotics.stackexchange.com/questions/tagged/rsm_core?tab=Votes">highest voted ones</a>.
  </p>
  
  <table class="table table-striped">
    <thead>
      <tr>
        <th scope="col">Title</th>
        <th scope="col">Answered?</th>
        <th scope="col">Created</th>
        <th scope="col">Active</th>
      </tr>
    </thead>
    <tbody>
      {{#questions}}
      <tr>
        <th scope="row"><a href="{{link}}">{{title}}</a><br><small>Tags: {{strtags}}</small></th>
        <th>{{answered}}</th>
        <th>{{created}}</th>
        <th>{{active}}</th>
      </tr>
      {{/questions}}
    </tbody>
  </table>
  {{#has_more}}
  <hr>
  <h4>Additional questions are available at
    <a href="https://robotics.stackexchange.com/questions/tagged/{{name}}?tab=Newest">Robotics Stack Exchange</a>
  </h4>
  {{/has_more}}
  
</script>

<script type="text/javascript" src="/js/mustache.js"></script>
<script type="text/javascript">
  jQuery(function() {
    jQuery.getJSON(url="https://api.stackexchange.com/2.3/questions?order=desc&site=robotics" +
                       "&tagged=rsm_core&pagesize=50&sort=activity")
    .done(function(feed) {
      if (feed.items.length > 0) {
        var question_count_str = (feed.has_more ? '>' : '') + String(feed.items.length)
        const questions = feed.items.map(
          function(question) {
            question.id = Math.round(Math.random() * 99999.0);
            question.created = (new Date(question.creation_date * 1000)).toDateString()
            question.active = (new Date(question.last_activity_date * 1000)).toDateString()
            question.answered = question.is_answered ? "Yes" : "No"
            question.strtags = question.tags.join(' ')
            return question;
          });
        const template = jQuery("#question-list-template").text();
        Mustache.parse(template);
        var rendered = Mustache.render(
          template, 
          { questions: questions,
            has_more: feed.has_more,
            name: "rsm_core"
          }
        );
      }
      //   TODO(tfoote) Resolve images
      //   jQuery("#-question-list img").each(function() {
      //     if (jQuery(this).attr("src").startsWith("/upfiles")) {
      //        jQuery(this).attr("src", "https://answers.ros.org" + jQuery(this).attr("src"));
      //     }
      //   });
      
      if (feed.items.length > 0) {
        jQuery("#humble-question-list").html(rendered);
        jQuery("#humble-question-list").show();
      } else {
        jQuery("#humble-no-question-list").show();
      }
      jQuery("#humble-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#jazzy-question-list").html(rendered);
        jQuery("#jazzy-question-list").show();
      } else {
        jQuery("#jazzy-no-question-list").show();
      }
      jQuery("#jazzy-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#kilted-question-list").html(rendered);
        jQuery("#kilted-question-list").show();
      } else {
        jQuery("#kilted-no-question-list").show();
      }
      jQuery("#kilted-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#rolling-question-list").html(rendered);
        jQuery("#rolling-question-list").show();
      } else {
        jQuery("#rolling-no-question-list").show();
      }
      jQuery("#rolling-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#github-question-list").html(rendered);
        jQuery("#github-question-list").show();
      } else {
        jQuery("#github-no-question-list").show();
      }
      jQuery("#github-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#noetic-question-list").html(rendered);
        jQuery("#noetic-question-list").show();
      } else {
        jQuery("#noetic-no-question-list").show();
      }
      jQuery("#noetic-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#galactic-question-list").html(rendered);
        jQuery("#galactic-question-list").show();
      } else {
        jQuery("#galactic-no-question-list").show();
      }
      jQuery("#galactic-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#iron-question-list").html(rendered);
        jQuery("#iron-question-list").show();
      } else {
        jQuery("#iron-no-question-list").show();
      }
      jQuery("#iron-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#melodic-question-list").html(rendered);
        jQuery("#melodic-question-list").show();
      } else {
        jQuery("#melodic-no-question-list").show();
      }
      jQuery("#melodic-questions-count").text(question_count_str);
      
    })
    .fail(function(jqxhr, textStatus, error) {
      console.error("Failed to get question data: " + jqxhr.responseText);
      
      jQuery("#humble-get-question-fail").show();
      
      jQuery("#jazzy-get-question-fail").show();
      
      jQuery("#kilted-get-question-fail").show();
      
      jQuery("#rolling-get-question-fail").show();
      
      jQuery("#github-get-question-fail").show();
      
      jQuery("#noetic-get-question-fail").show();
      
      jQuery("#galactic-get-question-fail").show();
      
      jQuery("#iron-get-question-fail").show();
      
      jQuery("#melodic-get-question-fail").show();
      
    });
  });
</script>


<script type="text/javascript">
  $(document).ready(function() {
    setupDistroSwitch("humble");
  });
</script>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="container-fluid">
      <div style="float:left;">
        
          <a href="https://github.com/rkent/rosindex" title="Find rosindex in Github">
          <span class="icon  icon--github">
            <svg viewBox="0 0 16 16">
              <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
            </svg>
          </span>

          <span class="username">rkent/rosindex</span>
        </a>
        <em class="hidden-xs">| generated on 2025-05-05</em>
      
      </div>
      <div style="float:right;">
        <p class="text"><span class="hidden-xs">a community-maintained index of robotics software
 | </span><a href="/privacy.txt">privacy</a></p>
      </div>
    </div>
  </div>

</footer>


  </body>

</html>
