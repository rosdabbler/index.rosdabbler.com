<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Package: nav2_mppi_controller</title>
    <meta name="description" content="a community-maintained index of robotics software
">

    
    <link rel="canonical" href="http://index.rosdabbler.com/p/nav2_mppi_controller/">
    
    
    <link rel="icon" sizes="any" type="image/svg+xml" href="/assets/rosindex_logo.svg">

    

    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">
    

    

    <script type="text/javascript" src=/js/jquery.js></script>
    <script src=/bootstrap/js/bootstrap.min.js type="text/javascript"></script>
    <script src=/js/jquery-cookie.js type="text/javascript"></script>
    
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EVD5Z6G6NH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EVD5Z6G6NH');
</script>

    <script type="text/javascript" src=/js/toc.js></script>

    <script src=/js/distro_switch.js></script>
  </head>

  <body>

    <header class="site-header">

  <div class="wrapper">
    <div class="container-fluid" style="margin-bottom: 10px">
      <div class="row">
        <!-- title -->
        <div class="col-xs-3" style="white-space:nowrap">
          <a class="site-title" href="/">
            <img src="/assets/rosindex_logo.svg" width="26" height="26" alt="ROS index logo" style="padding-bottom: 3px"/>
            ROS Index</a>
        </div>
        <!-- main internal links -->
        <div class="col-xs-6 text-center" style="padding:0px">
          <div class="btn-group hidden-xs" role="group" aria-label="..." style="padding: 6px">
            <div class="btn-group" role="group">
              <a href="/?search_packages=true" class="btn btn-default" role="button">Package List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/?search_repos=true" class="btn btn-default" role="button">Repository List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/search_deps" class="btn btn-default" role="button">System Dependencies</a>
            </div>
          </div>
          <div class="hidden-lg hidden-md hidden-sm">
            <button id="hLabel" class="btn btn-link dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Lists <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="hLabel">
              <li><a href="/?search_packages=true">Package List</a></li>
              <li><a href="/?search_repos=true">Repository List</a></li>
              <li><a href="/search_deps">System Dependencies</a></li>
            </ul>
          </div>
        </div>
        <!-- additional links -->
        <div class="col-xs-3 text-right" style="white-space:nowrap; padding:0px">
          <ul class="list-inline" style="margin-bottom:0px;">
            <li class="dropdown hidden-xs hidden-sm">
              <button id="rLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                ROS Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu" aria-labelledby="rLabel">
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-xs hidden-sm">
              <button id="aLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                About <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="aLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-md hidden-lg">
              <button id="qLabel" class="btn btn-link" type="button"
                      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="qLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
                <hr style="margin:7px" />
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin-top: 20px">
  <div class="container-fluid">
    <div class="row">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/?search_packages=true">Packages</a></li>
        <li class="active">nav2_mppi_controller</li>
      </ol>
    </div>
    <div class="row">
      

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
    <label id="humble-option" class="distro-button btn btn-xs btn-primary" href="#humble" data="humble">
      <input type="radio" name="options" id="humble-radio" autocomplete="off"> humble
    </label>
  
    <label id="jazzy-option" class="distro-button btn btn-xs btn-primary" href="#jazzy" data="jazzy">
      <input type="radio" name="options" id="jazzy-radio" autocomplete="off"> jazzy
    </label>
  
    <label id="kilted-option" class="distro-button btn btn-xs btn-default" href="#kilted" data="kilted">
      <input type="radio" name="options" id="kilted-radio" autocomplete="off"> kilted
    </label>
  
    <label id="rolling-option" class="distro-button btn btn-xs btn-default" href="#rolling" data="rolling">
      <input type="radio" name="options" id="rolling-radio" autocomplete="off"> rolling
    </label>
  
    <label id="github-option" class="distro-button btn btn-xs btn-primary" href="#github" data="github">
      <input type="radio" name="options" id="github-radio" autocomplete="off"> github
    </label>
  
    <label id="noetic-option" class="distro-button btn btn-xs btn-default" href="#noetic" data="noetic">
      <input type="radio" name="options" id="noetic-radio" autocomplete="off"> noetic
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-primary" data-toggle="dropdown" id="older-distro-button">
        <input type="radio" name="options" autocomplete="off">
      <span id="older-label">Older</span>
      <span class="caret"></span>
    </label>
    <ul class="dropdown-menu" role="menu">
      
        <li data="galactic" id="galactic-option" class="disabled older-distro-option"  href="#galactic">
          <a href="#galactic" data="galactic" id="galactic-button">galactic</a>
        </li>
      
        <li data="iron" id="iron-option" class=" older-distro-option"  href="#iron">
          <a href="#iron" data="iron" id="iron-button">iron</a>
        </li>
      
        <li data="melodic" id="melodic-option" class="disabled older-distro-option"  href="#melodic">
          <a href="#melodic" data="melodic" id="melodic-button">melodic</a>
        </li>
      
    </ul>
  </div>
</div>

    </div>
    <div class="row">
      &nbsp;
    </div>
  </div>
</div>


  <div class="distro distro-humble">
    <div class="container-fluid">
      
        
        
        

        <div class="row">
          <div class="col-md-10">
            

<div class="well well-sm">
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px" src="/assets/package.png">
      </td>
      <td>
        <h3 style="margin-top: 5px">
          <a style="text-decoration:none" href="/p/nav2_mppi_controller">nav2_mppi_controller</a> <small>package from <a style="text-decoration:none" href="/r/navigation2/github-ros-planning-navigation2">navigation2</a> repo</small>
        </h3>
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_amcl">

nav2_amcl
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_behavior_tree">

nav2_behavior_tree
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_behaviors">

nav2_behaviors
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_bringup">

nav2_bringup
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_bt_navigator">

nav2_bt_navigator
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_collision_monitor">

nav2_collision_monitor
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_common">

nav2_common
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_constrained_smoother">

nav2_constrained_smoother
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_controller">

nav2_controller
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_core">

nav2_core
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_costmap_2d">

nav2_costmap_2d
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/costmap_queue">

costmap_queue
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/dwb_core">

dwb_core
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/dwb_critics">

dwb_critics
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/dwb_msgs">

dwb_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/dwb_plugins">

dwb_plugins
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_dwb_controller">

nav2_dwb_controller
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav_2d_msgs">

nav_2d_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav_2d_utils">

nav_2d_utils
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_graceful_controller">

nav2_graceful_controller
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_lifecycle_manager">

nav2_lifecycle_manager
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_map_server">

nav2_map_server
</a>
            
          
            
            
              <span class="label label-default pkg-label">

nav2_mppi_controller
</span>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_msgs">

nav2_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_navfn_planner">

nav2_navfn_planner
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_planner">

nav2_planner
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_regulated_pure_pursuit_controller">

nav2_regulated_pure_pursuit_controller
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_rotation_shim_controller">

nav2_rotation_shim_controller
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_rviz_plugins">

nav2_rviz_plugins
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_simple_commander">

nav2_simple_commander
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_smac_planner">

nav2_smac_planner
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_smoother">

nav2_smoother
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_system_tests">

nav2_system_tests
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_theta_star_planner">

nav2_theta_star_planner
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_util">

nav2_util
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_velocity_smoother">

nav2_velocity_smoother
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_voxel_grid">

nav2_voxel_grid
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_waypoint_follower">

nav2_waypoint_follower
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/navigation2">

navigation2
</a>
            
          
      </td>
    </tr>
  </table>
</div>

            <div class="visible-xs visible-sm">
              
              
              



<div class="list-group list-group-sm list-group-horizontal list-group-justified">
  <a class="list-group-item text-center"
     target="_blank"
     href="http://docs.ros.org/en/humble/p/nav2_mppi_controller"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       <br>
       API Docs
  </a>
  <a class="list-group-item text-center"
     target="_blank"
     href="https://github.com/ros-planning/navigation2/tree/humble/nav2_mppi_controller"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       <br>
       Browse Code
  </a>
  
  
  
  
  
  
</div>

            </div>
            



<ul class="nav nav-tabs nav-justified" id="humble-tabs" style="margin-bottom:20px">
  <li class="better-tabs active">
    <a href="#humble-overview" data-toggle="tab">Overview</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    
    <a href="#humble-assets" data-toggle="tab"><span class="label label-primary">2</span> Assets</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    <a href="#humble-deps" data-toggle="tab"><span class="label label-primary">23</span> Dependencies</a>
  </li>
  <li class="better-tabs">
    
    <a href="#humble-tutorials" data-toggle="tab"><span class="label label-default">0</span> Tutorials</a>
  </li>
  <li class="better-tabs">
    <a href="#humble-questions" data-toggle="tab"><span id="humble-questions-count" class="label label-primary">0</span> Q & A</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="humble-overview">
    
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h4 class="panel-title">Package Summary</h4></div>
          <div class="panel-body">
            <table class="table table-condensed">
              <tr>
                <td style="width:100px;" class="text-right"><strong>Tags</strong></td>
                <td>
                  
                  
                    <em>No category tags.</em>
                  
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Version</strong></td>
                <td>1.1.18</td>
              </tr>
              <tr>
                <td class="text-right"><strong>License</strong></td>
                <td>MIT</td>
              </tr>
              <tr>
                <td class="text-right"><strong>Build type</strong></td>
                <td>
                  
                    <span class="label label-default">
                  
                    AMENT_CMAKE</span>
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Use</strong></td>
                <td>
                
                  <span class="label label-success">RECOMMENDED</span>
                
                </td>
              </tr>
            </table>
          </div>
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body">
            
            
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">ROS 2 Navigation Framework and System</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/ros-planning/navigation2.git">https://github.com/ros-planning/navigation2.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">humble</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-05-03
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="No CI information available for this package.">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <span class="label label-default">robotics</span> <span class="label label-default">navigation</span> <span class="label label-default">ros2</span> 
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/navigation2/#humble-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/navigation2/#humble-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/navigation2/#humble-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Package Description</h3></div>
          <div class="panel-body">
            nav2_mppi_controller
          </div>
          <div class="panel-heading"><h4 class="panel-title">Additional Links</h4></div>
          <div class="panel-body">
            
            
              <em>No additional links.</em>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Maintainers</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Steve Macenski</li>
                
                  <li>Aleksei Budyakov</li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Authors</h4></div>
          <div class="panel-body">
            
            
              <em>No additional authors.</em>
            
          </div>
        </div>
      </div>
    </div>
    
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-heading"><span class="glyphicon glyphicon-file"></span><a href="https://github.com/ros-planning/navigation2/tree/humble/nav2_mppi_controller/README.md" title="Open in git repository">nav2_mppi_controller/README.md</a></div>
              <div class="panel-body">
                    <div class="rendered-markdown">
<h1 id="model-predictive-path-integral-controller">Model Predictive Path Integral Controller</h1>

<p><img src="https://raw.githubusercontent.com/ros-planning/navigation2/humble/nav2_mppi_controller/media/demo.gif" alt=""></p>

<h2 id="overview">Overview</h2>

<p>This is a predictive controller (local trajectory planner) that implements the <a href="https://ieeexplore.ieee.org/document/7487277">Model Predictive Path Integral (MPPI)</a> algorithm to track a path with adaptive collision avoidance. It contains plugin-based critic functions to impact the behavior of the algorithm. It was created by <a href="https://www.linkedin.com/in/aleksei-budyakov-334889224/">Aleksei Budyakov</a> and adapted &amp; developed for Nav2 by <a href="https://www.linkedin.com/in/steve-macenski-41a985101/">Steve Macenski</a>.</p>

<p>This plugin implements the <code class="language-plaintext highlighter-rouge">nav2_core::Controller</code> interface allowing it to be used across the navigation stack as a local trajectory planner in the controller server’s action server (<code class="language-plaintext highlighter-rouge">controller_server</code>).</p>

<p>This controller is measured to run at 50+ Hz on a modest Intel processor (4th gen i5). See its Configuration Guide Page for additional parameter descriptions.</p>

<p>It works currently with Differential, Omnidirectional, and Ackermann robots.</p>

<h2 id="mppi-description">MPPI Description</h2>

<p>The MPPI algorithm is an MPC variant that finds a control velocity for the robot using an iterative approach. Using the previous time step’s best control solution and the robot’s current state, a set of randomly sampled perturbations from a Gaussian distribution are applied. These noised controls are forward simulated to generate a set of trajectories within the robot’s motion model.</p>

<p>Next, these trajectories are scored using a set of plugin-based critic functions to find the best trajectory in the batch. The output scores are used to set the best control with a soft max function.</p>

<p>This process is then repeated a number of times and returns a converged solution. This solution is then used as the basis of the next time step’s initial control.</p>

<h2 id="features">Features</h2>

<ul>
  <li>Predictive MPC trajectory planner</li>
  <li>Utilizes plugin-based critics which can be swapped out, tuned, or replaced easily by the user</li>
  <li>Highly optimized CPU-only performance using vectorization and tensor operations</li>
  <li>Supports a number of common motion models, including Ackermann, Differential-Drive, and Omni-directional</li>
  <li>Includes fallback mechanisms to handle soft-failures before escalating to recovery behaviors</li>
  <li>High-quality code implementation with Doxygen, high unit test coverage, documentation, and parameter guide</li>
  <li>Easily extensible to support modern research variants of MPPI</li>
  <li>Comes pre-tuned for good out-of-the-box behavior</li>
</ul>

<h2 id="configuration">Configuration</h2>

<h3 id="controller">Controller</h3>
<p>| Parameter                  | Type   | Definition                                                                                                                                                                                                                                                                                                           |
 | ———————      | —— | ——————————————————————————————————– |
 | motion_model               | string | Default: DiffDrive. Type of model [DiffDrive, Omni, Ackermann].                                          |
 | critics                    | string | Default: None. Critics (plugins) names                                                                   |
 | iteration_count            | int    | Default 1. Iteration count in MPPI algorithm. Recommend to keep as 1 and prefer more batches.            |
 | batch_size                 | int    | Default 1000. Count of randomly sampled candidate trajectories                                            |
 | time_steps                 | int    | Default 56. Number of time steps (points) in each sampled trajectory                                     |
 | model_dt                   | double | Default: 0.05. Time interval (s) between two sampled points in trajectories.                              |
 | vx_std                     | double | Default 0.2. Sampling standard deviation for VX                                                          |
 | vy_std                     | double | Default 0.2. Sampling standard deviation for VY                                                          |
 | wz_std                     | double | Default 0.4. Sampling standard deviation for Wz                                                          |
 | vx_max                     | double | Default 0.5. Max VX (m/s)                                                                                |
 | vy_max                     | double | Default 0.5. Max VY in either direction, if holonomic. (m/s)                                             |
 | vx_min                     | double | Default -0.35. Min VX (m/s)                                                                              |
 | wz_max                     | double | Default 1.9. Max WZ (rad/s)                                                                              |
 | temperature                | double | Default: 0.3. Selectiveness of trajectories by their costs (The closer this value to 0, the “more” we take in consideration controls with less cost), 0 mean use control with best cost, huge value will lead to just taking mean of all trajectories without cost consideration                                                   |
 | gamma                      | double | Default: 0.015. A trade-off between smoothness (high) and low energy (low). This is a complex parameter that likely won’t need to be changed from the default of <code class="language-plaintext highlighter-rouge">0.1</code> which works well for a broad range of cases. See Section 3D-2 in “Information Theoretic Model Predictive Control: Theory and Applications to Autonomous Driving” for detailed information.       |
 | visualize                  | bool   | Default: false. Publish visualization of trajectories, which can slow down the controller significantly. Use only for debugging.                                                                                                                                       |
 | retry_attempt_limit        | int    | Default 1. Number of attempts to find feasible trajectory on failure for soft-resets before reporting failure.                                                                                                                                                                                                       |
| reset_period            | double    | Default 1.0. required time of inactivity to reset optimizer  (only in Humble due to backport ABI policies)            |
 | regenerate_noises          | bool   | Default false. Whether to regenerate noises each iteration or use single noise distribution computed on initialization and reset. Practically, this is found to work fine since the trajectories are being sampled stochastically from a normal distribution and reduces compute jittering at run-time due to thread wake-ups to resample normal distribution. |</p>

<h4 id="trajectory-visualizer">Trajectory Visualizer</h4>
<p>| Parameter             | Type   | Definition                                                                                                  |
 | —————       | —— | ———————————————————————————————————– |
 | trajectory_step       | int    | Default: 5. The step between trajectories to visualize to downsample candidate trajectory pool.             |
 | time_step             | int    | Default: 3. The step between points on trajectories to visualize to downsample trajectory density.          |</p>

<h4 id="path-handler">Path Handler</h4>
<p>| Parameter                  | Type   | Definition                                                                                                  |
 | —————            | —— | ———————————————————————————————————– |
 | max_robot_pose_search_dist | double | Default: Costmap half-size. Max integrated distance ahead of robot pose to search for nearest path point in case of path looping.   |
 | prune_distance             | double | Default: 1.5. Distance ahead of nearest point on path to robot to prune path to.                            |
 | transform_tolerance        | double | Default: 0.1. Time tolerance for data transformations with TF.                                              |
 | enforce_path_inversion        | double | Default: False. If true, it will prune paths containing cusping points for segments changing directions (e.g. path inversions) such that the controller will be forced to change directions at or very near the planner’s requested inversion point. This is targeting Smac Planner users with feasible paths who need their robots to switch directions where specifically requested.      |
 | inversion_xy_tolerance        | double | Default: 0.2. Cartesian proximity (m) to path inversion point to be considered “achieved” to pass on the rest of the path after path inversion.      |
 | inversion_yaw_tolerance        | double | Default: 0.4. Angular proximity (radians) to path inversion point to be considered “achieved” to pass on the rest of the path after path inversion. 0.4 rad = 23 deg.  |</p>

<h4 id="ackermann-motion-model">Ackermann Motion Model</h4>
<p>| Parameter            | Type   | Definition                                                                                                  |
 | ——————– | —— | ———————————————————————————————————– |
 | min_turning_r        | double | minimum turning radius for ackermann motion model                                                           |</p>

<h4 id="constraint-critic">Constraint Critic</h4>
<p>| Parameter             | Type   | Definition                                                                                                  |
 | —————       | —— | ———————————————————————————————————– |
 | cost_weight           | double | Default 4.0. Weight to apply to critic term.                                                                |
 | cost_power            | int    | Default 1. Power order to apply to term.</p>

<h4 id="goal-angle-critic">Goal Angle Critic</h4>
<p>| Parameter                        | Type   | Definition                                                                                                  |
 | —————                  | —— | ———————————————————————————————————– |
 | cost_weight                      | double | Default 3.0. Weight to apply to critic term.                                                                |
 | cost_power                       | int    | Default 1. Power order to apply to term.                                                                    |
 | threshold_to_consider            | double | Default 0.5. Minimal distance between robot and goal above which angle goal cost considered.               |</p>

<h4 id="goal-critic">Goal Critic</h4>
<p>| Parameter            | Type   | Definition                                                                                                  |
 | ——————– | —— | ———————————————————————————————————– |
 | cost_weight          | double | Default 5.0. Weight to apply to critic term.                                                                |
 | cost_power           | int    | Default 1. Power order to apply to term.                                                                    |
 | threshold_to_consider      | double | Default 1.4. Distance between robot and goal above which goal cost starts being considered                                    |</p>

<h4 id="obstacles-critic">Obstacles Critic</h4>

<p>Uses estimated distances from obstacles using cost and inflation parameters to avoid obstacles</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Type</th>
      <th>Definition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>consider_footprint</td>
      <td>bool</td>
      <td>Default: False. Whether to use point cost (if robot is circular or low compute power) or compute SE2 footprint cost.</td>
    </tr>
    <tr>
      <td>critical_weight</td>
      <td>double</td>
      <td>Default 20.0. Weight to apply to critic for near collisions closer than <code class="language-plaintext highlighter-rouge">collision_margin_distance</code> to prevent near collisions <strong>only</strong> as a method of virtually inflating the footprint. This should not be used to generally influence obstacle avoidance away from critical collisions.</td>
    </tr>
    <tr>
      <td>repulsion_weight</td>
      <td>double</td>
      <td>Default 1.5. Weight to apply to critic for generally preferring routes in lower cost space. This is separated from the critical term to allow for fine tuning of obstacle behaviors with path alignment for dynamic scenes without impacting actions which may directly lead to near-collisions. This is applied within the <code class="language-plaintext highlighter-rouge">inflation_radius</code> distance from obstacles.</td>
    </tr>
    <tr>
      <td>cost_power</td>
      <td>int</td>
      <td>Default 1. Power order to apply to term.</td>
    </tr>
    <tr>
      <td>collision_cost</td>
      <td>double</td>
      <td>Default 10000.0. Cost to apply to a true collision in a trajectory.</td>
    </tr>
    <tr>
      <td>collision_margin_distance</td>
      <td>double</td>
      <td>Default 0.10. Margin distance from collision to apply severe penalty, similar to footprint inflation. Between 0.05-0.2 is reasonable.</td>
    </tr>
    <tr>
      <td>near_goal_distance</td>
      <td>double</td>
      <td>Default 0.5. Distance near goal to stop applying preferential obstacle term to allow robot to smoothly converge to goal pose in close proximity to obstacles.</td>
    </tr>
    <tr>
      <td>cost_scaling_factor</td>
      <td>double</td>
      <td>Default 10.0. Exponential decay factor across inflation radius. This should be the same as for your inflation layer (Humble only)</td>
    </tr>
    <tr>
      <td>inflation_radius</td>
      <td>double</td>
      <td>Default 0.55. Radius to inflate costmap around lethal obstacles. This should be the same as for your inflation layer (Humble only)</td>
    </tr>
  </tbody>
</table>

<h4 id="cost-critic">Cost Critic</h4>

<p>Uses inflated costmap cost directly to avoid obstacles</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Type</th>
      <th>Definition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>consider_footprint</td>
      <td>bool</td>
      <td>Default: False. Whether to use point cost (if robot is circular or low compute power) or compute SE2 footprint cost.</td>
    </tr>
    <tr>
      <td>cost_weight</td>
      <td>double</td>
      <td>Default 3.81. Wight to apply to critic to avoid obstacles.</td>
    </tr>
    <tr>
      <td>cost_power</td>
      <td>int</td>
      <td>Default 1. Power order to apply to term.</td>
    </tr>
    <tr>
      <td>collision_cost</td>
      <td>double</td>
      <td>Default 1000000.0. Cost to apply to a true collision in a trajectory.</td>
    </tr>
    <tr>
      <td>critical_cost</td>
      <td>double</td>
      <td>Default 300.0. Cost to apply to a pose with any point in in inflated space to prefer distance from obstacles.</td>
    </tr>
    <tr>
      <td>near_goal_distance</td>
      <td>double</td>
      <td>Default 0.5. Distance near goal to stop applying preferential obstacle term to allow robot to smoothly converge to goal pose in close proximity to obstacles.</td>
    </tr>
    <tr>
      <td>inflation_layer_name</td>
      <td>string</td>
      <td>Default “”. Name of the inflation layer. If empty, it uses the last inflation layer in the costmap. If you have multiple inflation layers, you may want to specify the name of the layer to use.</td>
    </tr>
  </tbody>
</table>

<h4 id="path-align-critic">Path Align Critic</h4>
<p>| Parameter                  | Type   | Definition                                                                                                                         |
 | —————            | —— | ———————————————————————————————————–                        |
 | cost_weight                | double | Default 10.0. Weight to apply to critic term.                                                                                       |
 | cost_power                 | int    | Default 1. Power order to apply to term.                                                                                           |
 | threshold_to_consider      | double | Default 0.5. Distance between robot and goal above which path align cost stops being considered                                    |
 | offset_from_furthest      | double | Default 20. Checks that the candidate trajectories are sufficiently far along their way tracking the path to apply the alignment critic. This ensures that path alignment is only considered when actually tracking the path, preventing awkward initialization motions preventing the robot from leaving the path to achieve the appropriate heading.  |
 | trajectory_point_step      | double | Default 4. Step of trajectory points to evaluate for path distance to reduce compute time. Between 1-10 is typically reasonable.   |
 | max_path_occupancy_ratio   | double | Default 0.07 (7%). Maximum proportion of the path that can be occupied before this critic is not considered to allow the obstacle and path follow critics to avoid obstacles while following the path’s intent in presence of dynamic objects in the scene.  |
 | use_path_orientations   | bool | Default false. Whether to consider path’s orientations in path alignment, which can be useful when paired with feasible smac planners to incentivize directional changes only where/when the smac planner requests them. If you want the robot to deviate and invert directions where the controller sees fit, keep as false. If your plans do not contain orientation information (e.g. navfn), keep as false.  |</p>

<p>Note: There is a “Legacy” version of this critic also available with the same parameters of an old formulation pre-October 2023.</p>

<h4 id="path-angle-critic">Path Angle Critic</h4>
<p>| Parameter                 | Type   | Definition                                                                                                  |
 | —————           | —— | ———————————————————————————————————– |
 | cost_weight               | double | Default 2.0. Weight to apply to critic term.                                                                |
 | cost_power                | int    | Default 1. Power order to apply to term.                                                                    |
 | threshold_to_consider     | double | Default 0.5. Distance between robot and goal above which path angle cost stops being considered             |
 | offset_from_furthest      | int    | Default 4. Number of path points after furthest one any trajectory achieves to compute path angle relative to.  |
 | max_angle_to_furthest     | double | Default 1.2. Angular distance between robot and goal above which path angle cost starts being considered           |
 | forward_preference     | bool | Default true. Whether or not your robot has a preference for which way is forward in motion. Different from if reversing is generally allowed, but if you robot contains <em>no</em> particular preference one way or another.           |</p>

<h4 id="path-follow-critic">Path Follow Critic</h4>
<p>| Parameter             | Type   | Definition                                                                                                  |
 | —————       | —— | ———————————————————————————————————– |
 | cost_weight           | double | Default 5.0. Weight to apply to critic term.                                                                |
 | cost_power            | int    | Default 1. Power order to apply to term.   |
 | offset_from_furthest  | int    | Default 6. Number of path points after furthest one any trajectory achieves to drive path tracking relative to.     |
 | threshold_to_consider        | float  | Default 1.4. Distance between robot and goal above which path follow cost stops being considered  |</p>

<h4 id="prefer-forward-critic">Prefer Forward Critic</h4>
<p>| Parameter             | Type   | Definition                                                                                                  |
 | —————       | —— | ———————————————————————————————————– |
 | cost_weight           | double | Default 5.0. Weight to apply to critic term.                                                                |
 | cost_power            | int    | Default 1. Power order to apply to term.                                                                    |
 | threshold_to_consider | double | Default 0.5. Distance between robot and goal above which prefer forward cost stops being considered         |</p>

<h4 id="twirling-critic">Twirling Critic</h4>
<p>| Parameter             | Type   | Definition                                                                                                  |
 | —————       | —— | ———————————————————————————————————– |
 | cost_weight           | double | Default 10.0. Weight to apply to critic term.                                                               |
 | cost_power            | int    | Default 1. Power order to apply to term.                                                                    |</p>

<h4 id="velocity-deadband-critic">Velocity Deadband Critic</h4>
<p>| Parameter             | Type     | Definition                                                                                                  |
 | —————       | ——   | ———————————————————————————————————– |
 | cost_weight           | double   | Default 35.0. Weight to apply to critic term.                                                               |
 | cost_power            | int      | Default 1. Power order to apply to term.                                                                    |
 | deadband_velocities   | double[] | Default [0.0, 0.0, 0.0].  The array of deadband velocities [vx, vz, wz]. A zero array indicates that the critic will take no action.      |</p>

<h3 id="xml-configuration-example">XML configuration example</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>controller_server:
  ros__parameters:
    controller_frequency: 30.0
    FollowPath:
      plugin: "nav2_mppi_controller::MPPIController"
      time_steps: 56
      model_dt: 0.05
      batch_size: 2000
      vx_std: 0.2
      vy_std: 0.2
      wz_std: 0.4
      vx_max: 0.5
      vx_min: -0.35
      vy_max: 0.5
      wz_max: 1.9
      iteration_count: 1
      prune_distance: 1.7
      transform_tolerance: 0.1
      temperature: 0.3
      gamma: 0.015
      motion_model: "DiffDrive"
      visualize: false
      TrajectoryVisualizer:
        trajectory_step: 5
        time_step: 3
      AckermannConstraints:
        min_turning_r: 0.2
      critics: ["ConstraintCritic", "CostCritic", "GoalCritic", "GoalAngleCritic", "PathAlignCritic", "PathFollowCritic", "PathAngleCritic", "PreferForwardCritic"]
      ConstraintCritic:
        enabled: true
        cost_power: 1
        cost_weight: 4.0
      GoalCritic:
        enabled: true
        cost_power: 1
        cost_weight: 5.0
        threshold_to_consider: 1.4
      GoalAngleCritic:
        enabled: true
        cost_power: 1
        cost_weight: 3.0
        threshold_to_consider: 0.5
      PreferForwardCritic:
        enabled: true
        cost_power: 1
        cost_weight: 5.0
        threshold_to_consider: 0.5
      # ObstaclesCritic:
      #   enabled: true
      #   cost_power: 1
      #   repulsion_weight: 1.5
      #   critical_weight: 20.0
      #   consider_footprint: false
      #   collision_cost: 10000.0
      #   collision_margin_distance: 0.1
      #   near_goal_distance: 0.5
      CostCritic:
        enabled: true
        cost_power: 1
        cost_weight: 3.81
        critical_cost: 300.0
        consider_footprint: true
        collision_cost: 1000000.0
        near_goal_distance: 1.0
      PathAlignCritic:
      PathAlignCritic:
        enabled: true
        cost_power: 1
        cost_weight: 14.0
        max_path_occupancy_ratio: 0.05
        trajectory_point_step: 3
        threshold_to_consider: 0.5
        offset_from_furthest: 20
        use_path_orientations: false
      PathFollowCritic:
        enabled: true
        cost_power: 1
        cost_weight: 5.0
        offset_from_furthest: 5
        threshold_to_consider: 1.4
      PathAngleCritic:
        enabled: true
        cost_power: 1
        cost_weight: 2.0
        offset_from_furthest: 4
        threshold_to_consider: 0.5
        max_angle_to_furthest: 1.0
        forward_preference: true
      # VelocityDeadbandCritic:
      #   enabled: true
      #   cost_power: 1
      #   cost_weight: 35.0
      #   deadband_velocities: [0.05, 0.05, 0.05]
      # TwirlingCritic:
      #   enabled: true
      #   twirling_cost_power: 1
      #   twirling_cost_weight: 10.0

</code></pre></div></div>
<h2 id="topics">Topics</h2>

<table>
  <thead>
    <tr>
      <th>Topic</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">trajectories</code></td>
      <td><code class="language-plaintext highlighter-rouge">visualization_msgs/MarkerArray</code></td>
      <td>Randomly generated trajectories, including resulting control sequence</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">transformed_global_plan</code></td>
      <td><code class="language-plaintext highlighter-rouge">nav_msgs/Path</code></td>
      <td>Part of global plan considered by local planner</td>
    </tr>
  </tbody>
</table>

<h2 id="notes-to-users">Notes to Users</h2>

<h3 id="general-words-of-wisdom">General Words of Wisdom</h3>

<p>The <code class="language-plaintext highlighter-rouge">model_dt</code> parameter generally should be set to the duration of your control frequency. So if your control frequency is 20hz, this should be <code class="language-plaintext highlighter-rouge">0.05</code>. However, you may also set it lower <strong>but not larger</strong>.</p>

<p>Visualization of the trajectories using <code class="language-plaintext highlighter-rouge">visualize</code> uses compute resources to back out trajectories for visualization and therefore slows compute time. It is not suggested that this parameter is set to <code class="language-plaintext highlighter-rouge">true</code> during a deployed use, but is a useful debug instrument while tuning the system, but use sparingly. Visualizing 2000 batches @ 56 points at 30 hz is <em>a lot</em>.</p>

<p>The most common parameters you might want to start off changing are the velocity profiles (<code class="language-plaintext highlighter-rouge">vx_max</code>, <code class="language-plaintext highlighter-rouge">vx_min</code>, <code class="language-plaintext highlighter-rouge">wz_max</code>, and <code class="language-plaintext highlighter-rouge">vy_max</code> if holonomic) and the <code class="language-plaintext highlighter-rouge">motion_model</code> to correspond to your vehicle. Its wise to consider the <code class="language-plaintext highlighter-rouge">prune_distance</code> of the path plan in proportion to your maximum velocity and prediction horizon. The only deeper parameter that will likely need to be adjusted for your particular settings is the Obstacle critics’ <code class="language-plaintext highlighter-rouge">repulsion_weight</code> since the tuning of this is proportional to your inflation layer’s radius. Higher radii should correspond to reduced <code class="language-plaintext highlighter-rouge">repulsion_weight</code> due to the penalty formation (e.g. <code class="language-plaintext highlighter-rouge">inflation_radius - min_dist_to_obstacle</code>). If this penalty is too high, the robot will slow significantly when entering cost-space from non-cost space or jitter in narrow corridors. It is noteworthy, but likely not necessary to be changed, that the Obstacle critic may use the full footprint information if <code class="language-plaintext highlighter-rouge">consider_footprint = true</code>, though comes at an increased compute cost.</p>

<p>If you don’t require path following behavior (e.g. just want to follow a goal pose and let the model predictive elements decide the best way to accomplish that), you may easily remove the PathAlign, PathFollow and PathAngle critics.</p>

<p>By default, the controller is tuned and has the capabilities established in the PathAlign/Obstacle critics to generally follow the path closely when no obstacles prevent it, but able to deviate from the path when blocked. See <code class="language-plaintext highlighter-rouge">PathAlignCritic::score()</code> for details, but it is disabled when the local path is blocked so the obstacle critic takes over in that state.</p>

<h3 id="prediction-horizon-costmap-sizing-and-offsets">Prediction Horizon, Costmap Sizing, and Offsets</h3>

<p>As this is a predictive planner, there is some relationship between maximum speed, prediction times, and costmap size that users should keep in mind while tuning for their application. If a controller server costmap is set to 3.0m in size, that means that with the robot in the center, there is 1.5m of information on either side of the robot. When your prediction horizon (time_steps * model_dt) at maximum speed (vx_max) is larger than this, then your robot will be artificially limited in its maximum speeds and behavior by the costmap limitation. For example, if you predict forward 3 seconds (60 steps @ 0.05s per step) at 0.5m/s maximum speed, the <strong>minimum</strong> required costmap radius is 1.5m - or 3m total width.</p>

<p>The same applies to the Path Follow and Align offsets from furthest. In the same example if the furthest point we can consider is already at the edge of the costmap, then further offsets are thresholded because they’re unusable. So its important while selecting these parameters to make sure that the theoretical offsets can exist on the costmap settings selected with the maximum prediction horizon and velocities desired. Setting the threshold for consideration in the path follower + goal critics as the same as your prediction horizon can make sure you have clean hand-offs between them, as the path follower will otherwise attempt to slow slightly once it reaches the final goal pose as its marker.</p>

<p>The Path Follow critic cannot drive velocities greater than the projectable distance of that velocity on the available path on the rolling costmap. The Path Align critic <code class="language-plaintext highlighter-rouge">offset_from_furthest</code> represents the number of path points a trajectory passes through while tracking the path. If this is set either absurdly low (e.g. 5) it can trigger when a robot is simply trying to start path tracking causing some suboptimal behaviors and local minima while starting a task. If it is set absurdly high (e.g. 50) relative to the path resolution and costmap size, then the critic may never trigger or only do so when at full-speed. A balance here is wise. A selection of this value to be ~30% of the maximum velocity distance projected is good (e.g. if a planner produces points every 2.5cm, 60 can fit on the 1.5m local costmap radius. If the max speed is 0.5m/s with a 3s prediction time, then 20 points represents 33% of the maximum speed projected over the prediction horizon onto the path). When in doubt, <code class="language-plaintext highlighter-rouge">prediction_horizon_s * max_speed / path_resolution / 3.0</code> is a good baseline.</p>

<h3 id="obstacle-inflation-layer-and-path-following">Obstacle, Inflation Layer, and Path Following</h3>

<p>There also exists a relationship between the costmap configurations and the Obstacle critic configurations. If the Obstacle critic is not well tuned with the costmap parameters (inflation radius, scale) it can cause the robot to wobble significantly as it attempts to take finitely lower-cost trajectories with a slightly lower cost in exchange for jerky motion. The default behavior was tuned for small AMRs (e.g. turtlebots or similar), so if using a larger robot, you may want to reduce the <code class="language-plaintext highlighter-rouge">repulsion_weight</code> in kind. It may also perform awkward maneuvers when in free-space to try to maximize time in a small pocket of 0-cost over a more natural motion which involves moving into some low-costed region. Finally, it may generally refuse to go into costed space at all when starting in a free 0-cost space if the gain is set disproportionately higher than the Path Follow scoring to encourage the robot to move along the path. This is due to the critic cost of staying in free space becoming more attractive than entering even lightly costed space in exchange for progression along the task.</p>

<p>Thus, care should be taken to select weights of the obstacle critic in conjunction with the costmap inflation radius and scale so that a robot does not have such issues. How I (Steve, your friendly neighborhood navigator) tuned this was to first create the appropriate obstacle critic behavior desirable in conjunction with the inflation layer parameters. Its worth noting that the Obstacle critic converts the cost into a distance from obstacles, so the nature of the distribution of costs in the inflation isn’t overly significant. However, the inflation radius and the scale will define the cost at the end of the distribution where free-space meets the lowest cost value within the radius. So testing for quality behavior when going over that threshold should be considered.</p>

<p>As you increase or decrease your weights on the Obstacle, you may notice the aforementioned behaviors (e.g. won’t overcome free to non-free threshold). To overcome them, increase the FollowPath critic cost to increase the desire for the trajectory planner to continue moving towards the goal. Make sure to not overshoot this though, keep them balanced. A desirable outcome is smooth motion roughly in the center of spaces without significant close interactions with obstacles. It shouldn’t be perfectly following a path yet nor should the output velocity be wobbling jaggedly.</p>

<p>Once you have your obstacle avoidance behavior tuned and matched with an appropriate path following penalty, tune the Path Align critic to align with the path. If you design exact-path-alignment behavior, its possible to skip the obstacle critic step as highly tuning the system to follow the path will give it less ability to deviate to avoid obstacles (though it’ll slow and stop). Tuning the critic weight for the Obstacle critic high will do the job to avoid near-collisions but the repulsion weight is largely unnecessary to you. For others wanting more dynamic behavior, it <em>can</em> be beneficial to slowly lower the weight on the obstacle critic to give the path alignment critic some more room to work. If your path was generated with a cost-aware planner (like all provided by Nav2) and providing paths sufficiently far from obstacles for your satisfaction, the impact of a slightly reduced Obstacle critic with a Path Alignment critic will do you well. Not over-weighting the path align critic will allow the robot to  deviate from the path to get around dynamic obstacles in the scene or other obstacles not previous considered during path planning. It is subjective as to the best behavior for your application, but it has been shown that MPPI can be an exact path tracker and/or avoid dynamic obstacles very fluidly and everywhere in between. The defaults provided are in the generally right regime for a balanced initial trade-off.</p>
</div>
              </div>
            </div>
          </div>
        </div>
      
    
    <div class="row">
      <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-heading"><span class="glyphicon glyphicon-list"></span> CHANGELOG</div>
          <div class="panel-body">
            
              <em>No CHANGELOG found.</em>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="humble-tutorials">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wiki Tutorials</h3>
      </div>
      <div class="panel-body">
        
        <em>This package does not provide any links to tutorials in it's <a href="https://index.ros.org/contribute/metadata/">rosindex metadata</a>.</em>
        <em>You can check on the <a href="http://wiki.ros.org/nav2_mppi_controller/Tutorials" target="_blank">ROS Wiki Tutorials</a> page for the package.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="humble-deps">
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Package Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th class="text-center">Deps</th>
                  <th style="width: 100%">Name</th>
                </thead>
                <tbody>
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake#humble">ament_cmake  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_ros#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_ros#humble">ament_cmake_ros  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_auto#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_auto#humble">ament_lint_auto  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_common#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_common#humble">ament_lint_common  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_gtest#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_gtest#humble">ament_cmake_gtest  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rclcpp#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rclcpp#humble">rclcpp  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/nav2_common#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/nav2_common#humble">nav2_common  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/nav2_core#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/nav2_core#humble">nav2_core  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/nav2_util#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/nav2_util#humble">nav2_util  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/nav2_costmap_2d#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/nav2_costmap_2d#humble">nav2_costmap_2d  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/geometry_msgs#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/geometry_msgs#humble">geometry_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/visualization_msgs#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/visualization_msgs#humble">visualization_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/nav2_msgs#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/nav2_msgs#humble">nav2_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/pluginlib#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/pluginlib#humble">pluginlib  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/tf2_geometry_msgs#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/tf2_geometry_msgs#humble">tf2_geometry_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/tf2#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/tf2#humble">tf2  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/tf2_eigen#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/tf2_eigen#humble">tf2_eigen  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/tf2_ros#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/tf2_ros#humble">tf2_ros  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/std_msgs#humble-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/std_msgs#humble">std_msgs  </a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
          <div class="panel-heading">
            <h3 class="panel-title">System Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                </thead>
                <tbody>
                  
                    
                      <tr>
                        <td><a href="/d/xtensor">xtensor</a></td>
                      </tr>
                    
                  
                    
                      <tr>
                        <td><a href="/d/libomp-dev">libomp-dev</a></td>
                      </tr>
                    
                  
                    
                      <tr>
                        <td><a href="/d/benchmark">benchmark</a></td>
                      </tr>
                    
                  
                    
                      <tr>
                        <td><a href="/d/xsimd">xsimd</a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Dependant Packages</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                  <th class="text-center">Deps</th>
                </thead>
                <tbody>
                  
                    
                    
                    <tr>
                      <td><a href="/p/navigation2#humble">navigation2</a></td>
                      <td class="text-center">
                        
                        <a href="/p/navigation2#humble-deps" >
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                    
                    
                    <tr>
                      <td><a href="/p/omni_base_2dnav#humble">omni_base_2dnav</a></td>
                      <td class="text-center">
                        
                        <a href="/p/omni_base_2dnav#humble-deps" >
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                    
                    
                    <tr>
                      <td><a href="/p/pmb2_2dnav#humble">pmb2_2dnav</a></td>
                      <td class="text-center">
                        
                        <a href="/p/pmb2_2dnav#humble-deps" >
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="humble-assets">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Launch files</h3>
      </div>
      <div class="panel-body">
        
          <em>No launch files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Messages</h3>
      </div>
      <div class="panel-body">
        
          <em>No message files found.</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Services</h3>
      </div>
      <div class="panel-body">
        
          <em>No service files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Plugins</h3>
      </div>
      <div class="panel-body">
        
          <ul>
            
              <li><a href="https://github.com/ros-planning/navigation2/tree/humble/nav2_mppi_controller//mppic.xml" target="_blank">nav2_core</a></li>
            
              <li><a href="https://github.com/ros-planning/navigation2/tree/humble/nav2_mppi_controller//critics.xml" target="_blank">nav2_mppi_controller</a></li>
            
          </ul>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="humble-questions">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent questions tagged <kbd>nav2_mppi_controller</kbd> at <strong><a href="https://robotics.stackexchange.com/" target="_blank">Robotics Stack Exchange</a></strong></h3>      </div>
      <div id="humble-question-list" class="panel-body" style="display: none;"></div>
      <div id="humble-no-question-list" class="panel-body" style="display: none;">
        <p>No questions yet, you can ask one <a href="https://robotics.stackexchange.com/questions/tagged/nav2_mppi_controller+humble">here</a>.</p>
      </div>
      <div id="humble-get-question-fail" class="panel-body alert alert-warning" style="display: none;">
        <p>Failed to get question list, you can ticket an issue <a href="https://github.com/ros-infrastructure/rosindex/issues/new" target="_blank" class="alert-link">here</a> </p>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/package_body_tabs.js"></script>

<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
jQuery(function() {
    // Update the count on the links to the contribution suggestions
    updateContributionSuggestionsCountOnPackage('https://github.com/ros-planning/navigation2.git');
});
</script>

          </div>
          <div class="col-md-2 hidden-xs hidden-sm">
            
            
            



<div class="list-group list-group-sm ">
  <a class="list-group-item"
     target="_blank"
     href="http://docs.ros.org/en/humble/p/nav2_mppi_controller"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       
       API Docs
  </a>
  <a class="list-group-item"
     target="_blank"
     href="https://github.com/ros-planning/navigation2/tree/humble/nav2_mppi_controller"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       
       Browse Code
  </a>
  
  
  
  
  
  
</div>

          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-jazzy">
    <div class="container-fluid">
      
        
        
        

        <div class="row">
          <div class="col-md-10">
            

<div class="well well-sm">
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px" src="/assets/package.png">
      </td>
      <td>
        <h3 style="margin-top: 5px">
          <a style="text-decoration:none" href="/p/nav2_mppi_controller">nav2_mppi_controller</a> <small>package from <a style="text-decoration:none" href="/r/navigation2/github-ros-planning-navigation2">navigation2</a> repo</small>
        </h3>
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_amcl">

nav2_amcl
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_behavior_tree">

nav2_behavior_tree
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_behaviors">

nav2_behaviors
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_bringup">

nav2_bringup
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_bt_navigator">

nav2_bt_navigator
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_collision_monitor">

nav2_collision_monitor
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_common">

nav2_common
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_constrained_smoother">

nav2_constrained_smoother
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_controller">

nav2_controller
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_core">

nav2_core
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_costmap_2d">

nav2_costmap_2d
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/opennav_docking">

opennav_docking
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/opennav_docking_bt">

opennav_docking_bt
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/opennav_docking_core">

opennav_docking_core
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/costmap_queue">

costmap_queue
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/dwb_core">

dwb_core
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/dwb_critics">

dwb_critics
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/dwb_msgs">

dwb_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/dwb_plugins">

dwb_plugins
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_dwb_controller">

nav2_dwb_controller
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav_2d_msgs">

nav_2d_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav_2d_utils">

nav_2d_utils
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_graceful_controller">

nav2_graceful_controller
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_lifecycle_manager">

nav2_lifecycle_manager
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_loopback_sim">

nav2_loopback_sim
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_map_server">

nav2_map_server
</a>
            
          
            
            
              <span class="label label-default pkg-label">

nav2_mppi_controller
</span>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_msgs">

nav2_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_navfn_planner">

nav2_navfn_planner
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_planner">

nav2_planner
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_regulated_pure_pursuit_controller">

nav2_regulated_pure_pursuit_controller
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_rotation_shim_controller">

nav2_rotation_shim_controller
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_rviz_plugins">

nav2_rviz_plugins
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_simple_commander">

nav2_simple_commander
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_smac_planner">

nav2_smac_planner
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_smoother">

nav2_smoother
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_system_tests">

nav2_system_tests
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_theta_star_planner">

nav2_theta_star_planner
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_util">

nav2_util
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_velocity_smoother">

nav2_velocity_smoother
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_voxel_grid">

nav2_voxel_grid
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_waypoint_follower">

nav2_waypoint_follower
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/navigation2">

navigation2
</a>
            
          
      </td>
    </tr>
  </table>
</div>

            <div class="visible-xs visible-sm">
              
              
              



<div class="list-group list-group-sm list-group-horizontal list-group-justified">
  <a class="list-group-item text-center"
     target="_blank"
     href="http://docs.ros.org/en/jazzy/p/nav2_mppi_controller"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       <br>
       API Docs
  </a>
  <a class="list-group-item text-center"
     target="_blank"
     href="https://github.com/ros-planning/navigation2/tree/jazzy/nav2_mppi_controller"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       <br>
       Browse Code
  </a>
  
  
  
  
  
  
</div>

            </div>
            



<ul class="nav nav-tabs nav-justified" id="jazzy-tabs" style="margin-bottom:20px">
  <li class="better-tabs active">
    <a href="#jazzy-overview" data-toggle="tab">Overview</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    
    <a href="#jazzy-assets" data-toggle="tab"><span class="label label-primary">2</span> Assets</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    <a href="#jazzy-deps" data-toggle="tab"><span class="label label-primary">23</span> Dependencies</a>
  </li>
  <li class="better-tabs">
    
    <a href="#jazzy-tutorials" data-toggle="tab"><span class="label label-default">0</span> Tutorials</a>
  </li>
  <li class="better-tabs">
    <a href="#jazzy-questions" data-toggle="tab"><span id="jazzy-questions-count" class="label label-primary">0</span> Q & A</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="jazzy-overview">
    
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h4 class="panel-title">Package Summary</h4></div>
          <div class="panel-body">
            <table class="table table-condensed">
              <tr>
                <td style="width:100px;" class="text-right"><strong>Tags</strong></td>
                <td>
                  
                  
                    <em>No category tags.</em>
                  
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Version</strong></td>
                <td>1.3.6</td>
              </tr>
              <tr>
                <td class="text-right"><strong>License</strong></td>
                <td>MIT</td>
              </tr>
              <tr>
                <td class="text-right"><strong>Build type</strong></td>
                <td>
                  
                    <span class="label label-default">
                  
                    AMENT_CMAKE</span>
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Use</strong></td>
                <td>
                
                  <span class="label label-success">RECOMMENDED</span>
                
                </td>
              </tr>
            </table>
          </div>
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body">
            
            
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">ROS 2 Navigation Framework and System</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/ros-planning/navigation2.git">https://github.com/ros-planning/navigation2.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">jazzy</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-05-03
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="No CI information available for this package.">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <span class="label label-default">robotics</span> <span class="label label-default">navigation</span> <span class="label label-default">ros2</span> 
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/navigation2/#jazzy-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/navigation2/#jazzy-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/navigation2/#jazzy-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Package Description</h3></div>
          <div class="panel-body">
            nav2_mppi_controller
          </div>
          <div class="panel-heading"><h4 class="panel-title">Additional Links</h4></div>
          <div class="panel-body">
            
            
              <em>No additional links.</em>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Maintainers</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Steve Macenski</li>
                
                  <li>Aleksei Budyakov</li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Authors</h4></div>
          <div class="panel-body">
            
            
              <em>No additional authors.</em>
            
          </div>
        </div>
      </div>
    </div>
    
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-heading"><span class="glyphicon glyphicon-file"></span><a href="https://github.com/ros-planning/navigation2/tree/jazzy/nav2_mppi_controller/README.md" title="Open in git repository">nav2_mppi_controller/README.md</a></div>
              <div class="panel-body">
                    <div class="rendered-markdown">
<h1 id="model-predictive-path-integral-controller">Model Predictive Path Integral Controller</h1>

<p><img src="https://raw.githubusercontent.com/ros-planning/navigation2/jazzy/nav2_mppi_controller/media/demo.gif" alt=""></p>

<h2 id="overview">Overview</h2>

<p>This is a predictive controller (local trajectory planner) that implements the <a href="https://ieeexplore.ieee.org/document/7487277">Model Predictive Path Integral (MPPI)</a> algorithm to track a path with adaptive collision avoidance. It contains plugin-based critic functions to impact the behavior of the algorithm. It was created by <a href="https://www.linkedin.com/in/aleksei-budyakov-334889224/">Aleksei Budyakov</a> and adapted &amp; developed for Nav2 by <a href="https://www.linkedin.com/in/steve-macenski-41a985101/">Steve Macenski</a>.</p>

<p>This plugin implements the <code class="language-plaintext highlighter-rouge">nav2_core::Controller</code> interface allowing it to be used across the navigation stack as a local trajectory planner in the controller server’s action server (<code class="language-plaintext highlighter-rouge">controller_server</code>).</p>

<p>This controller is measured to run at 50+ Hz on a modest Intel processor (4th gen i5). See its Configuration Guide Page for additional parameter descriptions.</p>

<p>It works currently with Differential, Omnidirectional, and Ackermann robots.</p>

<h2 id="mppi-description">MPPI Description</h2>

<p>The MPPI algorithm is an MPC variant that finds a control velocity for the robot using an iterative approach. Using the previous time step’s best control solution and the robot’s current state, a set of randomly sampled perturbations from a Gaussian distribution are applied. These noised controls are forward simulated to generate a set of trajectories within the robot’s motion model.</p>

<p>Next, these trajectories are scored using a set of plugin-based critic functions to find the best trajectory in the batch. The output scores are used to set the best control with a soft max function.</p>

<p>This process is then repeated a number of times and returns a converged solution. This solution is then used as the basis of the next time step’s initial control.</p>

<h2 id="features">Features</h2>

<ul>
  <li>Predictive MPC trajectory planner</li>
  <li>Utilizes plugin-based critics which can be swapped out, tuned, or replaced easily by the user</li>
  <li>Highly optimized CPU-only performance using vectorization and tensor operations</li>
  <li>Supports a number of common motion models, including Ackermann, Differential-Drive, and Omni-directional</li>
  <li>Includes fallback mechanisms to handle soft-failures before escalating to recovery behaviors</li>
  <li>High-quality code implementation with Doxygen, high unit test coverage, documentation, and parameter guide</li>
  <li>Easily extensible to support modern research variants of MPPI</li>
  <li>Comes pre-tuned for good out-of-the-box behavior</li>
</ul>

<h2 id="configuration">Configuration</h2>

<h3 id="controller">Controller</h3>
<p>| Parameter                  | Type   | Definition                                                                                                                                                                                                                                                                                                           |
 | ———————      | —— | ——————————————————————————————————– |
 | motion_model               | string | Default: DiffDrive. Type of model [DiffDrive, Omni, Ackermann].                                          |
 | critics                    | string | Default: None. Critics (plugins) names                                                                   |
 | iteration_count            | int    | Default 1. Iteration count in MPPI algorithm. Recommend to keep as 1 and prefer more batches.            |
 | batch_size                 | int    | Default 1000. Count of randomly sampled candidate trajectories                                            |
 | time_steps                 | int    | Default 56. Number of time steps (points) in each sampled trajectory                                     |
 | model_dt                   | double | Default: 0.05. Time interval (s) between two sampled points in trajectories.                              |
 | vx_std                     | double | Default 0.2. Sampling standard deviation for VX                                                          |
 | vy_std                     | double | Default 0.2. Sampling standard deviation for VY                                                          |
 | wz_std                     | double | Default 0.4. Sampling standard deviation for Wz                                                          |
 | vx_max                     | double | Default 0.5. Max VX (m/s)                                                                                |
 | vy_max                     | double | Default 0.5. Max VY in either direction, if holonomic. (m/s)                                             |
 | vx_min                     | double | Default -0.35. Min VX (m/s)                                                                              |
 | wz_max                     | double | Default 1.9. Max WZ (rad/s)                                                                              |
 | temperature                | double | Default: 0.3. Selectiveness of trajectories by their costs (The closer this value to 0, the “more” we take in consideration controls with less cost), 0 mean use control with best cost, huge value will lead to just taking mean of all trajectories without cost consideration                                                   |
 | gamma                      | double | Default: 0.015. A trade-off between smoothness (high) and low energy (low). This is a complex parameter that likely won’t need to be changed from the default of <code class="language-plaintext highlighter-rouge">0.1</code> which works well for a broad range of cases. See Section 3D-2 in “Information Theoretic Model Predictive Control: Theory and Applications to Autonomous Driving” for detailed information.       |
 | visualize                  | bool   | Default: false. Publish visualization of trajectories, which can slow down the controller significantly. Use only for debugging.                                                                                                                                       |
 | retry_attempt_limit        | int    | Default 1. Number of attempts to find feasible trajectory on failure for soft-resets before reporting failure.                                                                                                                                                                                                       |
 | regenerate_noises          | bool   | Default false. Whether to regenerate noises each iteration or use single noise distribution computed on initialization and reset. Practically, this is found to work fine since the trajectories are being sampled stochastically from a normal distribution and reduces compute jittering at run-time due to thread wake-ups to resample normal distribution. |</p>

<h4 id="trajectory-visualizer">Trajectory Visualizer</h4>
<p>| Parameter             | Type   | Definition                                                                                                  |
 | —————       | —— | ———————————————————————————————————– |
 | trajectory_step       | int    | Default: 5. The step between trajectories to visualize to downsample candidate trajectory pool.             |
 | time_step             | int    | Default: 3. The step between points on trajectories to visualize to downsample trajectory density.          |</p>

<h4 id="path-handler">Path Handler</h4>
<p>| Parameter                  | Type   | Definition                                                                                                  |
 | —————            | —— | ———————————————————————————————————– |
 | max_robot_pose_search_dist | double | Default: Costmap half-size. Max integrated distance ahead of robot pose to search for nearest path point in case of path looping.   |
 | prune_distance             | double | Default: 1.5. Distance ahead of nearest point on path to robot to prune path to.                            |
 | transform_tolerance        | double | Default: 0.1. Time tolerance for data transformations with TF.                                              |
 | enforce_path_inversion        | double | Default: False. If true, it will prune paths containing cusping points for segments changing directions (e.g. path inversions) such that the controller will be forced to change directions at or very near the planner’s requested inversion point. This is targeting Smac Planner users with feasible paths who need their robots to switch directions where specifically requested.      |
 | inversion_xy_tolerance        | double | Default: 0.2. Cartesian proximity (m) to path inversion point to be considered “achieved” to pass on the rest of the path after path inversion.      |
 | inversion_yaw_tolerance        | double | Default: 0.4. Angular proximity (radians) to path inversion point to be considered “achieved” to pass on the rest of the path after path inversion. 0.4 rad = 23 deg.  |</p>

<h4 id="ackermann-motion-model">Ackermann Motion Model</h4>
<p>| Parameter            | Type   | Definition                                                                                                  |
 | ——————– | —— | ———————————————————————————————————– |
 | min_turning_r        | double | minimum turning radius for ackermann motion model                                                           |</p>

<h4 id="constraint-critic">Constraint Critic</h4>
<p>| Parameter             | Type   | Definition                                                                                                  |
 | —————       | —— | ———————————————————————————————————– |
 | cost_weight           | double | Default 4.0. Weight to apply to critic term.                                                                |
 | cost_power            | int    | Default 1. Power order to apply to term.</p>

<h4 id="goal-angle-critic">Goal Angle Critic</h4>
<p>| Parameter                        | Type   | Definition                                                                                                  |
 | —————                  | —— | ———————————————————————————————————– |
 | cost_weight                      | double | Default 3.0. Weight to apply to critic term.                                                                |
 | cost_power                       | int    | Default 1. Power order to apply to term.                                                                    |
 | threshold_to_consider            | double | Default 0.5. Minimal distance between robot and goal above which angle goal cost considered.               |</p>

<h4 id="goal-critic">Goal Critic</h4>
<p>| Parameter            | Type   | Definition                                                                                                  |
 | ——————– | —— | ———————————————————————————————————– |
 | cost_weight          | double | Default 5.0. Weight to apply to critic term.                                                                |
 | cost_power           | int    | Default 1. Power order to apply to term.                                                                    |
 | threshold_to_consider      | double | Default 1.4. Distance between robot and goal above which goal cost starts being considered                                    |</p>

<h4 id="obstacles-critic">Obstacles Critic</h4>

<p>Uses estimated distances from obstacles using cost and inflation parameters to avoid obstacles</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Type</th>
      <th>Definition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>consider_footprint</td>
      <td>bool</td>
      <td>Default: False. Whether to use point cost (if robot is circular or low compute power) or compute SE2 footprint cost.</td>
    </tr>
    <tr>
      <td>critical_weight</td>
      <td>double</td>
      <td>Default 20.0. Weight to apply to critic for near collisions closer than <code class="language-plaintext highlighter-rouge">collision_margin_distance</code> to prevent near collisions <strong>only</strong> as a method of virtually inflating the footprint. This should not be used to generally influence obstacle avoidance away from critical collisions.</td>
    </tr>
    <tr>
      <td>repulsion_weight</td>
      <td>double</td>
      <td>Default 1.5. Weight to apply to critic for generally preferring routes in lower cost space. This is separated from the critical term to allow for fine tuning of obstacle behaviors with path alignment for dynamic scenes without impacting actions which may directly lead to near-collisions. This is applied within the <code class="language-plaintext highlighter-rouge">inflation_radius</code> distance from obstacles.</td>
    </tr>
    <tr>
      <td>cost_power</td>
      <td>int</td>
      <td>Default 1. Power order to apply to term.</td>
    </tr>
    <tr>
      <td>collision_cost</td>
      <td>double</td>
      <td>Default 100000.0. Cost to apply to a true collision in a trajectory.</td>
    </tr>
    <tr>
      <td>collision_margin_distance</td>
      <td>double</td>
      <td>Default 0.10. Margin distance from collision to apply severe penalty, similar to footprint inflation. Between 0.05-0.2 is reasonable.</td>
    </tr>
    <tr>
      <td>near_goal_distance</td>
      <td>double</td>
      <td>Default 0.5. Distance near goal to stop applying preferential obstacle term to allow robot to smoothly converge to goal pose in close proximity to obstacles.</td>
    </tr>
    <tr>
      <td>inflation_layer_name</td>
      <td>string</td>
      <td>Default “”. Name of the inflation layer. If empty, it uses the last inflation layer in the costmap. If you have multiple inflation layers, you may want to specify the name of the layer to use.</td>
    </tr>
  </tbody>
</table>

<h4 id="cost-critic">Cost Critic</h4>

<p>Uses inflated costmap cost directly to avoid obstacles</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Type</th>
      <th>Definition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>consider_footprint</td>
      <td>bool</td>
      <td>Default: False. Whether to use point cost (if robot is circular or low compute power) or compute SE2 footprint cost.</td>
    </tr>
    <tr>
      <td>cost_weight</td>
      <td>double</td>
      <td>Default 3.81. Wight to apply to critic to avoid obstacles.</td>
    </tr>
    <tr>
      <td>cost_power</td>
      <td>int</td>
      <td>Default 1. Power order to apply to term.</td>
    </tr>
    <tr>
      <td>collision_cost</td>
      <td>double</td>
      <td>Default 1000000.0. Cost to apply to a true collision in a trajectory.</td>
    </tr>
    <tr>
      <td>critical_cost</td>
      <td>double</td>
      <td>Default 300.0. Cost to apply to a pose with any point in in inflated space to prefer distance from obstacles.</td>
    </tr>
    <tr>
      <td>near_goal_distance</td>
      <td>double</td>
      <td>Default 0.5. Distance near goal to stop applying preferential obstacle term to allow robot to smoothly converge to goal pose in close proximity to obstacles.</td>
    </tr>
    <tr>
      <td>inflation_layer_name</td>
      <td>string</td>
      <td>Default “”. Name of the inflation layer. If empty, it uses the last inflation layer in the costmap. If you have multiple inflation layers, you may want to specify the name of the layer to use.</td>
    </tr>
    <tr>
      <td>trajectory_point_step</td>
      <td>int</td>
      <td>Default 2. Step of trajectory points to evaluate for costs since otherwise so dense represents multiple points for a single costmap cell.</td>
    </tr>
  </tbody>
</table>

<h4 id="path-align-critic">Path Align Critic</h4>
<p>| Parameter                  | Type   | Definition                                                                                                                         |
 | —————            | —— | ———————————————————————————————————–                        |
 | cost_weight                | double | Default 10.0. Weight to apply to critic term.                                                                                       |
 | cost_power                 | int    | Default 1. Power order to apply to term.                                                                                           |
 | threshold_to_consider      | double | Default 0.5. Distance between robot and goal above which path align cost stops being considered                                    |
 | offset_from_furthest      | double | Default 20. Checks that the candidate trajectories are sufficiently far along their way tracking the path to apply the alignment critic. This ensures that path alignment is only considered when actually tracking the path, preventing awkward initialization motions preventing the robot from leaving the path to achieve the appropriate heading.  |
 | trajectory_point_step      | int | Default 4. Step of trajectory points to evaluate for path distance to reduce compute time. Between 1-10 is typically reasonable.   |
 | max_path_occupancy_ratio   | double | Default 0.07 (7%). Maximum proportion of the path that can be occupied before this critic is not considered to allow the obstacle and path follow critics to avoid obstacles while following the path’s intent in presence of dynamic objects in the scene.  |
 | use_path_orientations   | bool | Default false. Whether to consider path’s orientations in path alignment, which can be useful when paired with feasible smac planners to incentivize directional changes only where/when the smac planner requests them. If you want the robot to deviate and invert directions where the controller sees fit, keep as false. If your plans do not contain orientation information (e.g. navfn), keep as false.  |</p>

<h4 id="path-angle-critic">Path Angle Critic</h4>
<p>| Parameter                 | Type   | Definition                                                                                                  |
 | —————           | —— | ———————————————————————————————————– |
 | cost_weight               | double | Default 2.2. Weight to apply to critic term.                                                                |
 | cost_power                | int    | Default 1. Power order to apply to term.                                                                    |
 | threshold_to_consider     | double | Default 0.5. Distance between robot and goal above which path angle cost stops being considered             |
 | offset_from_furthest      | int    | Default 4. Number of path points after furthest one any trajectory achieves to compute path angle relative to.  |
 | max_angle_to_furthest     | double | Default 0.785398. Angular distance between robot and goal above which path angle cost starts being considered           |
 | mode     | int | Default 0 (Forward Preference). Enum type for mode of operations for the path angle critic depending on path input types and behavioral desires. 0: Forward Preference, penalizes high path angles relative to the robot’s orientation to incentivize turning towards the path. 1: No directional preference, penalizes high path angles relative to the robot’s orientation or mirrored orientation (e.g. reverse), which ever is less, when a particular direction of travel is not preferable. 2: Consider feasible path orientation, when using a feasible path whereas the path points have orientation information (e.g. Smac Planners), consider the path’s requested direction of travel to penalize path angles such that the robot will follow the path in the requested direction. |</p>

<h4 id="path-follow-critic">Path Follow Critic</h4>
<p>| Parameter             | Type   | Definition                                                                                                  |
 | —————       | —— | ———————————————————————————————————– |
 | cost_weight           | double | Default 5.0. Weight to apply to critic term.                                                                |
 | cost_power            | int    | Default 1. Power order to apply to term.   |
 | offset_from_furthest  | int    | Default 6. Number of path points after furthest one any trajectory achieves to drive path tracking relative to.     |
 | threshold_to_consider        | float  | Default 1.4. Distance between robot and goal above which path follow cost stops being considered  |</p>

<h4 id="prefer-forward-critic">Prefer Forward Critic</h4>
<p>| Parameter             | Type   | Definition                                                                                                  |
 | —————       | —— | ———————————————————————————————————– |
 | cost_weight           | double | Default 5.0. Weight to apply to critic term.                                                                |
 | cost_power            | int    | Default 1. Power order to apply to term.                                                                    |
 | threshold_to_consider | double | Default 0.5. Distance between robot and goal above which prefer forward cost stops being considered         |</p>

<h4 id="twirling-critic">Twirling Critic</h4>
<p>| Parameter             | Type   | Definition                                                                                                  |
 | —————       | —— | ———————————————————————————————————– |
 | cost_weight           | double | Default 10.0. Weight to apply to critic term.                                                               |
 | cost_power            | int    | Default 1. Power order to apply to term.                                                                    |</p>

<h4 id="velocity-deadband-critic">Velocity Deadband Critic</h4>
<p>| Parameter             | Type     | Definition                                                                                                  |
 | —————       | ——   | ———————————————————————————————————– |
 | cost_weight           | double   | Default 35.0. Weight to apply to critic term.                                                               |
 | cost_power            | int      | Default 1. Power order to apply to term.                                                                    |
 | deadband_velocities   | double[] | Default [0.0, 0.0, 0.0].  The array of deadband velocities [vx, vz, wz]. A zero array indicates that the critic will take no action.      |</p>

<h3 id="xml-configuration-example">XML configuration example</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>controller_server:
  ros__parameters:
    controller_frequency: 30.0
    FollowPath:
      plugin: "nav2_mppi_controller::MPPIController"
      time_steps: 56
      model_dt: 0.05
      batch_size: 2000
      vx_std: 0.2
      vy_std: 0.2
      wz_std: 0.4
      vx_max: 0.5
      vx_min: -0.35
      vy_max: 0.5
      wz_max: 1.9
      iteration_count: 1
      prune_distance: 1.7
      transform_tolerance: 0.1
      temperature: 0.3
      gamma: 0.015
      motion_model: "DiffDrive"
      visualize: false
      TrajectoryVisualizer:
        trajectory_step: 5
        time_step: 3
      AckermannConstraints:
        min_turning_r: 0.2
      critics: ["ConstraintCritic", "CostCritic", "GoalCritic", "GoalAngleCritic", "PathAlignCritic", "PathFollowCritic", "PathAngleCritic", "PreferForwardCritic"]
      ConstraintCritic:
        enabled: true
        cost_power: 1
        cost_weight: 4.0
      GoalCritic:
        enabled: true
        cost_power: 1
        cost_weight: 5.0
        threshold_to_consider: 1.4
      GoalAngleCritic:
        enabled: true
        cost_power: 1
        cost_weight: 3.0
        threshold_to_consider: 0.5
      PreferForwardCritic:
        enabled: true
        cost_power: 1
        cost_weight: 5.0
        threshold_to_consider: 0.5
      # Option to replace Cost and use Obstacles instead
      # ObstaclesCritic:
      #   enabled: true
      #   cost_power: 1
      #   repulsion_weight: 1.5
      #   critical_weight: 20.0
      #   consider_footprint: false
      #   collision_cost: 10000.0
      #   collision_margin_distance: 0.1
      #   near_goal_distance: 0.5
      CostCritic:
        enabled: true
        cost_power: 1
        cost_weight: 3.81
        critical_cost: 300.0
        consider_footprint: true
        collision_cost: 1000000.0
        near_goal_distance: 1.0
        trajectory_point_step: 2
      PathAlignCritic:
        enabled: true
        cost_power: 1
        cost_weight: 14.0
        max_path_occupancy_ratio: 0.05
        trajectory_point_step: 4
        threshold_to_consider: 0.5
        offset_from_furthest: 20
        use_path_orientations: false
      PathFollowCritic:
        enabled: true
        cost_power: 1
        cost_weight: 5.0
        offset_from_furthest: 5
        threshold_to_consider: 1.4
      PathAngleCritic:
        enabled: true
        cost_power: 1
        cost_weight: 2.0
        offset_from_furthest: 4
        threshold_to_consider: 0.5
        max_angle_to_furthest: 1.0
        forward_preference: true
      # VelocityDeadbandCritic:
      #   enabled: true
      #   cost_power: 1
      #   cost_weight: 35.0
      #   deadband_velocities: [0.05, 0.05, 0.05]
      # TwirlingCritic:
      #   enabled: true
      #   twirling_cost_power: 1
      #   twirling_cost_weight: 10.0

</code></pre></div></div>
<h2 id="topics">Topics</h2>

<table>
  <thead>
    <tr>
      <th>Topic</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">trajectories</code></td>
      <td><code class="language-plaintext highlighter-rouge">visualization_msgs/MarkerArray</code></td>
      <td>Randomly generated trajectories, including resulting control sequence</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">transformed_global_plan</code></td>
      <td><code class="language-plaintext highlighter-rouge">nav_msgs/Path</code></td>
      <td>Part of global plan considered by local planner</td>
    </tr>
  </tbody>
</table>

<h2 id="notes-to-users">Notes to Users</h2>

<h3 id="general-words-of-wisdom">General Words of Wisdom</h3>

<p>The <code class="language-plaintext highlighter-rouge">model_dt</code> parameter generally should be set to the duration of your control frequency. So if your control frequency is 20hz, this should be <code class="language-plaintext highlighter-rouge">0.05</code>. However, you may also set it lower <strong>but not larger</strong>.</p>

<p>Visualization of the trajectories using <code class="language-plaintext highlighter-rouge">visualize</code> uses compute resources to back out trajectories for visualization and therefore slows compute time. It is not suggested that this parameter is set to <code class="language-plaintext highlighter-rouge">true</code> during a deployed use, but is a useful debug instrument while tuning the system, but use sparingly. Visualizing 2000 batches @ 56 points at 30 hz is <em>a lot</em>.</p>

<p>The most common parameters you might want to start off changing are the velocity profiles (<code class="language-plaintext highlighter-rouge">vx_max</code>, <code class="language-plaintext highlighter-rouge">vx_min</code>, <code class="language-plaintext highlighter-rouge">wz_max</code>, and <code class="language-plaintext highlighter-rouge">vy_max</code> if holonomic) and the <code class="language-plaintext highlighter-rouge">motion_model</code> to correspond to your vehicle. Its wise to consider the <code class="language-plaintext highlighter-rouge">prune_distance</code> of the path plan in proportion to your maximum velocity and prediction horizon. The only deeper parameter that will likely need to be adjusted for your particular settings is the Obstacle critics’ <code class="language-plaintext highlighter-rouge">repulsion_weight</code> since the tuning of this is proportional to your inflation layer’s radius. Higher radii should correspond to reduced <code class="language-plaintext highlighter-rouge">repulsion_weight</code> due to the penalty formation (e.g. <code class="language-plaintext highlighter-rouge">inflation_radius - min_dist_to_obstacle</code>). If this penalty is too high, the robot will slow significantly when entering cost-space from non-cost space or jitter in narrow corridors. It is noteworthy, but likely not necessary to be changed, that the Obstacle critic may use the full footprint information if <code class="language-plaintext highlighter-rouge">consider_footprint = true</code>, though comes at an increased compute cost.</p>

<p>If you don’t require path following behavior (e.g. just want to follow a goal pose and let the model predictive elements decide the best way to accomplish that), you may easily remove the PathAlign, PathFollow and PathAngle critics.</p>

<p>By default, the controller is tuned and has the capabilities established in the PathAlign/Obstacle critics to generally follow the path closely when no obstacles prevent it, but able to deviate from the path when blocked. See <code class="language-plaintext highlighter-rouge">PathAlignCritic::score()</code> for details, but it is disabled when the local path is blocked so the obstacle critic takes over in that state.</p>

<p>If you want to slow further on approach to goal, consider increasing the <code class="language-plaintext highlighter-rouge">threshold_to_consider</code> parameters to give a hand off from the path tracking critics to the goal approach critics sooner - then tune those critics for your profile of interest.</p>

<h3 id="prediction-horizon-costmap-sizing-and-offsets">Prediction Horizon, Costmap Sizing, and Offsets</h3>

<p>As this is a predictive planner, there is some relationship between maximum speed, prediction times, and costmap size that users should keep in mind while tuning for their application. If a controller server costmap is set to 3.0m in size, that means that with the robot in the center, there is 1.5m of information on either side of the robot. When your prediction horizon (time_steps * model_dt) at maximum speed (vx_max) is larger than this, then your robot will be artificially limited in its maximum speeds and behavior by the costmap limitation. For example, if you predict forward 3 seconds (60 steps @ 0.05s per step) at 0.5m/s maximum speed, the <strong>minimum</strong> required costmap radius is 1.5m - or 3m total width.</p>

<p>The same applies to the Path Follow and Align offsets from furthest. In the same example if the furthest point we can consider is already at the edge of the costmap, then further offsets are thresholded because they’re unusable. So its important while selecting these parameters to make sure that the theoretical offsets can exist on the costmap settings selected with the maximum prediction horizon and velocities desired. Setting the threshold for consideration in the path follower + goal critics as the same as your prediction horizon can make sure you have clean hand-offs between them, as the path follower will otherwise attempt to slow slightly once it reaches the final goal pose as its marker.</p>

<p>The Path Follow critic cannot drive velocities greater than the projectable distance of that velocity on the available path on the rolling costmap. The Path Align critic <code class="language-plaintext highlighter-rouge">offset_from_furthest</code> represents the number of path points a trajectory passes through while tracking the path. If this is set either absurdly low (e.g. 5) it can trigger when a robot is simply trying to start path tracking causing some suboptimal behaviors and local minima while starting a task. If it is set absurdly high (e.g. 50) relative to the path resolution and costmap size, then the critic may never trigger or only do so when at full-speed. A balance here is wise. A selection of this value to be ~30% of the maximum velocity distance projected is good (e.g. if a planner produces points every 2.5cm, 60 can fit on the 1.5m local costmap radius. If the max speed is 0.5m/s with a 3s prediction time, then 20 points represents 33% of the maximum speed projected over the prediction horizon onto the path). When in doubt, <code class="language-plaintext highlighter-rouge">prediction_horizon_s * max_speed / path_resolution / 3.0</code> is a good baseline.</p>

<h3 id="obstacle-inflation-layer-and-path-following">Obstacle, Inflation Layer, and Path Following</h3>

<p>There also exists a relationship between the costmap configurations and the Obstacle critic configurations. If the Obstacle critic is not well tuned with the costmap parameters (inflation radius, scale) it can cause the robot to wobble significantly as it attempts to take finitely lower-cost trajectories with a slightly lower cost in exchange for jerky motion. The default behavior was tuned for small AMRs (e.g. turtlebots or similar), so if using a larger robot, you may want to reduce the <code class="language-plaintext highlighter-rouge">repulsion_weight</code> in kind. It may also perform awkward maneuvers when in free-space to try to maximize time in a small pocket of 0-cost over a more natural motion which involves moving into some low-costed region. Finally, it may generally refuse to go into costed space at all when starting in a free 0-cost space if the gain is set disproportionately higher than the Path Follow scoring to encourage the robot to move along the path. This is due to the critic cost of staying in free space becoming more attractive than entering even lightly costed space in exchange for progression along the task.</p>

<p>Thus, care should be taken to select weights of the obstacle critic in conjunction with the costmap inflation radius and scale so that a robot does not have such issues. How I (Steve, your friendly neighborhood navigator) tuned this was to first create the appropriate obstacle critic behavior desirable in conjunction with the inflation layer parameters. Its worth noting that the Obstacle critic converts the cost into a distance from obstacles, so the nature of the distribution of costs in the inflation isn’t overly significant. However, the inflation radius and the scale will define the cost at the end of the distribution where free-space meets the lowest cost value within the radius. So testing for quality behavior when going over that threshold should be considered.</p>

<p>As you increase or decrease your weights on the Obstacle, you may notice the aforementioned behaviors (e.g. won’t overcome free to non-free threshold). To overcome them, increase the FollowPath critic cost to increase the desire for the trajectory planner to continue moving towards the goal. Make sure to not overshoot this though, keep them balanced. A desirable outcome is smooth motion roughly in the center of spaces without significant close interactions with obstacles. It shouldn’t be perfectly following a path yet nor should the output velocity be wobbling jaggedly.</p>

<p>Once you have your obstacle avoidance behavior tuned and matched with an appropriate path following penalty, tune the Path Align critic to align with the path. If you design exact-path-alignment behavior, its possible to skip the obstacle critic step as highly tuning the system to follow the path will give it less ability to deviate to avoid obstacles (though it’ll slow and stop). Tuning the critic weight for the Obstacle critic high will do the job to avoid near-collisions but the repulsion weight is largely unnecessary to you. For others wanting more dynamic behavior, it <em>can</em> be beneficial to slowly lower the weight on the obstacle critic to give the path alignment critic some more room to work. If your path was generated with a cost-aware planner (like all provided by Nav2) and providing paths sufficiently far from obstacles for your satisfaction, the impact of a slightly reduced Obstacle critic with a Path Alignment critic will do you well. Not over-weighting the path align critic will allow the robot to  deviate from the path to get around dynamic obstacles in the scene or other obstacles not previous considered during path planning. It is subjective as to the best behavior for your application, but it has been shown that MPPI can be an exact path tracker and/or avoid dynamic obstacles very fluidly and everywhere in between. The defaults provided are in the generally right regime for a balanced initial trade-off.</p>
</div>
              </div>
            </div>
          </div>
        </div>
      
    
    <div class="row">
      <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-heading"><span class="glyphicon glyphicon-list"></span> CHANGELOG</div>
          <div class="panel-body">
            
              <em>No CHANGELOG found.</em>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="jazzy-tutorials">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wiki Tutorials</h3>
      </div>
      <div class="panel-body">
        
        <em>This package does not provide any links to tutorials in it's <a href="https://index.ros.org/contribute/metadata/">rosindex metadata</a>.</em>
        <em>You can check on the <a href="http://wiki.ros.org/nav2_mppi_controller/Tutorials" target="_blank">ROS Wiki Tutorials</a> page for the package.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="jazzy-deps">
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Package Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th class="text-center">Deps</th>
                  <th style="width: 100%">Name</th>
                </thead>
                <tbody>
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake#jazzy">ament_cmake  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_ros#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_ros#jazzy">ament_cmake_ros  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_auto#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_auto#jazzy">ament_lint_auto  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_common#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_common#jazzy">ament_lint_common  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_gtest#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_gtest#jazzy">ament_cmake_gtest  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rclcpp#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rclcpp#jazzy">rclcpp  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/nav2_common#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/nav2_common#jazzy">nav2_common  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/nav2_core#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/nav2_core#jazzy">nav2_core  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/nav2_util#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/nav2_util#jazzy">nav2_util  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/nav2_costmap_2d#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/nav2_costmap_2d#jazzy">nav2_costmap_2d  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/geometry_msgs#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/geometry_msgs#jazzy">geometry_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/visualization_msgs#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/visualization_msgs#jazzy">visualization_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/nav2_msgs#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/nav2_msgs#jazzy">nav2_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/pluginlib#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/pluginlib#jazzy">pluginlib  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/tf2_geometry_msgs#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/tf2_geometry_msgs#jazzy">tf2_geometry_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/tf2#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/tf2#jazzy">tf2  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/tf2_eigen#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/tf2_eigen#jazzy">tf2_eigen  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/tf2_ros#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/tf2_ros#jazzy">tf2_ros  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/std_msgs#jazzy-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/std_msgs#jazzy">std_msgs  </a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
          <div class="panel-heading">
            <h3 class="panel-title">System Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                </thead>
                <tbody>
                  
                    
                      <tr>
                        <td><a href="/d/xtensor">xtensor</a></td>
                      </tr>
                    
                  
                    
                      <tr>
                        <td><a href="/d/libomp-dev">libomp-dev</a></td>
                      </tr>
                    
                  
                    
                      <tr>
                        <td><a href="/d/benchmark">benchmark</a></td>
                      </tr>
                    
                  
                    
                      <tr>
                        <td><a href="/d/xsimd">xsimd</a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Dependant Packages</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                  <th class="text-center">Deps</th>
                </thead>
                <tbody>
                  
                    
                    
                    <tr>
                      <td><a href="/p/navigation2#jazzy">navigation2</a></td>
                      <td class="text-center">
                        
                        <a href="/p/navigation2#jazzy-deps" >
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="jazzy-assets">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Launch files</h3>
      </div>
      <div class="panel-body">
        
          <em>No launch files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Messages</h3>
      </div>
      <div class="panel-body">
        
          <em>No message files found.</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Services</h3>
      </div>
      <div class="panel-body">
        
          <em>No service files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Plugins</h3>
      </div>
      <div class="panel-body">
        
          <ul>
            
              <li><a href="https://github.com/ros-planning/navigation2/tree/jazzy/nav2_mppi_controller//mppic.xml" target="_blank">nav2_core</a></li>
            
              <li><a href="https://github.com/ros-planning/navigation2/tree/jazzy/nav2_mppi_controller//critics.xml" target="_blank">nav2_mppi_controller</a></li>
            
          </ul>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="jazzy-questions">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent questions tagged <kbd>nav2_mppi_controller</kbd> at <strong><a href="https://robotics.stackexchange.com/" target="_blank">Robotics Stack Exchange</a></strong></h3>      </div>
      <div id="jazzy-question-list" class="panel-body" style="display: none;"></div>
      <div id="jazzy-no-question-list" class="panel-body" style="display: none;">
        <p>No questions yet, you can ask one <a href="https://robotics.stackexchange.com/questions/tagged/nav2_mppi_controller+jazzy">here</a>.</p>
      </div>
      <div id="jazzy-get-question-fail" class="panel-body alert alert-warning" style="display: none;">
        <p>Failed to get question list, you can ticket an issue <a href="https://github.com/ros-infrastructure/rosindex/issues/new" target="_blank" class="alert-link">here</a> </p>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/package_body_tabs.js"></script>

<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
jQuery(function() {
    // Update the count on the links to the contribution suggestions
    updateContributionSuggestionsCountOnPackage('https://github.com/ros-planning/navigation2.git');
});
</script>

          </div>
          <div class="col-md-2 hidden-xs hidden-sm">
            
            
            



<div class="list-group list-group-sm ">
  <a class="list-group-item"
     target="_blank"
     href="http://docs.ros.org/en/jazzy/p/nav2_mppi_controller"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       
       API Docs
  </a>
  <a class="list-group-item"
     target="_blank"
     href="https://github.com/ros-planning/navigation2/tree/jazzy/nav2_mppi_controller"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       
       Browse Code
  </a>
  
  
  
  
  
  
</div>

          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-kilted">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>kilted</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-rolling">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>rolling</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-github">
    <div class="container-fluid">
      
        
        
        

        <div class="row">
          <div class="col-md-10">
            

<div class="well well-sm">
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px" src="/assets/package.png">
      </td>
      <td>
        <h3 style="margin-top: 5px">
          <a style="text-decoration:none" href="/p/nav2_mppi_controller">nav2_mppi_controller</a> <small>package from <a style="text-decoration:none" href="/r/ttennis-pickup-robot/github-pomelo925-ttennis-pickup-robot">ttennis-pickup-robot</a> repo</small>
        </h3>
          
            
            
              <a class="label label-primary pkg-label" href="/p/conference">

conference
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/flask_esp">

flask_esp
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_simple_commander">

nav2_simple_commander
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_amcl">

nav2_amcl
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_behavior_tree">

nav2_behavior_tree
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_behaviors">

nav2_behaviors
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_bringup">

nav2_bringup
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_bt_navigator">

nav2_bt_navigator
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_collision_monitor">

nav2_collision_monitor
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_common">

nav2_common
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_constrained_smoother">

nav2_constrained_smoother
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_controller">

nav2_controller
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_core">

nav2_core
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_costmap_2d">

nav2_costmap_2d
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/costmap_queue">

costmap_queue
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/dwb_core">

dwb_core
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/dwb_critics">

dwb_critics
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/dwb_msgs">

dwb_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/dwb_plugins">

dwb_plugins
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_dwb_controller">

nav2_dwb_controller
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav_2d_msgs">

nav_2d_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav_2d_utils">

nav_2d_utils
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_graceful_controller">

nav2_graceful_controller
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_lifecycle_manager">

nav2_lifecycle_manager
</a>
            
          
            
            
              <span class="label label-default pkg-label">

nav2_mppi_controller
</span>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_msgs">

nav2_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_navfn_planner">

nav2_navfn_planner
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_planner">

nav2_planner
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_regulated_pure_pursuit_controller">

nav2_regulated_pure_pursuit_controller
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_rotation_shim_controller">

nav2_rotation_shim_controller
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_rviz_plugins">

nav2_rviz_plugins
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_smac_planner">

nav2_smac_planner
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_smoother">

nav2_smoother
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_system_tests">

nav2_system_tests
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_theta_star_planner">

nav2_theta_star_planner
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_util">

nav2_util
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_velocity_smoother">

nav2_velocity_smoother
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_voxel_grid">

nav2_voxel_grid
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_waypoint_follower">

nav2_waypoint_follower
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/navigation2">

navigation2
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/rosserial_msgs">

rosserial_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/rosserial_server">

rosserial_server
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/flask_esp8266">

flask_esp8266
</a>
            
          
      </td>
    </tr>
  </table>
</div>

            <div class="visible-xs visible-sm">
              
              
              



<div class="list-group list-group-sm list-group-horizontal list-group-justified">
  <a class="list-group-item text-center"
     target="_blank"
     href="http://docs.ros.org/en/github/p/nav2_mppi_controller"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       <br>
       API Docs
  </a>
  <a class="list-group-item text-center"
     target="_blank"
     href="https://github.com/pomelo925/ttennis-pickup-robot/tree/main/3.Software/B.Navigation/nav2-ws/src/navigation2/nav2_mppi_controller"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       <br>
       Browse Code
  </a>
  
  
  
  
  
  
</div>

            </div>
            



<ul class="nav nav-tabs nav-justified" id="github-tabs" style="margin-bottom:20px">
  <li class="better-tabs active">
    <a href="#github-overview" data-toggle="tab">Overview</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    
    <a href="#github-assets" data-toggle="tab"><span class="label label-primary">2</span> Assets</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    <a href="#github-deps" data-toggle="tab"><span class="label label-primary">23</span> Dependencies</a>
  </li>
  <li class="better-tabs">
    
    <a href="#github-tutorials" data-toggle="tab"><span class="label label-default">0</span> Tutorials</a>
  </li>
  <li class="better-tabs">
    <a href="#github-questions" data-toggle="tab"><span id="github-questions-count" class="label label-primary">0</span> Q & A</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="github-overview">
    
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h4 class="panel-title">Package Summary</h4></div>
          <div class="panel-body">
            <table class="table table-condensed">
              <tr>
                <td style="width:100px;" class="text-right"><strong>Tags</strong></td>
                <td>
                  
                  
                    <em>No category tags.</em>
                  
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Version</strong></td>
                <td>1.1.16</td>
              </tr>
              <tr>
                <td class="text-right"><strong>License</strong></td>
                <td>MIT</td>
              </tr>
              <tr>
                <td class="text-right"><strong>Build type</strong></td>
                <td>
                  
                    <span class="label label-default">
                  
                    AMENT_CMAKE</span>
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Use</strong></td>
                <td>
                
                  <span class="label label-success">RECOMMENDED</span>
                
                </td>
              </tr>
            </table>
          </div>
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body">
            
            
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">清華大學動力機械系25級畢業專題項目</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/pomelo925/ttennis-pickup-robot.git">https://github.com/pomelo925/ttennis-pickup-robot.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">main</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2024-12-05
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          <span class="label label-warning">UNKNOWN
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="No CI information available for this package.">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-default">UNRELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/ttennis-pickup-robot/#github-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ttennis-pickup-robot/#github-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ttennis-pickup-robot/#github-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Package Description</h3></div>
          <div class="panel-body">
            nav2_mppi_controller
          </div>
          <div class="panel-heading"><h4 class="panel-title">Additional Links</h4></div>
          <div class="panel-body">
            
            
              <em>No additional links.</em>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Maintainers</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Steve Macenski</li>
                
                  <li>Aleksei Budyakov</li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Authors</h4></div>
          <div class="panel-body">
            
            
              <em>No additional authors.</em>
            
          </div>
        </div>
      </div>
    </div>
    
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-heading"><span class="glyphicon glyphicon-file"></span><a href="https://github.com/pomelo925/ttennis-pickup-robot/tree/main/3.Software/B.Navigation/nav2-ws/src/navigation2/nav2_mppi_controller/README.md" title="Open in git repository">3.Software/B.Navigation/nav2-ws/src/navigation2/nav2_mppi_controller/README.md</a></div>
              <div class="panel-body">
                    <div class="rendered-markdown">
<h1 id="model-predictive-path-integral-controller">Model Predictive Path Integral Controller</h1>

<p><img src="https://raw.githubusercontent.com/pomelo925/ttennis-pickup-robot/main/3.Software/B.Navigation/nav2-ws/src/navigation2/nav2_mppi_controller/media/demo.gif" alt=""></p>

<h2 id="overview">Overview</h2>

<p>This is a predictive controller (local trajectory planner) that implements the <a href="https://ieeexplore.ieee.org/document/7487277">Model Predictive Path Integral (MPPI)</a> algorithm to track a path with adaptive collision avoidance. It contains plugin-based critic functions to impact the behavior of the algorithm. It was created by <a href="https://www.linkedin.com/in/aleksei-budyakov-334889224/">Aleksei Budyakov</a> and adapted &amp; developed for Nav2 by <a href="https://www.linkedin.com/in/steve-macenski-41a985101/">Steve Macenski</a>.</p>

<p>This plugin implements the <code class="language-plaintext highlighter-rouge">nav2_core::Controller</code> interface allowing it to be used across the navigation stack as a local trajectory planner in the controller server’s action server (<code class="language-plaintext highlighter-rouge">controller_server</code>).</p>

<p>This controller is measured to run at 50+ Hz on a modest Intel processor (4th gen i5). See its Configuration Guide Page for additional parameter descriptions.</p>

<p>It works currently with Differential, Omnidirectional, and Ackermann robots.</p>

<h2 id="mppi-description">MPPI Description</h2>

<p>The MPPI algorithm is an MPC variant that finds a control velocity for the robot using an iterative approach. Using the previous time step’s best control solution and the robot’s current state, a set of randomly sampled perturbations from a Gaussian distribution are applied. These noised controls are forward simulated to generate a set of trajectories within the robot’s motion model.</p>

<p>Next, these trajectories are scored using a set of plugin-based critic functions to find the best trajectory in the batch. The output scores are used to set the best control with a soft max function.</p>

<p>This process is then repeated a number of times and returns a converged solution. This solution is then used as the basis of the next time step’s initial control.</p>

<h2 id="features">Features</h2>

<ul>
  <li>Predictive MPC trajectory planner</li>
  <li>Utilizes plugin-based critics which can be swapped out, tuned, or replaced easily by the user</li>
  <li>Highly optimized CPU-only performance using vectorization and tensor operations</li>
  <li>Supports a number of common motion models, including Ackermann, Differential-Drive, and Omni-directional</li>
  <li>Includes fallback mechanisms to handle soft-failures before escalating to recovery behaviors</li>
  <li>High-quality code implementation with Doxygen, high unit test coverage, documentation, and parameter guide</li>
  <li>Easily extensible to support modern research variants of MPPI</li>
  <li>Comes pre-tuned for good out-of-the-box behavior</li>
</ul>

<h2 id="configuration">Configuration</h2>

<h3 id="controller">Controller</h3>
<p>| Parameter                  | Type   | Definition                                                                                                                                                                                                                                                                                                           |
 | ———————      | —— | ——————————————————————————————————– |
 | motion_model               | string | Default: DiffDrive. Type of model [DiffDrive, Omni, Ackermann].                                          |
 | critics                    | string | Default: None. Critics (plugins) names                                                                   |
 | iteration_count            | int    | Default 1. Iteration count in MPPI algorithm. Recommend to keep as 1 and prefer more batches.            |
 | batch_size                 | int    | Default 1000. Count of randomly sampled candidate trajectories                                            |
 | time_steps                 | int    | Default 56. Number of time steps (points) in each sampled trajectory                                     |
 | model_dt                   | double | Default: 0.05. Time interval (s) between two sampled points in trajectories.                              |
 | vx_std                     | double | Default 0.2. Sampling standard deviation for VX                                                          |
 | vy_std                     | double | Default 0.2. Sampling standard deviation for VY                                                          |
 | wz_std                     | double | Default 0.4. Sampling standard deviation for Wz                                                          |
 | vx_max                     | double | Default 0.5. Max VX (m/s)                                                                                |
 | vy_max                     | double | Default 0.5. Max VY in either direction, if holonomic. (m/s)                                             |
 | vx_min                     | double | Default -0.35. Min VX (m/s)                                                                              |
 | wz_max                     | double | Default 1.9. Max WZ (rad/s)                                                                              |
 | temperature                | double | Default: 0.3. Selectiveness of trajectories by their costs (The closer this value to 0, the “more” we take in consideration controls with less cost), 0 mean use control with best cost, huge value will lead to just taking mean of all trajectories without cost consideration                                                   |
 | gamma                      | double | Default: 0.015. A trade-off between smoothness (high) and low energy (low). This is a complex parameter that likely won’t need to be changed from the default of <code class="language-plaintext highlighter-rouge">0.1</code> which works well for a broad range of cases. See Section 3D-2 in “Information Theoretic Model Predictive Control: Theory and Applications to Autonomous Driving” for detailed information.       |
 | visualize                  | bool   | Default: false. Publish visualization of trajectories, which can slow down the controller significantly. Use only for debugging.                                                                                                                                       |
 | retry_attempt_limit        | int    | Default 1. Number of attempts to find feasible trajectory on failure for soft-resets before reporting failure.                                                                                                                                                                                                       |
| reset_period            | double    | Default 1.0. required time of inactivity to reset optimizer  (only in Humble due to backport ABI policies)            |
 | regenerate_noises          | bool   | Default false. Whether to regenerate noises each iteration or use single noise distribution computed on initialization and reset. Practically, this is found to work fine since the trajectories are being sampled stochastically from a normal distribution and reduces compute jittering at run-time due to thread wake-ups to resample normal distribution. |</p>

<h4 id="trajectory-visualizer">Trajectory Visualizer</h4>
<p>| Parameter             | Type   | Definition                                                                                                  |
 | —————       | —— | ———————————————————————————————————– |
 | trajectory_step       | int    | Default: 5. The step between trajectories to visualize to downsample candidate trajectory pool.             |
 | time_step             | int    | Default: 3. The step between points on trajectories to visualize to downsample trajectory density.          |</p>

<h4 id="path-handler">Path Handler</h4>
<p>| Parameter                  | Type   | Definition                                                                                                  |
 | —————            | —— | ———————————————————————————————————– |
 | max_robot_pose_search_dist | double | Default: Costmap half-size. Max integrated distance ahead of robot pose to search for nearest path point in case of path looping.   |
 | prune_distance             | double | Default: 1.5. Distance ahead of nearest point on path to robot to prune path to.                            |
 | transform_tolerance        | double | Default: 0.1. Time tolerance for data transformations with TF.                                              |
 | enforce_path_inversion        | double | Default: False. If true, it will prune paths containing cusping points for segments changing directions (e.g. path inversions) such that the controller will be forced to change directions at or very near the planner’s requested inversion point. This is targeting Smac Planner users with feasible paths who need their robots to switch directions where specifically requested.      |
 | inversion_xy_tolerance        | double | Default: 0.2. Cartesian proximity (m) to path inversion point to be considered “achieved” to pass on the rest of the path after path inversion.      |
 | inversion_yaw_tolerance        | double | Default: 0.4. Angular proximity (radians) to path inversion point to be considered “achieved” to pass on the rest of the path after path inversion. 0.4 rad = 23 deg.  |</p>

<h4 id="ackermann-motion-model">Ackermann Motion Model</h4>
<p>| Parameter            | Type   | Definition                                                                                                  |
 | ——————– | —— | ———————————————————————————————————– |
 | min_turning_r        | double | minimum turning radius for ackermann motion model                                                           |</p>

<h4 id="constraint-critic">Constraint Critic</h4>
<p>| Parameter             | Type   | Definition                                                                                                  |
 | —————       | —— | ———————————————————————————————————– |
 | cost_weight           | double | Default 4.0. Weight to apply to critic term.                                                                |
 | cost_power            | int    | Default 1. Power order to apply to term.</p>

<h4 id="goal-angle-critic">Goal Angle Critic</h4>
<p>| Parameter                        | Type   | Definition                                                                                                  |
 | —————                  | —— | ———————————————————————————————————– |
 | cost_weight                      | double | Default 3.0. Weight to apply to critic term.                                                                |
 | cost_power                       | int    | Default 1. Power order to apply to term.                                                                    |
 | threshold_to_consider            | double | Default 0.5. Minimal distance between robot and goal above which angle goal cost considered.               |</p>

<h4 id="goal-critic">Goal Critic</h4>
<p>| Parameter            | Type   | Definition                                                                                                  |
 | ——————– | —— | ———————————————————————————————————– |
 | cost_weight          | double | Default 5.0. Weight to apply to critic term.                                                                |
 | cost_power           | int    | Default 1. Power order to apply to term.                                                                    |
 | threshold_to_consider      | double | Default 1.4. Distance between robot and goal above which goal cost starts being considered                                    |</p>

<h4 id="obstacles-critic">Obstacles Critic</h4>

<p>Uses estimated distances from obstacles using cost and inflation parameters to avoid obstacles</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Type</th>
      <th>Definition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>consider_footprint</td>
      <td>bool</td>
      <td>Default: False. Whether to use point cost (if robot is circular or low compute power) or compute SE2 footprint cost.</td>
    </tr>
    <tr>
      <td>critical_weight</td>
      <td>double</td>
      <td>Default 20.0. Weight to apply to critic for near collisions closer than <code class="language-plaintext highlighter-rouge">collision_margin_distance</code> to prevent near collisions <strong>only</strong> as a method of virtually inflating the footprint. This should not be used to generally influence obstacle avoidance away from critical collisions.</td>
    </tr>
    <tr>
      <td>repulsion_weight</td>
      <td>double</td>
      <td>Default 1.5. Weight to apply to critic for generally preferring routes in lower cost space. This is separated from the critical term to allow for fine tuning of obstacle behaviors with path alignment for dynamic scenes without impacting actions which may directly lead to near-collisions. This is applied within the <code class="language-plaintext highlighter-rouge">inflation_radius</code> distance from obstacles.</td>
    </tr>
    <tr>
      <td>cost_power</td>
      <td>int</td>
      <td>Default 1. Power order to apply to term.</td>
    </tr>
    <tr>
      <td>collision_cost</td>
      <td>double</td>
      <td>Default 10000.0. Cost to apply to a true collision in a trajectory.</td>
    </tr>
    <tr>
      <td>collision_margin_distance</td>
      <td>double</td>
      <td>Default 0.10. Margin distance from collision to apply severe penalty, similar to footprint inflation. Between 0.05-0.2 is reasonable.</td>
    </tr>
    <tr>
      <td>near_goal_distance</td>
      <td>double</td>
      <td>Default 0.5. Distance near goal to stop applying preferential obstacle term to allow robot to smoothly converge to goal pose in close proximity to obstacles.</td>
    </tr>
    <tr>
      <td>cost_scaling_factor</td>
      <td>double</td>
      <td>Default 10.0. Exponential decay factor across inflation radius. This should be the same as for your inflation layer (Humble only)</td>
    </tr>
    <tr>
      <td>inflation_radius</td>
      <td>double</td>
      <td>Default 0.55. Radius to inflate costmap around lethal obstacles. This should be the same as for your inflation layer (Humble only)</td>
    </tr>
  </tbody>
</table>

<h4 id="cost-critic">Cost Critic</h4>

<p>Uses inflated costmap cost directly to avoid obstacles</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Type</th>
      <th>Definition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>consider_footprint</td>
      <td>bool</td>
      <td>Default: False. Whether to use point cost (if robot is circular or low compute power) or compute SE2 footprint cost.</td>
    </tr>
    <tr>
      <td>cost_weight</td>
      <td>double</td>
      <td>Default 3.81. Wight to apply to critic to avoid obstacles.</td>
    </tr>
    <tr>
      <td>cost_power</td>
      <td>int</td>
      <td>Default 1. Power order to apply to term.</td>
    </tr>
    <tr>
      <td>collision_cost</td>
      <td>double</td>
      <td>Default 1000000.0. Cost to apply to a true collision in a trajectory.</td>
    </tr>
    <tr>
      <td>critical_cost</td>
      <td>double</td>
      <td>Default 300.0. Cost to apply to a pose with any point in in inflated space to prefer distance from obstacles.</td>
    </tr>
    <tr>
      <td>near_goal_distance</td>
      <td>double</td>
      <td>Default 0.5. Distance near goal to stop applying preferential obstacle term to allow robot to smoothly converge to goal pose in close proximity to obstacles.</td>
    </tr>
    <tr>
      <td>inflation_layer_name</td>
      <td>string</td>
      <td>Default “”. Name of the inflation layer. If empty, it uses the last inflation layer in the costmap. If you have multiple inflation layers, you may want to specify the name of the layer to use.</td>
    </tr>
  </tbody>
</table>

<h4 id="path-align-critic">Path Align Critic</h4>
<p>| Parameter                  | Type   | Definition                                                                                                                         |
 | —————            | —— | ———————————————————————————————————–                        |
 | cost_weight                | double | Default 10.0. Weight to apply to critic term.                                                                                       |
 | cost_power                 | int    | Default 1. Power order to apply to term.                                                                                           |
 | threshold_to_consider      | double | Default 0.5. Distance between robot and goal above which path align cost stops being considered                                    |
 | offset_from_furthest      | double | Default 20. Checks that the candidate trajectories are sufficiently far along their way tracking the path to apply the alignment critic. This ensures that path alignment is only considered when actually tracking the path, preventing awkward initialization motions preventing the robot from leaving the path to achieve the appropriate heading.  |
 | trajectory_point_step      | double | Default 4. Step of trajectory points to evaluate for path distance to reduce compute time. Between 1-10 is typically reasonable.   |
 | max_path_occupancy_ratio   | double | Default 0.07 (7%). Maximum proportion of the path that can be occupied before this critic is not considered to allow the obstacle and path follow critics to avoid obstacles while following the path’s intent in presence of dynamic objects in the scene.  |
 | use_path_orientations   | bool | Default false. Whether to consider path’s orientations in path alignment, which can be useful when paired with feasible smac planners to incentivize directional changes only where/when the smac planner requests them. If you want the robot to deviate and invert directions where the controller sees fit, keep as false. If your plans do not contain orientation information (e.g. navfn), keep as false.  |</p>

<p>Note: There is a “Legacy” version of this critic also available with the same parameters of an old formulation pre-October 2023.</p>

<h4 id="path-angle-critic">Path Angle Critic</h4>
<p>| Parameter                 | Type   | Definition                                                                                                  |
 | —————           | —— | ———————————————————————————————————– |
 | cost_weight               | double | Default 2.0. Weight to apply to critic term.                                                                |
 | cost_power                | int    | Default 1. Power order to apply to term.                                                                    |
 | threshold_to_consider     | double | Default 0.5. Distance between robot and goal above which path angle cost stops being considered             |
 | offset_from_furthest      | int    | Default 4. Number of path points after furthest one any trajectory achieves to compute path angle relative to.  |
 | max_angle_to_furthest     | double | Default 1.2. Angular distance between robot and goal above which path angle cost starts being considered           |
 | forward_preference     | bool | Default true. Whether or not your robot has a preference for which way is forward in motion. Different from if reversing is generally allowed, but if you robot contains <em>no</em> particular preference one way or another.           |</p>

<h4 id="path-follow-critic">Path Follow Critic</h4>
<p>| Parameter             | Type   | Definition                                                                                                  |
 | —————       | —— | ———————————————————————————————————– |
 | cost_weight           | double | Default 5.0. Weight to apply to critic term.                                                                |
 | cost_power            | int    | Default 1. Power order to apply to term.   |
 | offset_from_furthest  | int    | Default 6. Number of path points after furthest one any trajectory achieves to drive path tracking relative to.     |
 | threshold_to_consider        | float  | Default 1.4. Distance between robot and goal above which path follow cost stops being considered  |</p>

<h4 id="prefer-forward-critic">Prefer Forward Critic</h4>
<p>| Parameter             | Type   | Definition                                                                                                  |
 | —————       | —— | ———————————————————————————————————– |
 | cost_weight           | double | Default 5.0. Weight to apply to critic term.                                                                |
 | cost_power            | int    | Default 1. Power order to apply to term.                                                                    |
 | threshold_to_consider | double | Default 0.5. Distance between robot and goal above which prefer forward cost stops being considered         |</p>

<h4 id="twirling-critic">Twirling Critic</h4>
<p>| Parameter             | Type   | Definition                                                                                                  |
 | —————       | —— | ———————————————————————————————————– |
 | cost_weight           | double | Default 10.0. Weight to apply to critic term.                                                               |
 | cost_power            | int    | Default 1. Power order to apply to term.                                                                    |</p>

<h4 id="velocity-deadband-critic">Velocity Deadband Critic</h4>
<p>| Parameter             | Type     | Definition                                                                                                  |
 | —————       | ——   | ———————————————————————————————————– |
 | cost_weight           | double   | Default 35.0. Weight to apply to critic term.                                                               |
 | cost_power            | int      | Default 1. Power order to apply to term.                                                                    |
 | deadband_velocities   | double[] | Default [0.0, 0.0, 0.0].  The array of deadband velocities [vx, vz, wz]. A zero array indicates that the critic will take no action.      |</p>

<h3 id="xml-configuration-example">XML configuration example</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>controller_server:
  ros__parameters:
    controller_frequency: 30.0
    FollowPath:
      plugin: "nav2_mppi_controller::MPPIController"
      time_steps: 56
      model_dt: 0.05
      batch_size: 2000
      vx_std: 0.2
      vy_std: 0.2
      wz_std: 0.4
      vx_max: 0.5
      vx_min: -0.35
      vy_max: 0.5
      wz_max: 1.9
      iteration_count: 1
      prune_distance: 1.7
      transform_tolerance: 0.1
      temperature: 0.3
      gamma: 0.015
      motion_model: "DiffDrive"
      visualize: false
      TrajectoryVisualizer:
        trajectory_step: 5
        time_step: 3
      AckermannConstraints:
        min_turning_r: 0.2
      critics: ["ConstraintCritic", "CostCritic", "GoalCritic", "GoalAngleCritic", "PathAlignCritic", "PathFollowCritic", "PathAngleCritic", "PreferForwardCritic"]
      ConstraintCritic:
        enabled: true
        cost_power: 1
        cost_weight: 4.0
      GoalCritic:
        enabled: true
        cost_power: 1
        cost_weight: 5.0
        threshold_to_consider: 1.4
      GoalAngleCritic:
        enabled: true
        cost_power: 1
        cost_weight: 3.0
        threshold_to_consider: 0.5
      PreferForwardCritic:
        enabled: true
        cost_power: 1
        cost_weight: 5.0
        threshold_to_consider: 0.5
      # ObstaclesCritic:
      #   enabled: true
      #   cost_power: 1
      #   repulsion_weight: 1.5
      #   critical_weight: 20.0
      #   consider_footprint: false
      #   collision_cost: 10000.0
      #   collision_margin_distance: 0.1
      #   near_goal_distance: 0.5
      CostCritic:
        enabled: true
        cost_power: 1
        cost_weight: 3.81
        critical_cost: 300.0
        consider_footprint: true
        collision_cost: 1000000.0
        near_goal_distance: 1.0
      PathAlignCritic:
      PathAlignCritic:
        enabled: true
        cost_power: 1
        cost_weight: 14.0
        max_path_occupancy_ratio: 0.05
        trajectory_point_step: 3
        threshold_to_consider: 0.5
        offset_from_furthest: 20
        use_path_orientations: false
      PathFollowCritic:
        enabled: true
        cost_power: 1
        cost_weight: 5.0
        offset_from_furthest: 5
        threshold_to_consider: 1.4
      PathAngleCritic:
        enabled: true
        cost_power: 1
        cost_weight: 2.0
        offset_from_furthest: 4
        threshold_to_consider: 0.5
        max_angle_to_furthest: 1.0
        forward_preference: true
      # VelocityDeadbandCritic:
      #   enabled: true
      #   cost_power: 1
      #   cost_weight: 35.0
      #   deadband_velocities: [0.05, 0.05, 0.05]
      # TwirlingCritic:
      #   enabled: true
      #   twirling_cost_power: 1
      #   twirling_cost_weight: 10.0

</code></pre></div></div>
<h2 id="topics">Topics</h2>

<table>
  <thead>
    <tr>
      <th>Topic</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">trajectories</code></td>
      <td><code class="language-plaintext highlighter-rouge">visualization_msgs/MarkerArray</code></td>
      <td>Randomly generated trajectories, including resulting control sequence</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">transformed_global_plan</code></td>
      <td><code class="language-plaintext highlighter-rouge">nav_msgs/Path</code></td>
      <td>Part of global plan considered by local planner</td>
    </tr>
  </tbody>
</table>

<h2 id="notes-to-users">Notes to Users</h2>

<h3 id="general-words-of-wisdom">General Words of Wisdom</h3>

<p>The <code class="language-plaintext highlighter-rouge">model_dt</code> parameter generally should be set to the duration of your control frequency. So if your control frequency is 20hz, this should be <code class="language-plaintext highlighter-rouge">0.05</code>. However, you may also set it lower <strong>but not larger</strong>.</p>

<p>Visualization of the trajectories using <code class="language-plaintext highlighter-rouge">visualize</code> uses compute resources to back out trajectories for visualization and therefore slows compute time. It is not suggested that this parameter is set to <code class="language-plaintext highlighter-rouge">true</code> during a deployed use, but is a useful debug instrument while tuning the system, but use sparingly. Visualizing 2000 batches @ 56 points at 30 hz is <em>a lot</em>.</p>

<p>The most common parameters you might want to start off changing are the velocity profiles (<code class="language-plaintext highlighter-rouge">vx_max</code>, <code class="language-plaintext highlighter-rouge">vx_min</code>, <code class="language-plaintext highlighter-rouge">wz_max</code>, and <code class="language-plaintext highlighter-rouge">vy_max</code> if holonomic) and the <code class="language-plaintext highlighter-rouge">motion_model</code> to correspond to your vehicle. Its wise to consider the <code class="language-plaintext highlighter-rouge">prune_distance</code> of the path plan in proportion to your maximum velocity and prediction horizon. The only deeper parameter that will likely need to be adjusted for your particular settings is the Obstacle critics’ <code class="language-plaintext highlighter-rouge">repulsion_weight</code> since the tuning of this is proportional to your inflation layer’s radius. Higher radii should correspond to reduced <code class="language-plaintext highlighter-rouge">repulsion_weight</code> due to the penalty formation (e.g. <code class="language-plaintext highlighter-rouge">inflation_radius - min_dist_to_obstacle</code>). If this penalty is too high, the robot will slow significantly when entering cost-space from non-cost space or jitter in narrow corridors. It is noteworthy, but likely not necessary to be changed, that the Obstacle critic may use the full footprint information if <code class="language-plaintext highlighter-rouge">consider_footprint = true</code>, though comes at an increased compute cost.</p>

<p>If you don’t require path following behavior (e.g. just want to follow a goal pose and let the model predictive elements decide the best way to accomplish that), you may easily remove the PathAlign, PathFollow and PathAngle critics.</p>

<p>By default, the controller is tuned and has the capabilities established in the PathAlign/Obstacle critics to generally follow the path closely when no obstacles prevent it, but able to deviate from the path when blocked. See <code class="language-plaintext highlighter-rouge">PathAlignCritic::score()</code> for details, but it is disabled when the local path is blocked so the obstacle critic takes over in that state.</p>

<h3 id="prediction-horizon-costmap-sizing-and-offsets">Prediction Horizon, Costmap Sizing, and Offsets</h3>

<p>As this is a predictive planner, there is some relationship between maximum speed, prediction times, and costmap size that users should keep in mind while tuning for their application. If a controller server costmap is set to 3.0m in size, that means that with the robot in the center, there is 1.5m of information on either side of the robot. When your prediction horizon (time_steps * model_dt) at maximum speed (vx_max) is larger than this, then your robot will be artificially limited in its maximum speeds and behavior by the costmap limitation. For example, if you predict forward 3 seconds (60 steps @ 0.05s per step) at 0.5m/s maximum speed, the <strong>minimum</strong> required costmap radius is 1.5m - or 3m total width.</p>

<p>The same applies to the Path Follow and Align offsets from furthest. In the same example if the furthest point we can consider is already at the edge of the costmap, then further offsets are thresholded because they’re unusable. So its important while selecting these parameters to make sure that the theoretical offsets can exist on the costmap settings selected with the maximum prediction horizon and velocities desired. Setting the threshold for consideration in the path follower + goal critics as the same as your prediction horizon can make sure you have clean hand-offs between them, as the path follower will otherwise attempt to slow slightly once it reaches the final goal pose as its marker.</p>

<p>The Path Follow critic cannot drive velocities greater than the projectable distance of that velocity on the available path on the rolling costmap. The Path Align critic <code class="language-plaintext highlighter-rouge">offset_from_furthest</code> represents the number of path points a trajectory passes through while tracking the path. If this is set either absurdly low (e.g. 5) it can trigger when a robot is simply trying to start path tracking causing some suboptimal behaviors and local minima while starting a task. If it is set absurdly high (e.g. 50) relative to the path resolution and costmap size, then the critic may never trigger or only do so when at full-speed. A balance here is wise. A selection of this value to be ~30% of the maximum velocity distance projected is good (e.g. if a planner produces points every 2.5cm, 60 can fit on the 1.5m local costmap radius. If the max speed is 0.5m/s with a 3s prediction time, then 20 points represents 33% of the maximum speed projected over the prediction horizon onto the path). When in doubt, <code class="language-plaintext highlighter-rouge">prediction_horizon_s * max_speed / path_resolution / 3.0</code> is a good baseline.</p>

<h3 id="obstacle-inflation-layer-and-path-following">Obstacle, Inflation Layer, and Path Following</h3>

<p>There also exists a relationship between the costmap configurations and the Obstacle critic configurations. If the Obstacle critic is not well tuned with the costmap parameters (inflation radius, scale) it can cause the robot to wobble significantly as it attempts to take finitely lower-cost trajectories with a slightly lower cost in exchange for jerky motion. The default behavior was tuned for small AMRs (e.g. turtlebots or similar), so if using a larger robot, you may want to reduce the <code class="language-plaintext highlighter-rouge">repulsion_weight</code> in kind. It may also perform awkward maneuvers when in free-space to try to maximize time in a small pocket of 0-cost over a more natural motion which involves moving into some low-costed region. Finally, it may generally refuse to go into costed space at all when starting in a free 0-cost space if the gain is set disproportionately higher than the Path Follow scoring to encourage the robot to move along the path. This is due to the critic cost of staying in free space becoming more attractive than entering even lightly costed space in exchange for progression along the task.</p>

<p>Thus, care should be taken to select weights of the obstacle critic in conjunction with the costmap inflation radius and scale so that a robot does not have such issues. How I (Steve, your friendly neighborhood navigator) tuned this was to first create the appropriate obstacle critic behavior desirable in conjunction with the inflation layer parameters. Its worth noting that the Obstacle critic converts the cost into a distance from obstacles, so the nature of the distribution of costs in the inflation isn’t overly significant. However, the inflation radius and the scale will define the cost at the end of the distribution where free-space meets the lowest cost value within the radius. So testing for quality behavior when going over that threshold should be considered.</p>

<p>As you increase or decrease your weights on the Obstacle, you may notice the aforementioned behaviors (e.g. won’t overcome free to non-free threshold). To overcome them, increase the FollowPath critic cost to increase the desire for the trajectory planner to continue moving towards the goal. Make sure to not overshoot this though, keep them balanced. A desirable outcome is smooth motion roughly in the center of spaces without significant close interactions with obstacles. It shouldn’t be perfectly following a path yet nor should the output velocity be wobbling jaggedly.</p>

<p>Once you have your obstacle avoidance behavior tuned and matched with an appropriate path following penalty, tune the Path Align critic to align with the path. If you design exact-path-alignment behavior, its possible to skip the obstacle critic step as highly tuning the system to follow the path will give it less ability to deviate to avoid obstacles (though it’ll slow and stop). Tuning the critic weight for the Obstacle critic high will do the job to avoid near-collisions but the repulsion weight is largely unnecessary to you. For others wanting more dynamic behavior, it <em>can</em> be beneficial to slowly lower the weight on the obstacle critic to give the path alignment critic some more room to work. If your path was generated with a cost-aware planner (like all provided by Nav2) and providing paths sufficiently far from obstacles for your satisfaction, the impact of a slightly reduced Obstacle critic with a Path Alignment critic will do you well. Not over-weighting the path align critic will allow the robot to  deviate from the path to get around dynamic obstacles in the scene or other obstacles not previous considered during path planning. It is subjective as to the best behavior for your application, but it has been shown that MPPI can be an exact path tracker and/or avoid dynamic obstacles very fluidly and everywhere in between. The defaults provided are in the generally right regime for a balanced initial trade-off.</p>
</div>
              </div>
            </div>
          </div>
        </div>
      
    
    <div class="row">
      <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-heading"><span class="glyphicon glyphicon-list"></span> CHANGELOG</div>
          <div class="panel-body">
            
              <em>No CHANGELOG found.</em>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="github-tutorials">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wiki Tutorials</h3>
      </div>
      <div class="panel-body">
        
        <em>This package does not provide any links to tutorials in it's <a href="https://index.ros.org/contribute/metadata/">rosindex metadata</a>.</em>
        <em>You can check on the <a href="http://wiki.ros.org/nav2_mppi_controller/Tutorials" target="_blank">ROS Wiki Tutorials</a> page for the package.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="github-deps">
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Package Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th class="text-center">Deps</th>
                  <th style="width: 100%">Name</th>
                </thead>
                <tbody>
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake#github-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake#github">ament_cmake  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_ros#github-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_ros#github">ament_cmake_ros  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_auto#github-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_auto#github">ament_lint_auto  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_common#github-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_common#github">ament_lint_common  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_gtest#github-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_gtest#github">ament_cmake_gtest  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rclcpp#github-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rclcpp#github">rclcpp  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/nav2_common#github-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/nav2_common#github">nav2_common  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/nav2_core#github-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/nav2_core#github">nav2_core  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/nav2_util#github-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/nav2_util#github">nav2_util  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/nav2_costmap_2d#github-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/nav2_costmap_2d#github">nav2_costmap_2d  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/geometry_msgs#github-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/geometry_msgs#github">geometry_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/visualization_msgs#github-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/visualization_msgs#github">visualization_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/nav2_msgs#github-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/nav2_msgs#github">nav2_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/pluginlib#github-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/pluginlib#github">pluginlib  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/tf2_geometry_msgs#github-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/tf2_geometry_msgs#github">tf2_geometry_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/tf2#github-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/tf2#github">tf2  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/tf2_eigen#github-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/tf2_eigen#github">tf2_eigen  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/tf2_ros#github-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/tf2_ros#github">tf2_ros  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/std_msgs#github-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/std_msgs#github">std_msgs  </a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
          <div class="panel-heading">
            <h3 class="panel-title">System Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                </thead>
                <tbody>
                  
                    
                      <tr>
                        <td><a href="/d/xtensor">xtensor</a></td>
                      </tr>
                    
                  
                    
                      <tr>
                        <td><a href="/d/libomp-dev">libomp-dev</a></td>
                      </tr>
                    
                  
                    
                      <tr>
                        <td><a href="/d/benchmark">benchmark</a></td>
                      </tr>
                    
                  
                    
                      <tr>
                        <td><a href="/d/xsimd">xsimd</a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Dependant Packages</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                  <th class="text-center">Deps</th>
                </thead>
                <tbody>
                  
                    
                    
                    <tr>
                      <td><a href="/p/navigation2#github">navigation2</a></td>
                      <td class="text-center">
                        
                        <a href="/p/navigation2#github-deps" >
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                    <tr>
                      <td><a href="/p/navigation2#github">navigation2</a></td>
                      <td class="text-center">
                        
                        <a href="/p/navigation2#github-deps" >
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="github-assets">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Launch files</h3>
      </div>
      <div class="panel-body">
        
          <em>No launch files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Messages</h3>
      </div>
      <div class="panel-body">
        
          <em>No message files found.</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Services</h3>
      </div>
      <div class="panel-body">
        
          <em>No service files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Plugins</h3>
      </div>
      <div class="panel-body">
        
          <ul>
            
              <li><a href="https://github.com/pomelo925/ttennis-pickup-robot/tree/main/3.Software/B.Navigation/nav2-ws/src/navigation2/nav2_mppi_controller//mppic.xml" target="_blank">nav2_core</a></li>
            
              <li><a href="https://github.com/pomelo925/ttennis-pickup-robot/tree/main/3.Software/B.Navigation/nav2-ws/src/navigation2/nav2_mppi_controller//critics.xml" target="_blank">nav2_mppi_controller</a></li>
            
          </ul>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="github-questions">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent questions tagged <kbd>nav2_mppi_controller</kbd> at <strong><a href="https://robotics.stackexchange.com/" target="_blank">Robotics Stack Exchange</a></strong></h3>      </div>
      <div id="github-question-list" class="panel-body" style="display: none;"></div>
      <div id="github-no-question-list" class="panel-body" style="display: none;">
        <p>No questions yet, you can ask one <a href="https://robotics.stackexchange.com/questions/tagged/nav2_mppi_controller+github">here</a>.</p>
      </div>
      <div id="github-get-question-fail" class="panel-body alert alert-warning" style="display: none;">
        <p>Failed to get question list, you can ticket an issue <a href="https://github.com/ros-infrastructure/rosindex/issues/new" target="_blank" class="alert-link">here</a> </p>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/package_body_tabs.js"></script>

<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
jQuery(function() {
    // Update the count on the links to the contribution suggestions
    updateContributionSuggestionsCountOnPackage('https://github.com/pomelo925/ttennis-pickup-robot.git');
});
</script>

          </div>
          <div class="col-md-2 hidden-xs hidden-sm">
            
            
            



<div class="list-group list-group-sm ">
  <a class="list-group-item"
     target="_blank"
     href="http://docs.ros.org/en/github/p/nav2_mppi_controller"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       
       API Docs
  </a>
  <a class="list-group-item"
     target="_blank"
     href="https://github.com/pomelo925/ttennis-pickup-robot/tree/main/3.Software/B.Navigation/nav2-ws/src/navigation2/nav2_mppi_controller"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       
       Browse Code
  </a>
  
  
  
  
  
  
</div>

          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-noetic">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>noetic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-galactic">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>galactic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-iron">
    <div class="container-fluid">
      
        
        
        

        <div class="row">
          <div class="col-md-10">
            

<div class="well well-sm">
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px" src="/assets/package.png">
      </td>
      <td>
        <h3 style="margin-top: 5px">
          <a style="text-decoration:none" href="/p/nav2_mppi_controller">nav2_mppi_controller</a> <small>package from <a style="text-decoration:none" href="/r/navigation2/github-ros-planning-navigation2">navigation2</a> repo</small>
        </h3>
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_amcl">

nav2_amcl
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_behavior_tree">

nav2_behavior_tree
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_behaviors">

nav2_behaviors
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_bringup">

nav2_bringup
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_bt_navigator">

nav2_bt_navigator
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_collision_monitor">

nav2_collision_monitor
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_common">

nav2_common
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_constrained_smoother">

nav2_constrained_smoother
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_controller">

nav2_controller
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_core">

nav2_core
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_costmap_2d">

nav2_costmap_2d
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/costmap_queue">

costmap_queue
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/dwb_core">

dwb_core
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/dwb_critics">

dwb_critics
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/dwb_msgs">

dwb_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/dwb_plugins">

dwb_plugins
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_dwb_controller">

nav2_dwb_controller
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav_2d_msgs">

nav_2d_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav_2d_utils">

nav_2d_utils
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_lifecycle_manager">

nav2_lifecycle_manager
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_map_server">

nav2_map_server
</a>
            
          
            
            
              <span class="label label-default pkg-label">

nav2_mppi_controller
</span>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_msgs">

nav2_msgs
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_navfn_planner">

nav2_navfn_planner
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_planner">

nav2_planner
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_regulated_pure_pursuit_controller">

nav2_regulated_pure_pursuit_controller
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_rotation_shim_controller">

nav2_rotation_shim_controller
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_rviz_plugins">

nav2_rviz_plugins
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_simple_commander">

nav2_simple_commander
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_smac_planner">

nav2_smac_planner
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_smoother">

nav2_smoother
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_system_tests">

nav2_system_tests
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_theta_star_planner">

nav2_theta_star_planner
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_util">

nav2_util
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_velocity_smoother">

nav2_velocity_smoother
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_voxel_grid">

nav2_voxel_grid
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/nav2_waypoint_follower">

nav2_waypoint_follower
</a>
            
          
            
            
              <a class="label label-primary pkg-label" href="/p/navigation2">

navigation2
</a>
            
          
      </td>
    </tr>
  </table>
</div>

            <div class="visible-xs visible-sm">
              
              
              



<div class="list-group list-group-sm list-group-horizontal list-group-justified">
  <a class="list-group-item text-center"
     target="_blank"
     href="http://docs.ros.org/en/iron/p/nav2_mppi_controller"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       <br>
       API Docs
  </a>
  <a class="list-group-item text-center"
     target="_blank"
     href="https://github.com/ros-planning/navigation2/tree/iron/nav2_mppi_controller"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       <br>
       Browse Code
  </a>
  
  
  
  
  
  
</div>

            </div>
            



<ul class="nav nav-tabs nav-justified" id="iron-tabs" style="margin-bottom:20px">
  <li class="better-tabs active">
    <a href="#iron-overview" data-toggle="tab">Overview</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    
    <a href="#iron-assets" data-toggle="tab"><span class="label label-primary">2</span> Assets</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    <a href="#iron-deps" data-toggle="tab"><span class="label label-primary">23</span> Dependencies</a>
  </li>
  <li class="better-tabs">
    
    <a href="#iron-tutorials" data-toggle="tab"><span class="label label-default">0</span> Tutorials</a>
  </li>
  <li class="better-tabs">
    <a href="#iron-questions" data-toggle="tab"><span id="iron-questions-count" class="label label-primary">0</span> Q & A</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="iron-overview">
    
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h4 class="panel-title">Package Summary</h4></div>
          <div class="panel-body">
            <table class="table table-condensed">
              <tr>
                <td style="width:100px;" class="text-right"><strong>Tags</strong></td>
                <td>
                  
                  
                    <em>No category tags.</em>
                  
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Version</strong></td>
                <td>1.2.10</td>
              </tr>
              <tr>
                <td class="text-right"><strong>License</strong></td>
                <td>MIT</td>
              </tr>
              <tr>
                <td class="text-right"><strong>Build type</strong></td>
                <td>
                  
                    <span class="label label-default">
                  
                    AMENT_CMAKE</span>
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Use</strong></td>
                <td>
                
                  <span class="label label-success">RECOMMENDED</span>
                
                </td>
              </tr>
            </table>
          </div>
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body">
            
            
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">ROS 2 Navigation Framework and System</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/ros-planning/navigation2.git">https://github.com/ros-planning/navigation2.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">iron</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2024-10-02
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          
            <span class="label label-success">
          
          DEVELOPED
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="No CI information available for this package.">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <span class="label label-default">robotics</span> <span class="label label-default">navigation</span> <span class="label label-default">ros2</span> 
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/navigation2/#iron-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/navigation2/#iron-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/navigation2/#iron-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Package Description</h3></div>
          <div class="panel-body">
            nav2_mppi_controller
          </div>
          <div class="panel-heading"><h4 class="panel-title">Additional Links</h4></div>
          <div class="panel-body">
            
            
              <em>No additional links.</em>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Maintainers</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>Steve Macenski</li>
                
                  <li>Aleksei Budyakov</li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Authors</h4></div>
          <div class="panel-body">
            
            
              <em>No additional authors.</em>
            
          </div>
        </div>
      </div>
    </div>
    
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-heading"><span class="glyphicon glyphicon-file"></span><a href="https://github.com/ros-planning/navigation2/tree/iron/nav2_mppi_controller/README.md" title="Open in git repository">nav2_mppi_controller/README.md</a></div>
              <div class="panel-body">
                    <div class="rendered-markdown">
<h1 id="model-predictive-path-integral-controller">Model Predictive Path Integral Controller</h1>

<p><img src="https://raw.githubusercontent.com/ros-planning/navigation2/iron/nav2_mppi_controller/media/demo.gif" alt=""></p>

<h2 id="overview">Overview</h2>

<p>This is a predictive controller (local trajectory planner) that implements the <a href="https://ieeexplore.ieee.org/document/7487277">Model Predictive Path Integral (MPPI)</a> algorithm to track a path with adaptive collision avoidance. It contains plugin-based critic functions to impact the behavior of the algorithm. It was created by <a href="https://www.linkedin.com/in/aleksei-budyakov-334889224/">Aleksei Budyakov</a> and adapted &amp; developed for Nav2 by <a href="https://www.linkedin.com/in/steve-macenski-41a985101/">Steve Macenski</a>.</p>

<p>This plugin implements the <code class="language-plaintext highlighter-rouge">nav2_core::Controller</code> interface allowing it to be used across the navigation stack as a local trajectory planner in the controller server’s action server (<code class="language-plaintext highlighter-rouge">controller_server</code>).</p>

<p>This controller is measured to run at 50+ Hz on a modest Intel processor (4th gen i5). See its Configuration Guide Page for additional parameter descriptions.</p>

<p>It works currently with Differential, Omnidirectional, and Ackermann robots.</p>

<h2 id="mppi-description">MPPI Description</h2>

<p>The MPPI algorithm is an MPC variant that finds a control velocity for the robot using an iterative approach. Using the previous time step’s best control solution and the robot’s current state, a set of randomly sampled perturbations from a Gaussian distribution are applied. These noised controls are forward simulated to generate a set of trajectories within the robot’s motion model.</p>

<p>Next, these trajectories are scored using a set of plugin-based critic functions to find the best trajectory in the batch. The output scores are used to set the best control with a soft max function.</p>

<p>This process is then repeated a number of times and returns a converged solution. This solution is then used as the basis of the next time step’s initial control.</p>

<h2 id="features">Features</h2>

<ul>
  <li>Predictive MPC trajectory planner</li>
  <li>Utilizes plugin-based critics which can be swapped out, tuned, or replaced easily by the user</li>
  <li>Highly optimized CPU-only performance using vectorization and tensor operations</li>
  <li>Supports a number of common motion models, including Ackermann, Differential-Drive, and Omni-directional</li>
  <li>Includes fallback mechanisms to handle soft-failures before escalating to recovery behaviors</li>
  <li>High-quality code implementation with Doxygen, high unit test coverage, documentation, and parameter guide</li>
  <li>Easily extensible to support modern research variants of MPPI</li>
  <li>Comes pre-tuned for good out-of-the-box behavior</li>
</ul>

<h2 id="configuration">Configuration</h2>

<h3 id="controller">Controller</h3>
<p>| Parameter                  | Type   | Definition                                                                                                                                                                                                                                                                                                           |
 | ———————      | —— | ——————————————————————————————————– |
 | motion_model               | string | Default: DiffDrive. Type of model [DiffDrive, Omni, Ackermann].                                          |
 | critics                    | string | Default: None. Critics (plugins) names                                                                   |
 | iteration_count            | int    | Default 1. Iteration count in MPPI algorithm. Recommend to keep as 1 and prefer more batches.            |
 | batch_size                 | int    | Default 1000. Count of randomly sampled candidate trajectories                                            |
 | time_steps                 | int    | Default 56. Number of time steps (points) in each sampled trajectory                                     |
 | model_dt                   | double | Default: 0.05. Time interval (s) between two sampled points in trajectories.                              |
 | vx_std                     | double | Default 0.2. Sampling standard deviation for VX                                                          |
 | vy_std                     | double | Default 0.2. Sampling standard deviation for VY                                                          |
 | wz_std                     | double | Default 0.4. Sampling standard deviation for Wz                                                          |
 | vx_max                     | double | Default 0.5. Max VX (m/s)                                                                                |
 | vy_max                     | double | Default 0.5. Max VY in either direction, if holonomic. (m/s)                                             |
 | vx_min                     | double | Default -0.35. Min VX (m/s)                                                                              |
 | wz_max                     | double | Default 1.9. Max WZ (rad/s)                                                                              |
 | temperature                | double | Default: 0.3. Selectiveness of trajectories by their costs (The closer this value to 0, the “more” we take in consideration controls with less cost), 0 mean use control with best cost, huge value will lead to just taking mean of all trajectories without cost consideration                                                   |
 | gamma                      | double | Default: 0.015. A trade-off between smoothness (high) and low energy (low). This is a complex parameter that likely won’t need to be changed from the default of <code class="language-plaintext highlighter-rouge">0.1</code> which works well for a broad range of cases. See Section 3D-2 in “Information Theoretic Model Predictive Control: Theory and Applications to Autonomous Driving” for detailed information.       |
 | visualize                  | bool   | Default: false. Publish visualization of trajectories, which can slow down the controller significantly. Use only for debugging.                                                                                                                                       |
 | retry_attempt_limit        | int    | Default 1. Number of attempts to find feasible trajectory on failure for soft-resets before reporting failure.                                                                                                                                                                                                       |
 | regenerate_noises          | bool   | Default false. Whether to regenerate noises each iteration or use single noise distribution computed on initialization and reset. Practically, this is found to work fine since the trajectories are being sampled stochastically from a normal distribution and reduces compute jittering at run-time due to thread wake-ups to resample normal distribution. |</p>

<h4 id="trajectory-visualizer">Trajectory Visualizer</h4>
<p>| Parameter             | Type   | Definition                                                                                                  |
 | —————       | —— | ———————————————————————————————————– |
 | trajectory_step       | int    | Default: 5. The step between trajectories to visualize to downsample candidate trajectory pool.             |
 | time_step             | int    | Default: 3. The step between points on trajectories to visualize to downsample trajectory density.          |</p>

<h4 id="path-handler">Path Handler</h4>
<p>| Parameter                  | Type   | Definition                                                                                                  |
 | —————            | —— | ———————————————————————————————————– |
 | max_robot_pose_search_dist | double | Default: Costmap half-size. Max integrated distance ahead of robot pose to search for nearest path point in case of path looping.   |
 | prune_distance             | double | Default: 1.5. Distance ahead of nearest point on path to robot to prune path to.                            |
 | transform_tolerance        | double | Default: 0.1. Time tolerance for data transformations with TF.                                              |
 | enforce_path_inversion        | double | Default: False. If true, it will prune paths containing cusping points for segments changing directions (e.g. path inversions) such that the controller will be forced to change directions at or very near the planner’s requested inversion point. This is targeting Smac Planner users with feasible paths who need their robots to switch directions where specifically requested.      |
 | inversion_xy_tolerance        | double | Default: 0.2. Cartesian proximity (m) to path inversion point to be considered “achieved” to pass on the rest of the path after path inversion.      |
 | inversion_yaw_tolerance        | double | Default: 0.4. Angular proximity (radians) to path inversion point to be considered “achieved” to pass on the rest of the path after path inversion. 0.4 rad = 23 deg.  |</p>

<h4 id="ackermann-motion-model">Ackermann Motion Model</h4>
<p>| Parameter            | Type   | Definition                                                                                                  |
 | ——————– | —— | ———————————————————————————————————– |
 | min_turning_r        | double | minimum turning radius for ackermann motion model                                                           |</p>

<h4 id="constraint-critic">Constraint Critic</h4>
<p>| Parameter             | Type   | Definition                                                                                                  |
 | —————       | —— | ———————————————————————————————————– |
 | cost_weight           | double | Default 4.0. Weight to apply to critic term.                                                                |
 | cost_power            | int    | Default 1. Power order to apply to term.</p>

<h4 id="goal-angle-critic">Goal Angle Critic</h4>
<p>| Parameter                        | Type   | Definition                                                                                                  |
 | —————                  | —— | ———————————————————————————————————– |
 | cost_weight                      | double | Default 3.0. Weight to apply to critic term.                                                                |
 | cost_power                       | int    | Default 1. Power order to apply to term.                                                                    |
 | threshold_to_consider            | double | Default 0.5. Minimal distance between robot and goal above which angle goal cost considered.               |</p>

<h4 id="goal-critic">Goal Critic</h4>
<p>| Parameter            | Type   | Definition                                                                                                  |
 | ——————– | —— | ———————————————————————————————————– |
 | cost_weight          | double | Default 5.0. Weight to apply to critic term.                                                                |
 | cost_power           | int    | Default 1. Power order to apply to term.                                                                    |
 | threshold_to_consider      | double | Default 1.4. Distance between robot and goal above which goal cost starts being considered                                    |</p>

<h4 id="obstacles-critic">Obstacles Critic</h4>

<p>Uses estimated distances from obstacles using cost and inflation parameters to avoid obstacles</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Type</th>
      <th>Definition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>consider_footprint</td>
      <td>bool</td>
      <td>Default: False. Whether to use point cost (if robot is circular or low compute power) or compute SE2 footprint cost.</td>
    </tr>
    <tr>
      <td>critical_weight</td>
      <td>double</td>
      <td>Default 20.0. Weight to apply to critic for near collisions closer than <code class="language-plaintext highlighter-rouge">collision_margin_distance</code> to prevent near collisions <strong>only</strong> as a method of virtually inflating the footprint. This should not be used to generally influence obstacle avoidance away from critical collisions.</td>
    </tr>
    <tr>
      <td>repulsion_weight</td>
      <td>double</td>
      <td>Default 1.5. Weight to apply to critic for generally preferring routes in lower cost space. This is separated from the critical term to allow for fine tuning of obstacle behaviors with path alignment for dynamic scenes without impacting actions which may directly lead to near-collisions. This is applied within the <code class="language-plaintext highlighter-rouge">inflation_radius</code> distance from obstacles.</td>
    </tr>
    <tr>
      <td>cost_power</td>
      <td>int</td>
      <td>Default 1. Power order to apply to term.</td>
    </tr>
    <tr>
      <td>collision_cost</td>
      <td>double</td>
      <td>Default 10000.0. Cost to apply to a true collision in a trajectory.</td>
    </tr>
    <tr>
      <td>collision_margin_distance</td>
      <td>double</td>
      <td>Default 0.10. Margin distance from collision to apply severe penalty, similar to footprint inflation. Between 0.05-0.2 is reasonable.</td>
    </tr>
    <tr>
      <td>near_goal_distance</td>
      <td>double</td>
      <td>Default 0.5. Distance near goal to stop applying preferential obstacle term to allow robot to smoothly converge to goal pose in close proximity to obstacles.</td>
    </tr>
    <tr>
      <td>inflation_layer_name</td>
      <td>string</td>
      <td>Default “”. Name of the inflation layer. If empty, it uses the last inflation layer in the costmap. If you have multiple inflation layers, you may want to specify the name of the layer to use.</td>
    </tr>
  </tbody>
</table>

<h4 id="cost-critic">Cost Critic</h4>

<p>Uses inflated costmap cost directly to avoid obstacles</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Type</th>
      <th>Definition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>consider_footprint</td>
      <td>bool</td>
      <td>Default: False. Whether to use point cost (if robot is circular or low compute power) or compute SE2 footprint cost.</td>
    </tr>
    <tr>
      <td>cost_weight</td>
      <td>double</td>
      <td>Default 3.81. Wight to apply to critic to avoid obstacles.</td>
    </tr>
    <tr>
      <td>cost_power</td>
      <td>int</td>
      <td>Default 1. Power order to apply to term.</td>
    </tr>
    <tr>
      <td>collision_cost</td>
      <td>double</td>
      <td>Default 1000000.0. Cost to apply to a true collision in a trajectory.</td>
    </tr>
    <tr>
      <td>critical_cost</td>
      <td>double</td>
      <td>Default 300.0. Cost to apply to a pose with any point in in inflated space to prefer distance from obstacles.</td>
    </tr>
    <tr>
      <td>near_goal_distance</td>
      <td>double</td>
      <td>Default 0.5. Distance near goal to stop applying preferential obstacle term to allow robot to smoothly converge to goal pose in close proximity to obstacles.</td>
    </tr>
    <tr>
      <td>inflation_layer_name</td>
      <td>string</td>
      <td>Default “”. Name of the inflation layer. If empty, it uses the last inflation layer in the costmap. If you have multiple inflation layers, you may want to specify the name of the layer to use.</td>
    </tr>
  </tbody>
</table>

<h4 id="path-align-critic">Path Align Critic</h4>
<p>| Parameter                  | Type   | Definition                                                                                                                         |
 | —————            | —— | ———————————————————————————————————–                        |
 | cost_weight                | double | Default 10.0. Weight to apply to critic term.                                                                                       |
 | cost_power                 | int    | Default 1. Power order to apply to term.                                                                                           |
 | threshold_to_consider      | double | Default 0.5. Distance between robot and goal above which path align cost stops being considered                                    |
 | offset_from_furthest      | double | Default 20. Checks that the candidate trajectories are sufficiently far along their way tracking the path to apply the alignment critic. This ensures that path alignment is only considered when actually tracking the path, preventing awkward initialization motions preventing the robot from leaving the path to achieve the appropriate heading.  |
 | trajectory_point_step      | double | Default 4. Step of trajectory points to evaluate for path distance to reduce compute time. Between 1-10 is typically reasonable.   |
 | max_path_occupancy_ratio   | double | Default 0.07 (7%). Maximum proportion of the path that can be occupied before this critic is not considered to allow the obstacle and path follow critics to avoid obstacles while following the path’s intent in presence of dynamic objects in the scene.  |
 | use_path_orientations   | bool | Default false. Whether to consider path’s orientations in path alignment, which can be useful when paired with feasible smac planners to incentivize directional changes only where/when the smac planner requests them. If you want the robot to deviate and invert directions where the controller sees fit, keep as false. If your plans do not contain orientation information (e.g. navfn), keep as false.  |</p>

<p>Note: There is a “Legacy” version of this critic also available with the same parameters of an old formulation pre-October 2023.</p>

<h4 id="path-angle-critic">Path Angle Critic</h4>
<p>| Parameter                 | Type   | Definition                                                                                                  |
 | —————           | —— | ———————————————————————————————————– |
 | cost_weight               | double | Default 2.0. Weight to apply to critic term.                                                                |
 | cost_power                | int    | Default 1. Power order to apply to term.                                                                    |
 | threshold_to_consider     | double | Default 0.5. Distance between robot and goal above which path angle cost stops being considered             |
 | offset_from_furthest      | int    | Default 4. Number of path points after furthest one any trajectory achieves to compute path angle relative to.  |
 | max_angle_to_furthest     | double | Default 1.2. Angular distance between robot and goal above which path angle cost starts being considered           |
 | mode     | int | Default 0 (Forward Preference). Enum type for mode of operations for the path angle critic depending on path input types and behavioral desires. 0: Forward Preference, penalizes high path angles relative to the robot’s orientation to incentivize turning towards the path. 1: No directional preference, penalizes high path angles relative to the robot’s orientation or mirrored orientation (e.g. reverse), which ever is less, when a particular direction of travel is not preferable. 2: Consider feasible path orientation, when using a feasible path whereas the path points have orientation information (e.g. Smac Planners), consider the path’s requested direction of travel to penalize path angles such that the robot will follow the path in the requested direction. |</p>

<h4 id="path-follow-critic">Path Follow Critic</h4>
<p>| Parameter             | Type   | Definition                                                                                                  |
 | —————       | —— | ———————————————————————————————————– |
 | cost_weight           | double | Default 5.0. Weight to apply to critic term.                                                                |
 | cost_power            | int    | Default 1. Power order to apply to term.   |
 | offset_from_furthest  | int    | Default 6. Number of path points after furthest one any trajectory achieves to drive path tracking relative to.     |
 | threshold_to_consider        | float  | Default 1.4. Distance between robot and goal above which path follow cost stops being considered  |</p>

<h4 id="prefer-forward-critic">Prefer Forward Critic</h4>
<p>| Parameter             | Type   | Definition                                                                                                  |
 | —————       | —— | ———————————————————————————————————– |
 | cost_weight           | double | Default 5.0. Weight to apply to critic term.                                                                |
 | cost_power            | int    | Default 1. Power order to apply to term.                                                                    |
 | threshold_to_consider | double | Default 0.5. Distance between robot and goal above which prefer forward cost stops being considered         |</p>

<h4 id="twirling-critic">Twirling Critic</h4>
<p>| Parameter             | Type   | Definition                                                                                                  |
 | —————       | —— | ———————————————————————————————————– |
 | cost_weight           | double | Default 10.0. Weight to apply to critic term.                                                               |
 | cost_power            | int    | Default 1. Power order to apply to term.                                                                    |</p>

<h4 id="velocity-deadband-critic">Velocity Deadband Critic</h4>
<p>| Parameter             | Type     | Definition                                                                                                  |
 | —————       | ——   | ———————————————————————————————————– |
 | cost_weight           | double   | Default 35.0. Weight to apply to critic term.                                                               |
 | cost_power            | int      | Default 1. Power order to apply to term.                                                                    |
 | deadband_velocities   | double[] | Default [0.0, 0.0, 0.0].  The array of deadband velocities [vx, vz, wz]. A zero array indicates that the critic will take no action.      |</p>

<h3 id="xml-configuration-example">XML configuration example</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>controller_server:
  ros__parameters:
    controller_frequency: 30.0
    FollowPath:
      plugin: "nav2_mppi_controller::MPPIController"
      time_steps: 56
      model_dt: 0.05
      batch_size: 2000
      vx_std: 0.2
      vy_std: 0.2
      wz_std: 0.4
      vx_max: 0.5
      vx_min: -0.35
      vy_max: 0.5
      wz_max: 1.9
      iteration_count: 1
      prune_distance: 1.7
      transform_tolerance: 0.1
      temperature: 0.3
      gamma: 0.015
      motion_model: "DiffDrive"
      visualize: false
      TrajectoryVisualizer:
        trajectory_step: 5
        time_step: 3
      AckermannConstraints:
        min_turning_r: 0.2
      critics: ["ConstraintCritic", "CostCritic", "GoalCritic", "GoalAngleCritic", "PathAlignCritic", "PathFollowCritic", "PathAngleCritic", "PreferForwardCritic"]
      ConstraintCritic:
        enabled: true
        cost_power: 1
        cost_weight: 4.0
      GoalCritic:
        enabled: true
        cost_power: 1
        cost_weight: 5.0
        threshold_to_consider: 1.4
      GoalAngleCritic:
        enabled: true
        cost_power: 1
        cost_weight: 3.0
        threshold_to_consider: 0.5
      PreferForwardCritic:
        enabled: true
        cost_power: 1
        cost_weight: 5.0
        threshold_to_consider: 0.5
      # ObstaclesCritic:
      #   enabled: true
      #   cost_power: 1
      #   repulsion_weight: 1.5
      #   critical_weight: 20.0
      #   consider_footprint: false
      #   collision_cost: 10000.0
      #   collision_margin_distance: 0.1
      #   near_goal_distance: 0.5
      CostCritic:
        enabled: true
        cost_power: 1
        cost_weight: 3.81
        critical_cost: 300.0
        consider_footprint: true
        collision_cost: 1000000.0
        near_goal_distance: 1.0
      PathAlignCritic:
      PathAlignCritic:
        enabled: true
        cost_power: 1
        cost_weight: 14.0
        max_path_occupancy_ratio: 0.05
        trajectory_point_step: 3
        threshold_to_consider: 0.5
        offset_from_furthest: 20
        use_path_orientations: false
      PathFollowCritic:
        enabled: true
        cost_power: 1
        cost_weight: 5.0
        offset_from_furthest: 5
        threshold_to_consider: 1.4
      PathAngleCritic:
        enabled: true
        cost_power: 1
        cost_weight: 2.0
        offset_from_furthest: 4
        threshold_to_consider: 0.5
        max_angle_to_furthest: 1.0
        forward_preference: true
      # VelocityDeadbandCritic:
      #   enabled: true
      #   cost_power: 1
      #   cost_weight: 35.0
      #   deadband_velocities: [0.05, 0.05, 0.05]
      # TwirlingCritic:
      #   enabled: true
      #   twirling_cost_power: 1
      #   twirling_cost_weight: 10.0

</code></pre></div></div>
<h2 id="topics">Topics</h2>

<table>
  <thead>
    <tr>
      <th>Topic</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">trajectories</code></td>
      <td><code class="language-plaintext highlighter-rouge">visualization_msgs/MarkerArray</code></td>
      <td>Randomly generated trajectories, including resulting control sequence</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">transformed_global_plan</code></td>
      <td><code class="language-plaintext highlighter-rouge">nav_msgs/Path</code></td>
      <td>Part of global plan considered by local planner</td>
    </tr>
  </tbody>
</table>

<h2 id="notes-to-users">Notes to Users</h2>

<h3 id="general-words-of-wisdom">General Words of Wisdom</h3>

<p>The <code class="language-plaintext highlighter-rouge">model_dt</code> parameter generally should be set to the duration of your control frequency. So if your control frequency is 20hz, this should be <code class="language-plaintext highlighter-rouge">0.05</code>. However, you may also set it lower <strong>but not larger</strong>.</p>

<p>Visualization of the trajectories using <code class="language-plaintext highlighter-rouge">visualize</code> uses compute resources to back out trajectories for visualization and therefore slows compute time. It is not suggested that this parameter is set to <code class="language-plaintext highlighter-rouge">true</code> during a deployed use, but is a useful debug instrument while tuning the system, but use sparingly. Visualizing 2000 batches @ 56 points at 30 hz is <em>a lot</em>.</p>

<p>The most common parameters you might want to start off changing are the velocity profiles (<code class="language-plaintext highlighter-rouge">vx_max</code>, <code class="language-plaintext highlighter-rouge">vx_min</code>, <code class="language-plaintext highlighter-rouge">wz_max</code>, and <code class="language-plaintext highlighter-rouge">vy_max</code> if holonomic) and the <code class="language-plaintext highlighter-rouge">motion_model</code> to correspond to your vehicle. Its wise to consider the <code class="language-plaintext highlighter-rouge">prune_distance</code> of the path plan in proportion to your maximum velocity and prediction horizon. The only deeper parameter that will likely need to be adjusted for your particular settings is the Obstacle critics’ <code class="language-plaintext highlighter-rouge">repulsion_weight</code> since the tuning of this is proportional to your inflation layer’s radius. Higher radii should correspond to reduced <code class="language-plaintext highlighter-rouge">repulsion_weight</code> due to the penalty formation (e.g. <code class="language-plaintext highlighter-rouge">inflation_radius - min_dist_to_obstacle</code>). If this penalty is too high, the robot will slow significantly when entering cost-space from non-cost space or jitter in narrow corridors. It is noteworthy, but likely not necessary to be changed, that the Obstacle critic may use the full footprint information if <code class="language-plaintext highlighter-rouge">consider_footprint = true</code>, though comes at an increased compute cost.</p>

<p>If you don’t require path following behavior (e.g. just want to follow a goal pose and let the model predictive elements decide the best way to accomplish that), you may easily remove the PathAlign, PathFollow and PathAngle critics.</p>

<p>By default, the controller is tuned and has the capabilities established in the PathAlign/Obstacle critics to generally follow the path closely when no obstacles prevent it, but able to deviate from the path when blocked. See <code class="language-plaintext highlighter-rouge">PathAlignCritic::score()</code> for details, but it is disabled when the local path is blocked so the obstacle critic takes over in that state.</p>

<h3 id="prediction-horizon-costmap-sizing-and-offsets">Prediction Horizon, Costmap Sizing, and Offsets</h3>

<p>As this is a predictive planner, there is some relationship between maximum speed, prediction times, and costmap size that users should keep in mind while tuning for their application. If a controller server costmap is set to 3.0m in size, that means that with the robot in the center, there is 1.5m of information on either side of the robot. When your prediction horizon (time_steps * model_dt) at maximum speed (vx_max) is larger than this, then your robot will be artificially limited in its maximum speeds and behavior by the costmap limitation. For example, if you predict forward 3 seconds (60 steps @ 0.05s per step) at 0.5m/s maximum speed, the <strong>minimum</strong> required costmap radius is 1.5m - or 3m total width.</p>

<p>The same applies to the Path Follow and Align offsets from furthest. In the same example if the furthest point we can consider is already at the edge of the costmap, then further offsets are thresholded because they’re unusable. So its important while selecting these parameters to make sure that the theoretical offsets can exist on the costmap settings selected with the maximum prediction horizon and velocities desired. Setting the threshold for consideration in the path follower + goal critics as the same as your prediction horizon can make sure you have clean hand-offs between them, as the path follower will otherwise attempt to slow slightly once it reaches the final goal pose as its marker.</p>

<p>The Path Follow critic cannot drive velocities greater than the projectable distance of that velocity on the available path on the rolling costmap. The Path Align critic <code class="language-plaintext highlighter-rouge">offset_from_furthest</code> represents the number of path points a trajectory passes through while tracking the path. If this is set either absurdly low (e.g. 5) it can trigger when a robot is simply trying to start path tracking causing some suboptimal behaviors and local minima while starting a task. If it is set absurdly high (e.g. 50) relative to the path resolution and costmap size, then the critic may never trigger or only do so when at full-speed. A balance here is wise. A selection of this value to be ~30% of the maximum velocity distance projected is good (e.g. if a planner produces points every 2.5cm, 60 can fit on the 1.5m local costmap radius. If the max speed is 0.5m/s with a 3s prediction time, then 20 points represents 33% of the maximum speed projected over the prediction horizon onto the path). When in doubt, <code class="language-plaintext highlighter-rouge">prediction_horizon_s * max_speed / path_resolution / 3.0</code> is a good baseline.</p>

<h3 id="obstacle-inflation-layer-and-path-following">Obstacle, Inflation Layer, and Path Following</h3>

<p>There also exists a relationship between the costmap configurations and the Obstacle critic configurations. If the Obstacle critic is not well tuned with the costmap parameters (inflation radius, scale) it can cause the robot to wobble significantly as it attempts to take finitely lower-cost trajectories with a slightly lower cost in exchange for jerky motion. The default behavior was tuned for small AMRs (e.g. turtlebots or similar), so if using a larger robot, you may want to reduce the <code class="language-plaintext highlighter-rouge">repulsion_weight</code> in kind. It may also perform awkward maneuvers when in free-space to try to maximize time in a small pocket of 0-cost over a more natural motion which involves moving into some low-costed region. Finally, it may generally refuse to go into costed space at all when starting in a free 0-cost space if the gain is set disproportionately higher than the Path Follow scoring to encourage the robot to move along the path. This is due to the critic cost of staying in free space becoming more attractive than entering even lightly costed space in exchange for progression along the task.</p>

<p>Thus, care should be taken to select weights of the obstacle critic in conjunction with the costmap inflation radius and scale so that a robot does not have such issues. How I (Steve, your friendly neighborhood navigator) tuned this was to first create the appropriate obstacle critic behavior desirable in conjunction with the inflation layer parameters. Its worth noting that the Obstacle critic converts the cost into a distance from obstacles, so the nature of the distribution of costs in the inflation isn’t overly significant. However, the inflation radius and the scale will define the cost at the end of the distribution where free-space meets the lowest cost value within the radius. So testing for quality behavior when going over that threshold should be considered.</p>

<p>As you increase or decrease your weights on the Obstacle, you may notice the aforementioned behaviors (e.g. won’t overcome free to non-free threshold). To overcome them, increase the FollowPath critic cost to increase the desire for the trajectory planner to continue moving towards the goal. Make sure to not overshoot this though, keep them balanced. A desirable outcome is smooth motion roughly in the center of spaces without significant close interactions with obstacles. It shouldn’t be perfectly following a path yet nor should the output velocity be wobbling jaggedly.</p>

<p>Once you have your obstacle avoidance behavior tuned and matched with an appropriate path following penalty, tune the Path Align critic to align with the path. If you design exact-path-alignment behavior, its possible to skip the obstacle critic step as highly tuning the system to follow the path will give it less ability to deviate to avoid obstacles (though it’ll slow and stop). Tuning the critic weight for the Obstacle critic high will do the job to avoid near-collisions but the repulsion weight is largely unnecessary to you. For others wanting more dynamic behavior, it <em>can</em> be beneficial to slowly lower the weight on the obstacle critic to give the path alignment critic some more room to work. If your path was generated with a cost-aware planner (like all provided by Nav2) and providing paths sufficiently far from obstacles for your satisfaction, the impact of a slightly reduced Obstacle critic with a Path Alignment critic will do you well. Not over-weighting the path align critic will allow the robot to  deviate from the path to get around dynamic obstacles in the scene or other obstacles not previous considered during path planning. It is subjective as to the best behavior for your application, but it has been shown that MPPI can be an exact path tracker and/or avoid dynamic obstacles very fluidly and everywhere in between. The defaults provided are in the generally right regime for a balanced initial trade-off.</p>
</div>
              </div>
            </div>
          </div>
        </div>
      
    
    <div class="row">
      <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-heading"><span class="glyphicon glyphicon-list"></span> CHANGELOG</div>
          <div class="panel-body">
            
              <em>No CHANGELOG found.</em>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="iron-tutorials">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wiki Tutorials</h3>
      </div>
      <div class="panel-body">
        
        <em>This package does not provide any links to tutorials in it's <a href="https://index.ros.org/contribute/metadata/">rosindex metadata</a>.</em>
        <em>You can check on the <a href="http://wiki.ros.org/nav2_mppi_controller/Tutorials" target="_blank">ROS Wiki Tutorials</a> page for the package.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="iron-deps">
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Package Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th class="text-center">Deps</th>
                  <th style="width: 100%">Name</th>
                </thead>
                <tbody>
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake#iron">ament_cmake  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_ros#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_ros#iron">ament_cmake_ros  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_auto#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_auto#iron">ament_lint_auto  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_lint_common#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_lint_common#iron">ament_lint_common  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/ament_cmake_gtest#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/ament_cmake_gtest#iron">ament_cmake_gtest  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rclcpp#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rclcpp#iron">rclcpp  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/nav2_common#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/nav2_common#iron">nav2_common  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/nav2_core#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/nav2_core#iron">nav2_core  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/nav2_util#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/nav2_util#iron">nav2_util  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/nav2_costmap_2d#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/nav2_costmap_2d#iron">nav2_costmap_2d  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/geometry_msgs#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/geometry_msgs#iron">geometry_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/visualization_msgs#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/visualization_msgs#iron">visualization_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/nav2_msgs#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/nav2_msgs#iron">nav2_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/pluginlib#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/pluginlib#iron">pluginlib  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/tf2_geometry_msgs#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/tf2_geometry_msgs#iron">tf2_geometry_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/tf2#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/tf2#iron">tf2  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/tf2_eigen#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/tf2_eigen#iron">tf2_eigen  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/tf2_ros#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/tf2_ros#iron">tf2_ros  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/std_msgs#iron-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/std_msgs#iron">std_msgs  </a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
          <div class="panel-heading">
            <h3 class="panel-title">System Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                </thead>
                <tbody>
                  
                    
                      <tr>
                        <td><a href="/d/xtensor">xtensor</a></td>
                      </tr>
                    
                  
                    
                      <tr>
                        <td><a href="/d/libomp-dev">libomp-dev</a></td>
                      </tr>
                    
                  
                    
                      <tr>
                        <td><a href="/d/benchmark">benchmark</a></td>
                      </tr>
                    
                  
                    
                      <tr>
                        <td><a href="/d/xsimd">xsimd</a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Dependant Packages</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                  <th class="text-center">Deps</th>
                </thead>
                <tbody>
                  
                    
                    
                    <tr>
                      <td><a href="/p/navigation2#iron">navigation2</a></td>
                      <td class="text-center">
                        
                        <a href="/p/navigation2#iron-deps" >
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="iron-assets">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Launch files</h3>
      </div>
      <div class="panel-body">
        
          <em>No launch files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Messages</h3>
      </div>
      <div class="panel-body">
        
          <em>No message files found.</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Services</h3>
      </div>
      <div class="panel-body">
        
          <em>No service files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Plugins</h3>
      </div>
      <div class="panel-body">
        
          <ul>
            
              <li><a href="https://github.com/ros-planning/navigation2/tree/iron/nav2_mppi_controller//mppic.xml" target="_blank">nav2_core</a></li>
            
              <li><a href="https://github.com/ros-planning/navigation2/tree/iron/nav2_mppi_controller//critics.xml" target="_blank">nav2_mppi_controller</a></li>
            
          </ul>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="iron-questions">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent questions tagged <kbd>nav2_mppi_controller</kbd> at <strong><a href="https://robotics.stackexchange.com/" target="_blank">Robotics Stack Exchange</a></strong></h3>      </div>
      <div id="iron-question-list" class="panel-body" style="display: none;"></div>
      <div id="iron-no-question-list" class="panel-body" style="display: none;">
        <p>No questions yet, you can ask one <a href="https://robotics.stackexchange.com/questions/tagged/nav2_mppi_controller+iron">here</a>.</p>
      </div>
      <div id="iron-get-question-fail" class="panel-body alert alert-warning" style="display: none;">
        <p>Failed to get question list, you can ticket an issue <a href="https://github.com/ros-infrastructure/rosindex/issues/new" target="_blank" class="alert-link">here</a> </p>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/package_body_tabs.js"></script>

<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
jQuery(function() {
    // Update the count on the links to the contribution suggestions
    updateContributionSuggestionsCountOnPackage('https://github.com/ros-planning/navigation2.git');
});
</script>

          </div>
          <div class="col-md-2 hidden-xs hidden-sm">
            
            
            



<div class="list-group list-group-sm ">
  <a class="list-group-item"
     target="_blank"
     href="http://docs.ros.org/en/iron/p/nav2_mppi_controller"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       
       API Docs
  </a>
  <a class="list-group-item"
     target="_blank"
     href="https://github.com/ros-planning/navigation2/tree/iron/nav2_mppi_controller"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       
       Browse Code
  </a>
  
  
  
  
  
  
</div>

          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-melodic">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>melodic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>



<script id="question-list-template" type="text/html">
  <p>
    Browse <a href="https://robotics.stackexchange.com/questions/tagged/nav2_mppi_controller?tab=Newest">recent questions</a>
    or see the <a href="https://robotics.stackexchange.com/questions/tagged/nav2_mppi_controller?tab=Votes">highest voted ones</a>.
  </p>
  
  <table class="table table-striped">
    <thead>
      <tr>
        <th scope="col">Title</th>
        <th scope="col">Answered?</th>
        <th scope="col">Created</th>
        <th scope="col">Active</th>
      </tr>
    </thead>
    <tbody>
      {{#questions}}
      <tr>
        <th scope="row"><a href="{{link}}">{{title}}</a><br><small>Tags: {{strtags}}</small></th>
        <th>{{answered}}</th>
        <th>{{created}}</th>
        <th>{{active}}</th>
      </tr>
      {{/questions}}
    </tbody>
  </table>
  {{#has_more}}
  <hr>
  <h4>Additional questions are available at
    <a href="https://robotics.stackexchange.com/questions/tagged/{{name}}?tab=Newest">Robotics Stack Exchange</a>
  </h4>
  {{/has_more}}
  
</script>

<script type="text/javascript" src="/js/mustache.js"></script>
<script type="text/javascript">
  jQuery(function() {
    jQuery.getJSON(url="https://api.stackexchange.com/2.3/questions?order=desc&site=robotics" +
                       "&tagged=nav2_mppi_controller&pagesize=50&sort=activity")
    .done(function(feed) {
      if (feed.items.length > 0) {
        var question_count_str = (feed.has_more ? '>' : '') + String(feed.items.length)
        const questions = feed.items.map(
          function(question) {
            question.id = Math.round(Math.random() * 99999.0);
            question.created = (new Date(question.creation_date * 1000)).toDateString()
            question.active = (new Date(question.last_activity_date * 1000)).toDateString()
            question.answered = question.is_answered ? "Yes" : "No"
            question.strtags = question.tags.join(' ')
            return question;
          });
        const template = jQuery("#question-list-template").text();
        Mustache.parse(template);
        var rendered = Mustache.render(
          template, 
          { questions: questions,
            has_more: feed.has_more,
            name: "nav2_mppi_controller"
          }
        );
      }
      //   TODO(tfoote) Resolve images
      //   jQuery("#-question-list img").each(function() {
      //     if (jQuery(this).attr("src").startsWith("/upfiles")) {
      //        jQuery(this).attr("src", "https://answers.ros.org" + jQuery(this).attr("src"));
      //     }
      //   });
      
      if (feed.items.length > 0) {
        jQuery("#humble-question-list").html(rendered);
        jQuery("#humble-question-list").show();
      } else {
        jQuery("#humble-no-question-list").show();
      }
      jQuery("#humble-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#jazzy-question-list").html(rendered);
        jQuery("#jazzy-question-list").show();
      } else {
        jQuery("#jazzy-no-question-list").show();
      }
      jQuery("#jazzy-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#kilted-question-list").html(rendered);
        jQuery("#kilted-question-list").show();
      } else {
        jQuery("#kilted-no-question-list").show();
      }
      jQuery("#kilted-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#rolling-question-list").html(rendered);
        jQuery("#rolling-question-list").show();
      } else {
        jQuery("#rolling-no-question-list").show();
      }
      jQuery("#rolling-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#github-question-list").html(rendered);
        jQuery("#github-question-list").show();
      } else {
        jQuery("#github-no-question-list").show();
      }
      jQuery("#github-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#noetic-question-list").html(rendered);
        jQuery("#noetic-question-list").show();
      } else {
        jQuery("#noetic-no-question-list").show();
      }
      jQuery("#noetic-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#galactic-question-list").html(rendered);
        jQuery("#galactic-question-list").show();
      } else {
        jQuery("#galactic-no-question-list").show();
      }
      jQuery("#galactic-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#iron-question-list").html(rendered);
        jQuery("#iron-question-list").show();
      } else {
        jQuery("#iron-no-question-list").show();
      }
      jQuery("#iron-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#melodic-question-list").html(rendered);
        jQuery("#melodic-question-list").show();
      } else {
        jQuery("#melodic-no-question-list").show();
      }
      jQuery("#melodic-questions-count").text(question_count_str);
      
    })
    .fail(function(jqxhr, textStatus, error) {
      console.error("Failed to get question data: " + jqxhr.responseText);
      
      jQuery("#humble-get-question-fail").show();
      
      jQuery("#jazzy-get-question-fail").show();
      
      jQuery("#kilted-get-question-fail").show();
      
      jQuery("#rolling-get-question-fail").show();
      
      jQuery("#github-get-question-fail").show();
      
      jQuery("#noetic-get-question-fail").show();
      
      jQuery("#galactic-get-question-fail").show();
      
      jQuery("#iron-get-question-fail").show();
      
      jQuery("#melodic-get-question-fail").show();
      
    });
  });
</script>


<script type="text/javascript">
  $(document).ready(function() {
    setupDistroSwitch("humble");
  });
</script>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="container-fluid">
      <div style="float:left;">
        
          <a href="https://github.com/rkent/rosindex" title="Find rosindex in Github">
          <span class="icon  icon--github">
            <svg viewBox="0 0 16 16">
              <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
            </svg>
          </span>

          <span class="username">rkent/rosindex</span>
        </a>
        <em class="hidden-xs">| generated on 2025-05-05</em>
      
      </div>
      <div style="float:right;">
        <p class="text"><span class="hidden-xs">a community-maintained index of robotics software
 | </span><a href="/privacy.txt">privacy</a></p>
      </div>
    </div>
  </div>

</footer>


  </body>

</html>
