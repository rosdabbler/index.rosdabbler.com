<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Package: synchros2</title>
    <meta name="description" content="a community-maintained index of robotics software
">

    
    <link rel="canonical" href="http://index.rosdabbler.com/p/synchros2/">
    
    
    <link rel="icon" sizes="any" type="image/svg+xml" href="/assets/rosindex_logo.svg">

    

    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">
    

    

    <script type="text/javascript" src=/js/jquery.js></script>
    <script src=/bootstrap/js/bootstrap.min.js type="text/javascript"></script>
    <script src=/js/jquery-cookie.js type="text/javascript"></script>
    
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EVD5Z6G6NH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EVD5Z6G6NH');
</script>

    <script type="text/javascript" src=/js/toc.js></script>

    <script src=/js/distro_switch.js></script>
  </head>

  <body>

    <header class="site-header">

  <div class="wrapper">
    <div class="container-fluid" style="margin-bottom: 10px">
      <div class="row">
        <!-- title -->
        <div class="col-xs-3" style="white-space:nowrap">
          <a class="site-title" href="/">
            <img src="/assets/rosindex_logo.svg" width="26" height="26" alt="ROS index logo" style="padding-bottom: 3px"/>
            ROS Index</a>
        </div>
        <!-- main internal links -->
        <div class="col-xs-6 text-center" style="padding:0px">
          <div class="btn-group hidden-xs" role="group" aria-label="..." style="padding: 6px">
            <div class="btn-group" role="group">
              <a href="/?search_packages=true" class="btn btn-default" role="button">Package List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/?search_repos=true" class="btn btn-default" role="button">Repository List</a>
            </div>
            <div class="btn-group" role="group">
              <a href="/search_deps" class="btn btn-default" role="button">System Dependencies</a>
            </div>
          </div>
          <div class="hidden-lg hidden-md hidden-sm">
            <button id="hLabel" class="btn btn-link dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Lists <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="hLabel">
              <li><a href="/?search_packages=true">Package List</a></li>
              <li><a href="/?search_repos=true">Repository List</a></li>
              <li><a href="/search_deps">System Dependencies</a></li>
            </ul>
          </div>
        </div>
        <!-- additional links -->
        <div class="col-xs-3 text-right" style="white-space:nowrap; padding:0px">
          <ul class="list-inline" style="margin-bottom:0px;">
            <li class="dropdown hidden-xs hidden-sm">
              <button id="rLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                ROS Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu" aria-labelledby="rLabel">
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-xs hidden-sm">
              <button id="aLabel" class="btn btn-link" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                About <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="aLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
              </ul>
            </li>
            <li class="dropdown hidden-md hidden-lg">
              <button id="qLabel" class="btn btn-link" type="button"
                      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Resources <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="qLabel">
                <li><a href="/about">About </a></li>
                <li><a href="/contribute">Contribute</a></li>
                <li><a href="/help">Help</a></li>
                <li><a href="/stats">Stats</a></li>
                <hr style="margin:7px" />
                <li><a href="http://docs.ros.org/">Documentation</a></li>
                <li><a href="http://wiki.ros.org/Support">Support</a></li>
                <li><a href="http://discourse.ros.org/">Discussion Forum</a></li>
                <li><a href="http://status.ros.org/">Service Status</a></li>
                <li><a href="https://robotics.stackexchange.com/questions/tagged/ros">ros @ Robotics Stack Exchange</a></li>
                <li><a href="https://docs.ros.org/en/ros2_packages/">Package API</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin-top: 20px">
  <div class="container-fluid">
    <div class="row">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/?search_packages=true">Packages</a></li>
        <li class="active">synchros2</li>
      </ol>
    </div>
    <div class="row">
      

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
    <label id="humble-option" class="distro-button btn btn-xs btn-default" href="#humble" data="humble">
      <input type="radio" name="options" id="humble-radio" autocomplete="off"> humble
    </label>
  
    <label id="jazzy-option" class="distro-button btn btn-xs btn-default" href="#jazzy" data="jazzy">
      <input type="radio" name="options" id="jazzy-radio" autocomplete="off"> jazzy
    </label>
  
    <label id="kilted-option" class="distro-button btn btn-xs btn-default" href="#kilted" data="kilted">
      <input type="radio" name="options" id="kilted-radio" autocomplete="off"> kilted
    </label>
  
    <label id="rolling-option" class="distro-button btn btn-xs btn-default" href="#rolling" data="rolling">
      <input type="radio" name="options" id="rolling-radio" autocomplete="off"> rolling
    </label>
  
    <label id="github-option" class="distro-button btn btn-xs btn-primary" href="#github" data="github">
      <input type="radio" name="options" id="github-radio" autocomplete="off"> github
    </label>
  
    <label id="noetic-option" class="distro-button btn btn-xs btn-default" href="#noetic" data="noetic">
      <input type="radio" name="options" id="noetic-radio" autocomplete="off"> noetic
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-default" data-toggle="dropdown" id="older-distro-button">
        <input type="radio" name="options" autocomplete="off">
      <span id="older-label">Older</span>
      <span class="caret"></span>
    </label>
    <ul class="dropdown-menu" role="menu">
      
        <li data="galactic" id="galactic-option" class="disabled older-distro-option"  href="#galactic">
          <a href="#galactic" data="galactic" id="galactic-button">galactic</a>
        </li>
      
        <li data="iron" id="iron-option" class="disabled older-distro-option"  href="#iron">
          <a href="#iron" data="iron" id="iron-button">iron</a>
        </li>
      
        <li data="melodic" id="melodic-option" class="disabled older-distro-option"  href="#melodic">
          <a href="#melodic" data="melodic" id="melodic-button">melodic</a>
        </li>
      
    </ul>
  </div>
</div>

    </div>
    <div class="row">
      &nbsp;
    </div>
  </div>
</div>


  <div class="distro distro-humble">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>humble</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-jazzy">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>jazzy</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-kilted">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>kilted</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-rolling">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>rolling</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-github">
    <div class="container-fluid">
      
        
        
        

        <div class="row">
          <div class="col-md-10">
            

<div class="well well-sm">
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px" src="/assets/package.png">
      </td>
      <td>
        <h3 style="margin-top: 5px">
          <a style="text-decoration:none" href="/p/synchros2">synchros2</a> <small>package from <a style="text-decoration:none" href="/r/ros_utilities/github-bdaiinstitute-ros_utilities">ros_utilities</a> repo</small>
        </h3>
          
            
            
              <a class="label label-primary pkg-label" href="/p/bdai_ros2_wrappers">

bdai_ros2_wrappers
</a>
            
          
            
            
              <span class="label label-default pkg-label">

synchros2
</span>
            
          
      </td>
    </tr>
  </table>
</div>

            <div class="visible-xs visible-sm">
              
              
              



<div class="list-group list-group-sm list-group-horizontal list-group-justified">
  <a class="list-group-item text-center"
     target="_blank"
     href="http://docs.ros.org/en/github/p/synchros2"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       <br>
       API Docs
  </a>
  <a class="list-group-item text-center"
     target="_blank"
     href="https://github.com/bdaiinstitute/ros_utilities/tree/main/synchros2"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       <br>
       Browse Code
  </a>
  
  
  
  
  
  
</div>

            </div>
            



<ul class="nav nav-tabs nav-justified" id="github-tabs" style="margin-bottom:20px">
  <li class="better-tabs active">
    <a href="#github-overview" data-toggle="tab">Overview</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    
    <a href="#github-assets" data-toggle="tab"><span class="label label-default">0</span> Assets</a>
  </li>
  <li class="better-tabs">
    
    
    
    
    <a href="#github-deps" data-toggle="tab"><span class="label label-primary">5</span> Dependencies</a>
  </li>
  <li class="better-tabs">
    
    <a href="#github-tutorials" data-toggle="tab"><span class="label label-default">0</span> Tutorials</a>
  </li>
  <li class="better-tabs">
    <a href="#github-questions" data-toggle="tab"><span id="github-questions-count" class="label label-primary">0</span> Q & A</a>
  </li>
</ul>

<div class="tab-content">
  <div class="tab-pane active" id="github-overview">
    
    <div class="row">
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h4 class="panel-title">Package Summary</h4></div>
          <div class="panel-body">
            <table class="table table-condensed">
              <tr>
                <td style="width:100px;" class="text-right"><strong>Tags</strong></td>
                <td>
                  
                  
                    <em>No category tags.</em>
                  
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Version</strong></td>
                <td>1.0.0</td>
              </tr>
              <tr>
                <td class="text-right"><strong>License</strong></td>
                <td>MIT</td>
              </tr>
              <tr>
                <td class="text-right"><strong>Build type</strong></td>
                <td>
                  
                    <span class="label label-default">
                  
                    AMENT_PYTHON</span>
                </td>
              </tr>
              <tr>
                <td class="text-right"><strong>Use</strong></td>
                <td>
                
                  <span class="label label-success">RECOMMENDED</span>
                
                </td>
              </tr>
            </table>
          </div>
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body">
            
            
            
  <link rel="stylesheet" href="/css/ci-status.css">
  <table class="table table-condensed">
    <tr>
      <td class="text-right"><b>Description</b></td>
      <td><span class="label label-default">Wrappers and other utilities for ROS2</span></td>
    </tr>
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/bdaiinstitute/ros_utilities.git">https://github.com/bdaiinstitute/ros_utilities.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">main</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2025-04-18
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          <span class="label label-warning">UNKNOWN
        </span>
      </td>
    </tr>
              <tr>
                <td class="text-right"><b>CI status</b></td>
                <td class="ci-status">
                  
                  
                    <span class="label label-default" title="No CI information available for this package.">No Continuous Integration</span>
                  
                </td>
              </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-default">UNRELEASED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Tags</b></td>
      <td>
        
        
          <em>No category tags.</em>
        
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Contributing</b></td>
      <td>
        <a class="label label-primary" href="/r/ros_utilities/#github-contribute-lists-help-wanted">
          Help Wanted (<span class="contribute-lists-help-wanted-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ros_utilities/#github-contribute-lists-good-first-issue">
          Good First Issues (<span class="contribute-lists-good-first-issue-count">0</span>)
        </a>
        <br>
        <a class="label label-primary" href="/r/ros_utilities/#github-contribute-lists-pull-requests">
          Pull Requests to Review (<span class="contribute-lists-pull-requests-count">0</span>)
        </a>
      </td>
    </tr>
  </table>

          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Package Description</h3></div>
          <div class="panel-body">
            The AI Institute's wrappers for ROS2
          </div>
          <div class="panel-heading"><h4 class="panel-title">Additional Links</h4></div>
          <div class="panel-body">
            
            
              <em>No additional links.</em>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Maintainers</h4></div>
          <div class="panel-body">
            
            
              <ul class="list-unstyled">
                
                  <li>The AI Institute</li>
                
              </ul>
            
          </div>
          <div class="panel-heading"><h4 class="panel-title">Authors</h4></div>
          <div class="panel-body">
            
            
              <em>No additional authors.</em>
            
          </div>
        </div>
      </div>
    </div>
    
      
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-heading"><span class="glyphicon glyphicon-file"></span><a href="https://github.com/bdaiinstitute/ros_utilities/tree/main/synchros2/README.md" title="Open in git repository">synchros2/README.md</a></div>
              <div class="panel-body">
                    <div class="rendered-markdown">
<h1 id="synchros2"><code class="language-plaintext highlighter-rouge">synchros2</code></h1>

<p>At its core, <code class="language-plaintext highlighter-rouge">synchros2</code> is nothing but a collection of utilities and wrappers built on top of <a href="https://github.com/ros2/rclpy"><code class="language-plaintext highlighter-rouge">rclpy</code></a>. When used in concert, these utilities and wrappers simplify ROS 2 usage by enabling standard, idiomatic, synchronous Python programming. To that end, <code class="language-plaintext highlighter-rouge">synchros2</code> relies on heavy yet implicit concurrency and thus there is overhead in its simplicity.</p>

<h2 id="table-of-contents">Table of contents</h2>

<ul>
  <li>
<a href="https://github.com/bdaiinstitute/ros_utilities/tree/main/synchros2/#features">Features</a>
    <ul>
      <li><a href="https://github.com/bdaiinstitute/ros_utilities/tree/main/synchros2/#process-wide-apis">Process-wide APIs</a></li>
      <li><a href="https://github.com/bdaiinstitute/ros_utilities/tree/main/synchros2/#actionable-and-serviced-apis">Actionable and serviced APIs</a></li>
      <li><a href="https://github.com/bdaiinstitute/ros_utilities/tree/main/synchros2/#message-feed-apis">Message feed APIs</a></li>
    </ul>
  </li>
  <li>
<a href="https://github.com/bdaiinstitute/ros_utilities/tree/main/synchros2/#guidelines">Guidelines</a>
    <ul>
      <li><a href="https://github.com/bdaiinstitute/ros_utilities/tree/main/synchros2/#integration-testing">Integration testing</a></li>
    </ul>
  </li>
</ul>

<h2 id="features">Features</h2>

<h3 id="process-wide-apis">Process-wide APIs</h3>

<p>Process-wide APIs are built around the notion of a ROS 2 aware <em>scope</em>. ROS 2 aware scopes manage the lifetime of a
thread local graph of ROS 2 nodes, along with an executor that dispatches work for them. ROS 2 nodes may be
loaded and unloaded (i.e. instantiated and put to spin, and explicitly destroyed, respectively) or have their
entire lifecycle be managed (i.e. bound to a context manager). A ROS 2 aware scope may also define a main
ROS 2 node (for ease of use, for log forwarding, etc.). ROS 2 aware scopes may be nested, enforcing locality
of ROS 2 usage in a codebase, though the innermost scope is always accessible through <code class="language-plaintext highlighter-rouge">synchros2.scope</code>
module-level APIs.</p>

<p>A ROS 2 aware scope may also be process local (i.e. global within a process), which allows for the notion
of a ROS 2 aware <em>process</em>. Only one ROS 2 aware process may be active at any point in time as a top-level
scope i.e. a ROS 2 aware process may not start within an existing ROS 2 aware scope. The current ROS 2 aware
process and associated scope are always accessible process-wide through <code class="language-plaintext highlighter-rouge">synchros2.process</code>
module-level APIs.</p>

<p>These notions afford process-wide (and thread-wide) access to locally managed ROS 2 entities and thus ownership
and lifetime is well defined. Moreover, callbacks are dispatched in the background by default, enabling both
synchronous and asynchronous programming out-of-the-box.</p>

<p>These APIs are also quite handy to reconcile past <a href="http://wiki.ros.org/rospy"><code class="language-plaintext highlighter-rouge">rospy</code></a> experience with ROS 2.</p>

<h4 id="common-use-cases">Common use cases</h4>

<h5 id="setting-up-single-node-processes">Setting up single node processes</h5>

<p>To make use of ROS 2 without getting into the details, just decorate your executable entrypoint (or <code class="language-plaintext highlighter-rouge">main</code> function)
with <code class="language-plaintext highlighter-rouge">synchros2.process.main</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">logging</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="kn">import</span> <span class="n">synchros2.process</span> <span class="k">as</span> <span class="n">ros_process</span>

<span class="kn">import</span> <span class="n">std_msgs.msg</span>

<span class="nd">@ros_process.main</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">entrypoint</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="c1"># no need to initialize, it is automatic
</span>    <span class="n">node</span> <span class="o">=</span> <span class="n">ros_process</span><span class="p">.</span><span class="nf">node</span><span class="p">()</span>  <span class="c1"># or entrypoint.node
</span>    <span class="k">assert</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
    <span class="n">pub</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="nf">create_publisher</span><span class="p">(</span><span class="n">std_msgs</span><span class="p">.</span><span class="n">msg</span><span class="p">.</span><span class="n">String</span><span class="p">,</span> <span class="sh">"</span><span class="s">test</span><span class="sh">"</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">callback</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># you can block in a callback
</span>        <span class="n">pub</span><span class="p">.</span><span class="nf">publish</span><span class="p">(</span><span class="n">std_msgs</span><span class="p">.</span><span class="n">msg</span><span class="p">.</span><span class="nc">String</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="sh">"</span><span class="s">testing</span><span class="sh">"</span><span class="p">))</span>
    <span class="n">executor</span> <span class="o">=</span> <span class="n">ros_process</span><span class="p">.</span><span class="nf">executor</span><span class="p">()</span>  <span class="c1"># or entrypoint.executor
</span>    <span class="k">assert</span> <span class="n">executor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
    <span class="n">executor</span><span class="p">.</span><span class="nf">create_task</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>  <span class="c1"># dispatch callback for execution
</span>
    <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># you can block in the main thread
</span>
    <span class="n">node</span><span class="p">.</span><span class="nf">get_logger</span><span class="p">().</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">testing</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">logging</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">testing</span><span class="sh">"</span><span class="p">)</span>  <span class="c1"># you can use Python logging
</span>
    <span class="k">try</span><span class="p">:</span> 
        <span class="n">ros_process</span><span class="p">.</span><span class="nf">wait_for_shutdown</span><span class="p">()</span>  <span class="c1"># you can wait for Ctrl + C
</span>    <span class="k">except</span> <span class="nb">KeyboardInterrupt</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># to avoid traceback printing
</span>
    <span class="k">return</span>  <span class="c1"># no need to cleanup or shutdown, it is automatic
</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">entrypoint</span><span class="p">()</span>

</code></pre></div></div>

<p>Note a ROS 2 node and an executor are accessible process-wide through <code class="language-plaintext highlighter-rouge">synchros2.process</code> module APIs.
This is ideal for quick prototyping and simple scripts, as the UX is largely intuitive e.g. you can make blocking
calls from virtually anywhere.</p>

<h5 id="setting-up-multi-node-processes">Setting up multi-node processes</h5>

<p>You can spin as many ROS 2 nodes as you need, and skip the default process-wide node if unnecessary. Here’s an example that
loads three (3) ROS 2 nodes and spins them indefinitely:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">logging</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span>

<span class="kn">import</span> <span class="n">synchros2.process</span> <span class="k">as</span> <span class="n">ros_process</span>
<span class="kn">from</span> <span class="n">synchros2.node</span> <span class="kn">import</span> <span class="n">Node</span>

<span class="k">def</span> <span class="nf">graph</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Node</span><span class="p">]:</span>
    <span class="c1"># make sure to forward all keyword arguments for proper loading!
</span>    <span class="k">return</span> <span class="p">[</span><span class="nc">Node</span><span class="p">(</span><span class="sh">"</span><span class="s">my_node</span><span class="sh">"</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="nc">Node</span><span class="p">(</span><span class="sh">"</span><span class="s">my_other_node</span><span class="sh">"</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)]</span>

<span class="nd">@ros_process.main</span><span class="p">(</span><span class="n">prebaked</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">ros_process</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span> <span class="sh">"</span><span class="s">_hidden_node</span><span class="sh">"</span><span class="p">)</span>  <span class="c1"># or main.load
</span>    <span class="n">ros_process</span><span class="p">.</span><span class="nf">spin</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>  <span class="c1"># or main.spin, and it will block!
</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>

</code></pre></div></div>

<p>Note the use of ROS 2 node(s) factories, to load (or spin) entire collections at once.</p>

<h5 id="setting-up-interactive-multi-node-applications">Setting up interactive multi-node applications</h5>

<p>For interactive applications, you will most likely want to keep automatic spinning in place. Here’s an example that waits
for user input, sleeps for 5 seconds, and then echoes that user input from a callback without deadlocking:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">logging</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span>

<span class="kn">from</span> <span class="n">synchros2.futures</span> <span class="kn">import</span> <span class="n">wait_for_future</span>
<span class="kn">from</span> <span class="n">synchros2.node</span> <span class="kn">import</span> <span class="n">Node</span>
<span class="kn">import</span> <span class="n">synchros2.process</span> <span class="k">as</span> <span class="n">ros_process</span>

<span class="k">def</span> <span class="nf">graph</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Node</span><span class="p">]:</span>
    <span class="c1"># make sure to forward all keyword arguments for proper loading!
</span>    <span class="k">return</span> <span class="p">[</span><span class="nc">Node</span><span class="p">(</span><span class="sh">"</span><span class="s">my_node</span><span class="sh">"</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="nc">Node</span><span class="p">(</span><span class="sh">"</span><span class="s">my_other_node</span><span class="sh">"</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">work</span><span class="p">(</span><span class="n">prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">worker</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">ros_process</span><span class="p">.</span><span class="nf">node</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
        <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>  <span class="c1"># sleeping is safe!
</span>        <span class="n">node</span><span class="p">.</span><span class="nf">get_logger</span><span class="p">().</span><span class="nf">info</span><span class="p">(</span><span class="n">prompt</span> <span class="o">+</span> <span class="sh">"</span><span class="s"> done!</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">executor</span> <span class="o">=</span> <span class="n">ros_process</span><span class="p">.</span><span class="nf">executor</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">executor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
    <span class="n">future</span> <span class="o">=</span> <span class="n">executor</span><span class="p">.</span><span class="nf">create_task</span><span class="p">(</span><span class="n">worker</span><span class="p">)</span>  <span class="c1"># dispatch worker to executor
</span>    <span class="nf">wait_for_future</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>  <span class="c1"># block until worker is done
</span>
<span class="nd">@ros_process.main</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">ros_process</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>  <span class="c1"># or main.load
</span>    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="nf">work</span><span class="p">(</span><span class="nf">input</span><span class="p">())</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>

</code></pre></div></div>

<p>Note the use of <code class="language-plaintext highlighter-rouge">input</code> to read from <code class="language-plaintext highlighter-rouge">stdin</code>. This effectively prevents this executable from running with <code class="language-plaintext highlighter-rouge">launch</code>,
as <code class="language-plaintext highlighter-rouge">launch</code> does <strong>not</strong> pipe its own process <code class="language-plaintext highlighter-rouge">stdin</code> to that of any executed subprocess.</p>

<h5 id="setting-up-command-line-single-node-applications">Setting up command-line single node applications</h5>

<p>Command-line arguments may affect ROS 2 configuration if need be:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">argparse</span>
<span class="kn">import</span> <span class="n">logging</span>

<span class="kn">import</span> <span class="n">synchros2.process</span> <span class="k">as</span> <span class="n">ros_process</span>
<span class="kn">import</span> <span class="n">synchros2.scope</span> <span class="k">as</span> <span class="n">ros_scope</span>

<span class="k">class</span> <span class="nc">Application</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">robot_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">self</span><span class="p">.</span><span class="n">robot_name</span> <span class="o">=</span> <span class="n">robot_name</span>
        <span class="n">self</span><span class="p">.</span><span class="n">node</span> <span class="o">=</span> <span class="n">ros_scope</span><span class="p">.</span><span class="nf">node</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">cli</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="p">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="p">.</span><span class="nc">ArgumentParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="p">.</span><span class="nf">add_argument</span><span class="p">(</span><span class="sh">"</span><span class="s">robot_name</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">parser</span><span class="p">.</span><span class="nf">add_argument</span><span class="p">(</span><span class="sh">"</span><span class="s">-v</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">--verbose</span><span class="sh">"</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="sh">"</span><span class="s">store_true</span><span class="sh">"</span><span class="p">)</span>
    <span class="c1"># define ROS 2 aware process arguments based on CLI arguments
</span>    <span class="n">parser</span><span class="p">.</span><span class="nf">set_defaults</span><span class="p">(</span><span class="n">process_args</span><span class="o">=</span><span class="k">lambda</span> <span class="n">args</span><span class="p">:</span> <span class="nf">dict</span><span class="p">(</span><span class="n">forward_logging</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">verbose</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">parser</span>

<span class="nd">@ros_process.main</span><span class="p">(</span><span class="nf">cli</span><span class="p">(),</span> <span class="n">autospin</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="n">argparse</span><span class="p">.</span><span class="n">Namespace</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="nc">Application</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">robot_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">args</span><span class="p">.</span><span class="n">verbose</span><span class="p">:</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">()</span>
        <span class="n">root</span><span class="p">.</span><span class="nf">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="n">logging</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Application started!</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">ros_process</span><span class="p">.</span><span class="nf">spin</span><span class="p">()</span>  <span class="c1"># or main.spin
</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>

</code></pre></div></div>

<p>Note that process arguments are set via CLI. Also, note that a process-wide node is set explicitly (rather than implicitly).
The same can be done for process-wide executors. This allows fine grained control over ROS 2 configuration, which is useful
to those with special needs e.g. a custom main node (like in this case), a custom executor, etc.</p>

<h5 id="writing-ros-2-aware-libraries">Writing ROS 2 aware libraries</h5>

<p>You can use process-wide APIs to fetch ROS 2 defaults deep down call hierarchies, when passing nodes explicitly adds unnecessary clutter:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">time</span>

<span class="kn">import</span> <span class="n">synchros2.process</span> <span class="k">as</span> <span class="n">ros_process</span>
<span class="kn">import</span> <span class="n">synchros2.scope</span> <span class="k">as</span> <span class="n">ros_scope</span>
<span class="kn">from</span> <span class="n">synchros2.node</span> <span class="kn">import</span> <span class="n">Node</span>

<span class="k">class</span> <span class="nc">SomeFeature</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">self</span><span class="p">.</span><span class="n">node</span> <span class="o">=</span> <span class="n">ros_scope</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span> <span class="sh">"</span><span class="s">my_node</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">shutdown</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">ros_scope</span><span class="p">.</span><span class="nf">unload</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">node</span><span class="p">)</span>  <span class="c1"># or leave it behind until process ends
</span>
<span class="nd">@ros_process.main</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">feature</span> <span class="o">=</span> <span class="nc">SomeFeature</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">feature</span><span class="p">.</span><span class="nf">shutdown</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>

</code></pre></div></div>

<p>Note the use of <code class="language-plaintext highlighter-rouge">ros_scope</code> instead of <code class="language-plaintext highlighter-rouge">ros_process</code>. Both offer roughly the same APIs, but the former reaches out to the innermost scope,
whereas the latter presumes a process is active. Therefore, and as a rule of thumb, libraries should always use <code class="language-plaintext highlighter-rouge">synchros2.scope</code> APIs.
This will allow such libraries to work in more complex, multi-threaded, multi-scope applications, and simplify testing.</p>

<h5 id="writing-ros-2-aware-tests">Writing ROS 2 aware tests</h5>

<p>To write tests, set up a global ROS 2 aware scope instead of a process. Also, consider using namespaces to avoid default, hidden ROS 2 names.</p>

<p>Using <a href="https://docs.pytest.org/en/6.2.x/contents.html"><code class="language-plaintext highlighter-rouge">pytest</code></a> (recommended):</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">Iterator</span>

<span class="kn">import</span> <span class="n">synchros2.scope</span> <span class="k">as</span> <span class="n">ros_scope</span>
<span class="kn">from</span> <span class="n">synchros2.scope</span> <span class="kn">import</span> <span class="n">ROSAwareScope</span>

<span class="kn">import</span> <span class="n">pytest</span>

<span class="nd">@pytest.fixture</span>
<span class="k">def</span> <span class="nf">ros</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">ROSAwareScope</span><span class="p">]:</span>
    <span class="sh">"""</span><span class="s">
    A pytest fixture that will set up and yield a ROS 2 aware global scope to each test that requests it.

    See https://docs.pytest.org/en/6.2.x/fixture.html for a primer on pytest fixtures.
    </span><span class="sh">"""</span>
    <span class="k">with</span> <span class="n">ros_scope</span><span class="p">.</span><span class="nf">top</span><span class="p">(</span><span class="n">global_</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="sh">"</span><span class="s">fixture</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">top</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">top</span>

<span class="k">def</span> <span class="nf">test_it</span><span class="p">(</span><span class="n">ros</span><span class="p">:</span> <span class="n">ROSAwareScope</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="k">assert</span> <span class="n">ros</span><span class="p">.</span><span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
    <span class="n">ros</span><span class="p">.</span><span class="n">node</span><span class="p">.</span><span class="nf">get_logger</span><span class="p">().</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Logging!</span><span class="sh">"</span><span class="p">)</span>

</code></pre></div></div>

<p>Using <a href="https://docs.python.org/3/library/unittest.html"><code class="language-plaintext highlighter-rouge">unittest</code></a>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">unittest</span>

<span class="kn">import</span> <span class="n">synchros2.scope</span> <span class="k">as</span> <span class="n">ros_scope</span>

<span class="k">class</span> <span class="nc">TestCase</span><span class="p">(</span><span class="n">unittest</span><span class="p">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_it</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">ros_scope</span><span class="p">.</span><span class="nf">top</span><span class="p">(</span><span class="n">global_</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="sh">"</span><span class="s">fixture</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">ros</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">assertIsNotNone</span><span class="p">(</span><span class="n">ros</span><span class="p">.</span><span class="n">node</span><span class="p">)</span>
            <span class="n">ros</span><span class="p">.</span><span class="n">node</span><span class="p">.</span><span class="nf">get_logger</span><span class="p">().</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Logging!</span><span class="sh">"</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="actionable-and-serviced-apis">Actionable and serviced APIs</h3>

<p>These APIs wrap those in <a href="https://github.com/ros2/rclpy/tree/rolling/rclpy/rclpy/client.py"><code class="language-plaintext highlighter-rouge">rclpy.client</code></a> and <a href="https://github.com/ros2/rclpy/tree/rolling/rclpy/rclpy/action/client.py"><code class="language-plaintext highlighter-rouge">rclpy.action.client</code></a> to provide a simpler UX when dealing with ROS 2 actions and services.</p>

<p>Actionable and serviced APIs abstract ROS 2 action and service calls behind an interface that resembles that of remote procedure calls. These can be invoked either synchronously or asynchronously. When used asynchronously, serviced APIs return plain futures whereas actionable APIs return action futures. Action futures build on the notion of a future to track actions’ feedback, status, and result.</p>

<p>Both abstractions are well integrated with <a href="https://github.com/bdaiinstitute/ros_utilities/tree/main/synchros2/#process-wide-apis">ROS 2 aware scopes and processes</a>.</p>

<h4 id="common-use-cases-1">Common use cases</h4>

<p>The following snippets make use of standard ROS 2 <a href="https://index.ros.org/r/examples/github-ros2-examples"><code class="language-plaintext highlighter-rouge">examples</code></a> and <a href="https://index.ros.org/p/example_interfaces"><code class="language-plaintext highlighter-rouge">example_interfaces</code></a>.</p>

<h5 id="invoking-a-service-synchronously">Invoking a service synchronously</h5>

<p>You can use a serviced API as you would use any other callable:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">argparse</span>

<span class="kn">from</span> <span class="n">example_interfaces.srv</span> <span class="kn">import</span> <span class="n">AddTwoInts</span>

<span class="kn">from</span> <span class="n">synchros2.service</span> <span class="kn">import</span> <span class="n">Serviced</span><span class="p">,</span> <span class="n">ServiceTimeout</span><span class="p">,</span> <span class="n">ServiceError</span>
<span class="kn">import</span> <span class="n">synchros2.process</span> <span class="k">as</span> <span class="n">ros_process</span>

<span class="k">def</span> <span class="nf">cli</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="p">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="p">.</span><span class="nc">ArgumentParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="p">.</span><span class="nf">add_argument</span><span class="p">(</span><span class="sh">"</span><span class="s">a</span><span class="sh">"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">parser</span><span class="p">.</span><span class="nf">add_argument</span><span class="p">(</span><span class="sh">"</span><span class="s">b</span><span class="sh">"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parser</span>

<span class="nd">@ros_process.main</span><span class="p">(</span><span class="nf">cli</span><span class="p">())</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="n">argparse</span><span class="p">.</span><span class="n">Namespace</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">add_two_ints</span> <span class="o">=</span> <span class="nc">Serviced</span><span class="p">(</span><span class="n">AddTwoInts</span><span class="p">,</span> <span class="sh">"</span><span class="s">add_two_ints</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">add_two_ints</span><span class="p">.</span><span class="nf">wait_for_service</span><span class="p">(</span><span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">No </span><span class="si">{</span><span class="n">add_two_ints</span><span class="p">.</span><span class="n">service_name</span><span class="si">}</span><span class="s"> services found</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Computing </span><span class="si">{</span><span class="n">args</span><span class="p">.</span><span class="n">a</span><span class="si">}</span><span class="s"> + </span><span class="si">{</span><span class="n">args</span><span class="p">.</span><span class="n">b</span><span class="si">}</span><span class="s">...</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nf">add_two_ints</span><span class="p">(</span><span class="n">AddTwoInts</span><span class="p">.</span><span class="nc">Request</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">b</span><span class="p">),</span> <span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Result is</span><span class="sh">"</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="nb">sum</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ServiceTimeout</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Computation timed out</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ServiceError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Computation failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>

</code></pre></div></div>

<p><strong>Note</strong>: you may use servers in the <code class="language-plaintext highlighter-rouge">examples_rclpy_minimal_service</code> package to test this.</p>

<p>Serviced API calls are synchronous by default. This can also be made explicit by calling <code class="language-plaintext highlighter-rouge">synchronously()</code> on them instead e.g. <code class="language-plaintext highlighter-rouge">add_two_ints.synchronously()</code>.
All service outcomes other than nominal success are signaled using exceptions. An optional timeout prevents calling (and blocking on) a service request indefinitely.</p>

<h5 id="invoking-a-service-asynchronously">Invoking a service asynchronously</h5>

<p>You can get a future service response instead of blocking on call too:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">argparse</span>

<span class="kn">from</span> <span class="n">example_interfaces.srv</span> <span class="kn">import</span> <span class="n">AddTwoInts</span>

<span class="kn">from</span> <span class="n">synchros2.service</span> <span class="kn">import</span> <span class="n">Serviced</span>
<span class="kn">from</span> <span class="n">synchros2.futures</span> <span class="kn">import</span> <span class="n">wait_for_future</span>
<span class="kn">import</span> <span class="n">synchros2.process</span> <span class="k">as</span> <span class="n">ros_process</span>

<span class="k">def</span> <span class="nf">cli</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="p">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="p">.</span><span class="nc">ArgumentParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="p">.</span><span class="nf">add_argument</span><span class="p">(</span><span class="sh">"</span><span class="s">a</span><span class="sh">"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">parser</span><span class="p">.</span><span class="nf">add_argument</span><span class="p">(</span><span class="sh">"</span><span class="s">b</span><span class="sh">"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parser</span>

<span class="nd">@ros_process.main</span><span class="p">(</span><span class="nf">cli</span><span class="p">())</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="n">argparse</span><span class="p">.</span><span class="n">Namespace</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">add_two_ints</span> <span class="o">=</span> <span class="nc">Serviced</span><span class="p">(</span><span class="n">AddTwoInts</span><span class="p">,</span> <span class="sh">"</span><span class="s">add_two_ints</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">add_two_ints</span><span class="p">.</span><span class="nf">wait_for_service</span><span class="p">(</span><span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">No </span><span class="si">{</span><span class="n">add_two_ints</span><span class="p">.</span><span class="n">service_name</span><span class="si">}</span><span class="s"> services found</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Computing </span><span class="si">{</span><span class="n">args</span><span class="p">.</span><span class="n">a</span><span class="si">}</span><span class="s"> + </span><span class="si">{</span><span class="n">args</span><span class="p">.</span><span class="n">b</span><span class="si">}</span><span class="s">...</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">future</span> <span class="o">=</span> <span class="n">add_two_ints</span><span class="p">.</span><span class="nf">asynchronously</span><span class="p">(</span><span class="n">AddTwoInts</span><span class="p">.</span><span class="nc">Request</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">b</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nf">wait_for_future</span><span class="p">(</span><span class="n">future</span><span class="p">,</span> <span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Computation did not complete in time</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">future</span><span class="p">.</span><span class="nf">cancel</span><span class="p">()</span>
        <span class="k">return</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">future</span><span class="p">.</span><span class="nf">result</span><span class="p">()</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Result is</span><span class="sh">"</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="nb">sum</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>

</code></pre></div></div>

<p><strong>Note</strong>: you may use servers in the <code class="language-plaintext highlighter-rouge">examples_rclpy_minimal_service</code> package to test this.</p>

<p>Service response must be waited on, either explicitly and with a timeout or implicitly by early result request.
Note fetching the future call result may raise.</p>

<h5 id="invoking-an-action-synchronously">Invoking an action synchronously</h5>

<p>You can use an actionable API as you would use any other callable:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">argparse</span>

<span class="kn">from</span> <span class="n">example_interfaces.action</span> <span class="kn">import</span> <span class="n">Fibonacci</span>

<span class="kn">from</span> <span class="n">synchros2.action</span> <span class="kn">import</span> <span class="n">Actionable</span>
<span class="kn">from</span> <span class="n">synchros2.action</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ActionTimeout</span><span class="p">,</span> <span class="n">ActionRejected</span><span class="p">,</span> <span class="n">ActionCancelled</span><span class="p">,</span> <span class="n">ActionAborted</span>
<span class="p">)</span>
<span class="kn">import</span> <span class="n">synchros2.process</span> <span class="k">as</span> <span class="n">ros_process</span>

<span class="k">def</span> <span class="nf">cli</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="p">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="p">.</span><span class="nc">ArgumentParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="p">.</span><span class="nf">add_argument</span><span class="p">(</span><span class="sh">"</span><span class="s">order</span><span class="sh">"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parser</span>

<span class="nd">@ros_process.main</span><span class="p">(</span><span class="nf">cli</span><span class="p">())</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="n">argparse</span><span class="p">.</span><span class="n">Namespace</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">compute_fibonacci_sequence</span> <span class="o">=</span> <span class="nc">Actionable</span><span class="p">(</span><span class="n">Fibonacci</span><span class="p">,</span> <span class="sh">"</span><span class="s">fibonacci</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compute_fibonacci_sequence</span><span class="p">.</span><span class="nf">wait_for_server</span><span class="p">(</span><span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">No </span><span class="si">{</span><span class="n">compute_fibonacci_sequence</span><span class="p">.</span><span class="n">action_name</span><span class="si">}</span><span class="s"> action server found</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Computing Fibonacci sequence for order N = </span><span class="si">{</span><span class="n">args</span><span class="p">.</span><span class="n">order</span><span class="si">}</span><span class="s">...</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nf">compute_fibonacci_sequence</span><span class="p">(</span><span class="n">Fibonacci</span><span class="p">.</span><span class="nc">Goal</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">order</span><span class="p">),</span> <span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Sequence is</span><span class="sh">"</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">sequence</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ActionRejected</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Computation rejected</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ActionTimeout</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Computation timed out</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ActionAborted</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Computation aborted</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ActionCancelled</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Computation cancelled</span><span class="sh">"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>

</code></pre></div></div>

<p><strong>Note</strong>: you may use servers in the <code class="language-plaintext highlighter-rouge">examples_rclpy_minimal_action_server</code> package to test this.</p>

<p>Actionable API calls are synchronous by default. This can also be made explicit by calling <code class="language-plaintext highlighter-rouge">synchronously()</code> on them instead e.g. <code class="language-plaintext highlighter-rouge">compute_fibonacci_sequence.synchronously()</code>.
All action outcomes other than nominal success are signaled using exceptions. Action feedback is ignored unless a callback is specified on call.
An optional timeout prevents pursuing (and blocking on) an action indefinitely.</p>

<h5 id="invoking-an-action-asynchronously">Invoking an action asynchronously</h5>

<p>You can get a future to an ongoing action instead of blocking on it:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">argparse</span>

<span class="kn">from</span> <span class="n">example_interfaces.action</span> <span class="kn">import</span> <span class="n">Fibonacci</span>

<span class="kn">from</span> <span class="n">synchros2.action</span> <span class="kn">import</span> <span class="n">Actionable</span>
<span class="kn">from</span> <span class="n">synchros2.futures</span> <span class="kn">import</span> <span class="n">wait_for_future</span>
<span class="kn">import</span> <span class="n">synchros2.process</span> <span class="k">as</span> <span class="n">ros_process</span>

<span class="k">def</span> <span class="nf">cli</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="p">.</span><span class="n">ArgumentParser</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="p">.</span><span class="nc">ArgumentParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="p">.</span><span class="nf">add_argument</span><span class="p">(</span><span class="sh">"</span><span class="s">order</span><span class="sh">"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parser</span>

<span class="nd">@ros_process.main</span><span class="p">(</span><span class="nf">cli</span><span class="p">())</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="n">argparse</span><span class="p">.</span><span class="n">Namespace</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">compute_fibonacci_sequence</span> <span class="o">=</span> <span class="nc">Actionable</span><span class="p">(</span><span class="n">Fibonacci</span><span class="p">,</span> <span class="sh">"</span><span class="s">fibonacci</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compute_fibonacci_sequence</span><span class="p">.</span><span class="nf">wait_for_server</span><span class="p">(</span><span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">No </span><span class="si">{</span><span class="n">compute_fibonacci_sequence</span><span class="p">.</span><span class="n">action_name</span><span class="si">}</span><span class="s"> action server found</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Computing Fibonacci sequence for order N = </span><span class="si">{</span><span class="n">args</span><span class="p">.</span><span class="n">order</span><span class="si">}</span><span class="s">...</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">compute_fibonacci_sequence</span><span class="p">.</span><span class="nf">asynchronously</span><span class="p">(</span>
        <span class="n">Fibonacci</span><span class="p">.</span><span class="nc">Goal</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">order</span><span class="p">),</span> <span class="n">track_feedback</span><span class="o">=</span><span class="bp">True</span>
    <span class="p">)</span>
    <span class="nf">wait_for_future</span><span class="p">(</span><span class="n">action</span><span class="p">.</span><span class="n">acknowledgement</span><span class="p">,</span> <span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">action</span><span class="p">.</span><span class="n">acknowledged</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">action</span><span class="p">.</span><span class="n">accepted</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Computation rejected</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">for</span> <span class="n">feedback</span> <span class="ow">in</span> <span class="n">action</span><span class="p">.</span><span class="nf">feedback_stream</span><span class="p">(</span><span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Partial sequence is</span><span class="sh">"</span><span class="p">,</span> <span class="n">feedback</span><span class="p">.</span><span class="n">sequence</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nf">wait_for_future</span><span class="p">(</span><span class="n">action</span><span class="p">.</span><span class="n">finalization</span><span class="p">,</span> <span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Computation did not complete in time</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">action</span><span class="p">.</span><span class="nf">cancel</span><span class="p">()</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="n">action</span><span class="p">.</span><span class="n">succeeded</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Sequence is</span><span class="sh">"</span><span class="p">,</span> <span class="n">action</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">sequence</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">action</span><span class="p">.</span><span class="n">aborted</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Computation aborted</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">action</span><span class="p">.</span><span class="n">cancelled</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Computation cancelled</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Internal server error</span><span class="sh">"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>

</code></pre></div></div>

<p><strong>Note</strong>: you may use servers in the <code class="language-plaintext highlighter-rouge">examples_rclpy_minimal_action_server</code> package to test this.</p>

<p>Action status must be checked explicitly, and timely before attempting to access an action’s result or feedback (which may not be there yet).
Action acknowledgement and finalization futures can help synchronization. Action feedback streaming simplifies (soft) real-time action monitoring.</p>

<h3 id="message-feed-apis">Message feed APIs</h3>

<p>These APIs wrap <a href="https://index.ros.org/r/message_filters"><code class="language-plaintext highlighter-rouge">message_filters</code></a> to provide a simpler UX when dealing with streams of messages, including but not limited to ROS 2 topic subscriptions.</p>

<p>Message feeds are the stateful generalization of standard ROS 2 message filters. Any message filter can become a feed, allowing:</p>

<ul>
  <li>latest message retrieval</li>
  <li>message history retrieval</li>
  <li>message callback registration (and de-registration)</li>
  <li>message stream iteration as they arrive, one-by-one or in batches</li>
  <li>incoming message waits – any message or those matching a predicate</li>
</ul>

<p>Like message filters, most message feeds can be chained. This is true for all but those that externally source messages, ROS 2 topic subscriptions being the prime example of this. Other message feeds built into <code class="language-plaintext highlighter-rouge">synchros2</code> offer a vehicle for generic map-filter-reduce patterns, time synchronization across multiple message feeds, and synchronized <code class="language-plaintext highlighter-rouge">tf</code> lookups.</p>

<p>On word of caution. While any message filter can become a feed, standard ROS 2 message filters are usually not thread-safe. See <a href="https://github.com/bdaiinstitute/ros_utilities/tree/main/synchros2/synchros2/filters.py"><code class="language-plaintext highlighter-rouge">synchros2.filters</code></a> for thread-safe (re)implementations.</p>

<h4 id="common-use-cases-2">Common use cases</h4>

<p>The following snippets make use of standard ROS 2 <a href="https://index.ros.org/r/examples/github-ros2-examples"><code class="language-plaintext highlighter-rouge">examples</code></a>.
You may use the publishers in the <code class="language-plaintext highlighter-rouge">examples_rclpy_minimal_publisher</code> package to test these.</p>

<h5 id="looping-over-topic-messages">Looping over topic messages</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">contextlib</span> <span class="kn">import</span> <span class="n">closing</span>
<span class="kn">from</span> <span class="n">std_msgs.msg</span> <span class="kn">import</span> <span class="n">String</span>

<span class="kn">from</span> <span class="n">synchros2.subscription</span> <span class="kn">import</span> <span class="n">Subscription</span>
<span class="kn">import</span> <span class="n">synchros2.process</span> <span class="k">as</span> <span class="n">ros_process</span>

<span class="nd">@ros_process.main</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">topic_data</span> <span class="o">=</span> <span class="nc">Subscription</span><span class="p">(</span><span class="n">String</span><span class="p">,</span> <span class="sh">"</span><span class="s">topic</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">with</span> <span class="nf">closing</span><span class="p">(</span><span class="n">topic_data</span><span class="p">.</span><span class="nf">stream</span><span class="p">())</span> <span class="k">as</span> <span class="n">stream</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>

</code></pre></div></div>

<p>Note that the topic message stream is managed and closed explicitly by the <a href="https://docs.python.org/3/library/contextlib.html#contextlib.closing"><code class="language-plaintext highlighter-rouge">contextlib.closing</code></a> context manager. This is important to stop message buffering as soon as it is no longer necessary. This can be deferred to the <a href="https://docs.python.org/3/library/gc.html">garbage collector</a> but it may result in needless buffering for (much) longer.</p>

<h5 id="waiting-for-the-next-topic-message">Waiting for the next topic message</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">std_msgs.msg</span> <span class="kn">import</span> <span class="n">String</span>

<span class="kn">from</span> <span class="n">synchros2.subscription</span> <span class="kn">import</span> <span class="n">Subscription</span>
<span class="kn">from</span> <span class="n">synchros2.futures</span> <span class="kn">import</span> <span class="n">unwrap_future</span>
<span class="kn">import</span> <span class="n">synchros2.process</span> <span class="k">as</span> <span class="n">ros_process</span>

<span class="nd">@ros_process.main</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">topic_data</span> <span class="o">=</span> <span class="nc">Subscription</span><span class="p">(</span><span class="n">String</span><span class="p">,</span> <span class="sh">"</span><span class="s">topic</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">main</span><span class="p">.</span><span class="n">context</span><span class="p">.</span><span class="nf">ok</span><span class="p">():</span>
        <span class="n">message</span> <span class="o">=</span> <span class="nf">unwrap_future</span><span class="p">(</span><span class="n">topic_data</span><span class="p">.</span><span class="n">update</span><span class="p">,</span> <span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>

</code></pre></div></div>

<p>Note that the future update is <em>unwrapped</em> rather than waited on. If the future update does not become available in time, future unwrapping will raise.</p>

<h5 id="waiting-for-a-specific-topic-message">Waiting for a specific topic message</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">std_msgs.msg</span> <span class="kn">import</span> <span class="n">Int32</span>
<span class="kn">from</span> <span class="n">std_msgs.msg</span> <span class="kn">import</span> <span class="n">String</span>

<span class="kn">from</span> <span class="n">synchros2.subscription</span> <span class="kn">import</span> <span class="n">Subscription</span>
<span class="kn">from</span> <span class="n">synchros2.futures</span> <span class="kn">import</span> <span class="n">unwrap_future</span>
<span class="kn">import</span> <span class="n">synchros2.process</span> <span class="k">as</span> <span class="n">ros_process</span>

<span class="k">def</span> <span class="nf">to_int32</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Int32</span><span class="p">:</span>
    <span class="k">return</span> <span class="nc">Int32</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nf">int</span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="nf">rpartition</span><span class="p">(</span><span class="sh">"</span><span class="s"> </span><span class="sh">"</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

<span class="nd">@ros_process.main</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">topic_data</span> <span class="o">=</span> <span class="nc">Subscription</span><span class="p">(</span><span class="n">String</span><span class="p">,</span> <span class="sh">"</span><span class="s">topic</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">main</span><span class="p">.</span><span class="n">context</span><span class="p">.</span><span class="nf">ok</span><span class="p">():</span>
        <span class="n">message</span> <span class="o">=</span> <span class="nf">unwrap_future</span><span class="p">(</span><span class="n">topic_data</span><span class="p">.</span><span class="nf">matching_update</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">message</span><span class="p">:</span> <span class="nf">to_int32</span><span class="p">(</span><span class="n">message</span><span class="p">).</span><span class="n">data</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="p">),</span> <span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>

</code></pre></div></div>

<h5 id="setting-up-a-message-callback">Setting up a message callback</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">std_msgs.msg</span> <span class="kn">import</span> <span class="n">String</span>

<span class="kn">from</span> <span class="n">synchros2.subscription</span> <span class="kn">import</span> <span class="n">Subscription</span>
<span class="kn">import</span> <span class="n">synchros2.process</span> <span class="k">as</span> <span class="n">ros_process</span>

<span class="nd">@ros_process.main</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">topic_data</span> <span class="o">=</span> <span class="nc">Subscription</span><span class="p">(</span><span class="n">String</span><span class="p">,</span> <span class="sh">"</span><span class="s">topic</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">topic_data</span><span class="p">.</span><span class="nf">recall</span><span class="p">(</span><span class="k">lambda</span> <span class="n">message</span><span class="p">:</span> <span class="nf">print</span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">data</span><span class="p">))</span>
    <span class="n">main</span><span class="p">.</span><span class="nf">wait_for_shutdown</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>

</code></pre></div></div>

<h5 id="synchronizing-topic-messages">Synchronizing topic messages</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">contextlib</span> <span class="kn">import</span> <span class="n">closing</span>
<span class="kn">from</span> <span class="n">std_msgs.msg</span> <span class="kn">import</span> <span class="n">String</span>

<span class="kn">from</span> <span class="n">synchros2.feeds</span> <span class="kn">import</span> <span class="n">SynchronizedMessageFeed</span>
<span class="kn">from</span> <span class="n">synchros2.futures</span> <span class="kn">import</span> <span class="n">unwrap_future</span>
<span class="kn">from</span> <span class="n">synchros2.subscription</span> <span class="kn">import</span> <span class="n">Subscription</span>
<span class="kn">import</span> <span class="n">synchros2.process</span> <span class="k">as</span> <span class="n">ros_process</span>

<span class="nd">@ros_process.main</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">topics_data</span> <span class="o">=</span> <span class="nc">SynchronizedMessageFeed</span><span class="p">(</span>
        <span class="nc">Subscription</span><span class="p">(</span><span class="n">String</span><span class="p">,</span> <span class="sh">"</span><span class="s">topic0</span><span class="sh">"</span><span class="p">),</span>
        <span class="nc">Subscription</span><span class="p">(</span><span class="n">String</span><span class="p">,</span> <span class="sh">"</span><span class="s">topic1</span><span class="sh">"</span><span class="p">),</span>
        <span class="n">allow_headerless</span><span class="o">=</span><span class="bp">True</span>
    <span class="p">)</span>
    <span class="k">with</span> <span class="nf">closing</span><span class="p">(</span><span class="n">topics_data</span><span class="p">.</span><span class="nf">stream</span><span class="p">())</span> <span class="k">as</span> <span class="n">stream</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">a:</span><span class="sh">"</span><span class="p">,</span> <span class="n">a</span><span class="p">.</span><span class="n">data</span><span class="p">,</span> <span class="sh">"</span><span class="s">matches b:</span><span class="sh">"</span><span class="p">,</span> <span class="n">b</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>

</code></pre></div></div>

<h5 id="adapting-topic-messages">Adapting topic messages</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">contextlib</span> <span class="kn">import</span> <span class="n">closing</span>
<span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
<span class="kn">from</span> <span class="n">std_msgs.msg</span> <span class="kn">import</span> <span class="n">String</span>
<span class="kn">from</span> <span class="n">std_msgs.msg</span> <span class="kn">import</span> <span class="n">Int32</span>

<span class="kn">from</span> <span class="n">synchros2.feeds</span> <span class="kn">import</span> <span class="n">AdaptedMessageFeed</span>
<span class="kn">from</span> <span class="n">synchros2.subscription</span> <span class="kn">import</span> <span class="n">Subscription</span>
<span class="kn">import</span> <span class="n">synchros2.process</span> <span class="k">as</span> <span class="n">ros_process</span>

<span class="k">def</span> <span class="nf">to_int32</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Int32</span><span class="p">:</span>
    <span class="k">return</span> <span class="nc">Int32</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nf">int</span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="nf">rpartition</span><span class="p">(</span><span class="sh">"</span><span class="s"> </span><span class="sh">"</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

<span class="k">def</span> <span class="nf">keep_even</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="n">Int32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Int32</span><span class="p">]:</span>
    <span class="k">return</span> <span class="n">message</span> <span class="k">if</span> <span class="n">message</span><span class="p">.</span><span class="n">data</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">None</span>

<span class="nd">@ros_process.main</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">topic_data</span> <span class="o">=</span> <span class="nc">AdaptedMessageFeed</span><span class="p">(</span>
        <span class="nc">Subscription</span><span class="p">(</span><span class="n">String</span><span class="p">,</span> <span class="sh">"</span><span class="s">topic</span><span class="sh">"</span><span class="p">),</span>
        <span class="k">lambda</span> <span class="n">msg</span><span class="p">:</span> <span class="nf">keep_even</span><span class="p">(</span><span class="nf">to_int32</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="k">with</span> <span class="nf">closing</span><span class="p">(</span><span class="n">topic_data</span><span class="p">.</span><span class="nf">stream</span><span class="p">())</span> <span class="k">as</span> <span class="n">stream</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>

</code></pre></div></div>

<p>Note that the adapter logic not only transforms the message type but also filters them. Returning <code class="language-plaintext highlighter-rouge">None</code> stops message propagation down the chain of message feeds.</p>

<h5 id="fetch-the-last-10-topic-messages">Fetch the last 10 topic messages</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">contextlib</span> <span class="kn">import</span> <span class="n">closing</span>

<span class="kn">from</span> <span class="n">std_msgs.msg</span> <span class="kn">import</span> <span class="n">String</span>

<span class="kn">from</span> <span class="n">synchros2.subscription</span> <span class="kn">import</span> <span class="n">Subscription</span>
<span class="kn">from</span> <span class="n">synchros2.time</span> <span class="kn">import</span> <span class="n">Duration</span>
<span class="kn">import</span> <span class="n">synchros2.process</span> <span class="k">as</span> <span class="n">ros_process</span>

<span class="nd">@ros_process.main</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">clock</span> <span class="o">=</span> <span class="n">main</span><span class="p">.</span><span class="n">node</span><span class="p">.</span><span class="nf">get_clock</span><span class="p">()</span>
    <span class="k">with</span> <span class="nf">closing</span><span class="p">(</span><span class="nc">Subscription</span><span class="p">(</span><span class="n">String</span><span class="p">,</span> <span class="sh">"</span><span class="s">topic</span><span class="sh">"</span><span class="p">,</span> <span class="n">history_length</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span> <span class="k">as</span> <span class="n">topic_data</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Waiting for 5 seconds...</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">clock</span><span class="p">.</span><span class="nf">sleep_until</span><span class="p">(</span><span class="n">clock</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span> <span class="o">+</span> <span class="nc">Duration</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mf">5.0</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">topic_data</span><span class="p">.</span><span class="n">history</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>

</code></pre></div></div>

<h3 id="logging-interoperability">Logging interoperability</h3>

<p>To facilitate logging, <code class="language-plaintext highlighter-rouge">synchros2</code> include functionality to bridge code using Python standard <a href="https://docs.python.org/3/library/logging.html"><code class="language-plaintext highlighter-rouge">logging</code></a> with the ROS 2 logging system.</p>

<h4 id="api-review">API review</h4>

<h5 id="standard-logging">Standard <code class="language-plaintext highlighter-rouge">logging</code>
</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">logging</span>

<span class="n">logging</span><span class="p">.</span><span class="nf">basicConfig</span><span class="p">()</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Logged using standard logging</span><span class="sh">"</span><span class="p">)</span>

</code></pre></div></div>

<p>These logs will be handled by Python’s standard <code class="language-plaintext highlighter-rouge">logging</code> module (i.e. printed to console).</p>

<h5 id="standalone-rclpy-logging">Standalone <code class="language-plaintext highlighter-rouge">rclpy</code> logging</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">rclpy.logging</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">rclpy</span><span class="p">.</span><span class="n">logging</span><span class="p">.</span><span class="nf">get_logger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">set_level</span><span class="p">(</span><span class="n">rclpy</span><span class="p">.</span><span class="n">logging</span><span class="p">.</span><span class="n">LoggingSeverity</span><span class="p">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Logged using a standalone rclpy logger</span><span class="sh">"</span><span class="p">)</span>

</code></pre></div></div>

<p>These logs will be ultimately handled by <code class="language-plaintext highlighter-rouge">rcutils</code> logging system (i.e. printed to console, perhaps forwarded to <code class="language-plaintext highlighter-rouge">spdlog</code>).</p>

<h6 id="rclpy-node-logging">
<code class="language-plaintext highlighter-rouge">rclpy</code> node logging</h6>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">rclpy</span>
<span class="kn">import</span> <span class="n">rclpy.logging</span>

<span class="n">node</span> <span class="o">=</span> <span class="n">rclpy</span><span class="p">.</span><span class="nf">create_node</span><span class="p">(</span><span class="sh">"</span><span class="s">my_node</span><span class="sh">"</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="nf">get_logger</span><span class="p">()</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">set_level</span><span class="p">(</span><span class="n">rclpy</span><span class="p">.</span><span class="n">logging</span><span class="p">.</span><span class="n">LoggingSeverity</span><span class="p">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Logged using an rclpy node logger</span><span class="sh">"</span><span class="p">)</span>

</code></pre></div></div>

<p>These logs will be ultimately handled by <code class="language-plaintext highlighter-rouge">rcutils</code> logging system too, but will also be published to <code class="language-plaintext highlighter-rouge">/rosout</code>.</p>

<h4 id="log-bridging">Log bridging</h4>

<p>Managing multiple, independent logging systems is impractical. So is reworking a codebase to accommodate either. To avoid both scenarios, use <code class="language-plaintext highlighter-rouge">synchros2.logging.logs_to_ros</code> explicitly:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">logging</span>
<span class="kn">import</span> <span class="n">rclpy</span>

<span class="kn">from</span> <span class="n">synchros2.logging</span> <span class="kn">import</span> <span class="n">logs_to_ros</span>

<span class="n">node</span> <span class="o">=</span> <span class="n">rclpy</span><span class="p">.</span><span class="nf">create_node</span><span class="p">(</span><span class="sh">"</span><span class="s">my_node</span><span class="sh">"</span><span class="p">)</span>
<span class="k">with</span> <span class="nf">logs_to_ros</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="nf">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
    <span class="n">logger</span><span class="p">.</span><span class="nf">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Logged using standard logging</span><span class="sh">"</span><span class="p">)</span>

</code></pre></div></div>

<p>or implicitly through <a href="https://github.com/bdaiinstitute/ros_utilities/tree/main/synchros2/#process-wide-apis">process-wide APIs</a>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import logging

from synchros2.process as ros_process

@ros_process.main<span class="o">()</span>
def main<span class="o">()</span>:
    logger <span class="o">=</span> logging.getLogger<span class="o">(</span>__name__<span class="o">)</span>
    logger.setLevel<span class="o">(</span>logging.INFO<span class="o">)</span>
    logger.info<span class="o">(</span><span class="s2">"Logged using standard logging"</span><span class="o">)</span>

<span class="k">if </span>__name__ <span class="o">==</span> <span class="s2">"__main__"</span>:
    main<span class="o">()</span>    

</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">logging</code> logs will propagate up the logger hierarchy and then forwarded to the logger of the corresponding node (the one provided in the first case, or the main prebaked node in the second case) and thus at least printed to console and published to <code class="language-plaintext highlighter-rouge">/rosout</code>. Note the above presumes that severity levels at every step of the way are such that the corresponding log will get through (in this example, INFO or below for both <code class="language-plaintext highlighter-rouge">logging</code> and ROS 2 logging system).</p>

<h2 id="guidelines">Guidelines</h2>

<h3 id="integration-testing">Integration testing</h3>

<p>Unit testing ROS 2 code is no different from unit testing any other software, but some care must be exercised.</p>

<h4 id="considerations-for-integration-testing">Considerations for integration testing</h4>

<ul>
  <li>Data transport in ROS 2 is non-deterministic. So is callback execution when multi-threaded executors are in place. This is true for ROS 2 code in general, and for <a href="https://github.com/bdaiinstitute/ros_utilities/tree/main/synchros2/#process-wide-apis">process-wide APIs</a> in particular, for which non-determinism is the price to pay for a synchronous programming model. As such, time sensitive and execution order dependent tests are bound to fail, even if only sporadically. Synchronization is necessary to avoid these issues, and fortunately the very same process-wide APIs enable safe use of synchronization primitives (e.g. via a multi-threaded executor spinning in a background thread, as provided by <a href="https://github.com/bdaiinstitute/ros_utilities/blob/main/synchros2/synchros2/scope.py"><code class="language-plaintext highlighter-rouge">bdai_ros_wrappers.scope</code></a> functionality).</li>
  <li>ROS 2 middlewares perform peer discovery by default. This allows distributed architectures in production but leads to cross-talk during parallelized testing. <a href="https://github.com/ros2/ament_cmake_ros/tree/rolling/domain_coordinator"><code class="language-plaintext highlighter-rouge">domain_coordinator</code></a> functionality simplifies <a href="https://docs.ros.org/en/rolling/Concepts/Intermediate/About-Domain-ID.html">ROS domain ID</a> assignment enforcing host-wide uniqueness and with it, middleware isolation.</li>
</ul>

<p>Therefore, as rules of thumb consider:</p>

<ol>
  <li>Using <code class="language-plaintext highlighter-rouge">synchros2.scope.top</code> to setup ROS 2 in your test fixtures.
    <ul>
      <li>Isolate it by passing a unique domain ID, as provided by <code class="language-plaintext highlighter-rouge">domain_coordinator.domain_id</code>.</li>
    </ul>
  </li>
  <li>Using synchronization primitives to wait with timeouts.
    <ul>
      <li>Note timeouts make the test time sensitive. Pick timeouts an order of magnitude above the expected test timing.</li>
    </ul>
  </li>
</ol>

<h4 id="writing-integration-tests-using-pytest-recommended">Writing integration tests using <code class="language-plaintext highlighter-rouge">pytest</code> (recommended)</h4>

<p><a href="https://docs.pytest.org/en/7.4.x/"><code class="language-plaintext highlighter-rouge">pytest</code></a> is a testing framework for Python software, the most common in ROS 2 Python codebases.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">domain_coordinator</span>
<span class="kn">import</span> <span class="n">pytest</span>

<span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">Iterator</span>

<span class="kn">import</span> <span class="n">synchros2.scope</span> <span class="k">as</span> <span class="n">ros_scope</span>
<span class="kn">from</span> <span class="n">synchros2.action_client</span> <span class="kn">import</span> <span class="n">ActionClientWrapper</span>
<span class="kn">from</span> <span class="n">synchros2.futures</span> <span class="kn">import</span> <span class="n">wait_for_future</span>
<span class="kn">from</span> <span class="n">synchros2.scope</span> <span class="kn">import</span> <span class="n">ROSAwareScope</span>
<span class="kn">from</span> <span class="n">synchros2.single_goal_action_server</span> <span class="kn">import</span> <span class="n">SingleGoalActionServer</span>
<span class="kn">from</span> <span class="n">synchros2.subscription</span> <span class="kn">import</span> <span class="n">wait_for_message</span>

<span class="kn">from</span> <span class="n">std_msgs.msg</span> <span class="kn">import</span> <span class="n">String</span>
<span class="kn">from</span> <span class="n">std_srvs.srv</span> <span class="kn">import</span> <span class="n">Trigger</span>
<span class="kn">from</span> <span class="n">example_interfaces.action</span> <span class="kn">import</span> <span class="n">Fibonacci</span>

<span class="kn">from</span> <span class="n">rclpy.action.server</span> <span class="kn">import</span> <span class="n">ServerGoalHandle</span>
<span class="kn">from</span> <span class="n">rclpy.qos</span> <span class="kn">import</span> <span class="n">QoSProfile</span><span class="p">,</span> <span class="n">HistoryPolicy</span><span class="p">,</span> <span class="n">DurabilityPolicy</span>

<span class="nd">@pytest.fixture</span>
<span class="k">def</span> <span class="nf">ros</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">ROSAwareScope</span><span class="p">]:</span>
    <span class="sh">"""</span><span class="s">
    A pytest fixture that will set up and yield a ROS 2 aware global scope to each test that requests it.

    See https://docs.pytest.org/en/7.4.x/fixture.html for a primer on pytest fixtures.
    </span><span class="sh">"""</span>
    <span class="k">with</span> <span class="n">domain_coordinator</span><span class="p">.</span><span class="nf">domain_id</span><span class="p">()</span> <span class="k">as</span> <span class="n">domain_id</span><span class="p">:</span>  <span class="c1"># to ensure node isolation 
</span>        <span class="k">with</span> <span class="n">ros_scope</span><span class="p">.</span><span class="nf">top</span><span class="p">(</span><span class="n">global_</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="sh">"</span><span class="s">fixture</span><span class="sh">"</span><span class="p">,</span> <span class="n">domain_id</span><span class="o">=</span><span class="n">domain_id</span><span class="p">)</span> <span class="k">as</span> <span class="n">top</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">top</span>

<span class="k">def</span> <span class="nf">test_topic_pub_sub</span><span class="p">(</span><span class="n">ros</span><span class="p">:</span> <span class="n">ROSAwareScope</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">Asserts that a published message can be received on the other end.</span><span class="sh">"""</span>
    <span class="n">qos_profile</span> <span class="o">=</span> <span class="nc">QoSProfile</span><span class="p">(</span>
        <span class="n">depth</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">history</span><span class="o">=</span><span class="n">HistoryPolicy</span><span class="p">.</span><span class="n">KEEP_LAST</span><span class="p">,</span>
        <span class="n">durability</span><span class="o">=</span><span class="n">DurabilityPolicy</span><span class="p">.</span><span class="n">TRANSIENT_LOCAL</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">pub</span> <span class="o">=</span> <span class="n">ros</span><span class="p">.</span><span class="n">node</span><span class="p">.</span><span class="nf">create_publisher</span><span class="p">(</span><span class="n">String</span><span class="p">,</span> <span class="sh">"</span><span class="s">test</span><span class="sh">"</span><span class="p">,</span> <span class="n">qos_profile</span><span class="p">)</span>
    <span class="n">pub</span><span class="p">.</span><span class="nf">publish</span><span class="p">(</span><span class="nc">String</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="sh">"</span><span class="s">test</span><span class="sh">"</span><span class="p">))</span>
    <span class="c1"># Message will arrive at an unspecified point in the future, thus
</span>    <span class="k">assert</span> <span class="nf">wait_for_message</span><span class="p">(</span><span class="n">String</span><span class="p">,</span> <span class="sh">"</span><span class="s">test</span><span class="sh">"</span><span class="p">,</span> <span class="n">qos_profile</span><span class="o">=</span><span class="n">qos_profile</span><span class="p">,</span> <span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">test_service_server_client</span><span class="p">(</span><span class="n">ros</span><span class="p">:</span> <span class="n">ROSAwareScope</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">Asserts that a service server replies to client requests.</span><span class="sh">"""</span>
    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="n">_</span><span class="p">:</span> <span class="n">Trigger</span><span class="p">.</span><span class="n">Request</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="n">Trigger</span><span class="p">.</span><span class="n">Response</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Trigger</span><span class="p">.</span><span class="n">Response</span><span class="p">:</span>
        <span class="n">response</span><span class="p">.</span><span class="n">success</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="n">response</span>
    <span class="n">server</span> <span class="o">=</span> <span class="n">ros</span><span class="p">.</span><span class="n">node</span><span class="p">.</span><span class="nf">create_service</span><span class="p">(</span><span class="n">Trigger</span><span class="p">,</span> <span class="sh">"</span><span class="s">trigger</span><span class="sh">"</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">ros</span><span class="p">.</span><span class="n">node</span><span class="p">.</span><span class="nf">create_client</span><span class="p">(</span><span class="n">Trigger</span><span class="p">,</span> <span class="sh">"</span><span class="s">trigger</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">client</span><span class="p">.</span><span class="nf">wait_for_service</span><span class="p">(</span><span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
    <span class="n">future</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="nf">call_async</span><span class="p">(</span><span class="n">Trigger</span><span class="p">.</span><span class="nc">Request</span><span class="p">())</span>
    <span class="k">assert</span> <span class="nf">wait_for_future</span><span class="p">(</span><span class="n">future</span><span class="p">,</span> <span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">future</span><span class="p">.</span><span class="nf">result</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">response</span> <span class="ow">and</span> <span class="n">response</span><span class="p">.</span><span class="n">success</span>

<span class="k">def</span> <span class="nf">test_action_server_client</span><span class="p">(</span><span class="n">ros</span><span class="p">:</span> <span class="n">ROSAwareScope</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">Asserts that an action server reacts to action client requests.</span><span class="sh">"""</span>
    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="n">goal_handle</span><span class="p">:</span> <span class="n">ServerGoalHandle</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Fibonacci</span><span class="p">.</span><span class="n">Result</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">Fibonacci</span><span class="p">.</span><span class="nc">Result</span><span class="p">()</span>
        <span class="n">result</span><span class="p">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">goal_handle</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">order</span><span class="p">):</span>
            <span class="n">result</span><span class="p">.</span><span class="n">sequence</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">sequence</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">result</span><span class="p">.</span><span class="n">sequence</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">goal_handle</span><span class="p">.</span><span class="nf">succeed</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="n">server</span> <span class="o">=</span> <span class="nc">SingleGoalActionServer</span><span class="p">(</span><span class="n">ros</span><span class="p">.</span><span class="n">node</span><span class="p">,</span> <span class="n">Fibonacci</span><span class="p">,</span> <span class="sh">"</span><span class="s">compute</span><span class="sh">"</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
    <span class="n">client</span> <span class="o">=</span> <span class="nc">ActionClientWrapper</span><span class="p">(</span><span class="n">Fibonacci</span><span class="p">,</span> <span class="sh">"</span><span class="s">compute</span><span class="sh">"</span><span class="p">,</span> <span class="n">ros</span><span class="p">.</span><span class="n">node</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">client</span><span class="p">.</span><span class="nf">wait_for_server</span><span class="p">(</span><span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
    <span class="n">goal</span> <span class="o">=</span> <span class="n">Fibonacci</span><span class="p">.</span><span class="nc">Goal</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="nf">send_goal_and_wait</span><span class="p">(</span><span class="sh">"</span><span class="s">compute</span><span class="sh">"</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">result</span> <span class="ow">and</span> <span class="nf">list</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">sequence</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

</code></pre></div></div>

<h4 id="writing-integration-tests-using-unittest">Writing integration tests using <code class="language-plaintext highlighter-rouge">unittest</code>
</h4>

<p><a href="https://docs.python.org/3/library/unittest.html"><code class="language-plaintext highlighter-rouge">unittest</code></a> is the testing framework in Python’s standard library.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">contextlib</span>
<span class="kn">import</span> <span class="n">domain_coordinator</span>
<span class="kn">import</span> <span class="n">unittest</span>

<span class="kn">import</span> <span class="n">synchros2.scope</span> <span class="k">as</span> <span class="n">ros_scope</span>
<span class="kn">from</span> <span class="n">synchros2.action_client</span> <span class="kn">import</span> <span class="n">ActionClientWrapper</span>
<span class="kn">from</span> <span class="n">synchros2.futures</span> <span class="kn">import</span> <span class="n">wait_for_future</span>
<span class="kn">from</span> <span class="n">synchros2.scope</span> <span class="kn">import</span> <span class="n">ROSAwareScope</span>
<span class="kn">from</span> <span class="n">synchros2.single_goal_action_server</span> <span class="kn">import</span> <span class="n">SingleGoalActionServer</span>
<span class="kn">from</span> <span class="n">synchros2.subscription</span> <span class="kn">import</span> <span class="n">wait_for_message</span>

<span class="kn">from</span> <span class="n">std_msgs.msg</span> <span class="kn">import</span> <span class="n">String</span>
<span class="kn">from</span> <span class="n">std_srvs.srv</span> <span class="kn">import</span> <span class="n">Trigger</span>
<span class="kn">from</span> <span class="n">example_interfaces.action</span> <span class="kn">import</span> <span class="n">Fibonacci</span>

<span class="kn">from</span> <span class="n">rclpy.action.server</span> <span class="kn">import</span> <span class="n">ServerGoalHandle</span>
<span class="kn">from</span> <span class="n">rclpy.qos</span> <span class="kn">import</span> <span class="n">QoSProfile</span><span class="p">,</span> <span class="n">HistoryPolicy</span><span class="p">,</span> <span class="n">DurabilityPolicy</span>

<span class="k">class</span> <span class="nc">TestCase</span><span class="p">(</span><span class="n">unittest</span><span class="p">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="sh">"""</span><span class="s">Sets up an isolated ROS 2 aware scope for all tests in the test case.</span><span class="sh">"""</span>
        <span class="n">self</span><span class="p">.</span><span class="n">fixture</span> <span class="o">=</span> <span class="n">contextlib</span><span class="p">.</span><span class="nc">ExitStack</span><span class="p">()</span>
        <span class="n">domain_id</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">fixture</span><span class="p">.</span><span class="nf">enter_context</span><span class="p">(</span><span class="n">domain_coordinator</span><span class="p">.</span><span class="nf">domain_id</span><span class="p">())</span>
        <span class="n">self</span><span class="p">.</span><span class="n">ros</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">fixture</span><span class="p">.</span><span class="nf">enter_context</span><span class="p">(</span><span class="n">ros_scope</span><span class="p">.</span><span class="nf">top</span><span class="p">(</span>
            <span class="n">global_</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="sh">"</span><span class="s">fixture</span><span class="sh">"</span><span class="p">,</span> <span class="n">domain_id</span><span class="o">=</span><span class="n">domain_id</span>
        <span class="p">))</span>

    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">self</span><span class="p">.</span><span class="n">fixture</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>  <span class="c1"># exits all contexts
</span>
    <span class="k">def</span> <span class="nf">test_topic_pub_sub</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="sh">"""</span><span class="s">Asserts that a published message can be received on the other end.</span><span class="sh">"""</span>
        <span class="n">qos_profile</span> <span class="o">=</span> <span class="nc">QoSProfile</span><span class="p">(</span>
            <span class="n">depth</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
            <span class="n">history</span><span class="o">=</span><span class="n">HistoryPolicy</span><span class="p">.</span><span class="n">KEEP_LAST</span><span class="p">,</span>
            <span class="n">durability</span><span class="o">=</span><span class="n">DurabilityPolicy</span><span class="p">.</span><span class="n">TRANSIENT_LOCAL</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">pub</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">ros</span><span class="p">.</span><span class="n">node</span><span class="p">.</span><span class="nf">create_publisher</span><span class="p">(</span><span class="n">String</span><span class="p">,</span> <span class="sh">"</span><span class="s">test</span><span class="sh">"</span><span class="p">,</span> <span class="n">qos_profile</span><span class="p">)</span>
        <span class="n">pub</span><span class="p">.</span><span class="nf">publish</span><span class="p">(</span><span class="nc">String</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="sh">"</span><span class="s">test</span><span class="sh">"</span><span class="p">))</span>
        <span class="c1"># Message will arrive at an unspecified point in the future, thus
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">assertIsNotNone</span><span class="p">(</span><span class="nf">wait_for_message</span><span class="p">(</span>
            <span class="n">String</span><span class="p">,</span> <span class="sh">"</span><span class="s">test</span><span class="sh">"</span><span class="p">,</span> <span class="n">qos_profile</span><span class="o">=</span><span class="n">qos_profile</span><span class="p">,</span> <span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_service_server_client</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="sh">"""</span><span class="s">Asserts that a service server replies to client requests.</span><span class="sh">"""</span>
        <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="n">_</span><span class="p">:</span> <span class="n">Trigger</span><span class="p">.</span><span class="n">Request</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="n">Trigger</span><span class="p">.</span><span class="n">Response</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Trigger</span><span class="p">.</span><span class="n">Response</span><span class="p">:</span>
            <span class="n">response</span><span class="p">.</span><span class="n">success</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">return</span> <span class="n">response</span>
        <span class="n">server</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">ros</span><span class="p">.</span><span class="n">node</span><span class="p">.</span><span class="nf">create_service</span><span class="p">(</span><span class="n">Trigger</span><span class="p">,</span> <span class="sh">"</span><span class="s">trigger</span><span class="sh">"</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">ros</span><span class="p">.</span><span class="n">node</span><span class="p">.</span><span class="nf">create_client</span><span class="p">(</span><span class="n">Trigger</span><span class="p">,</span> <span class="sh">"</span><span class="s">trigger</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">assertTrue</span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="nf">wait_for_service</span><span class="p">(</span><span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">))</span>
        <span class="n">future</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="nf">call_async</span><span class="p">(</span><span class="n">Trigger</span><span class="p">.</span><span class="nc">Request</span><span class="p">())</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">assertTrue</span><span class="p">(</span><span class="nf">wait_for_future</span><span class="p">(</span><span class="n">future</span><span class="p">,</span> <span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">))</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">future</span><span class="p">.</span><span class="nf">result</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">assertIsNotNone</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">assertTrue</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">success</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_action_server_client</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="sh">"""</span><span class="s">Asserts that an action server reacts to action client requests.</span><span class="sh">"""</span>
        <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="n">goal_handle</span><span class="p">:</span> <span class="n">ServerGoalHandle</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Fibonacci</span><span class="p">.</span><span class="n">Result</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Fibonacci</span><span class="p">.</span><span class="nc">Result</span><span class="p">()</span>
            <span class="n">result</span><span class="p">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">goal_handle</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">order</span><span class="p">):</span>
                <span class="n">result</span><span class="p">.</span><span class="n">sequence</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">sequence</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">result</span><span class="p">.</span><span class="n">sequence</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">goal_handle</span><span class="p">.</span><span class="nf">succeed</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="n">server</span> <span class="o">=</span> <span class="nc">SingleGoalActionServer</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">ros</span><span class="p">.</span><span class="n">node</span><span class="p">,</span> <span class="n">Fibonacci</span><span class="p">,</span> <span class="sh">"</span><span class="s">compute</span><span class="sh">"</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="n">client</span> <span class="o">=</span> <span class="nc">ActionClientWrapper</span><span class="p">(</span><span class="n">Fibonacci</span><span class="p">,</span> <span class="sh">"</span><span class="s">compute</span><span class="sh">"</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">ros</span><span class="p">.</span><span class="n">node</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">assertTrue</span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="nf">wait_for_server</span><span class="p">(</span><span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">))</span>
        <span class="n">goal</span> <span class="o">=</span> <span class="n">Fibonacci</span><span class="p">.</span><span class="nc">Goal</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="nf">send_goal_and_wait</span><span class="p">(</span><span class="sh">"</span><span class="s">compute</span><span class="sh">"</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">timeout_sec</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">assertIsNotNone</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">assertEqual</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">sequence</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

</code></pre></div></div>

<h4 id="adding-integration-tests-to-a-package">Adding integration tests to a package</h4>

<p>A package’s type and build system dictate how unit tests are to be added. Unit tests for ROS 2 packages are typically hosted under the <code class="language-plaintext highlighter-rouge">test</code> subdirectory, so the following assumes this convention is observed.</p>

<p>For <code class="language-plaintext highlighter-rouge">ament_cmake</code> packages, the <code class="language-plaintext highlighter-rouge">CMakeLists.txt</code> file should have:</p>

<div class="language-cmake highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">if</span><span class="p">(</span>BUILD_TESTING<span class="p">)</span>
    <span class="nb">find_package</span><span class="p">(</span>ament_cmake_pytest REQUIRED<span class="p">)</span>
    <span class="c1"># Define an arbitrary target for your tests such as:</span>
    <span class="nf">ament_add_pytest_test</span><span class="p">(</span>unit_tests test<span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>

</code></pre></div></div>

<p>For <code class="language-plaintext highlighter-rouge">ament_python</code> packages, the <code class="language-plaintext highlighter-rouge">setup.py</code> file should have:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">setup</span><span class="p">(</span>
    <span class="c1"># ...
</span>    <span class="n">tests_require</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">pytest</span><span class="sh">'</span><span class="p">],</span>
<span class="p">)</span>

</code></pre></div></div>

<p>Note that <code class="language-plaintext highlighter-rouge">pytest</code> is the testing tool of choice regardless of package type.</p>

<p><strong>Note</strong>: <a href="https://docs.pytest.org/en/7.4.x/explanation/goodpractices.html#conventions-for-python-test-discovery">test discovery mechanisms in <code class="language-plaintext highlighter-rouge">pytest</code></a> do not require <code class="language-plaintext highlighter-rouge">__init__.py</code> files under <code class="language-plaintext highlighter-rouge">test</code> directories.</p>

<h4 id="useful-references">Useful references</h4>

<ul>
  <li><a href="https://docs.ros.org/en/rolling/Tutorials/Intermediate/Testing/Testing-Main.html">Official ROS 2 testing tutorial</a></li>
  <li><a href="https://pytest.org"><code class="language-plaintext highlighter-rouge">pytest</code> documentation</a></li>
  <li><a href="https://docs.python.org/3/library/unittest.html"><code class="language-plaintext highlighter-rouge">unittest</code> documentation</a></li>
</ul>
</div>
              </div>
            </div>
          </div>
        </div>
      
    
    <div class="row">
      <div class="col-xs-12">
        <div class="panel panel-default">
          <div class="panel-heading"><span class="glyphicon glyphicon-list"></span> CHANGELOG</div>
          <div class="panel-body">
            
              <em>No CHANGELOG found.</em>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="github-tutorials">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Wiki Tutorials</h3>
      </div>
      <div class="panel-body">
        
        <em>This package does not provide any links to tutorials in it's <a href="https://index.ros.org/contribute/metadata/">rosindex metadata</a>.</em>
        <em>You can check on the <a href="http://wiki.ros.org/synchros2/Tutorials" target="_blank">ROS Wiki Tutorials</a> page for the package.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="github-deps">
    <div class="row">
      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Package Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th class="text-center">Deps</th>
                  <th style="width: 100%">Name</th>
                </thead>
                <tbody>
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/action_msgs#github-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/action_msgs#github">action_msgs  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/rclpy#github-deps" class="endoftree">
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/rclpy#github">rclpy  </a></td>
                      </tr>
                    
                  
                    
                    
                      <tr>
                        <td class="text-center">
                          
                          <a href="/p/example_interfaces#github-deps" >
                            <span class="glyphicon glyphicon-arrow-left" title="Package dependencies"></span>
                          </a>
                        </td>
                        <td><a href="/p/example_interfaces#github">example_interfaces  </a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
          <div class="panel-heading">
            <h3 class="panel-title">System Dependencies</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                </thead>
                <tbody>
                  
                    
                      <tr>
                        <td><a href="/d/python3-typing-extensions">python3-typing-extensions</a></td>
                      </tr>
                    
                  
                    
                      <tr>
                        <td><a href="/d/python3-pytest">python3-pytest</a></td>
                      </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>

      <div class="col-sm-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">Dependant Packages</h3>
          </div>
          <div class="panel-body">
            
              <table class="table table-condensed table-striped">
                <thead>
                  <th>Name</th>
                  <th class="text-center">Deps</th>
                </thead>
                <tbody>
                  
                    
                    
                    <tr>
                      <td><a href="/p/bdai_ros2_wrappers#github">bdai_ros2_wrappers</a></td>
                      <td class="text-center">
                        
                        <a href="/p/bdai_ros2_wrappers#github-deps" >
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                    
                    
                    <tr>
                      <td><a href="/p/spot_common#github">spot_common</a></td>
                      <td class="text-center">
                        
                        <a href="/p/spot_common#github-deps" >
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                    
                    
                    <tr>
                      <td><a href="/p/spot_driver#github">spot_driver</a></td>
                      <td class="text-center">
                        
                        <a href="/p/spot_driver#github-deps" class="endoftree">
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                    
                    
                    <tr>
                      <td><a href="/p/spot_examples#github">spot_examples</a></td>
                      <td class="text-center">
                        
                        <a href="/p/spot_examples#github-deps" class="endoftree">
                          <span class="glyphicon glyphicon-arrow-right"></span>
                        </a>
                      </td>
                    </tr>
                    
                  
                </tbody>
              </table>
            
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="tab-pane" id="github-assets">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Launch files</h3>
      </div>
      <div class="panel-body">
        
          <em>No launch files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Messages</h3>
      </div>
      <div class="panel-body">
        
          <em>No message files found.</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Services</h3>
      </div>
      <div class="panel-body">
        
          <em>No service files found</em>
        
      </div>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Plugins</h3>
      </div>
      <div class="panel-body">
        
          <em>No plugins found.</em>
        
      </div>
    </div>
  </div>

  <div class="tab-pane" id="github-questions">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Recent questions tagged <kbd>synchros2</kbd> at <strong><a href="https://robotics.stackexchange.com/" target="_blank">Robotics Stack Exchange</a></strong></h3>      </div>
      <div id="github-question-list" class="panel-body" style="display: none;"></div>
      <div id="github-no-question-list" class="panel-body" style="display: none;">
        <p>No questions yet, you can ask one <a href="https://robotics.stackexchange.com/questions/tagged/synchros2+github">here</a>.</p>
      </div>
      <div id="github-get-question-fail" class="panel-body alert alert-warning" style="display: none;">
        <p>Failed to get question list, you can ticket an issue <a href="https://github.com/ros-infrastructure/rosindex/issues/new" target="_blank" class="alert-link">here</a> </p>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="/js/package_body_tabs.js"></script>

<script src=/js/contribution_suggestions.js></script>
<script type="text/javascript">
jQuery(function() {
    // Update the count on the links to the contribution suggestions
    updateContributionSuggestionsCountOnPackage('https://github.com/bdaiinstitute/ros_utilities.git');
});
</script>

          </div>
          <div class="col-md-2 hidden-xs hidden-sm">
            
            
            



<div class="list-group list-group-sm ">
  <a class="list-group-item"
     target="_blank"
     href="http://docs.ros.org/en/github/p/synchros2"
     title="View API documentation on docs.ros.org"
     >
       <span style="margin-right: 5px;" class="glyphicon glyphicon-file"></span>
       
       API Docs
  </a>
  <a class="list-group-item"
     target="_blank"
     href="https://github.com/bdaiinstitute/ros_utilities/tree/main/synchros2"
     title="View source code on repository">
       <span class="glyphicon glyphicon-folder-open" style="margin-right:5px;"></span>
       
       Browse Code
  </a>
  
  
  
  
  
  
</div>

          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-noetic">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>noetic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-galactic">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>galactic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-iron">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>iron</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-melodic">
    <div class="container-fluid">
      
          <div class="alert alert-warning">No version for distro <strong>melodic</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>



<script id="question-list-template" type="text/html">
  <p>
    Browse <a href="https://robotics.stackexchange.com/questions/tagged/synchros2?tab=Newest">recent questions</a>
    or see the <a href="https://robotics.stackexchange.com/questions/tagged/synchros2?tab=Votes">highest voted ones</a>.
  </p>
  
  <table class="table table-striped">
    <thead>
      <tr>
        <th scope="col">Title</th>
        <th scope="col">Answered?</th>
        <th scope="col">Created</th>
        <th scope="col">Active</th>
      </tr>
    </thead>
    <tbody>
      {{#questions}}
      <tr>
        <th scope="row"><a href="{{link}}">{{title}}</a><br><small>Tags: {{strtags}}</small></th>
        <th>{{answered}}</th>
        <th>{{created}}</th>
        <th>{{active}}</th>
      </tr>
      {{/questions}}
    </tbody>
  </table>
  {{#has_more}}
  <hr>
  <h4>Additional questions are available at
    <a href="https://robotics.stackexchange.com/questions/tagged/{{name}}?tab=Newest">Robotics Stack Exchange</a>
  </h4>
  {{/has_more}}
  
</script>

<script type="text/javascript" src="/js/mustache.js"></script>
<script type="text/javascript">
  jQuery(function() {
    jQuery.getJSON(url="https://api.stackexchange.com/2.3/questions?order=desc&site=robotics" +
                       "&tagged=synchros2&pagesize=50&sort=activity")
    .done(function(feed) {
      if (feed.items.length > 0) {
        var question_count_str = (feed.has_more ? '>' : '') + String(feed.items.length)
        const questions = feed.items.map(
          function(question) {
            question.id = Math.round(Math.random() * 99999.0);
            question.created = (new Date(question.creation_date * 1000)).toDateString()
            question.active = (new Date(question.last_activity_date * 1000)).toDateString()
            question.answered = question.is_answered ? "Yes" : "No"
            question.strtags = question.tags.join(' ')
            return question;
          });
        const template = jQuery("#question-list-template").text();
        Mustache.parse(template);
        var rendered = Mustache.render(
          template, 
          { questions: questions,
            has_more: feed.has_more,
            name: "synchros2"
          }
        );
      }
      //   TODO(tfoote) Resolve images
      //   jQuery("#-question-list img").each(function() {
      //     if (jQuery(this).attr("src").startsWith("/upfiles")) {
      //        jQuery(this).attr("src", "https://answers.ros.org" + jQuery(this).attr("src"));
      //     }
      //   });
      
      if (feed.items.length > 0) {
        jQuery("#humble-question-list").html(rendered);
        jQuery("#humble-question-list").show();
      } else {
        jQuery("#humble-no-question-list").show();
      }
      jQuery("#humble-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#jazzy-question-list").html(rendered);
        jQuery("#jazzy-question-list").show();
      } else {
        jQuery("#jazzy-no-question-list").show();
      }
      jQuery("#jazzy-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#kilted-question-list").html(rendered);
        jQuery("#kilted-question-list").show();
      } else {
        jQuery("#kilted-no-question-list").show();
      }
      jQuery("#kilted-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#rolling-question-list").html(rendered);
        jQuery("#rolling-question-list").show();
      } else {
        jQuery("#rolling-no-question-list").show();
      }
      jQuery("#rolling-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#github-question-list").html(rendered);
        jQuery("#github-question-list").show();
      } else {
        jQuery("#github-no-question-list").show();
      }
      jQuery("#github-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#noetic-question-list").html(rendered);
        jQuery("#noetic-question-list").show();
      } else {
        jQuery("#noetic-no-question-list").show();
      }
      jQuery("#noetic-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#galactic-question-list").html(rendered);
        jQuery("#galactic-question-list").show();
      } else {
        jQuery("#galactic-no-question-list").show();
      }
      jQuery("#galactic-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#iron-question-list").html(rendered);
        jQuery("#iron-question-list").show();
      } else {
        jQuery("#iron-no-question-list").show();
      }
      jQuery("#iron-questions-count").text(question_count_str);
      
      if (feed.items.length > 0) {
        jQuery("#melodic-question-list").html(rendered);
        jQuery("#melodic-question-list").show();
      } else {
        jQuery("#melodic-no-question-list").show();
      }
      jQuery("#melodic-questions-count").text(question_count_str);
      
    })
    .fail(function(jqxhr, textStatus, error) {
      console.error("Failed to get question data: " + jqxhr.responseText);
      
      jQuery("#humble-get-question-fail").show();
      
      jQuery("#jazzy-get-question-fail").show();
      
      jQuery("#kilted-get-question-fail").show();
      
      jQuery("#rolling-get-question-fail").show();
      
      jQuery("#github-get-question-fail").show();
      
      jQuery("#noetic-get-question-fail").show();
      
      jQuery("#galactic-get-question-fail").show();
      
      jQuery("#iron-get-question-fail").show();
      
      jQuery("#melodic-get-question-fail").show();
      
    });
  });
</script>


<script type="text/javascript">
  $(document).ready(function() {
    setupDistroSwitch("humble");
  });
</script>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="container-fluid">
      <div style="float:left;">
        
          <a href="https://github.com/rkent/rosindex" title="Find rosindex in Github">
          <span class="icon  icon--github">
            <svg viewBox="0 0 16 16">
              <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
            </svg>
          </span>

          <span class="username">rkent/rosindex</span>
        </a>
        <em class="hidden-xs">| generated on 2025-05-05</em>
      
      </div>
      <div style="float:right;">
        <p class="text"><span class="hidden-xs">a community-maintained index of robotics software
 | </span><a href="/privacy.txt">privacy</a></p>
      </div>
    </div>
  </div>

</footer>


  </body>

</html>
